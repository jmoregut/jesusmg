---
author: "Nombre Completo Autor"
date: "27/10/2017"
documentclass: book
forprint: true  # true: imprime a dos caras, false: libro digital
fontsize: 12pt # 10pt,11pt
geometry: margin = 2.5cm 
bibliography: ["bib/library.bib", "bib/paquetes.bib"]
# metodobib -> true: natbib (descomentar: citation_package: natbib) 
#           -> false: pandoc (comentar: citation_package: natbib)
metodobib: true
#natbib: plainnat, abbrvnat, unsrtnat
biblio-style: "plainnat"
#Método 2 (pandoc): descomente una línea de las 2 siguientes en caso de usarlo
csl: methods-in-ecology-and-evolution.csl      # no numera mejor en las citas
#csl: acm-sig-proceedings-long-author-list.csl  # numera peor en las citas
link-citations: yes
output: 
  pdf_document:
    keep_tex: no
    number_sections: yes
    citation_package: natbib  # comentado usa: pandoc-citeproc
    #toc: yes
    fig_caption: yes
    template: latex/templateMemoriaTFE.tex
    includes:
      #before_body: portadas/latex_paginatitulo_modTFE.tex
      #in_header: latex/latex_preambulo.tex
      #after_body: latex/latex_antes_enddoc.tex
---

```{r,include=FALSE,echo=FALSE}
r = getOption("repos")
r["CRAN"] = "http://cran.us.r-project.org"

```

<!-- \setcounter{chapter}{2} -->
<!-- \setcounter{chapter}{2} escribir 2 para capítulo 3  -->
<!-- \pagenumbering{arabic} -->


\ifdefined\ifprincipal
\else
\setlength{\parindent}{1em}
\pagestyle{fancy}
\setcounter{tocdepth}{4}
\tableofcontents
<!-- \nocite{*} -->
\fi

\ifdefined\ifdoblecara
\fancyhead{}{}
\fancyhead[LE,RO]{\scriptsize\rightmark}
\fancyfoot[LO,RE]{\scriptsize\slshape \leftmark}
\fancyfoot[C]{}
\fancyfoot[LE,RO]{\footnotesize\thepage}
\else
\fancyhead{}{}
\fancyhead[RO]{\scriptsize\rightmark}
\fancyfoot[LO]{\scriptsize\slshape \leftmark}
\fancyfoot[C]{}
\fancyfoot[RO]{\footnotesize\thepage}
\fi
\renewcommand{\headrulewidth}{0.4pt}
\renewcommand{\footrulewidth}{0.4pt}

# Anexo

## Código R utilizado para la depuración de la base de datos



```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Técnicas Multivariantes en Sports Analytics

Vamos a trabajar con una base de datos que nos ha sido cedida por el CAMD(Centro Andaluz de Medicina Deportiva)
Lectura de los datos:

```{r}
r = getOption("repos")
r["CRAN"] = "http://cran.us.r-project.org"
install.packages("readxl")
library(readxl)
datostfg=read_excel("datostfg.xlsx")
datostfg2=data.frame(datostfg)
```
Vamos a tratar la base de datos para hacerla más manejable.

Vamos a ir corrigiendo y modificando algunas variables:

```{r,include=TRUE}
####Variable 1 CENTRE:Centro en el que ha sido examinado.

table(datostfg2[,1]) ###En 4 casos no se especifica el centro

####Variable 2 NHC.CENTRO

table(datostfg2[,2]) ####Casos 2 y 10 estudiar 

####Variable 3 NHC.CORPORATIVO
datostfg2[,2]==datostfg2[,3] ####No siempre coinciden el NHC.CENTRO con el NHC.CORPORATIVO
table(datostfg2[,3]) ####Casos 2 y 10 estudiar 

####Variable 4 COBERTURA

table(datostfg2[,4])

####Variable 5(FECHA ALTA SISTEMA) Fecha de alta en el sistema
table(datostfg2[,5])

####Variable 6 (FECHA) Fecha en la que se realiza el protocolo
table(datostfg2[,6])

####Variable 7 (Sexo)
table(datostfg2[,7])

###Variable 8 (Otros Antecedentes)
table(datostfg2[,8])

###Variable 9 (Cardiopatía Isquémica)
table(datostfg2[,9])

###Variable 10 (Otras Cardiopatías)
table(datostfg2[,10])

###Variable 11 (Enf.Respiratoria) Enfermedades Respiratorias
table(datostfg2[,11])

###Variable 12 (Oncológicos)
table(datostfg2[,12])

####Variable 13 (Diabetes Tipo 1)
table(datostfg2[,13])

####Variable 14 (Hipertensión arterial)
table(datostfg2[,14])

####Variable 15 (Dislipemia)
table(datostfg2[,15])
```

```{r,include=TRUE}
####Variable 16

####Solo consideraremos las enfermedades cardiovasculares y anomalías correspondientes al corazón,así como problemas de circulación sanguínea.Si el paciente tiene ancedentes familiares de enfermedades cardiovasculares o de problemas de circulación,la variable que voy a crear debe presentar un 1,en caso contrario presentará un 0.
table(datostfg2[1:1000,16])
table(datostfg2[10984:11984,16])
grep400=grep("segundo",datostfg2[,16])
datostfg2[grep400,16]
grep401=grep("2 grado",datostfg2[,16])
datostfg2[grep401,16]
grep=grep("^no",datostfg2[,16])
datostfg2[grep,16]
datostfg2[grep[c(4,10,59,262,265,276,339)],16]="Desconoce"
grep_=grep[c(37,43,45,84,85,73,157,220,228,285,291,366)]###No muerte súbita
grep=grep[-c(37,43,45,84,85,73,157,220,228,285,291,366,4,10,59,262,265,276,339)]
datostfg2[,16]=replace(datostfg2[,16],grep,"No")

grep2=grep("^No",datostfg2[,16])
datostfg2[grep2,16]
datostfg2[grep2[c(572,871)],16]="Desconoce"
####No reemplazamos por "No" porque hay casos en los que pone que no hay antecedentes y a continuación pone trombosis,ACV, por lo que lo dejare igual para no perder información 
grep3=grep("^NO",datostfg2[,16])
datostfg2[grep3,16] ###No reemplazo para no perder cierta información
grep4=grep("^desconoce",datostfg2[,16])
datostfg2[,16]=replace(datostfg2[,16],grep4,"Desconoce")
grep5=grep("^mo",datostfg2[,16])
datostfg2[grep5,16]
datostfg2[,16]=replace(datostfg2[,16],grep5,"No")
grep7=grep("^ni",datostfg2[,16])
datostfg2[,16]=replace(datostfg2[,16],grep7,"No")
grep8=grep("^revisar",datostfg2[,16])
datostfg2[,16]=replace(datostfg2[,16],grep8,"Desconoce")
grep13=grep("Revisar",datostfg2[,16])
datostfg2[,16]=replace(datostfg2[,16],grep13,"Desconoce")
datostfg2[91,16]
datostfg2[91,16]="No"
grep53=grep("^Sin",datostfg2[,16])
datostfg2[grep53,16]
grep53=grep53[-c(2,5,6,23)]
grep54=grep("^sin",datostfg2[,16])
datostfg2[grep54,16]
grep48=grep("^SIN",datostfg2[,16])
grep753=grep("NR",datostfg2[,16])
datostfg2[grep753,16]
grep754=grep("^N.R",datostfg2[,16])
datostfg2[grep754,16]


grep9=grep("ACV",datostfg2[,16])
grep10=grep("AVC",datostfg2[,16])

grep11=grep("ICTUS",datostfg2[,16])
grep12=grep("ictus",datostfg2[,16])
grep21=grep("Ictus",datostfg2[,16])
grep14=grep("trombo",datostfg2[,16])
grep22=grep("Trombo",datostfg2[,16])
grep23=grep("TROMBO",datostfg2[,16])
grep24=grep("Tombo",datostfg2[,16])
datostfg2[grep24,16]
grep41=grep("coagulo",datostfg2[,16])
datostfg2[grep41,16]
grep42=grep("Coagulo",datostfg2[,16])
datostfg2[grep42,16]
grep248=grep("COAGUL",datostfg2[,16])
grep43=grep("IAM",datostfg2[,16])
datostfg2[grep43,16]
grep48=grep("^ ",datostfg2[,16])
grep402=grep("IAT",datostfg2[,16])
datostfg2[grep402,16]
grep248=grep("Embol",datostfg2[,16])
grep15=grep("embolia", datostfg2[,16])
grep25=grep("EMBO", datostfg2[,16])
datostfg2[grep25,16]
grep16=grep("derrame cerebral",datostfg2[,16])
grep245=grep("DERRAME",datostfg2[,16])
grep17=grep("problemas cardiacos",datostfg2[,16])
grep246=grep("CARDI",datostfg2[,16])
grep247=grep("Cardio",datostfg2[,16])
grep247=grep("cardio",datostfg2[,16])
datostfg2[grep247,16]
grep26=grep("cerebelo",datostfg2[,16])
datostfg2[grep26,16]
grep248=grep("CEREBEL",datostfg2[,16])
grep27=grep("Aneurisma",datostfg2[,16])
grep28=grep("aneurisma",datostfg2[,16])
grep29=grep("ANEURISMA",datostfg2[,16])
grep40=grep("CEREBR",datostfg2[,16])

grep17=grep17[-c(2)]
grep18=grep("cerebr",datostfg2[,16])
datostfg2[grep18,16]
grep19=grep("Encefalo",datostfg2[,16])
datostfg2[grep19,16]
grep248=grep("ENCE",datostfg2[,16])
grep30=grep("arteri",datostfg2[,16])
datostfg2[grep30,16]
grep30=grep30[-c(9,14,18)]
grep31=grep("problemas circulatorios",datostfg2[,16])
datostfg2[grep31,16]
datostfg2[grep31,175]
grep248=grep("CIRCULA",datostfg2[,16])
grep32=grep("ideopatica",datostfg2[,16])
datostfg2[584,16]
grep248=grep("IDEOPA",datostfg2[,16])
grep33=grep("Arteri",datostfg2[,16])
datostfg2[grep33,16]
grep248=grep("ARTERI",datostfg2[,16])
grep34=grep("Varices",datostfg2[,16])
datostfg2[grep34,16]
grep35=grep("varices",datostfg2[,16])
datostfg2[grep35,16]
grep248=grep("VARICES",datostfg2[,16])
grep36=grep("Vascu",datostfg2[,16])
grep4010=grep("vascu",datostfg2[,16])
grep248=grep("VASCU",datostfg2[,16])
grep37=grep("venosa",datostfg2[,16])
datostfg2[grep37,16]
grep248=grep("VENOSA",datostfg2[,16])
grep248=grep("Venosa",datostfg2[,16])
grep44=grep("tension",datostfg2[,16])
grep248=grep("Tension",datostfg2[,16])
grep248=grep("TENSION",datostfg2[,16])
datostfg2[grep44,16]
grep44=grep44[c(1,2,3)]
grep6=grep("taqui",datostfg2[,16])
grep248=grep("TAQUI",datostfg2[,16])
grep248=grep("Taqui",datostfg2[,16])
datostfg2[grep6,16]
 

grep6
grep249=grep("arritmia",datostfg2[,16])

datostfg2[grep249,16]
grep250=grep("Arritmia",datostfg2[,16])
datostfg2[grep250,16]
grep248=grep("ARRIT",datostfg2[,16])
grep248=grep("El paciente refiere",datostfg2[,16])
grep248=grep("EL PACIENTE REFIERE",datostfg2[,16])
grep252=grep("angina",datostfg2[,16])
grep253=grep("?ngor",datostfg2[,16])
grep253=grep("angor",datostfg2[,16])
grep253=grep("Angor",datostfg2[,16])
grep253=grep("Angina",datostfg2[,16])
grep253=grep("ANGOR",datostfg2[,16])
grep253=grep("ANGINA",datostfg2[,16])

grep253=grep("insuf",datostfg2[,16])
datostfg2[grep253,16]
grep253=grep("insuficiencia venosa",datostfg2[,16])
datostfg2[grep253,16]
grep254=grep("insuficiencia cardio",datostfg2[,16])
datostfg2[grep254,16]
grep255=grep("insuficienci venosa",datostfg2[,16])
datostfg2[grep255,16]
grep256=grep("insuficiencia vascular",datostfg2[,16])
datostfg2[grep256,16]
grep257=grep("Insuf",datostfg2[,16])
datostfg2[grep257,16]
grep257=grep("Insuficiencia venosa",datostfg2[,16])
datostfg2[grep257,16]
datostfg2[grep257,175]
grep258=grep("Insuficiencia circul",datostfg2[,16])
grep259=grep("INSUF",datostfg2[,16])
datostfg2[grep259,16] ###No lo tomamos
grep259=grep("HTA",datostfg2[,16])
datostfg2[grep259,16]
grep260=grep("Hta",datostfg2[,16])
grep260=grep("hta",datostfg2[,16])
datostfg2[grep260,16]
grep261=grep("infarto",datostfg2[,16])
grep262=grep("INFARTO",datostfg2[,16])
grep262=grep("Infarto",datostfg2[,16])
grep268=grep("WPW",datostfg2[,16])

grep269=grep("estrecha",datostfg2[,16])
grep269=grep("Valvu",datostfg2[,16])
grep269=grep("valvu",datostfg2[,16])
datostfg2[grep269,16]
grep270=grep("Marcap",datostfg2[,16])
grep270=grep("marcap",datostfg2[,16])
datostfg2[grep270,16]
grep271=grep("W-P-W",datostfg2[,16])
grep271=grep("edema",datostfg2[,16])
grep272=grep("ESTRECHA",datostfg2[,16])
grep272=grep("VALVU",datostfg2[,16])
grep272=grep("EDEMA",datostfg2[,16])
grep272=grep("MARCA",datostfg2[,16])

grep272=grep("miocardio",datostfg2[,16])
grep272=grep("Miocardio",datostfg2[,16])
datostfg2[grep272,16]
grep273=grep("MIOCARD",datostfg2[,16])

grep273=grep("Soplo",datostfg2[,16])
grep273=grep("SOPLO",datostfg2[,16])
grep273=grep("soplo",datostfg2[,16])
datostfg2[grep273,16]
grep274=grep("Bradicardia",datostfg2[,16])
datostfg2[grep274,16]
grep275=grep("bradicard",datostfg2[,16])
grep275=grep("Corazon",datostfg2[,16])
grep275=grep("corazon",datostfg2[,16])
grep275=grep("CORA",datostfg2[,16])
grep275=grep("vasos",datostfg2[,16])
grep275=grep("Vasos",datostfg2[,16])
grep275=grep("VASOS",datostfg2[,16])
grep1006=grep("coagula",datostfg2[,16])
datostfg2[grep1006,16]
grep1007=grep("cardiaco",datostfg2[,16])
datostfg2[grep1007,16]
grep1007=grep1007[-c(3)]
grep1008=grep("ACVA",datostfg2[,16])
datostfg2[grep1008,16]
grep1009=grep("A.C.V",datostfg2[,16])
datostfg2[grep1009,16]


grep20=grep("s?bita",datostfg2[,16])
datostfg2[grep20,16]
datostfg2[grep20[c(1001:1731)],16]
datostfg2[10087,16]
grepA.V.C=10087
grep10=c(grep10,grepA.V.C)
datostfg2[grep257,175]
grep4015=grep("s?ta ",datostfg2[,16])
datostfg2[grep4015,16]

grep20_3=grep20[c(31,32,44,45,49,56,61,74,110,122,130,141,143,175,177,200,263,278,333,364,372,426,454,457,469,491,493,518,523,561,566,576,622,665,669,673,674,729,733,938,985,1001,1032,1057,1108,1130,1170,1185,1187,1265,1271,1278,1331,1421,1669,1719,1722)] ###Muerte súbita
grep20_4=grep20[-c(31,32,44,45,49,56,61,74,110,122,130,141,143,175,177,200,263,278,333,364,372,426,454,457,469,491,493,518,523,561,566,576,622,665,669,673,674,729,733,938,985,1001,1032,1057,1108,1130,1170,1185,1187,1265,1271,1278,1331,1421,1669,1719,1722)] ###Sin Muerte súbita

grep38=grep("S?bita",datostfg2[,16])
datostfg2[grep38,16]
grep38==grep20

grep39=grep("S?BITA",datostfg2[,16])
datostfg2[grep39,16]
grep39_1=grep39[c(1,2,3)] ##No muerte súbita
grep39_2=grep39[c(4)] ##muerte súbita
grep132=grep("MS",datostfg2[,16])
datostfg2[grep132,16]
grep132_1=grep132[c(1,2,9,19)] ###Muerte súbita
grep132_2=grep132[-c(1,2,9,19)] ###Sin Muerte súbita

###Vamos a crear dos nuevas variables, la primera indicará si  algún familiar del deportista ha sufrido un accidente cerebrovascular,tiene problemas y/o anomalias cardiacas o problemas de circulación, mientras que la segunda indicará si hay antecedentes de muerte súbita en su familia.(El 1 representa el éxito)

datostfg2[,175]=c(rep(NA,11984))
datostfg2[,176]=c(rep(NA,11984))

datostfg2[,175]=replace(datostfg2[,175],grep,"3")
datostfg2[,175]=replace(datostfg2[,175],grep2,"3")
datostfg2[,175]=replace(datostfg2[,175],grep3,"3")
datostfg2[,175]=replace(datostfg2[,175],grep4,"3")
datostfg2[,175]=replace(datostfg2[,175],grep5,"3")
datostfg2[,175]=replace(datostfg2[,175],grep7,"3")
datostfg2[,175]=replace(datostfg2[,175],grep53,"3")
datostfg2[,175]=replace(datostfg2[,175],grep54,"3")
datostfg2[,175]=replace(datostfg2[,175],grep753,"3")
datostfg2[,175]=replace(datostfg2[,175],grep6,"1")
datostfg2[,175]=replace(datostfg2[,175],grep9,"1")
datostfg2[,175]=replace(datostfg2[,175],grep10,"1")
datostfg2[,175]=replace(datostfg2[,175],grep11,"1")
datostfg2[,175]=replace(datostfg2[,175],grep12,"1")
datostfg2[,175]=replace(datostfg2[,175],grep14,"1")
datostfg2[,175]=replace(datostfg2[,175],grep15,"1")
datostfg2[,175]=replace(datostfg2[,175],grep16,"1")
datostfg2[,175]=replace(datostfg2[,175],grep17,"1")
datostfg2[,175]=replace(datostfg2[,175],grep18,"1")
datostfg2[,175]=replace(datostfg2[,175],grep19,"1")
datostfg2[,175]=replace(datostfg2[,175],grep21,"1")
datostfg2[,175]=replace(datostfg2[,175],grep24,"1")
datostfg2[,175]=replace(datostfg2[,175],grep25,"1")
datostfg2[,175]=replace(datostfg2[,175],grep26,"1")
datostfg2[,175]=replace(datostfg2[,175],grep27,"1")
datostfg2[,175]=replace(datostfg2[,175],grep28,"1")
datostfg2[,175]=replace(datostfg2[,175],grep29,"1")
datostfg2[,175]=replace(datostfg2[,175],grep30,"1")
datostfg2[,175]=replace(datostfg2[,175],grep31,"1")
datostfg2[,175]=replace(datostfg2[,175],grep32,"1")
datostfg2[,175]=replace(datostfg2[,175],grep33,"1")
datostfg2[,175]=replace(datostfg2[,175],grep34,"1")
datostfg2[,175]=replace(datostfg2[,175],grep35,"1")
datostfg2[,175]=replace(datostfg2[,175],grep36,"1")
datostfg2[,175]=replace(datostfg2[,175],grep37,"1")
datostfg2[,175]=replace(datostfg2[,175],grep40,"1")
datostfg2[,175]=replace(datostfg2[,175],grep41,"1")
datostfg2[,175]=replace(datostfg2[,175],grep42,"1")
datostfg2[,175]=replace(datostfg2[,175],grep43,"1")
datostfg2[,175]=replace(datostfg2[,175],grep44,"1")
datostfg2[,175]=replace(datostfg2[,175],grep245,"1")
datostfg2[,175]=replace(datostfg2[,175],grep246,"1")
datostfg2[,175]=replace(datostfg2[,175],grep247,"1")
datostfg2[,175]=replace(datostfg2[,175],grep249,"1")
datostfg2[,175]=replace(datostfg2[,175],grep250,"1")
datostfg2[,175]=replace(datostfg2[,175],grep252,"1")
datostfg2[,175]=replace(datostfg2[,175],grep253,"1")
datostfg2[,175]=replace(datostfg2[,175],grep254,"1")
datostfg2[,175]=replace(datostfg2[,175],grep255,"1")
datostfg2[,175]=replace(datostfg2[,175],grep256,"1")
datostfg2[,175]=replace(datostfg2[,175],grep257,"1")
datostfg2[,175]=replace(datostfg2[,175],grep258,"1")
datostfg2[,175]=replace(datostfg2[,175],grep259,"1")
datostfg2[,175]=replace(datostfg2[,175],grep260,"1")
datostfg2[,175]=replace(datostfg2[,175],grep261,"1")
datostfg2[,175]=replace(datostfg2[,175],grep262,"1")
datostfg2[,175]=replace(datostfg2[,175],grep268,"1")
datostfg2[,175]=replace(datostfg2[,175],grep269,"1")
datostfg2[,175]=replace(datostfg2[,175],grep270,"1")
datostfg2[,175]=replace(datostfg2[,175],grep271,"1")
datostfg2[,175]=replace(datostfg2[,175],grep272,"1")
datostfg2[,175]=replace(datostfg2[,175],grep273,"1")
datostfg2[,175]=replace(datostfg2[,175],grep274,"1")
datostfg2[,175]=replace(datostfg2[,175],grep402,"1")
datostfg2[,175]=replace(datostfg2[,175],grep1006,"1")
datostfg2[,175]=replace(datostfg2[,175],grep1007,"1")
datostfg2[,175]=replace(datostfg2[,175],grep1008,"1")
datostfg2[,175]=replace(datostfg2[,175],grep1009,"1")
datostfg2[,175]=replace(datostfg2[,175],grep4010,"1")
table(datostfg2[,175])
datostfg2[grep1009,175]

for (i in 1:11984){comp=(
  is.na(datostfg2[i,175])==TRUE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,175]="2"
}else{
        datostfg2[i,175]=datostfg2[i,175]
}}

grep4000=grep("2",datostfg2[,175])
table(datostfg2[grep4000,16])
datostfg2[grep4000,175]=NA
grep4011=grep("cicula",datostfg2[,16])
datostfg2[,175]=replace(datostfg2[,175],grep4011,"1")
grep4012=grep("sintron",datostfg2[,16])
datostfg2[,175]=replace(datostfg2[,175],grep4012,"1")
grep4013=grep("Sintron",datostfg2[,16])
datostfg2[,175]=replace(datostfg2[,175],grep4013,"1")
grep4014=grep("hemorra",datostfg2[,16])
datostfg2[grep4014,16]
datostfg2[,175]=replace(datostfg2[,175],grep4014,"1")
table(datostfg2[,175])

datostfg2[,176]=replace(datostfg2[,176],grep,"0")
datostfg2[,176]=replace(datostfg2[,176],grep2,"0")
datostfg2[,176]=replace(datostfg2[,176],grep3,"0")
datostfg2[,176]=replace(datostfg2[,176],grep4,"0")
datostfg2[,176]=replace(datostfg2[,176],grep5,"0")
datostfg2[,176]=replace(datostfg2[,176],grep7,"0")
datostfg2[,176]=replace(datostfg2[,176],grep53,"0")
datostfg2[,176]=replace(datostfg2[,176],grep54,"0")
datostfg2[,176]=replace(datostfg2[,176],grep_,"0")
datostfg2[,176]=replace(datostfg2[,176],grep20_4,"0")
datostfg2[,176]=replace(datostfg2[,176],grep39_1,"0")
datostfg2[,176]=replace(datostfg2[,176],grep132_2,"0")
datostfg2[,176]=replace(datostfg2[,176],grep20_3,"1")
datostfg2[,176]=replace(datostfg2[,176],grep39_2,"1")
datostfg2[,176]=replace(datostfg2[,176],grep132_1,"1")
datostfg2[,176]=replace(datostfg2[,176],grep753,"0")


table(datostfg2[,176])

###Vamos a ponerle nombre a las nuevas variables

colnames(datostfg2)[175]="Familiar_ACV_PrCar_Cir"
colnames(datostfg2)[176]="Familiar_MuerteSubita"


```

```{r,include=TRUE}
###Variable 17

grep45=grep("^no",datostfg2[,17])
datostfg2[grep45,17]
datostfg2[grep45[c(1,2)],9]
datostfg2[grep45[c(85)],17]="Desconoce"
grep45_1=grep45[c(1,2)] 
grep45_2=grep45[-c(1,2)] ###No antecedentes 
datostfg2[,17]=replace(datostfg2[,17],grep45_2,"El deportista no refiere antecedentes de cardiopatia isquemica en sus familiares ( hasta segundo grado).")
grep46=grep("segundo",datostfg2[,17])
datostfg2[grep46,17]
datostfg2[,17]=replace(datostfg2[,17],grep46,"El deportista no refiere antecedentes de cardiopatia isquemica en sus familiares ( hasta segundo grado).")

grep401=grep("2 grado",datostfg2[,17])
grep47=grep("^No",datostfg2[,17])
datostfg2[grep47[1:1000],17]
datostfg2[grep47[c(7)],17]="Si,sin especificar"
grep47si=grep47[c(7)]
grep47=grep47[-c(7)]
datostfg2[,17]=replace(datostfg2[,17],grep46,"El deportista no refiere antecedentes de cardiopatia isquemica en sus familiares ( hasta segundo grado).")
 




grep49=grep("^NO",datostfg2[,17])
datostfg2[grep49,17]

grep50= grep("Sin",datostfg2[,17])
datostfg2[grep50,17]
datostfg2[grep50[c(11)],17]
datostfg2[grep50[c(11)],175]="1"
grep50=grep50[-c(11)]
###No uso replace para no perder informacion sobre muertes subitas
grep51= grep("sin",datostfg2[,17])
datostfg2[grep51,17]
datostfg2[grep51[c(49)],17]="Desconoce"
datostfg2[grep51[c(1,11,22,24,25,26,28,30,32,34,35,37,38,47,48,64,65,74,79,87,93,103,110,114,117,128,135,142,143,152,153,154,156,158,159)],17]
datostfg2[grep51[c(1,11,22,24,25,26,28,30,32,34,35,37,38,47,48,64,65,74,79,87,93,103,110,114,117,128,135,142,143,152,153,154,156,158,159)],175]="1"
grep51=grep51[-c(1,11,22,24,25,26,28,30,32,34,35,37,38,47,48,64,65,74,79,87,93,103,110,114,117,128,135,142,143,152,153,154,156,158,159)]
###No uso replace para no perder informacion sobre muertes subitas
grep52= grep("SIN",datostfg2[,17])
datostfg2[grep52,17]
datostfg2[grep52[c(8,18,20)],17]
datostfg2[grep52[c(8,18,20)],175]
grep52=grep52[-c(8,18,20)]
datostfg2[,17]=replace(datostfg2[,17],grep52,"No refiere antecedentes de cardiopatia isquemica en sus familiares o estos no tienen interes.")
grep113=grep("^Si",datostfg2[,17])
datostfg2[grep113,17] ###Error al escribir sin interes
datostfg2[,17]=replace(datostfg2[,17],grep113,"No refiere antecedentes de cardiopatia isquemica en sus familiares o estos no tienen interes.")
grep114=grep("^si",datostfg2[,17])
datostfg2[grep114,17] ###Sin errores
grep115=grep("^SI",datostfg2[,17])
datostfg2[grep115,17] ###Sin errores
grep754=grep("NR",datostfg2[,17])
datostfg2[grep754,17]
grep755=grep("^N.R",datostfg2[,17])




table(datostfg2[,17])


grep55=grep("ACV",datostfg2[,17])
datostfg2[grep55,9]
datostfg2[grep55,17]
grep248=grep("AVC",datostfg2[,17])
datostfg2[grep55,17]
grep56=grep("infarto",datostfg2[,17])
grep61=grep("INFARTO",datostfg2[,17])
grep62=grep("Infarto",datostfg2[,17])
grep57=grep("ICTUS",datostfg2[,17])
grep58=grep("ictus",datostfg2[,17])
grep59=grep("Ictus",datostfg2[,17])
grep60=grep("trombo",datostfg2[,17])
datostfg2[grep60,9]
datostfg2[grep60,17]
grep248=grep("Trombo",datostfg2[,17])
grep248=grep("TROMBO",datostfg2[,17])
grep248=grep("Tombo",datostfg2[,17])
grep70=grep("iAM",datostfg2[,17])
grep71=grep("IAM",datostfg2[,17])
grep72=grep("iam",datostfg2[,17])
grep144=grep("taqui",datostfg2[,17])
datostfg2[grep144,9]
datostfg2[grep144,17]
grep251=grep("TAQUI",datostfg2[,17])
grep251=grep("Taqui",datostfg2[,17])
datostfg2[grep144,17]
grep248=grep("TAQUI",datostfg2[,17])
grep248=grep("Taqui",datostfg2[,17])
grep248=grep("coagulo",datostfg2[,17])
grep248=grep("Coagulo",datostfg2[,17])
grep248=grep("COAGULO",datostfg2[,17])
grep248=grep("Embo", datostfg2[,17])
grep63=grep("embolia", datostfg2[,17])
datostfg2[grep63,9]
grep64=grep("EMBO", datostfg2[,17])
grep64=grep("derrame cerebral",datostfg2[,17])
grep403=grep("IAT",datostfg2[,17])
grep248=grep("DERRAME",datostfg2[,17])
grep64=grep("problemas cardiacos",datostfg2[,17])
datostfg2[grep64,17]
grep65=grep("cerebelo",datostfg2[,17])
grep248=grep("CEREBEL",datostfg2[,17])
grep65=grep("Aneurisma",datostfg2[,17])
grep66=grep("aneurisma",datostfg2[,17])
grep67=grep("ANEURISMA",datostfg2[,17])
grep67=grep("CEREBR",datostfg2[,17])

grep67=grep("cerebr",datostfg2[,17])
datostfg2[grep67,9]
datostfg2[grep67,17]
grep68=grep("Encefalo",datostfg2[,17])
grep248=grep("CIRCULA",datostfg2[,17])
grep248=grep("ENCE",datostfg2[,17])
grep68=grep("arteri",datostfg2[,17])
datostfg2[grep68,17]
grep69=grep("problemas circulatorios",datostfg2[,17])
grep69=grep("arritmia",datostfg2[,17])
grep145=grep("Arritmia",datostfg2[,17])
datostfg2[grep145,17]
grep248=grep("ARRIT",datostfg2[,17])
grep251=grep("IDEOPA",datostfg2[,17])
grep251=grep("ARTERI",datostfg2[,17])
datostfg2[grep248,17]
grep146=grep("El paciente refiere",datostfg2[,17])
datostfg2[grep146,17]
grep147=grep("Cardio",datostfg2[,17])
datostfg2[grep147,17]
grep148=grep("CARDIO",datostfg2[,17])
datostfg2[grep148,17]
grep149=grep("EL PACIENTE REFIERE",datostfg2[,17])
datostfg2[grep149,17]
grep73=grep("Arteri",datostfg2[,17])
grep74=grep("Varices",datostfg2[,17])
grep74=grep("varices",datostfg2[,17])
grep251=grep("VARICES",datostfg2[,17])
grep74=grep("Vasculitis",datostfg2[,17])
grep251=grep("vasculitis",datostfg2[,17])
grep251=grep("VASCU",datostfg2[,17])
grep74=grep("venosa",datostfg2[,17])
grep251=grep("VENOSA",datostfg2[,17])
grep251=grep("Venosa",datostfg2[,17])
grep74=grep("tension",datostfg2[,17])
grep251=grep("Tension",datostfg2[,17])
grep251=grep("TENSION",datostfg2[,17])

grep265=grep("HTA",datostfg2[,17])
datostfg2[grep265,17]
datostfg2[grep265,9]
grep266=grep("Hta",datostfg2[,17])
grep266=grep("hta",datostfg2[,17])

grep75=grep("angina",datostfg2[,17])
grep76=grep("?ngor",datostfg2[,17])
grep77=grep("angor",datostfg2[,17])
grep78=grep("Angor",datostfg2[,17])
grep79=grep("Angina",datostfg2[,17])
grep80=grep("ANGOR",datostfg2[,17])
grep81=grep("ANGINA",datostfg2[,17])
grep82=grep("aBU",datostfg2[,17])
datostfg2[grep82,17]
grep83=grep("Abuelo",datostfg2[,17])
datostfg2[grep83,17]
grep84=grep("fallece por cardiopatia",datostfg2[,17])
grep85=grep("insuf",datostfg2[,17])
datostfg2[grep85,17]
datostfg2[grep85,9]
grep86=grep("IM",datostfg2[,17])
datostfg2[grep86,17]
grep87=grep("Abuela",datostfg2[,17])
datostfg2[grep87,17]
grep88=grep("abu",datostfg2[,17])
datostfg2[grep88,17]
grep89=grep("Padre",datostfg2[,17])
datostfg2[grep89,17]
grep90=grep("padre",datostfg2[,17])
datostfg2[grep90,17]
grep91=grep("Madre",datostfg2[,17])
datostfg2[grep91,17]
grep92=grep("madre",datostfg2[,17])
datostfg2[grep92,17]
grep93=grep("TIO",datostfg2[,17])
datostfg2[grep93,17]
grep93_2=grep93[c(1,3,4,6,8)]###Sin antecedentes hasta segundo grado
grep94=grep("Tio",datostfg2[,17])
datostfg2[grep94,17]
grep94=grep94[-c(1)]
grep94_2=grep94[c(2,4,5,6,8,10,14,16,17,20,21,22,23,24,30,31,34,35,38,43,44,49,51,52,54,55,60,63,64,65,67,70,71,73,75,76,77,78,79,81,82,83,84,85,88,89,90,91,94,95,96,97,98,103,104,108,109,110,112,114,115,117,118,121,129,132,135,136,137,140,141,143,145,146,148,149,152,153,154,155,156,157,163,165,166,167,170,171,176,177,179,180,182,184,185,188,189,192,195,197,200,203,205,208,210)] ###Sin antecedentes hasta segundo grado
grep95=grep("^T",datostfg2[,17])
datostfg2[grep95,17]
grep95_2=grep95[-c(1,25,26,30,49,83,86,88,98,99,103,106,107,113,117,122,123,156,192,200,204,205,206,215,222,260,264,265,272,279,282,302,310,316,319,322,324,327,331)]  ###Sin antecedentes hasta segundo grado

grep97=grep("tIO",datostfg2[,17])
datostfg2[grep97,17]
grep98=grep("^TIA",datostfg2[,17])
datostfg2[grep98,17]
grep98_2=grep98 ###Sin antecedentes hasta segundo grado
grep99=grep("Tia",datostfg2[,17])
datostfg2[grep99,17]
grep99_2=grep99[-c(10,11,14,15,16,17,25,26,27,29,32)] ###Sin antecedentes hasta segundo grado
grep100=grep("^t",datostfg2[,17])
datostfg2[grep100,17]
grep100_2=grep100[-c(4,11,13,17,20)] ###Sin antecedentes hasta segundo grado
grep101=grep("PRIM",datostfg2[,17])
datostfg2[grep101,17]
grep102=grep("Prim",datostfg2[,17])
datostfg2[grep102,17]
grep102_2=grep102[c(3,5,6,7,10,12,13,14,15,16,20,23,24,25,26,27,28,29,30,31,34)] ###Sin antecedentes hasta segundo grado
grep103=grep("prim",datostfg2[,17])
datostfg2[grep103,17]
grep103_2=grep103[c(1,6,7,8,11,14,15,16,19,21,22)] ###Sin antecedentes hasta segundo grado
grep104=grep("pim",datostfg2[,17])
datostfg2[grep104,17]
grep104_2=grep104
grep105=grep("Ste",datostfg2[,17])
grep242=grep(" stent",datostfg2[,17])
datostfg2[grep242,17]
grep243=grep("STE",datostfg2[,17])
datostfg2[grep243,17]
grep106=grep("PADRE",datostfg2[,17])
datostfg2[grep106,17]
grep107=grep("MADRE",datostfg2[,17])
datostfg2[grep107,17]
grep108=grep("ABU",datostfg2[,17])
datostfg2[grep108,17]
grep112=grep("El deportista refiere",datostfg2[,17])
datostfg2[grep112,17]
grep116=grep("Aba",datostfg2[,17])
datostfg2[grep116,17]
grep117=grep("Abo",datostfg2[,17])
datostfg2[grep117,17]
grep118=grep("ABA",datostfg2[,17])
datostfg2[grep118,17]
grep119=grep("ABO",datostfg2[,17])
datostfg2[grep119,17]
grep120=grep("aba",datostfg2[,17])
datostfg2[grep120,17]
grep121=grep("abo",datostfg2[,17])
datostfg2[grep121,17]
grep119=grep("HIJO",datostfg2[,17])
grep119=grep("Hijo",datostfg2[,17])
grep119=grep("hijo",datostfg2[,17])
datostfg2[grep119,17]


###Veamos si hay más casos de intéres,por ejemplo con sobrinos.
grep109=grep("Sobri",datostfg2[,17])
datostfg2[grep109,17]
grep110=grep("SOBRI",datostfg2[,17])
datostfg2[grep110,17]
grep111=grep("sobri",datostfg2[,17])
datostfg2[grep111,17]

grep122=grep("Herman",datostfg2[,17])
datostfg2[grep122,17]
grep123=grep("HERMAN",datostfg2[,17])
datostfg2[grep123,17]
grep124=grep("herman",datostfg2[,17])
datostfg2[grep124,17]
grep125=grep("BISAB",datostfg2[,17])
datostfg2[grep125,17]
grep125=grep("bisab",datostfg2[,17])
datostfg2[grep125,17]
grep125_2=grep125 ###Sin antecedentes hasta segundo grado
grep126=grep("Bis",datostfg2[,17])
datostfg2[grep126,17]
grep126_2=grep126[c(2,3,5,6,7,8,11,14,15)] ###Sin antecedentes hasta segundo grado

grep275=grep("WPW",datostfg2[,17])
grep275=grep("estrecha",datostfg2[,17])
datostfg2[grep275,17]
datostfg2[grep275,9]
grep276=grep("Valvu",datostfg2[,17])
datostfg2[grep276,17]
datostfg2[grep276,9]
grep277=grep("valvu",datostfg2[,17])
datostfg2[grep277,17]
grep278=grep("Marcap",datostfg2[,17])
datostfg2[grep278,17]
datostfg2[grep278,9]
grep279=grep("marcap",datostfg2[,17])
datostfg2[grep279,17]
datostfg2[grep279,9]
grep280=grep("W-P-W",datostfg2[,17])
grep280=grep("edema",datostfg2[,17])
datostfg2[grep280,17]
datostfg2[grep280,9]
grep281=grep("Insuf",datostfg2[,17])
datostfg2[grep281,17]
grep282=grep("INSUF",datostfg2[,17])
datostfg2[grep282,17]
grep283=grep("ESTRECHA",datostfg2[,17])
grep283=grep("VALVU",datostfg2[,17])
datostfg2[grep283,17]
grep284=grep("EDEMA",datostfg2[,17])
grep285=grep("MARCA",datostfg2[,17])
datostfg2[grep285,17]
datostfg2[grep285,9]
grep286=grep("miocardio",datostfg2[,17])
datostfg2[grep286,17]
grep287=grep("Miocardio",datostfg2[,17])
datostfg2[grep287,17]
grep288=grep("MIOCARD",datostfg2[,17])
datostfg2[grep288,17]
grep289=grep("Soplo",datostfg2[,17])
datostfg2[grep289,17]
grep290=grep("SOPLO",datostfg2[,17])
grep290=grep("soplo",datostfg2[,17])
datostfg2[grep290,17]
datostfg2[grep290,9]
grep291=grep("Bradicardia",datostfg2[,17])
grep291=grep("bradicard",datostfg2[,17])
datostfg2[grep291,17]
datostfg2[grep291,9]
grep292=grep("Corazon",datostfg2[,17])
grep292=grep("corazon",datostfg2[,17])
datostfg2[grep292,17]
datostfg2[grep292,9]
grep293=grep("CORA",datostfg2[,17])
datostfg2[grep293,17]
grep294=grep("STE",datostfg2[,17])
datostfg2[grep294,17]
grep295=grep("Ste",datostfg2[,17])
datostfg2[grep295,17]
grep296=grep("ste",datostfg2[,17])
datostfg2[grep296,17]
grep297=grep("vasos",datostfg2[,17])
datostfg2[grep297,17]
grep298=grep("Vasos",datostfg2[,17])
datostfg2[grep298,17]
grep298=grep("VASOS",datostfg2[,17])
datostfg2[grep298,17]



###Volvemos a la primera variable creada,que es la variable 175

table(datostfg2[,175])
datostfg2[,175]=replace(datostfg2[,175],grep45_2,"4")
datostfg2[,175]=replace(datostfg2[,175],grep47,"4")
datostfg2[,175]=replace(datostfg2[,175],grep49,"4")
datostfg2[,175]=replace(datostfg2[,175],grep50,"4")
datostfg2[,175]=replace(datostfg2[,175],grep51,"4")
datostfg2[,175]=replace(datostfg2[,175],grep52,"4")
datostfg2[,175]=replace(datostfg2[,175],grep754,"4")
datostfg2[,175]=replace(datostfg2[,175],grep47si,"1")
datostfg2[,175]=replace(datostfg2[,175],grep55,"1")
datostfg2[,175]=replace(datostfg2[,175],grep56,"1")
datostfg2[,175]=replace(datostfg2[,175],grep57,"1")
datostfg2[,175]=replace(datostfg2[,175],grep58,"1")
datostfg2[,175]=replace(datostfg2[,175],grep59,"1")
datostfg2[,175]=replace(datostfg2[,175],grep60,"1")
datostfg2[,175]=replace(datostfg2[,175],grep61,"1")
datostfg2[,175]=replace(datostfg2[,175],grep62,"1")
datostfg2[,175]=replace(datostfg2[,175],grep63,"1")
datostfg2[,175]=replace(datostfg2[,175],grep64,"1")
datostfg2[,175]=replace(datostfg2[,175],grep65,"1")
datostfg2[,175]=replace(datostfg2[,175],grep66,"1")
datostfg2[,175]=replace(datostfg2[,175],grep67,"1")
datostfg2[,175]=replace(datostfg2[,175],grep68,"1")
datostfg2[,175]=replace(datostfg2[,175],grep69,"1")
datostfg2[,175]=replace(datostfg2[,175],grep70,"1")
datostfg2[,175]=replace(datostfg2[,175],grep71,"1")
datostfg2[,175]=replace(datostfg2[,175],grep72,"1")
datostfg2[,175]=replace(datostfg2[,175],grep73,"1")
datostfg2[,175]=replace(datostfg2[,175],grep74,"1")
datostfg2[,175]=replace(datostfg2[,175],grep75,"1")
datostfg2[,175]=replace(datostfg2[,175],grep76,"1")
datostfg2[,175]=replace(datostfg2[,175],grep77,"1")
datostfg2[,175]=replace(datostfg2[,175],grep78,"1")
datostfg2[,175]=replace(datostfg2[,175],grep79,"1")
datostfg2[,175]=replace(datostfg2[,175],grep80,"1")
datostfg2[,175]=replace(datostfg2[,175],grep81,"1")
datostfg2[,175]=replace(datostfg2[,175],grep82,"1")
datostfg2[,175]=replace(datostfg2[,175],grep83,"1")
datostfg2[,175]=replace(datostfg2[,175],grep84,"1")
datostfg2[,175]=replace(datostfg2[,175],grep85,"1")
datostfg2[,175]=replace(datostfg2[,175],grep86,"1")
datostfg2[,175]=replace(datostfg2[,175],grep87,"1")
datostfg2[,175]=replace(datostfg2[,175],grep88,"1")
datostfg2[,175]=replace(datostfg2[,175],grep89,"1")
datostfg2[,175]=replace(datostfg2[,175],grep90,"1")
datostfg2[,175]=replace(datostfg2[,175],grep91,"1")
datostfg2[,175]=replace(datostfg2[,175],grep92,"1")
datostfg2[,175]=replace(datostfg2[,175],grep93,"1")
datostfg2[,175]=replace(datostfg2[,175],grep94,"1")
datostfg2[,175]=replace(datostfg2[,175],grep95,"1")
datostfg2[,175]=replace(datostfg2[,175],grep97,"1")
datostfg2[,175]=replace(datostfg2[,175],grep98,"1")
datostfg2[,175]=replace(datostfg2[,175],grep99,"1")
datostfg2[,175]=replace(datostfg2[,175],grep100,"1")
datostfg2[,175]=replace(datostfg2[,175],grep101,"1")
datostfg2[,175]=replace(datostfg2[,175],grep102,"1")
datostfg2[,175]=replace(datostfg2[,175],grep103,"1")
datostfg2[,175]=replace(datostfg2[,175],grep104,"1")
datostfg2[,175]=replace(datostfg2[,175],grep105,"1")
datostfg2[,175]=replace(datostfg2[,175],grep106,"1")
datostfg2[,175]=replace(datostfg2[,175],grep107,"1")
datostfg2[,175]=replace(datostfg2[,175],grep108,"1")
datostfg2[,175]=replace(datostfg2[,175],grep109,"1")
datostfg2[,175]=replace(datostfg2[,175],grep110,"1")
datostfg2[,175]=replace(datostfg2[,175],grep111,"1")
datostfg2[,175]=replace(datostfg2[,175],grep112,"1")
datostfg2[,175]=replace(datostfg2[,175],grep113,"1")
datostfg2[,175]=replace(datostfg2[,175],grep114,"1")
datostfg2[,175]=replace(datostfg2[,175],grep115,"1")
datostfg2[,175]=replace(datostfg2[,175],grep116,"1")
datostfg2[,175]=replace(datostfg2[,175],grep117,"1")
datostfg2[,175]=replace(datostfg2[,175],grep118,"1")
datostfg2[,175]=replace(datostfg2[,175],grep119,"1")
datostfg2[,175]=replace(datostfg2[,175],grep120,"1")
datostfg2[,175]=replace(datostfg2[,175],grep121,"1")
datostfg2[,175]=replace(datostfg2[,175],grep122,"1")
datostfg2[,175]=replace(datostfg2[,175],grep123,"1")
datostfg2[,175]=replace(datostfg2[,175],grep124,"1")
datostfg2[,175]=replace(datostfg2[,175],grep125,"1")
datostfg2[,175]=replace(datostfg2[,175],grep126,"1")
datostfg2[,175]=replace(datostfg2[,175],grep144,"1")
datostfg2[,175]=replace(datostfg2[,175],grep145,"1")
datostfg2[,175]=replace(datostfg2[,175],grep146,"1")
datostfg2[,175]=replace(datostfg2[,175],grep147,"1")
datostfg2[,175]=replace(datostfg2[,175],grep148,"1")
datostfg2[,175]=replace(datostfg2[,175],grep242,"1")
datostfg2[,175]=replace(datostfg2[,175],grep243,"1")
datostfg2[,175]=replace(datostfg2[,175],grep248,"1")
datostfg2[,175]=replace(datostfg2[,175],grep265,"1")
datostfg2[,175]=replace(datostfg2[,175],grep275,"1")
datostfg2[,175]=replace(datostfg2[,175],grep276,"1")
datostfg2[,175]=replace(datostfg2[,175],grep277,"1")
datostfg2[,175]=replace(datostfg2[,175],grep278,"1")
datostfg2[,175]=replace(datostfg2[,175],grep279,"1")
datostfg2[,175]=replace(datostfg2[,175],grep280,"1")
datostfg2[,175]=replace(datostfg2[,175],grep281,"1")
datostfg2[,175]=replace(datostfg2[,175],grep282,"1")
datostfg2[,175]=replace(datostfg2[,175],grep283,"1")
datostfg2[,175]=replace(datostfg2[,175],grep284,"1")
datostfg2[,175]=replace(datostfg2[,175],grep285,"1")
datostfg2[,175]=replace(datostfg2[,175],grep286,"1")
datostfg2[,175]=replace(datostfg2[,175],grep287,"1")
datostfg2[,175]=replace(datostfg2[,175],grep288,"1")
datostfg2[,175]=replace(datostfg2[,175],grep289,"1")
datostfg2[,175]=replace(datostfg2[,175],grep290,"1")
datostfg2[,175]=replace(datostfg2[,175],grep291,"1")
datostfg2[,175]=replace(datostfg2[,175],grep292,"1")
datostfg2[,175]=replace(datostfg2[,175],grep293,"1")
datostfg2[,175]=replace(datostfg2[,175],grep294,"1")
datostfg2[,175]=replace(datostfg2[,175],grep295,"1")
datostfg2[,175]=replace(datostfg2[,175],grep296,"1")
datostfg2[,175]=replace(datostfg2[,175],grep297,"1")
datostfg2[,175]=replace(datostfg2[,175],grep45_1,"1")
table(datostfg2[,175])


for (i in 1:11984){comp=(
  is.na(datostfg2[i,175])==TRUE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,175]="2"
}else{
        datostfg2[i,175]=datostfg2[i,175]
}}

grep4000=grep("2",datostfg2[,175])
table(datostfg2[grep4000,17])
datostfg2[grep4000,175]=NA

grep4040=grep("cateterismo",datostfg2[,17])
datostfg2[grep4040,175]="1"
grep4041=grep("^prova cardio",datostfg2[,17])
datostfg2[grep4041,175]="1"
grep4042=grep("tio paterno",datostfg2[,17])
datostfg2[grep4042,17]
datostfg2[grep4042,175]="1"
grep4043=grep("tio materno",datostfg2[,17])
datostfg2[grep4043,17]
datostfg2[grep4043,175]="1"
grep4044=grep("^prueba antecedentes",datostfg2[,17])
datostfg2[grep4044,17]
datostfg2[grep4044,175]="1"
grep4045=grep("^se han borrado",datostfg2[,17])
datostfg2[grep4045,17]
datostfg2[grep4045,175]="1"
grep4046=grep("Paftr",datostfg2[,17])
datostfg2[grep4046,17]
datostfg2[grep4046,175]="1"
grep4047=grep("^El paciente refiere",datostfg2[,17])
datostfg2[grep4047,17]
datostfg2[grep4047,175]="1"
grep4048=grep("^Dos",datostfg2[,17])
datostfg2[grep4048,17]
datostfg2[grep4048,175]="1"
grep4049=grep("^Coarta",datostfg2[,17])
datostfg2[grep4049,17]
datostfg2[grep4049,175]="1"
grep4050=grep("^by",datostfg2[,17])
datostfg2[grep4050,17]
datostfg2[grep4050,175]="1"
grep4051=grep("I.A.M.",datostfg2[,17])
datostfg2[grep4051,17]
datostfg2[grep4051,175]
datostfg2[grep4051,175]="1"
grep4052=grep("^Abui",datostfg2[,17])
datostfg2[grep4052,17]
datostfg2[grep4051,175]="1"
table(datostfg2[,175])
grep4052=grep("^abu",datostfg2[,17])
datostfg2[grep4052,17]
datostfg2[grep4052,175]="1"
table(datostfg2[,175])
####Volvamos ahora a la segunda variable

grep127=grep("s?bita",datostfg2[,17])
datostfg2[grep127,17]
grep128=grep("S?bita",datostfg2[,17])
datostfg2[grep128,17]
grep127==grep128
grep127_1=grep127[-c(10,11,19,20,21,22,23,24,26,27,29,30,31,32,33,34,35,36,37,38,39,40,43,44,45,46,49,50,51,52,55,56,57,58,59,60,61,62,63,64,66,67,68,70,72,73,74,75,76,77,78,80,81,82,85,87,88,89,90,91,92,93,94,97,98,99,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,126,128,129,131,134,136,137,138,139,141,143,144,145,146,147,148,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,167,168,169,170,171,172,173,174,176,177,178,189,190,192,194,196,197,198,208)] ####Casos de muerte subita


grep127_2=grep127[c(10,11,19,20,21,22,23,24,26,27,29,30,31,32,33,34,35,36,37,38,39,40,43,44,45,46,49,50,51,52,55,56,57,58,59,60,61,62,63,64,66,67,68,70,72,73,74,75,76,77,78,80,81,82,85,87,88,89,90,91,92,93,94,97,98,99,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,126,128,129,131,134,136,137,138,139,141,143,144,145,146,147,148,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,167,168,169,170,171,172,173,174,176,177,178,189,190,192,194,196,197,198,208)] ####Casos sin muerte subita
grep129=grep("S?BITA",datostfg2[,17])
datostfg2[grep129,17]
grep130=grep("MS",datostfg2[,17])
datostfg2[grep130,17]
grep130_1=grep130[c(1,2,40,69,122,144,146,158,171,191,197)]###Casos de muerte subita
grep130_2=grep130[-c(1,2,40,69,122,144,146,158,171,191,197)]###Casos sin muerte subita
grep131=grep("ms",datostfg2[,17])

datostfg2[,176]=replace(datostfg2[,176],grep45_2,"0")
datostfg2[,176]=replace(datostfg2[,176],grep47,"0")
datostfg2[,176]=replace(datostfg2[,176],grep49,"0")
datostfg2[,176]=replace(datostfg2[,176],grep50,"0")
datostfg2[,176]=replace(datostfg2[,176],grep51,"0")
datostfg2[,176]=replace(datostfg2[,176],grep52,"0")
datostfg2[,176]=replace(datostfg2[,176],grep754,"0")
datostfg2[,176]=replace(datostfg2[,176],grep127_2,"0")
datostfg2[,176]=replace(datostfg2[,176],grep130_2,"0")
datostfg2[,176]=replace(datostfg2[,176],grep7,"0")
datostfg2[,176]=replace(datostfg2[,176],grep127_1,"1")
datostfg2[,176]=replace(datostfg2[,176],grep129,"1")
datostfg2[,176]=replace(datostfg2[,176],grep130_1,"1")
table(datostfg2[,175])
```


```{r,include=TRUE}
####Variable 18
table(datostfg2[,175])
grep134=grep("^no",datostfg2[,18])
datostfg2[grep134,18]
grep134_1=grep134[-c(12,13,14,15,16,17,18,28,127)] ###Sin antecedentes
grep134_2=grep134[c(12,13,14,15,16,17,18,28,127)] ###Sin antecedentes hasta segundo grado
datostfg2[,18]=replace(datostfg2[,18],grep134_1,"No")
datostfg2[,18]=replace(datostfg2[,18],grep134_2,"El deportista no refiere antecedentes de cardiopatia isquemica en sus familiares ( hasta segundo grado).")

grep401=grep("segundo",datostfg2[,18])
datostfg2[grep401,18]
datostfg2[,18]=replace(datostfg2[,18],grep401,"El deportista no refiere antecedentes de cardiopatia isquemica en sus familiares ( hasta segundo grado).")
grep403=grep("2 grado",datostfg2[,18])
grep135=grep("^No",datostfg2[,18])
datostfg2[grep135,18]
##No uso replace para no perder informacion sobre muertes subitas

grep136=grep("^NO",datostfg2[,18])
datostfg2[grep136,18]
datostfg2[,18]=replace(datostfg2[,18],grep136,"No")
grep137=grep("^desconoce",datostfg2[,18])
datostfg2[,18]=replace(datostfg2[,18],grep137,"Desconoce")
grep138=grep("^mo",datostfg2[,18])
datostfg2[,18]=replace(datostfg2[,18],grep138,"No")
grep140=grep("^ni",datostfg2[,18])
grep141=grep("^revisar",datostfg2[,18])
grep142=grep("Revisar",datostfg2[,18])
grep143=grep("^Sin",datostfg2[,18])
datostfg2[grep143,18]
grep143_1=grep143[c(1,3,4,7,8,12,13,14,23,43,84,83,89,99,129,143,144,145,147,162,165,192,204,207,251,260,262,268,270,273,280,285,287,291,312,327,331)] ###Sin especificar
datostfg2[,18]=replace(datostfg2[,18],grep143_1,"Si,sin especificar")
grep143_2=grep143[-c(1,3,4,7,8,12,13,14,23,43,84,83,89,99,129,143,144,145,147,162,165,192,204,207,251,260,262,268,270,273,280,285,287,291,312,327,331)]  ###Sin interes
datostfg2[,18]=replace(datostfg2[,18],grep143_2,"No")
grep149=grep("^sin",datostfg2[,18])
datostfg2[grep149,18]
grep149_1=grep149[-c(7)] ###Sin interes
datostfg2[,18]=replace(datostfg2[,18],grep149_1,"No")
grep149_2=grep149[c(7)] ###Sin especificar
datostfg2[,18]=replace(datostfg2[,18],grep149_2,"Si,sin especificar")
grep143_1=c(grep143_1,grep149_2)
grep150=grep("^SIN",datostfg2[,18])
grep755=grep("NR",datostfg2[,18])
datostfg2[grep755,18]
grep756=grep("^N.R",datostfg2[,18])


grep151=grep("ACV",datostfg2[,18])
datostfg2[grep151,18]
grep152=grep("AVC",datostfg2[,18])
datostfg2[grep152,18]
grep153=grep("ICTUS",datostfg2[,18])
datostfg2[grep153,18]
grep154=grep("ictus",datostfg2[,18])
datostfg2[grep154,18]
grep155=grep("Ictus",datostfg2[,18])
datostfg2[grep155,18]
grep156=grep("trombo",datostfg2[,18])
grep157=grep("Trombo",datostfg2[,18])
grep158=grep("TROMBO",datostfg2[,18])
grep159=grep("Tombo",datostfg2[,18])
datostfg2[grep156,18]
datostfg2[grep157,18]
grep160=grep("coagulo",datostfg2[,18])
datostfg2[grep160,18]
grep161=grep("Coagulo",datostfg2[,18])
datostfg2[grep161,18]
grep161=grep("IAM",datostfg2[,18])
datostfg2[grep161,18]
grep162=grep("iAM",datostfg2[,18])
datostfg2[grep162,18]
grep162=grep("iam",datostfg2[,18])
datostfg2[grep162,18]
grep163=grep("Iam",datostfg2[,18])
datostfg2[grep162,18]
grep163=grep("^ ",datostfg2[,18])
grep163=grep("embolia", datostfg2[,18])
datostfg2[grep163,18]
grep164=grep("EMBO", datostfg2[,18])
datostfg2[grep164,18]
grep164=grep("derrame cerebral",datostfg2[,18])
datostfg2[grep164,18]
grep165=grep("problemas cardiacos",datostfg2[,18])
datostfg2[grep165,18]
grep166=grep("cerebelo",datostfg2[,18])
grep166=grep("Aneurisma",datostfg2[,18])
datostfg2[grep166,18]
grep167=grep("aneurisma",datostfg2[,18])
datostfg2[grep167,18]
grep168=grep("ANEURISMA",datostfg2[,18])
datostfg2[grep168,18]
grep169=grep("CEREBR",datostfg2[,18])
grep169=grep("cerebr",datostfg2[,18])
datostfg2[grep169,18]
grep170=grep("Encefalo",datostfg2[,18])
grep171=grep("arteri",datostfg2[,18])
datostfg2[grep171,18]
grep172=grep("problemas circulatorios",datostfg2[,18])
datostfg2[grep172,18]
grep173=grep("ideopatica",datostfg2[,18])
grep173=grep("Arteri",datostfg2[,18])
datostfg2[grep173,18]
grep174=grep("Varices",datostfg2[,18])
grep175=grep("varices",datostfg2[,18])
grep175=grep("Vasculitis",datostfg2[,18])
grep251=grep("vasculitis",datostfg2[,18])
grep251=grep("VASCU",datostfg2[,18])

grep175=grep("venosa",datostfg2[,18])
datostfg2[grep175,18]
grep176=grep("tension",datostfg2[,18])
grep177=grep("taqui",datostfg2[,18])
datostfg2[grep177,18]
grep251=grep("TAQUI",datostfg2[,18])
grep264=grep("Taqui",datostfg2[,18])
grep403=grep("IAT",datostfg2[,18])


grep178=grep("arritmia",datostfg2[,18])
datostfg2[grep178,18]
grep179=grep("Arritmia",datostfg2[,18])
grep298=grep("ARRIT",datostfg2[,18])
datostfg2[grep179,18]
grep180=grep("El paciente refiere",datostfg2[,18])
datostfg2[grep180,18]
grep181=grep("Cardio",datostfg2[,18])
datostfg2[grep181,18]
grep182=grep("CARDIO",datostfg2[,18])
datostfg2[grep182,18]
grep183=grep("EL PACIENTE REFIERE",datostfg2[,18])
grep183=grep("angina",datostfg2[,18])
grep184=grep("?ngor",datostfg2[,18])
grep184=grep("angor",datostfg2[,18])
grep184=grep("Angor",datostfg2[,18])
grep184=grep("Angina",datostfg2[,18])
grep185=grep("ANGOR",datostfg2[,18])
grep185=grep("ANGINA",datostfg2[,18])
grep185=grep("^aBU",datostfg2[,18])
grep185=grep("^Abuelo",datostfg2[,18])
datostfg2[grep185,18]
grep186=grep("fallece por cardiopatia",datostfg2[,18])
grep186=grep("insuf",datostfg2[,18])
datostfg2[grep186,18]
grep187=grep("IM",datostfg2[,18])
datostfg2[grep187,18]
grep188=grep("Abuela",datostfg2[,18])
datostfg2[grep188,18]
grep189=grep("abuel",datostfg2[,18])
datostfg2[grep189,18]
grep190=grep("Padre",datostfg2[,18])
datostfg2[grep190,18]
grep191=grep("padre",datostfg2[,18])
datostfg2[grep90,18]
grep192=grep("Madre",datostfg2[,18])
datostfg2[grep192,18]
grep193=grep("madre",datostfg2[,18])
datostfg2[grep193,18]
grep194=grep("TIO",datostfg2[,18])
grep194=grep("Tio",datostfg2[,18])
datostfg2[grep194,18]
grep195=grep("tIO",datostfg2[,18])
datostfg2[grep195,18]
grep195=grep("TIA",datostfg2[,18])
datostfg2[grep195,18]
grep196=grep("Tia",datostfg2[,18])
datostfg2[grep196,18]

grep197=grep("tio",datostfg2[,18])
datostfg2[grep197,18]
grep198=grep(" tia",datostfg2[,18]) ###Si ponemos "tia" coge todas aquellas en las que aparece cardioapatia tambien, esto incluye "No tiene referentes de cardiopatia..."
datostfg2[grep198,18]


grep199=grep("PRIM",datostfg2[,18])
grep199=grep("Prim",datostfg2[,18])
datostfg2[grep199,18]
grep200=grep("prim",datostfg2[,18])
datostfg2[grep200,18]
grep200=grep200[-c(5)]  ####Porque coge la palabra "primer"

grep201=grep("pim",datostfg2[,18])
grep201=grep("^St",datostfg2[,18])
grep201=grep("PADRE",datostfg2[,18])
datostfg2[grep201,18]
grep202=grep("MADRE",datostfg2[,18])
datostfg2[grep202,18]
grep203=grep("ABU",datostfg2[,18])
datostfg2[grep203,18]
grep204=grep("^El deportista refiere",datostfg2[,18])
datostfg2[grep204,18]
grep205=grep("Aba",datostfg2[,18])
datostfg2[grep205,18]
grep206=grep("Abo",datostfg2[,18])
datostfg2[grep206,18]
grep207=grep("ABA",datostfg2[,18])
datostfg2[grep207,18] ###No lo consideramos,porque voy buscando ABA (abreviatura de abuela)
grep208=grep("ABO",datostfg2[,18]) ###No lo consideramos
datostfg2[grep208,18]
grep207=grep("aba",datostfg2[,18])
datostfg2[grep207,18]
grep207=grep(" aba",datostfg2[,18]) ###Para eliminar la que no queria
grep208=grep("abo",datostfg2[,18])
datostfg2[grep208,18]
grep170=grep("Hijo",datostfg2[,18])
datostfg2[grep170,18]
grep174=grep("hijo",datostfg2[,18])
datostfg2[grep174,18]
grep176=grep("HIJO",datostfg2[,18])
datostfg2[grep176,18]



###Veamos si hay más casos de intéres,por ejemplo con sobrinos.
grep209=grep("Sobri",datostfg2[,18])
datostfg2[grep209,18]
grep210=grep("SOBRI",datostfg2[,18])
datostfg2[grep210,18]
grep210=grep("sobri",datostfg2[,18])
datostfg2[grep210,18]

grep211=grep("Herman",datostfg2[,18])
datostfg2[grep211,18]
grep212=grep("HERMAN",datostfg2[,18])
datostfg2[grep212,18]
grep213=grep("herman",datostfg2[,18])
datostfg2[grep213,18]
grep214=grep("BISAB",datostfg2[,18])
datostfg2[grep214,18]
grep214=grep("bisab",datostfg2[,18])
datostfg2[grep214,18]
grep215=grep("Bis",datostfg2[,18])



datostfg2[grep215,18]
grep216=grep("WPW",datostfg2[,18])
datostfg2[grep216,18]
grep217=grep("estrecha",datostfg2[,18])
datostfg2[grep217,18]
grep218=grep("Valvu",datostfg2[,18])
datostfg2[grep218,18]
grep219=grep("valvu",datostfg2[,18])
datostfg2[grep219,18]
grep220=grep("Marcap",datostfg2[,18])
datostfg2[grep220,18]
grep221=grep("marcap",datostfg2[,18])
datostfg2[grep221,18]
grep222=grep("W-P-W",datostfg2[,18])
datostfg2[grep222,18]
grep223=grep("edema",datostfg2[,18])
datostfg2[grep223,18]
grep224=grep("Insuf",datostfg2[,18])
datostfg2[grep224,18]
grep225=grep("INSUF",datostfg2[,18])
datostfg2[grep225,18]
grep226=grep("ESTRECHA",datostfg2[,18])
datostfg2[grep226,18]
grep226=grep("VALVU",datostfg2[,18])
datostfg2[grep226,18]
grep227=grep("EDEMA",datostfg2[,18])
datostfg2[grep227,18]
grep227=grep("MARCA",datostfg2[,18])
datostfg2[grep227,18]
grep228=grep("infarto",datostfg2[,18])
datostfg2[grep228,18]
grep229=grep("Infarto",datostfg2[,18])
datostfg2[grep229,18]
grep229=grep("INFARTO",datostfg2[,18])
datostfg2[grep229,18]
grep229=grep("miocardio",datostfg2[,18])
datostfg2[grep229,18]
grep230=grep("Miocardio",datostfg2[,18])
datostfg2[grep230,18]
grep231=grep("MIOCARD",datostfg2[,18])
datostfg2[grep231,18]

grep232=grep("Soplo",datostfg2[,18])
datostfg2[grep232,18]
grep233=grep("SOPLO",datostfg2[,18])
datostfg2[grep233,18]
grep233=grep("soplo",datostfg2[,18])
datostfg2[grep233,18]
grep234=grep("Bradicardia",datostfg2[,18])
datostfg2[grep234,18]
grep236=grep("bradicard",datostfg2[,18])
datostfg2[grep236,18]
grep237=grep("Corazon",datostfg2[,18])
datostfg2[grep237,18]
grep237=grep("corazon",datostfg2[,18])
datostfg2[grep237,18]
grep239=grep("CORA",datostfg2[,18])
datostfg2[grep239,18]
grep239=grep("STE",datostfg2[,18])
datostfg2[grep239,18]
grep239=grep("Ste",datostfg2[,18])
datostfg2[grep239,18]
grep240=grep("ste",datostfg2[,18])
datostfg2[grep240,18]
grep241=grep("vasos",datostfg2[,18])
datostfg2[grep241,18]
grep244=grep("Vasos",datostfg2[,18])
datostfg2[grep244,18]
grep248=grep("VASOS",datostfg2[,18])
datostfg2[grep247,18]
grep266=grep("HTA",datostfg2[,18])
datostfg2[grep266,18]
grep267=grep("Hta",datostfg2[,18])
grep267=grep("hta",datostfg2[,18])

####La bradicardia,el soplo y el corazon grande o  de atleta son tipicos en deportistas de altos rendimientos, como aquí estamos considerando a los familiares, los estudiaremos como anomalías cardiacas

grep300=grep("TIO",datostfg2[,18])
grep300=grep("Tio",datostfg2[,18])
datostfg2[grep300,18]


grep301=grep("^T",datostfg2[,18])
datostfg2[grep301,18]
grep301=grep301[-c(108,172)]
grep302=grep("tIO",datostfg2[,18])
grep302=grep("^TIA",datostfg2[,18])
grep302=grep("Tia",datostfg2[,18])
datostfg2[grep302,18]
grep302=grep302[-c(25,41)]
grep303=grep("^t",datostfg2[,18])
grep303=grep303[-c(1)]
datostfg2[grep303,18]

###Volvemos a la primera variable creada,que es la variable 175
table(datostfg2[,175])
datostfg2[,175]=replace(datostfg2[,175],grep134_1,"5")
datostfg2[,175]=replace(datostfg2[,175],grep135,"5")
datostfg2[,175]=replace(datostfg2[,175],grep136,"5")
datostfg2[,175]=replace(datostfg2[,175],grep138,"5")
datostfg2[,175]=replace(datostfg2[,175],grep140,"5")
datostfg2[,175]=replace(datostfg2[,175],grep143_2,"5")
datostfg2[,175]=replace(datostfg2[,175],grep149_1,"5")
datostfg2[,175]=replace(datostfg2[,175],grep755,"5")
datostfg2[,175]=replace(datostfg2[,175],grep143_1,"1")
datostfg2[,175]=replace(datostfg2[,175],grep149_2,"1")
datostfg2[,175]=replace(datostfg2[,175],grep151,"1")
datostfg2[,175]=replace(datostfg2[,175],grep152,"1")
datostfg2[,175]=replace(datostfg2[,175],grep153,"1")
datostfg2[,175]=replace(datostfg2[,175],grep154,"1")
datostfg2[,175]=replace(datostfg2[,175],grep155,"1")
datostfg2[,175]=replace(datostfg2[,175],grep156,"1")
datostfg2[,175]=replace(datostfg2[,175],grep157,"1")
datostfg2[,175]=replace(datostfg2[,175],grep158,"1")
datostfg2[,175]=replace(datostfg2[,175],grep159,"1")
datostfg2[,175]=replace(datostfg2[,175],grep160,"1")
datostfg2[,175]=replace(datostfg2[,175],grep161,"1")
datostfg2[,175]=replace(datostfg2[,175],grep162,"1")
datostfg2[,175]=replace(datostfg2[,175],grep163,"1")
datostfg2[,175]=replace(datostfg2[,175],grep164,"1")
datostfg2[,175]=replace(datostfg2[,175],grep165,"1")
datostfg2[,175]=replace(datostfg2[,175],grep166,"1")
datostfg2[,175]=replace(datostfg2[,175],grep167,"1")
datostfg2[,175]=replace(datostfg2[,175],grep168,"1")
datostfg2[,175]=replace(datostfg2[,175],grep169,"1")
datostfg2[,175]=replace(datostfg2[,175],grep170,"1")
datostfg2[,175]=replace(datostfg2[,175],grep171,"1")
datostfg2[,175]=replace(datostfg2[,175],grep172,"1")
datostfg2[,175]=replace(datostfg2[,175],grep173,"1")
datostfg2[,175]=replace(datostfg2[,175],grep174,"1")
datostfg2[,175]=replace(datostfg2[,175],grep175,"1")
datostfg2[,175]=replace(datostfg2[,175],grep176,"1")
datostfg2[,175]=replace(datostfg2[,175],grep177,"1")
datostfg2[,175]=replace(datostfg2[,175],grep178,"1")
datostfg2[,175]=replace(datostfg2[,175],grep179,"1")
datostfg2[,175]=replace(datostfg2[,175],grep180,"1")
datostfg2[,175]=replace(datostfg2[,175],grep181,"1")
datostfg2[,175]=replace(datostfg2[,175],grep182,"1")
datostfg2[,175]=replace(datostfg2[,175],grep183,"1")
datostfg2[,175]=replace(datostfg2[,175],grep184,"1")
datostfg2[,175]=replace(datostfg2[,175],grep185,"1")
datostfg2[,175]=replace(datostfg2[,175],grep186,"1")
datostfg2[,175]=replace(datostfg2[,175],grep187,"1")
datostfg2[,175]=replace(datostfg2[,175],grep188,"1")
datostfg2[,175]=replace(datostfg2[,175],grep189,"1")
datostfg2[,175]=replace(datostfg2[,175],grep190,"1")
datostfg2[,175]=replace(datostfg2[,175],grep191,"1")
datostfg2[,175]=replace(datostfg2[,175],grep192,"1")
datostfg2[,175]=replace(datostfg2[,175],grep193,"1")
datostfg2[,175]=replace(datostfg2[,175],grep194,"1")
datostfg2[,175]=replace(datostfg2[,175],grep195,"1")
datostfg2[,175]=replace(datostfg2[,175],grep196,"1")
datostfg2[,175]=replace(datostfg2[,175],grep197,"1")
datostfg2[,175]=replace(datostfg2[,175],grep198,"1")
datostfg2[,175]=replace(datostfg2[,175],grep199,"1")
datostfg2[,175]=replace(datostfg2[,175],grep200,"1")
datostfg2[,175]=replace(datostfg2[,175],grep251,"1")
datostfg2[,175]=replace(datostfg2[,175],grep264,"1")
datostfg2[,175]=replace(datostfg2[,175],grep298,"1")
datostfg2[,175]=replace(datostfg2[,175],grep201,"1")
datostfg2[,175]=replace(datostfg2[,175],grep202,"1")
datostfg2[,175]=replace(datostfg2[,175],grep203,"1")
datostfg2[,175]=replace(datostfg2[,175],grep204,"1")
datostfg2[,175]=replace(datostfg2[,175],grep205,"1")
datostfg2[,175]=replace(datostfg2[,175],grep206,"1")
datostfg2[,175]=replace(datostfg2[,175],grep207,"1")
datostfg2[,175]=replace(datostfg2[,175],grep208,"1")
datostfg2[,175]=replace(datostfg2[,175],grep209,"1")
datostfg2[,175]=replace(datostfg2[,175],grep210,"1")
datostfg2[,175]=replace(datostfg2[,175],grep211,"1")
datostfg2[,175]=replace(datostfg2[,175],grep212,"1")
datostfg2[,175]=replace(datostfg2[,175],grep213,"1")
datostfg2[,175]=replace(datostfg2[,175],grep214,"1")
datostfg2[,175]=replace(datostfg2[,175],grep215,"1")
datostfg2[,175]=replace(datostfg2[,175],grep216,"1")
datostfg2[,175]=replace(datostfg2[,175],grep217,"1")
datostfg2[,175]=replace(datostfg2[,175],grep218,"1")
datostfg2[,175]=replace(datostfg2[,175],grep219,"1")
datostfg2[,175]=replace(datostfg2[,175],grep220,"1")
datostfg2[,175]=replace(datostfg2[,175],grep221,"1")
datostfg2[,175]=replace(datostfg2[,175],grep222,"1")
datostfg2[,175]=replace(datostfg2[,175],grep223,"1")
datostfg2[,175]=replace(datostfg2[,175],grep224,"1")
datostfg2[,175]=replace(datostfg2[,175],grep225,"1")
datostfg2[,175]=replace(datostfg2[,175],grep226,"1")
datostfg2[,175]=replace(datostfg2[,175],grep227,"1")
datostfg2[,175]=replace(datostfg2[,175],grep228,"1")
datostfg2[,175]=replace(datostfg2[,175],grep229,"1")
datostfg2[,175]=replace(datostfg2[,175],grep230,"1")
datostfg2[,175]=replace(datostfg2[,175],grep231,"1")
datostfg2[,175]=replace(datostfg2[,175],grep232,"1")
datostfg2[,175]=replace(datostfg2[,175],grep233,"1")
datostfg2[,175]=replace(datostfg2[,175],grep234,"1")
datostfg2[,175]=replace(datostfg2[,175],grep236,"1")
datostfg2[,175]=replace(datostfg2[,175],grep237,"1")
datostfg2[,175]=replace(datostfg2[,175],grep239,"1")
datostfg2[,175]=replace(datostfg2[,175],grep240,"1")
datostfg2[,175]=replace(datostfg2[,175],grep241,"1")
datostfg2[,175]=replace(datostfg2[,175],grep244,"1")
datostfg2[,175]=replace(datostfg2[,175],grep248,"1")
datostfg2[,175]=replace(datostfg2[,175],grep266,"1")
datostfg2[,175]=replace(datostfg2[,175],grep267,"1")
datostfg2[,175]=replace(datostfg2[,175],grep300,"1")
datostfg2[,175]=replace(datostfg2[,175],grep301,"1")
datostfg2[,175]=replace(datostfg2[,175],grep302,"1")
datostfg2[,175]=replace(datostfg2[,175],grep303,"1")





grep101=grep("PRIM",datostfg2[,17])
datostfg2[grep101,17]
grep102=grep("Prim",datostfg2[,17])
datostfg2[grep102,17]
grep103=grep("prim",datostfg2[,17])
datostfg2[grep103,17]
grep104=grep("pim",datostfg2[,17])
datostfg2[grep104,17]
datostfg2[,175]=replace(datostfg2[,175],grep101,"1")
datostfg2[,175]=replace(datostfg2[,175],grep102,"1")
datostfg2[,175]=replace(datostfg2[,175],grep103,"1")
datostfg2[,175]=replace(datostfg2[,175],grep104,"1")

table(datostfg2[,175])

####Volvamos ahora a la segunda de nuestras variables creadas
grep298=grep("s?bita",datostfg2[,18])
datostfg2[grep298,18]
grep298_1=grep298[c(6,7,11,15)] ##Sin muerte subita
grep298_2=grep298[-c(6,7,11,15)] ##muerte subita
grep299=grep("S?bita",datostfg2[,18])
grep299==grep298
grep299=grep("S?BITA",datostfg2[,18])
grep299=grep("MS",datostfg2[,18])
datostfg2[grep299,18]

# for (i in 1:11984){comp=(
#   is.na(datostfg2[i,175])==TRUE)
# if(!is.na(comp)) if (comp) {
#    datostfg2[i,175]="2"
# }else{
#         datostfg2[i,175]=datostfg2[i,175]
# }}

# grep4000=grep("2",datostfg2[,175])
# table(datostfg2[grep4000,18])

grep4016=grep("^Probable",datostfg2[,18])
datostfg2[grep4016,18]
datostfg2[grep4016,175]="1"
grep4017=grep("^otras",datostfg2[,18])
datostfg2[grep4017,18]
datostfg2[grep4017,175]="1"
grep4018=grep("^Extra",datostfg2[,18])
datostfg2[grep4018,18]
datostfg2[grep4018,175]="1"
grep4019=grep("^Dilata",datostfg2[,18])
datostfg2[grep4019,18]
datostfg2[grep4019,175]="1"
grep4020=grep("^Agra",datostfg2[,18])
datostfg2[grep4020,18]
datostfg2[grep4020,175]="1"
grep4040=grep("cateterismo",datostfg2[,17])
datostfg2[grep4040,175]="1"
grep4041=grep("^prova cardio",datostfg2[,17])
datostfg2[grep4041,175]="1"
grep4042=grep("tio paterno",datostfg2[,17])
datostfg2[grep4042,17]
datostfg2[grep4042,175]="1"
grep4043=grep("tio materno",datostfg2[,17])
datostfg2[grep4043,17]
datostfg2[grep4043,175]="1"
grep4044=grep("^prueba antecedentes",datostfg2[,17])
datostfg2[grep4044,17]
datostfg2[grep4044,175]="1"
grep4045=grep("^se han borrado",datostfg2[,17])
datostfg2[grep4045,17]
datostfg2[grep4045,175]="1"
grep4046=grep("Paftr",datostfg2[,17])
datostfg2[grep4046,17]
datostfg2[grep4046,175]="1"
grep4047=grep("^El paciente refiere",datostfg2[,17])
datostfg2[grep4047,17]
datostfg2[grep4047,175]="1"
grep4048=grep("^Dos",datostfg2[,17])
datostfg2[grep4048,17]
datostfg2[grep4048,175]="1"
grep4049=grep("^Coarta",datostfg2[,17])
datostfg2[grep4049,17]
datostfg2[grep4049,175]="1"
grep4050=grep("^by",datostfg2[,17])
datostfg2[grep4050,17]
datostfg2[grep4050,175]="1"
grep4051=grep("I.A.M.",datostfg2[,17])
datostfg2[grep4051,17]
datostfg2[grep4051,175]
datostfg2[grep4051,175]="1"
grep4052=grep("^Abui",datostfg2[,17])
datostfg2[grep4052,17]
datostfg2[grep4052,175]="1"
grep4052=grep("^abu",datostfg2[,17])
datostfg2[grep4052,17]
datostfg2[grep4052,175]="1"
table(datostfg2[,175])

datostfg2[,176]=replace(datostfg2[,176],grep134_1,"0")
datostfg2[,176]=replace(datostfg2[,176],grep135,"0")
datostfg2[,176]=replace(datostfg2[,176],grep136,"0")
datostfg2[,176]=replace(datostfg2[,176],grep138,"0")
datostfg2[,176]=replace(datostfg2[,176],grep140,"0")
datostfg2[,176]=replace(datostfg2[,176],grep143_2,"0")
datostfg2[,176]=replace(datostfg2[,176],grep149_1,"0")
datostfg2[,176]=replace(datostfg2[,176],grep755,"0")
datostfg2[,176]=replace(datostfg2[,176],grep298_1,"0")
datostfg2[,176]=replace(datostfg2[,176],grep298_2,"1")
datostfg2[,176]=replace(datostfg2[,176],grep299,"1")





####Veamos si hay alguna incongruencia.

datostfg2[grep400,17]
datostfg2[grep400,18] ###Arritmia
###Hay que asignarle un 1
datostfg2[,175]=replace(datostfg2[,175],grep400,"1")

datostfg2[grep45_2,16] ###Todo ok
datostfg2[grep45_2,18] ###Todo ok


datostfg2[grep46,16]

#####Hay contradicciones en las componentes 9,14,41,47,52,68,71,81,83,84,92,146,152,158,170,180,181
#202,205,207,211,214,230,236,242,243,274,275,280,284,295,300,304,310,320,330,336,337,341,348,352,355,359,362,372,397 y 407 de grep46 ya que hay algun familiar de primera o segunda generación que ha sufrido un accidente cerebrovascular o tiene alguna enfermedad cardiovascular.Hay que asignarle un 1.

###En las componentes 4,17,25,73,108,124,250,287 y 354 tambien debemos poner un 1 ,ya que los familiares presentan problemas circularios y/o familiares de tercera generación o superior tienen problemas cardiacos.
table(datostfg2[,175])
grep46_1=grep46[c(4,9,14,17,25,41,47,52,68,71,73,81,83,84,92,108,124,146,152,158,170,180,181,202,205,207,211,214,230,236,242,243,250,274,275,280,284,287,295,300,304,310,320,330,336,337,341,348,352,354,355,359,362,372,397,407)]
grep46_0=grep46[-c(4,9,14,17,25,41,47,52,68,71,73,81,83,84,92,108,124,146,152,158,170,180,181,202,205,207,211,214,230,236,242,243,250,274,275,280,284,287,295,300,304,310,320,330,336,337,341,348,352,354,355,359,362,372,397,407)]

datostfg2[,175]=replace(datostfg2[,175],grep46_1,"1")
datostfg2[,175]=replace(datostfg2[,175],grep46_0,"0")


datostfg2[grep46,18]

#####Hay contradicciones en las componentes 5,11,15,27,32,41,56,63,80,93,99,106,119,127,134,177,178,183,196,211,212,216,217,219,224,241,242,256,272,276,279,285,289,302,303,309,310,313,314,318,322,329,331,337,339,349,355,356,361,374,384,388,394,397,399,403,404,405,406,408,410,411,419 y 420 de grep46 ya que hay algun familiar de primera o segunda generación que ha sufrido un accidente cerebrovascular o tiene alguna enfermedad cardiovascular.Hay que asignarle un 1.


###En las componentes 17,70,101,102,113,126,130,139,156,161,167,174,253,254,307,396,398 y 414 tambien debemos poner un 1 ,ya que los familiares presentan problemas circularios y/o familiares de tercera generación o superior tienen problemas cardiacos.

grep46_11=grep46[c(5,11,15,17,27,32,41,56,63,80,93,99,101,102,106,113,119,126,127,130,134,139,156,161,167,174,177,178,183,196,211,212,216,217,219,224,241,242,253,254,256,272,276,279,285,289,302,303,307,309,310,313,314,318,322,329,331,337,339,349,355,356,361,374,384,388,394,396,397,398,399,403,404,405,406,408,410,411,414,419,420)]

grep46_10=grep46[-c(5,11,15,17,27,32,41,56,63,80,93,99,101,102,106,113,119,126,127,130,134,139,156,161,167,174,177,178,183,196,211,212,216,217,219,224,241,242,253,254,256,272,276,279,285,289,302,303,307,309,310,313,314,318,322,329,331,337,339,349,355,356,361,374,384,388,394,396,397,398,399,403,404,405,406,408,410,411,414,419,420)]

datostfg2[,175]=replace(datostfg2[,175],grep46_11,"1")
datostfg2[,175]=replace(datostfg2[,175],grep46_10,"0")

table(datostfg2[,175])
datostfg2[grep134_2,16] ####Componente 8,insuficiencia venosa
datostfg2[grep134_2,17] ####Componentes 1,3,4,6,7,8,9

grep134_20=grep134_2[c(2,5)] ###Le asignamos un 0
grep134_21=grep134_2[-c(2,5)] ###Le asignamos un 1

datostfg2[,175]=replace(datostfg2[,175],grep134_21,"1")
datostfg2[,175]=replace(datostfg2[,175],grep134_20,"0")

datostfg2[grep401,16] 

#####Hay contradicciones en las componentes 2,8,12,29,40,46,60,63,71,74,75,87,117,135,136,137,141,153,165,178,179,199,200,203,210,221,227,230,237,243,283,284,286,287,292,301,306,308,322,324,338,340,344,349,356,358,359,369,374,380 y 415 de grep401 ya que hay algun familiar de primera o segunda generación que ha sufrido un accidente cerebrovascular o tiene alguna enfermedad cardiovascular.Hay que asignarle un 1.

###En las componentes 21,28,65,123,252,256,257,294,295,333,335,397 y 424 tambien debemos poner un 1 ,ya que los familiares presentan problemas circularios y/o familiares de tercera generación o superior tienen problemas cardiacos.

grep401_1=grep401[c(2,8,12,21,28,29,40,46,60,63,65,71,74,75,87,117,123,135,136,137,141,153,165,178,179,199,200,203,210,221,227,230,237,243,252,256,257,283,284,286,287,292,294,295,301,306,308,322,324,333,335,338,340,344,349,356,358,359,369,374,380,397,415,424 )]

grep401_0=grep401[-c(2,8,12,21,28,29,40,46,60,63,65,71,74,75,87,117,123,135,136,137,141,153,165,178,179,199,200,203,210,221,227,230,237,243,252,256,257,283,284,286,287,292,294,295,301,306,308,322,324,333,335,338,340,344,349,356,358,359,369,374,380,397,415,424 )]

datostfg2[,175]=replace(datostfg2[,175],grep401_1,"1")
datostfg2[,175]=replace(datostfg2[,175],grep401_0,"0")

datostfg2[grep401,17] 



#####Hay contradicciones en las componentes 5,22,29,32,38,41,56,61,73,80,82,93,95,97,105,111,112,116,119,123,130,131,133,135,136,137,144,147,148,151,155,163,168,169,171,173,175,176,187,188,191,202,208,209,211,213,214,215,217,221,224,225,227,234,238,246,248,256,257,260,262,266,267,270,271,277,278,280,281,283,286,289,290,295,312,315,316,317,324,325,328,329,335,336,337,340,345,348,358,363,366,367,368,374,383,385,392,393,395,397,398,399,405,406,407,408,412,413 y 424 de grep401 ya que hay algun familiar de primera o segunda generación que ha sufrido un accidente cerebrovascular o tiene alguna enfermedad cardiovascular.Hay que asignarle un 1.

###En las componentes 47,71,158,261,272,276 y 333 tambien debemos poner un 1 ,ya que los familiares presentan problemas circularios y/o familiares de tercera generación o superior tienen problemas cardiacos.




grep401_11=grep401[c(5,22,29,32,38,41,47,56,61,71,73,80,82,93,95,97,105,111,112,116,119,123,130,131,133,135,136,137,144,147,148,151,155,158,163,168,169,171,173,175,176,187,188,191,202,208,209,211,213,214,215,217,221,224,225,227,234,238,246,248,256,257,260,261,262,266,267,270,271,272,276,277,278,280,281,283,286,289,290,295,312,315,316,317,324,325,328,329,333,335,336,337,340,345,348,358,363,366,367,368,374,383,385,392,393,395,397,398,399,405, 406,407,408,412,413,424)]

grep401_10=grep401[-c(5,22,29,32,38,41,47,56,61,71,73,80,82,93,95,97,105,111,112,116,119,123,130,131,133,135,136,137,144,147,148,151,155,158,163,168,169,171,173,175,176,187,188,191,202,208,209,211,213,214,215,217,221,224,225,227,234,238,246,248,256,257,260,261,262,266,267,270,271,272,276,277,278,280,281,283,286,289,290,295,312,315,316,317,324,325,328,329,333,335,336,337,340,345,348,358,363,366,367,368,374,383,385,392,393,395,397,398,399,405, 406,407,408,412,413,424)]

datostfg2[,175]=replace(datostfg2[,175],grep401_11,"1")
datostfg2[,175]=replace(datostfg2[,175],grep401_10,"0")
table(datostfg2[,175])
grep4011=grep("cicula",datostfg2[,16])
datostfg2[,175]=replace(datostfg2[,175],grep4011,"1")
grep4012=grep("sintron",datostfg2[,16])
datostfg2[,175]=replace(datostfg2[,175],grep4012,"1")
grep4013=grep("Sintron",datostfg2[,16])
datostfg2[,175]=replace(datostfg2[,175],grep4013,"1")
grep4014=grep("hemorra",datostfg2[,16])
datostfg2[grep4014,16]
grep4010=grep("vascu",datostfg2[,16])
datostfg2[grep4010,175]="1"
datostfg2[,175]=replace(datostfg2[,175],grep4014,"1")
table(datostfg2[,175])
grep___3=grep("3",datostfg2[,175])
datostfg2[grep___3,17]
datostfg2[grep___3,18]
datostfg2[grep___3[c(167,81)],175]="1"
datostfg2[grep___3[-c(167,81)],175]="0"
grep___4=grep("4",datostfg2[,175])
datostfg2[grep___4,16]
datostfg2[grep___4,18]
datostfg2[grep___4[c(80,77,71,69,67,66,64,62,59,57,56,44,32,31,25,23,16,15,13)],175]="1"
datostfg2[grep___4[-c(80,77,71,69,67,66,64,62,59,57,56,44,32,31,25,23,16,15,13)],175]="0"
grep___5=grep("5",datostfg2[,175])
datostfg2[grep___5,16]
datostfg2[grep___5[1001:2000],16]
datostfg2[grep___5[2001:2709],16]
datostfg2[grep___5,17]
datostfg2[grep___5[1001:2000],17]
datostfg2[grep___5[2001:2709],17]

datostfg2[grep___5[c(2001,2003,2022,2027,2031,2032,2037,2050,2052,2056,2062,2064,2068,2070,2079,2088,2089,2104,2106,2111,2116,2120,2123,2124,2128,2129,2133,2149,2151,2156,2158,2160,2173,2175,2181,2183,2187,2200,2206,2210,2216,2227,2228,2231,2234,2236,2238,2246,2260,2271,2275,2278,2280,2281,2283,2301,2305,2310,2318,2321,2324,2325,2336,2340,2351,2363,2365,2374,2406,2430,2434,2437,2438,2439,2440,2442,2450,2451,2455,2456,2459,2464,2471,2476,2496,2502,2504,2505,2506,2519,2522,2523,2527,2529,2546,2556,2561,2573,2574,2578,2591,2593,2594,2596,2600,2605,2614,2623,2632,2635,2638,2639,2650,2657,2684,2689,2705,2708,2709,1001,1002,1016,1027,1030,1035,1040,1042,1046,1050,1055,1056,1066,1082,1093,1099,1127,1141,1150,1151,1155,1160,1165,1170,1179,1186,1199,1200,1202,1211,1215,1220,1221,1225,1232,1236,1237,1239,1248,1256,1268,1275,1281,1283,1286,1290,1302,1304,1310,1318,1333,1335,1340,1350,1359,1363,1379,1380,1382,1387,1413,1414,1420,1426,1434,1440,1451,1453,1456,1469,1473,1485,1490,1493,1497,1517,1518,1519,1520,1533,1544,1551,1554,1556,1557,1558,1567,1569,1572,1583,1582,1593,1594,1595,1607,1609,1617,1618,1630,1634,1647,1649,1650,1651,1654,1660,1662,1666,1672,1678,1683,1695,1697,1699,1705,1711,1712,1716,1736,1738,1743,1750,1753,1757,1758,1763,1764,1774,1775,1777,1780,1788,1794,1795,1796,1801,1804,1809,1826,1832,1834,1836,1840,1844,1849,1852,1856,1866,1870,1872,1877,1884,1896,1904,1939,1944,1952,1958,1959,1962,1967,1969,1970,1972,1976,1978,1980,1983,1984,1985,1989,1990,1991,1992,1996,1997,1999,1,4,5,11,14,31,37,38,56,79,101,119,121,124,138,146,149,153,154,159,168,179,228,241,244,249,258,307,315,320,322,326,328,338,339,340,346,359,363,367,386,393,404,408,411,424,450,452,459,466,469,471,480,516,519,520,533,543,546,547,549,566,576,579,581,598,599,611,615,630,631,635,646,669,678,680,684,690,731,736,738,744,746,753,769,772,775,776,792,793,794,798,801,804,808,810,816,846,849,854,859,865,877,882,894,898,926,928,933,936,938,942,943,948,949,962,973,977,992,995
)],175]="1"


datostfg2[grep___5[c(2709,2707,2705,2704,2700,2698,2697,2683,2679,2678,2674,2673,2668,2665,2656,2652,2648,2647,2644,2643,2639,2637,2636,2635,2632,2629,2626,2625,2624,2623,2621,2619,2611,2609,2601,2600,2599,2595,2592,2591,2589,2588,2579,2575,2574,2573,2570,2569,2565,2556,2555,2553,2550,2549,2544,2542,2541,2534,2529,2528,2527,2522,2520,2517,2516,2513,2512,2509,2507,2504,2502,2499,2497,2494,2486,2478,2476,2475,2473,2469,2467,2463,2461,2459,2455,2454,2449,2448,2446,2444,2437,2434,2432,2431,2422,2420,2405,2404,2401,2396,2392,2390,2388,2378,2372,2364,2360,2358,2357,2355,2348,2347,2346,2344,2342,2341,2340,2339,2336,2334,2330,2315,2314,2311,2301,2299,2298,2296,2285,2284,2280,2273,2269,2268,2265,2260,2257,2254,2243,2242,2236,2235,2234,2229,2226,2224,2221,2209,2208,2206,2205,2201,2198,2195,2192,2190,2189,2188,2187,2185,2184,2182,2175,2174,2173,2172,2170,2165,2160,2159,2154,2151,2150,2148,2145,2140,2134,2133,2132,2129,2124,2120,2111,2106,2101,2096,2092,2091,2090,2081,2077,2073,2069,2068,2066,2062,2060,2058,2057,2052,2051,2044,2043,2039,2038,2037,2034,2032,2026,2022,2019,2017,2015,2014,2013,2011,2006,2005,2001,1002,1005,1012,1015,1017,1022,1023,1024,1033,1035,1039,1041,1042,1043,1045,1051,1052,1053,1057,1058,1059,1060,1070,1079,1082,1084,1086,1087,1091,1092,1100,1101,1102,1103,1111,1120,1121,1131,1135,1139,1140,1143,1148,1151,1154,1155,1159,1160,1161,1163,1164,1177,1180,1182,1184,1193,1194,1195,1198,1202,1205,1211,1215,1216,1219,1231,1233,1234,1238,1241,1244,1245,1246,1247,1252,1254,1255,1257,1258,1259,1261,1265,1267,1268,1269,1277,1281,1283,1290,1300,1302,1307,1309,1315,1316,1319,1321,1322,1323,1327,1338,1339,1340,1345,1352,1354,1357,1359,1370,1375,1377,1382,1384,1385,1386,1389,1394,1395,1401,1405,1406,1409,1410,1419,1422,1429,1430,1435,1437,1438,1441,1451,1452,1453,1455,1459,1462,1467,1469,1470,1471,1472,1473,1474,1475,1479,1480,1482,1484,1486,1490,1492,1494,1497,1500,1502,1504,1508,1509,1510,1512,1514,1517,1518,1519,1520,1524,1525,1532,1533,1540,1541,1542,1545,1549,1551,1554,1556,1558,1563,1566,1567,1568,1570,1574,1576,1579,1582,1583,1584,1588,1597,1599,1602,1605,1607,1613,1622,1627,1629,1640,1643,1644,1650,1651,1653,1660,1661,1663,1664,1666,1671,1674,1676,1678,1680,1684,1686,1687,1692,1693,1695,1697,1698,1700,1710,1711,1712,1714,1716,1720,1726,1729,1731,1735,1736,1737,1740,1742,1744,1745,1748,1753,1757,1758,1763,1764,1765,1770,1776,1780,1788,1789,1795,1799,1801,1802,1804,1805,1808,1810,1814,1815,1819,1821,1822,1826,1828,1831,1834,1844,1846,1849,1850,1853,1854,1857,1859,1862,1866,1867,1869,1871,1872,1873,1877,1880,1882,1883,1887,1888,1892,1894,1895,1902,1903,1906,1907,1910,1911,1912,1918,1925,1930,1935,1943,1947,1954,1956,1959,1962,1963,1968,1977,1978,1979,1981,1982,1983,1989,2000,604,611,615,617,619,627,629,630,631,639,640,646,649,650,652,657,658,660,664,667,674,678,679,690,695,699,714,715,716,719,727,731,732,734,739,741,742,750,755,756,760,763,765,766,768,779,780,784,785,791,793,806,813,814,821,823,825,826,828,833,836,839,844,847,848,849,851,852,855,856,857,858,859,860,861,864,865,866,877,878,881,883,889,890,895,900,901,902,903,904,907,916,918,919,922,923,924,925,927,928,929,930,931,935,939,941,943,947,953,957,958,971,974,976,977,980,985,988,990,991,992,994,996,997,999)],175]="1"
grep6000=grep("ocular",datostfg2[,16])
datostfg2[grep6000,16]
datostfg2[grep6000[-c(8)],175]="1"

grep___5=grep("5",datostfg2[,175])
datostfg2[grep___5,175]="0"
table(datostfg2[,175])

for (i in 1:11984){comp=(is.na(datostfg2[i,16])==TRUE&&
  is.na(datostfg2[i,17])==TRUE&&
  is.na(datostfg2[i,18])==TRUE  )
if(!is.na(comp)) if (comp) {
   datostfg2[i,175]="0"
}else{
        datostfg2[i,175]=datostfg2[i,175]
}}
table(datostfg2[,175])

for (i in 1:11984){comp=(is.na(datostfg2[i,175])==TRUE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,175]="2"
}else{
        datostfg2[i,175]=datostfg2[i,175]
}}
table(datostfg2[,175])
grep___2=grep("2",datostfg2[,175])
datostfg2[grep___2,16]
datostfg2[grep___2,17]
datostfg2[grep___2,18]

datostfg2[grep___2[c(658,599,587,586,562,501,444,431,418,415,403,376,348,221,218,149,141,134,131,49)],16]
datostfg2[grep___2[c(658,599,587,586,562,501,444,431,418,415,403,376,348,221,218,149,141,134,131,49)],175]="1"
grep___2=grep("2",datostfg2[,175])
datostfg2[grep___2,175]="0"
table(datostfg2[,175])
```



```{r,include=TRUE}
###Variable 19 Hipertensión_txt
table(datostfg2[,19])

####Si el paciente tiene antecedentes familiares de hipertensión la variable numérica debe presenta un 1 y en caso contrario un 0.

###Observamos que hay deportistas en tratamiento que no tienen el 1 asignado en la columna 14(Hipertensión), esto se debe a  el tratamiento o a la práctica deportiva.
####Aqui voy a crear una variable con un 2 si la hipertensión está controlada con deporte,con un 1 si el deportista está en tratamiento y un 0 si no lo está.

grep500=grep("trat",datostfg2[,19])
datostfg2[grep500,19]

###Voy a mirar la componente 36 de grep500
datostfg2[grep500[c(36)],14] ###El deportista también tiene tratamiento,es lo que yo infiero con la información de la que dispongo
grep500=grep500[-c(10,11,12,17,31,37,50,53)]
grep501=grep("Trat",datostfg2[,19])
grep501=grep("TRAT",datostfg2[,19])
grep501=grep("TTO",datostfg2[,19])
datostfg2[grep501,19]
datostfg2[grep501,14] ###El deportista también tiene tratamiento,es lo que yo infiero con la información de la que dispongo
grep502=grep("Tto",datostfg2[,19])
grep502=grep("tto",datostfg2[,19])
datostfg2[grep502,19]
grep502=grep502-c(2,31,81,82,102,153)
grep506=grep("MEDI ",datostfg2[,19])
grep506=grep("medi",datostfg2[,19])
datostfg2[grep506,19]
grep507=grep506[-c(1,2)]
grep508=grep("Medi",datostfg2[,19])


####Sin tratamiento
grep503=grep("^no",datostfg2[,19])
datostfg2[grep503,19]
grep503=grep503[-c(4,5,10,11,12,17,55,64,65,66,74,79,88,101,102,108,112,113,124,130,144,155,168,200,221,227,234)]
grep504=grep("^No",datostfg2[,19])
datostfg2[grep504,19]
grep505=grep("^NO",datostfg2[,19])
datostfg2[grep505,19]
grep508=grep506[c(1,2)]
grep756=grep("NR",datostfg2[,19])
grep756=grep("^N.R",datostfg2[,19])


###Controlada con actividad fisica
grep509=grep("Controlad",datostfg2[,19])
datostfg2[grep509,19] 
grep509=grep509[c(1)]
grep510=grep("controlad",datostfg2[,19])
datostfg2[grep510,19] ###No lo seleccionamos
grep511=grep("CONTROLAD",datostfg2[,19])
###No lo seleccionamos
grep511=grep("deporte",datostfg2[,19])
grep511=grep("actividad",datostfg2[,19])
datostfg2[grep511,19] ###La misma que habiamos obtenido en grep509



datostfg2[,177]=c(rep(NA,11984))

datostfg2[,177]=replace(datostfg2[,177],grep503,"0")
datostfg2[,177]=replace(datostfg2[,177],grep504,"0")
datostfg2[,177]=replace(datostfg2[,177],grep505,"0")
datostfg2[,177]=replace(datostfg2[,177],grep508,"0")
datostfg2[,177]=replace(datostfg2[,177],grep500,"1")
datostfg2[,177]=replace(datostfg2[,177],grep501,"1")
datostfg2[,177]=replace(datostfg2[,177],grep502,"1")
datostfg2[,177]=replace(datostfg2[,177],grep506,"1")
datostfg2[,177]=replace(datostfg2[,177],grep507,"1")
datostfg2[,177]=replace(datostfg2[,177],grep509,"2")







####Voy a crear otra variable que nos indique si algun familiar del deportista tiene o ha tenido hipertension.

###Antes que nada,seleccionamos los deportistas con algun familiar con HTA que habiamos observado al estudiar las variables 16,17,18.

grepHTA=c(grep259,grep260,grep265,grep266,grep267)
grep512=grep("Padre",datostfg2[,19])
datostfg2[grep512,19]
grep513=grep("padre",datostfg2[,19])
datostfg2[grep513,19]
grep514=grep("PADRE",datostfg2[,19])
datostfg2[grep514,19]
grep515=grep("MADRE",datostfg2[,19])
datostfg2[grep515,19]
grep516=grep("Madre",datostfg2[,19])
datostfg2[grep516,19]
grep516=grep516[-c(5,14,15,18,20)]
grep517=grep("madre",datostfg2[,19])
datostfg2[grep517,19]
grep517=grep516[-c(3,6)]
grep518=grep("Herman",datostfg2[,19])
datostfg2[grep518,19]
grep519=grep("HERMAN",datostfg2[,19])
datostfg2[grep519,19]
grep520=grep("herman",datostfg2[,19])
datostfg2[grep520,19]
grep520=grep520[-c(7)]
grep521=grep("Abuel",datostfg2[,19])
datostfg2[grep521,19]
grep522=grep("ABUEL",datostfg2[,19])
datostfg2[grep522,19]
grep523=grep("abuel",datostfg2[,19])
datostfg2[grep523,19]
grep524=grep("TI",datostfg2[,19])
grep524=grep("ti",datostfg2[,19])
datostfg2[grep524,19]
grep524=grep524[c(6,8)]
grep525=grep("Ti",datostfg2[,19])
datostfg2[grep525,19]
grep526=grep("Hijo",datostfg2[,19])
datostfg2[grep526,19]
grep527=grep("HIJO",datostfg2[,19])
grep527=grep("hijo",datostfg2[,19]) ####No considerar
datostfg2[grep527,19]
grep527=grep("t?",datostfg2[,19])
datostfg2[grep527,19]
grep527=grep527[c(164,182,202,762,841)]
grep528=grep("Prim",datostfg2[,19])
grep529=grep("PRIM",datostfg2[,19])
grep530=grep("prim",datostfg2[,19])
grep528=grep("Sobrin",datostfg2[,19])
grep529=grep("SOBRINO",datostfg2[,19])
grep530=grep("sobrino",datostfg2[,19])
grep528=grep("Bisab",datostfg2[,19])
grep529=grep("BISAB",datostfg2[,19])
grep530=grep("bisab",datostfg2[,19])
grep403=grep("hijo",datostfg2[,19])
datostfg2[grep403,19]
grep48=grep("Hijo",datostfg2[,19])
datostfg2[grep48,19]
grep528=grep("Hijo",datostfg2[,19])
datostfg2[grep528,19]



datostfg2[,14]=replace(datostfg2[,14],grep500,"1")
datostfg2[,14]=replace(datostfg2[,14],grep501,"1")
datostfg2[,14]=replace(datostfg2[,14],grep502,"1")
datostfg2[,14]=replace(datostfg2[,14],grep506,"1")
datostfg2[,14]=replace(datostfg2[,14],grep507,"1")
datostfg2[,14]=replace(datostfg2[,14],grep517,"1")
datostfg2[,14]=replace(datostfg2[,14],grep508,"1")
datostfg2[,14]=replace(datostfg2[,14],grep509,"1")
datostfg2[,14]=replace(datostfg2[,14],grep510,"1")
datostfg2[,14]=replace(datostfg2[,14],grep511,"1")
datostfg2[,14]=replace(datostfg2[,14],grep503,"0")
datostfg2[,14]=replace(datostfg2[,14],grep504,"0")
datostfg2[,14]=replace(datostfg2[,14],grep505,"0")
datostfg2[,14]=replace(datostfg2[,14],grep512,"1")
datostfg2[,14]=replace(datostfg2[,14],grep513,"1")
datostfg2[,14]=replace(datostfg2[,14],grep514,"1")
datostfg2[,14]=replace(datostfg2[,14],grep515,"1")
datostfg2[,14]=replace(datostfg2[,14],grep516,"1")
datostfg2[,14]=replace(datostfg2[,14],grep517,"1")
datostfg2[,14]=replace(datostfg2[,14],grep518,"1")
datostfg2[,14]=replace(datostfg2[,14],grep519,"1")
datostfg2[,14]=replace(datostfg2[,14],grep520,"1")
datostfg2[,14]=replace(datostfg2[,14],grep521,"1")
datostfg2[,14]=replace(datostfg2[,14],grep522,"1")
datostfg2[,14]=replace(datostfg2[,14],grep523,"1")
datostfg2[,14]=replace(datostfg2[,14],grep524,"1")
datostfg2[,14]=replace(datostfg2[,14],grep525,"1")
datostfg2[,14]=replace(datostfg2[,14],grep526,"1")
datostfg2[,14]=replace(datostfg2[,14],grep527,"1")
datostfg2[,14]=replace(datostfg2[,14],grep530,"1")
datostfg2[,14]=replace(datostfg2[,14],grepHTA,"1")
datostfg2[,14]=replace(datostfg2[,14],grep48,"1")
datostfg2[,14]=replace(datostfg2[,14],grep528,"1")
datostfg2[,14]=replace(datostfg2[,14],grep403,"1")

colnames(datostfg2)[177]="TratamientoHipertension"

grep2613=grep("1",datostfg2[,14])
datostfg2[grep2613[1:1000],19]

####Bucle
for (i in 1:11984){comp=(datostfg2[i,14]=="1"&&
  is.na(datostfg2[i,19])==TRUE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,14]="0"
}else{
        datostfg2[i,14]=datostfg2[i,14]
}}

grep2613=grep("1",datostfg2[,14])
datostfg2[grep2613,19]
datostfg2[grep2613[c(2,4,8,12,13,16,26,38,69,71,91,96,97,99,103,104,105,108,109,112,113,116,118,119,120,125,132,133,137,140,149,151,152,155,157,159,164,165,166,174,179,180,181,182,183,186,188,191,195,197,200,206,209,210,212,245,246,256,264,279,295,310,315,321,322,324,344,352,367)],19]
datostfg2[grep2613[c(2,4,8,12,13,16,26,38,69,71,91,96,97,99,103,104,105,108,109,112,113,116,118,119,120,125,132,133,137,140,149,151,152,155,157,159,164,165,166,174,179,180,181,182,183,186,188,191,195,197,200,206,209,210,212,245,246,256,264,279,295,310,315,321,322,324,344,352,367)],14]="0"

grep2614=grep("0",datostfg2[,14])
table(datostfg2[grep2614,19])
grep2615=grep("tto",datostfg2[,19])
datostfg2[grep2615,19]
datostfg2[grep2615,14]
datostfg2[grep2615,14]="1"
grep2616=grep("fallecid",datostfg2[,19])
datostfg2[grep2616,19]
datostfg2[grep2616,14]
datostfg2[grep2616,14]="1"
grep2617=grep("^Historia",datostfg2[,19])
datostfg2[grep2617,19]
datostfg2[grep2617,14]
datostfg2[grep2617,14]="1"
grep2618=grep("tratam",datostfg2[,19])
datostfg2[grep2618,19]
datostfg2[grep2618,14]
datostfg2[grep2618[c(14,49)],14]="1"
grep2619=grep("medicada",datostfg2[,19])
datostfg2[grep2619,19]
datostfg2[grep2619,14]
datostfg2[grep2619,14]="1"

####Bucle
for (i in 1:11984){comp=(
  is.na(datostfg2[i,25])==FALSE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,14]="1"
}else{
        datostfg2[i,14]=datostfg2[i,14]
}}

for (i in 1:11984){comp=(datostfg2[i,14]=="1")
if(!is.na(comp)) if (comp) {
   datostfg2[i,175]="1"
}else{
        datostfg2[i,175]=datostfg2[i,175]
}}

grepHiper1=grep("Hiperten",datostfg2[,16])
datostfg2[grepHiper1,16]
grepHiper1=grepHiper1[c(174,173,171,170,168,167,166,165,164,162,161,155,154,151,150,149,146,144,142,141,129,128,127,125,123,118,117,116,112,110,109,108,107,101,99,98,96,95,94,93,92,87,86,83,80,79,78,77,74,73,72,71,68,67,64,63,60,55,53,48,39,35,34,32,26,25,18,17,16,12,11,6,2,1)]
grepHiper2=grep("hiperten",datostfg2[,16])
datostfg2[grepHiper2,16]
grepHiper3=grep("HIPERTEN",datostfg2[,16])
datostfg2[grepHiper3,16]
grepHiper3=grep("Hiperten",datostfg2[,17])
datostfg2[grepHiper3,17]
grepHiper4=grep("hiperten",datostfg2[,17])
datostfg2[grepHiper4,17]
grepHiper5=grep("HIPERTEN",datostfg2[,17])
datostfg2[grepHiper5,17]
grepHiper6=grep("Hiperten",datostfg2[,18])
datostfg2[grepHiper6,18]
grepHiper7=grep("hiperten",datostfg2[,18])
datostfg2[grepHiper7,18]
grepHiper8=grep("HIPERTEN",datostfg2[,18])
datostfg2[grepHiper8,18]
grepHiper8=grep("HTA",datostfg2[,16])
datostfg2[grepHiper8,16]
grepHiper9=grep("HTA",datostfg2[,17])
datostfg2[grepHiper9,17]
grepHiper10=grep("HTA",datostfg2[,18])
datostfg2[grepHiper10,18]
grepHiper11=grep("ht",datostfg2[,16])
datostfg2[grepHiper11,16]
grepHiper12=grep("ht",datostfg2[,17])
datostfg2[grepHiper12,17]
grepHiper12=grep("ht",datostfg2[,18])
datostfg2[grepHiper12,18]
grepHiper12=grep("Hta",datostfg2[,17])
datostfg2[grepHiper12,17]
grepHiper12=grep("Hta",datostfg2[,18])
datostfg2[grepHiper12,18]
grepHiper12=grep("Hta",datostfg2[,16])
datostfg2[grepHiper12,16]
datostfg2[,14]=replace(datostfg2[,14],grepHiper1,"1")
datostfg2[,14]=replace(datostfg2[,14],grepHiper2,"1")
datostfg2[,14]=replace(datostfg2[,14],grepHiper3,"1")
datostfg2[,14]=replace(datostfg2[,14],grepHiper4,"1")
datostfg2[,14]=replace(datostfg2[,14],grepHiper6,"1")
datostfg2[,14]=replace(datostfg2[,14],grepHiper7,"1")
datostfg2[,14]=replace(datostfg2[,14],grepHiper8,"1")
datostfg2[,14]=replace(datostfg2[,14],grepHiper9,"1")
datostfg2[,14]=replace(datostfg2[,14],grepHiper10,"1")
datostfg2[,14]=replace(datostfg2[,14],grepHiper11,"1")


datostfg2[c(2676,3877,5871,5919,6123),19]
datostfg2[c(2676,3877,5871,5919,6123),14]="0"
```



```{r,include=TRUE}
####Variable 13 (Diabetes.Tipo.1.)
table(datostfg2[,13])
####Variable 21 (DiaTipo1Fam_Multi)
table(datostfg2[,21]) #####Ninguna categoria se repite,en principio no tocar nada

####Si el paciente tiene antecedentes familiares de Diabetes Tipo 1 la variable numérica debe presentar un 1,en caso contrario presentará un 0.

####Bucles
for (i in 1:11984){comp=(
  is.na(datostfg2[i,21])==FALSE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,13]="1"
}else{
        datostfg2[i,13]=datostfg2[i,13]
}}

for (i in 1:11984){comp=(
  is.na(datostfg2[i,21])==TRUE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,13]="0"
}else{
        datostfg2[i,13]=datostfg2[i,13]
}}
grep2900=grep("1",datostfg2[,13])
table(datostfg2[grep2900,21])
grepDIA1=grep("Diabetes",datostfg2[,16])
datostfg2[grepDIA1,16]
grepDIA2=grep("diabetes",datostfg2[,16])
datostfg2[grepDIA2,16]
grepDIA3=grep("DIABETE",datostfg2[,16])
datostfg2[grepDIA3,16]
grepDIA4=grep("Diabetes",datostfg2[,17])
datostfg2[grepDIA4,17]
grepDIA4=grep("diabetes",datostfg2[,17])
datostfg2[grepDIA4,17]
grepDIA4=grep("DIABETE",datostfg2[,17])
datostfg2[grepDIA4,17]
grepDIA4=grep("Diabetes",datostfg2[,18])
datostfg2[grepDIA4,18]
grepDIA4=grep("diabetes",datostfg2[,18])
datostfg2[grepDIA4,18]
grepDIA5=grep("DIABETE",datostfg2[,18])
datostfg2[grepDIA5,18]

datostfg2[grepDIA1[c(181,179,142,119,91,74,34,29,7,5,4,3,2)],13]="1"
datostfg2[grepDIA2[c(21,19,16,9,6,1)],13]="1"
####Variable 20 (Diabetes.Tipo.2)
table(datostfg2[,20]) 

#####Variable 22 (DiaTipo2Fam_Multi)
table(datostfg2[,22]) #####Ninguna categoria se repite,en principio no tocar nada

####Si el paciente tiene antecedentes familiares de Diabetes Tipo 2 la variable numérica debe presentar un 1,en caso contrario presentará un 0.

####Bucles
for (i in 1:11984){comp=(
  is.na(datostfg2[i,22])==TRUE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,20]="0"
}else{
        datostfg2[i,20]=datostfg2[i,20]
}}

for (i in 1:11984){comp=(
  is.na(datostfg2[i,22])==FALSE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,20]="1"
}else{
        datostfg2[i,20]=datostfg2[i,20]
}}

grep2901=grep("1",datostfg2[,20])
table(datostfg2[grep2901,22])
datostfg2[grepDIA1[c(182,178,175,174,172,171,164,156,155,153,150,149,145,140,136,133,126,92,91,86,81,80,78,77,76,75,73,72,61,57,56,48,47,34,29)],20]="1"
datostfg2[grepDIA2[c(28,26,20,17)],20]="1"

datostfg2[c(2676,3877,5871,5919,6123),21]
datostfg2[c(2676,3877,5871,5919,6123),13]
datostfg2[c(2676,3877,5871,5919,6123),22]
datostfg2[c(2676,3877,5871,5919,6123),20]
```

```{r,include=TRUE}
####Variable 23 (EnfRespiratoria_txt)

######Si el paciente tiene antecedentes familiares de enfermedades respiratorias la variable numérica debe presentar un 1,en caso contrario presentará un 0.

datostfg2[1:1000,23]
datostfg2[10984:11984,23]
grep531=grep("^no",datostfg2[,23])
datostfg2[grep531,23]
grep531=grep531[-c(2,5,20,197)]
grep532=grep("^No",datostfg2[,23])
datostfg2[grep532,23]
datostfg2[grep532[1001:2000],23]
datostfg2[grep532[2001:2160],23]
grep532=grep532[-c(691,726,729)]

grep533=grep("^NO",datostfg2[,23])
datostfg2[grep533,23]
grep534=grep("^ni",datostfg2[,23])
datostfg2[grep534,23]
grep535=grep("^NI",datostfg2[,23])
datostfg2[grep535,23]
grep536=grep("^SIN",datostfg2[,23])
datostfg2[grep536,23]
grep537=grep("^Sin",datostfg2[,23])
grep537=grep("^sin",datostfg2[,23])
datostfg2[grep537,23]
grep538=grep("^El deportista no refiere",datostfg2[,23])
datostfg2[grep538,23]
grep539=grep("^EL DEPORTISTA NO REFIERE",datostfg2[,23])
grep756=grep("NR",datostfg2[,23])
datostfg2[grep756,23]
grep757=grep("^N.R",datostfg2[,23])

grep540=grep("ABA",datostfg2[,23])
datostfg2[grep540,23]
grep541=grep("Aba",datostfg2[,23]) ###En este caso Aba es diminutivo de abuela
datostfg2[grep541,23]
grep541=grep("aba",datostfg2[,23])
datostfg2[grep541,23] ####No considerar
grep541=grep("EPOC",datostfg2[,23])
datostfg2[grep541,23]
grep542=grep("epoc",datostfg2[,23])
datostfg2[grep542,23]
grep543=grep("Epoc",datostfg2[,23])
datostfg2[grep543,23] 
grep544=grep("Bronqui",datostfg2[,23])
datostfg2[grep544,23]
grep545=grep("BRONQUI",datostfg2[,23])
datostfg2[grep545,23]
grep546=grep("bronqui",datostfg2[,23])
datostfg2[grep546,23] 
grep547=grep("Asma",datostfg2[,23])
datostfg2[grep547,23]
grep548=grep("ASMA",datostfg2[,23])
datostfg2[grep548,23]
grep549=grep("asma",datostfg2[,23])
datostfg2[grep549,23] 
grep550=grep("ASma",datostfg2[,23])
datostfg2[grep550,23]
grep551=grep("Disnea",datostfg2[,23])
grep551=grep("DISNEA",datostfg2[,23])
datostfg2[grep551,23]
grep552=grep("disnea",datostfg2[,23])
datostfg2[grep552,23] 
grep553=grep("Patolo",datostfg2[,23])
grep553=grep("PATOLO",datostfg2[,23])
grep553=grep("patolo",datostfg2[,23])
datostfg2[grep553,23] 
grep554=grep("rinitis",datostfg2[,23])
datostfg2[grep554,23]
grep555=grep("Rinitis",datostfg2[,23])
grep555=grep("RINITIS",datostfg2[,23])
grep555=grep("Alergia",datostfg2[,23])
datostfg2[grep555,23]
grep556=grep("ALERGIA",datostfg2[,23])
datostfg2[grep556,23]
grep556=grep("alergia",datostfg2[,23])
datostfg2[grep556,23] 
grep557=grep("Problemas",datostfg2[,23])
datostfg2[grep557,23]
grep558=grep("PROBLEMAS",datostfg2[,23])
grep558=grep("problemas",datostfg2[,23])
datostfg2[grep558,23] 
grep559=grep("EAP",datostfg2[,23])
datostfg2[grep559,23] 
grep560=grep("eap",datostfg2[,23])
grep560=grep("Eap",datostfg2[,23])
grep560=grep("Hiperactivi",datostfg2[,23])
datostfg2[grep560,23]
grep561=grep("hiperacti",datostfg2[,23])
grep561=grep("HIPER",datostfg2[,23])
datostfg2[grep561,23]
grep562=grep("Insuf",datostfg2[,23])
datostfg2[grep562,23]
grep563=grep("INSUF",datostfg2[,23])
grep564=grep("insuf",datostfg2[,23])
datostfg2[grep564,23] 
grep565=grep("imnsuficiencia",datostfg2[,23])
datostfg2[grep565,23] 
grep566=grep("SAOS",datostfg2[,23])
datostfg2[grep566,23]
grep567=grep("Saos",datostfg2[,23])
grep567=grep("saos",datostfg2[,23])
grep567=grep("Apnea",datostfg2[,23])
datostfg2[grep567,23]
grep568=grep("APNEA",datostfg2[,23])
grep568=grep("apnea",datostfg2[,23])
datostfg2[grep568,23] 
grep569=grep("TBC",datostfg2[,23])
datostfg2[grep569,23]
grep570=grep("Tbc",datostfg2[,23])
datostfg2[grep570,23]
grep571=grep("tbc",datostfg2[,23])
grep571=grep("NEUMO",datostfg2[,23])
grep571=grep("Neumo",datostfg2[,23])
datostfg2[grep571,23]
grep572=grep("neumo",datostfg2[,23])
datostfg2[grep572,23] 
grep573=grep("Bronco",datostfg2[,23])
datostfg2[grep573,23]
grep574=grep("BRONCO",datostfg2[,23])
grep574=grep("bronco",datostfg2[,23])
datostfg2[grep574,23] 
grep575=grep("Hialina",datostfg2[,23])
datostfg2[grep575,23] 
grep576=grep("HIALINA",datostfg2[,23])
grep576=grep("hialina",datostfg2[,23])
grep577=grep("Silicosis",datostfg2[,23])
datostfg2[grep577,23]
grep578=grep("silicosis",datostfg2[,23])
datostfg2[grep578,23]
grep579=grep("SILICOSIS",datostfg2[,23])
grep579=grep("El deportista refiere",datostfg2[,23])
grep579=grep("Faringitis",datostfg2[,23])
datostfg2[grep579,23]
grep580=grep("faringitis",datostfg2[,23])
grep580=grep("FARINGITIS",datostfg2[,23])
grep580=grep("Laringitis",datostfg2[,23])
datostfg2[grep580,23]
grep580=grep("laringitis",datostfg2[,23])
grep580=grep("LARINGITIS",datostfg2[,23])
grep580=grep("Sinusitis",datostfg2[,23])
grep580=grep("sinusitis",datostfg2[,23])
datostfg2[grep580,23]
grep576=grep("SINUSITIS",datostfg2[,23])
grep576=grep("Amigdalitis",datostfg2[,23])
grep576=grep("amigdalitis",datostfg2[,23])
datostfg2[grep580,23]
grep576=grep("Amigdalitis",datostfg2[,23])
grep576=grep("Gripe",datostfg2[,23])
grep576=grep("gripe",datostfg2[,23])
grep576=grep("GRIPE",datostfg2[,23])
grep576=grep("pulmon",datostfg2[,23])
datostfg2[grep576,23]
grep581=grep("Pulmon",datostfg2[,23])
datostfg2[grep581,23]
grep582=grep("PULMON",datostfg2[,23])
datostfg2[grep582,23]
grep1030=grep("resp",datostfg2[,23])
datostfg2[grep1030,23] ####Considerar 228,251,215 y 70 como un si
grep1030=grep1030[c(348,343,341,335,334,331,329,327,326,324,323,319,314,312,294,293,288,286,285,284,283,282,277,272,269,265,261,260,258,257,256,255,254,251,250,249,248,247,243,240,239,238,234,233,230,228,227,226,225,223,217,216,215,213,211,209,207,205,203,201,200,198,197,196,195,194,193,192,186,182,181,180,177,176,174,165,161,157,153,151,147,145,144,143,142,140,139,136,135,133,132,131,130,129,127,126,125,124,122,121,120,119,118,117,116,115,113,111,108,107,106,104,103,102,101,100,98,97,96,95,94,90,85,83,82,81,79,78,77,76,75,74,73,72,71,70,69,68,66,64,63,62,58,57,55,54,53,52,51,50,49,48,46,44,43,42,37,35,34,33,32,30,25,23,22,20,17,16,15,12,11,10,9,7,5,3,2,1)]
grep1031=grep("rgi",datostfg2[,23])
datostfg2[grep1031,23] 
grep1032=grep("S.A.O.",datostfg2[,23])
datostfg2[grep1032,23] 
grep1033=grep("Carcinoma",datostfg2[,23])
grep1033=grep("CARCINOMA",datostfg2[,23])
grep1033=grep("carcinoma",datostfg2[,23])
datostfg2[grep1033,23]
grep1034=grep("silui",datostfg2[,23])
datostfg2[grep1034,23]
grep1035=grep("Silui",datostfg2[,23])
grep1035=grep("SILUI",datostfg2[,23])


####Comprobemos si hay algun caso en que solo aparece el familiar sin especificar la enfermedad respiratoria que sufre

grep582=grep("Padre",datostfg2[,23])
datostfg2[grep582,23]
grep583=grep("padre",datostfg2[,23])
datostfg2[grep513,23]
grep584=grep("PADRE",datostfg2[,23])
datostfg2[grep584,23]
grep585=grep("MADRE",datostfg2[,23])
datostfg2[grep585,23]
grep586=grep("Madre",datostfg2[,23])
datostfg2[grep586,23]
grep587=grep("madre",datostfg2[,23])
datostfg2[grep587,23]
grep588=grep("Herman",datostfg2[,23])
datostfg2[grep588,23]
grep589=grep("HERMAN",datostfg2[,23])
datostfg2[grep589,23]
grep590=grep("herman",datostfg2[,23])
datostfg2[grep590,23]
grep591=grep("Abuel",datostfg2[,23])
datostfg2[grep591,23]
grep592=grep("ABUEL",datostfg2[,23])
datostfg2[grep592,23]
grep593=grep("abuel",datostfg2[,23])
datostfg2[grep593,23]
grep594=grep("TI",datostfg2[,23])
datostfg2[grep594,23]

grep595=grep("^ti",datostfg2[,23])
datostfg2[grep595,23]
grep596=grep("^Ti",datostfg2[,23])
datostfg2[grep596,23]
grep597=grep("Hijo",datostfg2[,23])
datostfg2[grep597,23]
grep598=grep("HIJO",datostfg2[,23])
grep598=grep("hijo",datostfg2[,23])
datostfg2[grep598,23]
grep599=grep("Prim",datostfg2[,23])
datostfg2[grep599,23]
grep600=grep("PRIM",datostfg2[,23])
grep600=grep("prim",datostfg2[,23])
datostfg2[grep600,23]
grep601=grep("Sobrin",datostfg2[,23])
datostfg2[grep601,23]
grep602=grep("SOBRINO",datostfg2[,23])
grep602=grep("sobrino",datostfg2[,23])
datostfg2[grep602,23]
grep603=grep("Bisab",datostfg2[,23])
datostfg2[grep603,23]
grep604=grep("BISAB",datostfg2[,23])
grep604=grep("bisab",datostfg2[,23])
datostfg2[grep604,23]
datostfg2[706,23]=datostfg[706,22]
datostfg2[706,22]=NA


datostfg2[,11]=replace(datostfg2[,11],grep531,"0")
datostfg2[,11]=replace(datostfg2[,11],grep532,"0")
datostfg2[,11]=replace(datostfg2[,11],grep533,"0")
datostfg2[,11]=replace(datostfg2[,11],grep534,"0")
datostfg2[,11]=replace(datostfg2[,11],grep535,"0")
datostfg2[,11]=replace(datostfg2[,11],grep536,"0")
datostfg2[,11]=replace(datostfg2[,11],grep537,"0")
datostfg2[,11]=replace(datostfg2[,11],grep538,"0")
datostfg2[,11]=replace(datostfg2[,11],grep756,"0")
datostfg2[,11]=replace(datostfg2[,11],grep540,"1")
datostfg2[,11]=replace(datostfg2[,11],grep541,"1")
datostfg2[,11]=replace(datostfg2[,11],grep542,"1")
datostfg2[,11]=replace(datostfg2[,11],grep543,"1")
datostfg2[,11]=replace(datostfg2[,11],grep544,"1")
datostfg2[,11]=replace(datostfg2[,11],grep545,"1")
datostfg2[,11]=replace(datostfg2[,11],grep546,"1")
datostfg2[,11]=replace(datostfg2[,11],grep547,"1")
datostfg2[,11]=replace(datostfg2[,11],grep548,"1")
datostfg2[,11]=replace(datostfg2[,11],grep549,"1")
datostfg2[,11]=replace(datostfg2[,11],grep550,"1")
datostfg2[,11]=replace(datostfg2[,11],grep551,"1")
datostfg2[,11]=replace(datostfg2[,11],grep552,"1")
datostfg2[,11]=replace(datostfg2[,11],grep553,"1")
datostfg2[,11]=replace(datostfg2[,11],grep554,"1")
datostfg2[,11]=replace(datostfg2[,11],grep555,"1")
datostfg2[,11]=replace(datostfg2[,11],grep556,"1")
datostfg2[,11]=replace(datostfg2[,11],grep557,"1")
datostfg2[,11]=replace(datostfg2[,11],grep558,"1")
datostfg2[,11]=replace(datostfg2[,11],grep559,"1")
datostfg2[,11]=replace(datostfg2[,11],grep560,"1")
datostfg2[,11]=replace(datostfg2[,11],grep561,"1")
datostfg2[,11]=replace(datostfg2[,11],grep562,"1")
datostfg2[,11]=replace(datostfg2[,11],grep563,"1")
datostfg2[,11]=replace(datostfg2[,11],grep564,"1")
datostfg2[,11]=replace(datostfg2[,11],grep565,"1")
datostfg2[,11]=replace(datostfg2[,11],grep566,"1")
datostfg2[,11]=replace(datostfg2[,11],grep567,"1")
datostfg2[,11]=replace(datostfg2[,11],grep568,"1")
datostfg2[,11]=replace(datostfg2[,11],grep569,"1")
datostfg2[,11]=replace(datostfg2[,11],grep570,"1")
datostfg2[,11]=replace(datostfg2[,11],grep571,"1")
datostfg2[,11]=replace(datostfg2[,11],grep572,"1")
datostfg2[,11]=replace(datostfg2[,11],grep573,"1")
datostfg2[,11]=replace(datostfg2[,11],grep574,"1")
datostfg2[,11]=replace(datostfg2[,11],grep575,"1")
datostfg2[,11]=replace(datostfg2[,11],grep576,"1")
datostfg2[,11]=replace(datostfg2[,11],grep577,"1")
datostfg2[,11]=replace(datostfg2[,11],grep578,"1")
datostfg2[,11]=replace(datostfg2[,11],grep579,"1")
datostfg2[,11]=replace(datostfg2[,11],grep580,"1")
datostfg2[,11]=replace(datostfg2[,11],grep581,"1")
datostfg2[,11]=replace(datostfg2[,11],grep582,"1")
datostfg2[,11]=replace(datostfg2[,11],grep583,"1")
datostfg2[,11]=replace(datostfg2[,11],grep584,"1")
datostfg2[,11]=replace(datostfg2[,11],grep585,"1")
datostfg2[,11]=replace(datostfg2[,11],grep586,"1")
datostfg2[,11]=replace(datostfg2[,11],grep587,"1")
datostfg2[,11]=replace(datostfg2[,11],grep588,"1")
datostfg2[,11]=replace(datostfg2[,11],grep589,"1")
datostfg2[,11]=replace(datostfg2[,11],grep590,"1")
datostfg2[,11]=replace(datostfg2[,11],grep591,"1")
datostfg2[,11]=replace(datostfg2[,11],grep592,"1")
datostfg2[,11]=replace(datostfg2[,11],grep593,"1")
datostfg2[,11]=replace(datostfg2[,11],grep594,"1")
datostfg2[,11]=replace(datostfg2[,11],grep595,"1")
datostfg2[,11]=replace(datostfg2[,11],grep596,"1")
datostfg2[,11]=replace(datostfg2[,11],grep597,"1")
datostfg2[,11]=replace(datostfg2[,11],grep598,"1")
datostfg2[,11]=replace(datostfg2[,11],grep599,"1")
datostfg2[,11]=replace(datostfg2[,11],grep600,"1")
datostfg2[,11]=replace(datostfg2[,11],grep601,"1")
datostfg2[,11]=replace(datostfg2[,11],grep602,"1")
datostfg2[,11]=replace(datostfg2[,11],grep603,"1")
datostfg2[,11]=replace(datostfg2[,11],grep604,"1")
datostfg2[,11]=replace(datostfg2[,11],grep1030,"1")
datostfg2[,11]=replace(datostfg2[,11],grep1031,"1")
datostfg2[,11]=replace(datostfg2[,11],grep1032,"1")
datostfg2[,11]=replace(datostfg2[,11],grep1033,"1")
datostfg2[,11]=replace(datostfg2[,11],grep1034,"1")
datostfg2[,11]=replace(datostfg2[,11],grep1035,"1")

grep2607=grep("1",datostfg2[,11])
datostfg2[grep2607,23]

####Bucle
for (i in 1:11984){comp=(
  is.na(datostfg2[i,23])==TRUE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,11]="0"
}else{
        datostfg2[i,11]=datostfg2[i,11]
}}

grep2607=grep("1",datostfg2[,11])
datostfg2[grep2607[1:1000],23]
datostfg2[grep2607[1001:2000],23]
datostfg2[grep2607[2001:2836],23]
datostfg2[grep2607[c(16,23,52,150,151,172,198,200,202,210,213,241,320,327,360,377,531,647,651,662,703,726,743,748,750,790,811,812,813,879,898,929,961,1169,1256,1273,1317,1358,1473,1479,1521,1554,1625,1651,1669,1683,1693,1760,1773,1804,1941,1964,2023,2045,2046,2090,2094,2096,2141,2187,2213,2217,2283,2361,2460,2463,2491,2505,2692,2764)],23]
datostfg2[grep2607[c(16,23,52,150,151,172,198,200,202,210,213,241,320,327,360,377,531,647,651,662,703,726,743,748,750,790,811,812,813,879,898,929,961,1169,1256,1273,1317,1358,1473,1479,1521,1554,1625,1651,1669,1683,1693,1760,1773,1804,1941,1964,2023,2045,2046,2090,2094,2096,2141,2187,2213,2217,2283,2361,2460,2463,2491,2505,2692,2764)],11]="0"

grep2608=grep("0",datostfg2[,11])
table(datostfg2[grep2608,23])
grep2609=grep("Abo",datostfg2[,23])
datostfg2[grep2609,23]
datostfg2[grep2609,11]
datostfg2[grep2609,11]="1"
grep2610=grep("Aba",datostfg2[,23])
datostfg2[grep2610,23]
datostfg2[grep2610,11]
datostfg2[grep2610,11]="1"
grep2611=grep("DIsnea",datostfg2[,23])
datostfg2[grep2611,23]
datostfg2[grep2611,11]
datostfg2[grep2611,11]="1"
grep2612=grep("tos",datostfg2[,23])
datostfg2[grep2612,23]
datostfg2[grep2612,11]
datostfg2[grep2612[c(2)],11]="1"
grep2608=grep("0",datostfg2[,11])
table(datostfg2[grep2608,23])

table(datostfg2[,11])
####Bucle
for (i in 1:11984){comp=(is.na(datostfg2[i,11])==TRUE&&
  is.na(datostfg2[i,23])==FALSE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,11]="Revisar"
}else{
        datostfg2[i,11]=datostfg2[i,11]
}}
grep2903=grep("Revisar",datostfg2[,11])
datostfg2[grep2903,23]
datostfg2[grep2903[c(1,3,4,5)],11]="0"
datostfg2[grep2903[c(2)],11]="1"

datostfg2[c(2676,3877,5871,5919,6123),23]
datostfg2[c(2676,3877,5871,5919,6123),11]
```




```{r,include=TRUE}
####Variable 24 (AntOnco_txt)
datostfg2[1:1000,24]
datostfg2[10984:11984,24]
####Vamos a crear una varible dicotómica con un 1 si algún familiar del deportista tiene un antecedente oncológico y un 0 en caso contrario.

grep605=grep("^no",datostfg2[,24])
datostfg2[grep605,24]
grep606=grep("^No",datostfg2[,24])
datostfg2[grep606,24]
datostfg2[grep606[1001:1220],24]
grep606=grep606[-c(298,418,537,828)]
grep607=grep("^NO",datostfg2[,24])
datostfg2[grep607,24]
grep608=grep("^ni",datostfg2[,24])
grep608=grep("^NI",datostfg2[,24])
datostfg2[grep608,24]
grep609=grep("^SIN",datostfg2[,24])
datostfg2[grep609,24]
grep610=grep("^Sin",datostfg2[,24])
datostfg2[grep610,24]
grep610_si=grep610[c(1)]
grep610=grep610[-c(1)]
datostfg2[grep610_si,24]
grep611=grep("^sin",datostfg2[,24])
datostfg2[grep611,24]
grep612=grep("^El deportista no refiere",datostfg2[,24])
datostfg2[grep612,24]
grep613=grep("^EL DEPORTISTA NO REFIERE",datostfg2[,24])
grep757=grep("NR",datostfg2[,24])
datostfg2[grep757,24]
grep758=grep("^N.R",datostfg2[,24])

grep614=grep("ca ",datostfg2[,24])
datostfg2[grep614,24]
datostfg2[grep614[1001:1258],24]
grep614=grep614[-c(93,264)]
grep615=grep("CA ",datostfg2[,24]) 
datostfg2[grep615,24]
grep616=grep("Ca ",datostfg2[,24])
datostfg2[grep616,24] 
grep617=grep("Cancer",datostfg2[,24])
datostfg2[grep617,24]
grep618=grep("cancer",datostfg2[,24])
datostfg2[grep618,24]
grep619=grep("CANCER",datostfg2[,24])
datostfg2[grep619,24] 
grep620=grep("c?ncer",datostfg2[,24])
datostfg2[grep620,24]
grep621=grep("C?ncer",datostfg2[,24]) ###Igual que 620
datostfg2[grep621,24]
grep622=grep("C?NCER",datostfg2[,24])
datostfg2[grep622,24] 


grep623=grep("Linfoma",datostfg2[,24])
datostfg2[grep623,24]
grep624=grep("LINFOMA",datostfg2[,24])
datostfg2[grep624,24]
grep625=grep("linfoma",datostfg2[,24])
datostfg2[grep625,24] 
grep626=grep("Leucemia",datostfg2[,24])
datostfg2[grep626,24]
grep627=grep("LEUCEMIA",datostfg2[,24])
datostfg2[grep627,24]
grep628=grep("leucemia",datostfg2[,24])
datostfg2[grep628,24]
grep629=grep("Melanoma",datostfg2[,24])
datostfg2[grep629,24] 
grep630=grep("MELANOMA",datostfg2[,24])
datostfg2[grep630,24] 
grep631=grep("melanoma",datostfg2[,24])
datostfg2[grep631,24] 
grep632=grep("Carcinoma",datostfg2[,24])
datostfg2[grep632,24] 
grep633=grep("CARCINOMA",datostfg2[,24])
datostfg2[grep633,24]
grep634=grep("carcinoma",datostfg2[,24])
datostfg2[grep634,24]

grep635=grep("Neo",datostfg2[,24])
datostfg2[grep635,24]
datostfg2[grep635[1001:1283],24]
grep636=grep("NEO",datostfg2[,24])
grep636=grep("neo",datostfg2[,24])
datostfg2[grep636,24]
grep637=grep("Sarcoma",datostfg2[,24])
datostfg2[grep637,24]
grep638=grep("SARCOMA",datostfg2[,24])
datostfg2[grep638,24]
grep638=grep("sarcoma",datostfg2[,24])
datostfg2[grep638,24] 
grep639=grep("Tumor",datostfg2[,24])
datostfg2[grep639,24]
grep640=grep("TUMOR",datostfg2[,24])
datostfg2[grep640,24]
grep641=grep("tumor",datostfg2[,24])
datostfg2[grep641,24] 
grep642=grep("Noe",datostfg2[,24])
datostfg2[grep642,24] 
grep643=grep("noe",datostfg2[,24])
grep643=grep("NOE",datostfg2[,24])
grep643=grep("cirrosis",datostfg2[,24])
datostfg2[grep643,24]
grep644=grep("CIRROSIS",datostfg2[,24])
grep644=grep("Cirrosis",datostfg2[,24])
datostfg2[grep644,24]
grep645=grep("Mioma",datostfg2[,24])
datostfg2[grep645,24]
grep646=grep("mioma",datostfg2[,24])
datostfg2[grep646,24] 
grep647=grep("MIOMA",datostfg2[,24])
datostfg2[grep647,24] 
grep648=grep("Feocromo",datostfg2[,24])
datostfg2[grep648,24] 
grep649=grep("FEOCROMO",datostfg2[,24])
grep649=grep("feocromo",datostfg2[,24])
datostfg2[grep649,24] 
grep650=grep("nevus",datostfg2[,24])
datostfg2[grep650,24]
grep651=grep("Nevus",datostfg2[,24])
grep651=grep("NEVUS",datostfg2[,24])
grep651=grep("HISTEREC",datostfg2[,24])
grep651=grep("Histerec",datostfg2[,24])
datostfg2[grep651,24]
grep652=grep("histerec",datostfg2[,24])
datostfg2[grep652,24]
grep653=grep("crcinoma",datostfg2[,24])
datostfg2[grep653,24]
grep654=grep("Crcinoma",datostfg2[,24])
grep654=grep("CRCINOMA",datostfg2[,24])
grep655=grep("ictus",datostfg2[,24])
datostfg2[grep655,24] ####Infiero que el ictus es a  consecuencia del cancer
grep656=grep("ICTUS",datostfg2[,24])
grep656=grep("Ictus",datostfg2[,24])
grep1036=grep("basocelular",datostfg2[,24])
datostfg2[grep1036,24]
grep1037=grep("Basocelular",datostfg2[,24])
grep1037=grep("BASOCELULAR",datostfg2[,24])
grep1037=grep("Glioma",datostfg2[,24])
datostfg2[grep1037,24]
grep1038=grep("glioma",datostfg2[,24])
datostfg2[grep1038,24]
grep1039=grep("GLIOMA",datostfg2[,24])
datostfg2[grep1039,24]
grep1040=grep("uterino",datostfg2[,24])
datostfg2[grep1040,24]
grep1041=grep("Uterino",datostfg2[,24])
datostfg2[grep1041,24]
grep1042=grep("UTERINO",datostfg2[,24])
grep1043=grep("Lyunch",datostfg2[,24])
datostfg2[grep1043,24]
grep1044=grep("lyunch",datostfg2[,24])
grep1044=grep("LYUNCH",datostfg2[,24])
grep1044=grep("LY",datostfg2[,24])
grep1044=grep("ly",datostfg2[,24])
grep1045=grep("Hodking",datostfg2[,24])
datostfg2[grep1045,24]
grep1046=grep("hodking",datostfg2[,24])
datostfg2[grep1046,24]
grep1047=grep("HODKING",datostfg2[,24])
datostfg2[grep1047,24]
grep1048=grep("ho",datostfg2[,24])
datostfg2[grep1048,24]
grep1048=grep1048[c(20,12,4)]
grep1049=grep("Ho",datostfg2[,24])
datostfg2[grep1049,24] 
grep1049=grep1049[c(59,58,57,56,55,54,53,52,48,47,46,45,44,43,42,40,37,36,35,33,32,30,29,28,27,26,25,24,23,21,20,19,18,15,12,11,10,8,7,6,5,4,3,1)]
grep1050=grep("HO",datostfg2[,24])
datostfg2[grep1050,24] ####Lo mismo que en grep1047

####Veamos si en algÚn caso solo aparece el familiar,sin especificar la enfermedad.

grep656=grep("Padre",datostfg2[,24])
datostfg2[grep656,24]
grep657=grep("padre",datostfg2[,24])
datostfg2[grep657,24]
grep658=grep("PADRE",datostfg2[,24])
datostfg2[grep658,24]
grep659=grep("MADRE",datostfg2[,24])
datostfg2[grep659,24]
grep660=grep("Madre",datostfg2[,24])
datostfg2[grep660,24]
grep661=grep("madre",datostfg2[,24])
datostfg2[grep661,24]
grep662=grep("Herman",datostfg2[,24])
datostfg2[grep662,24]
grep663=grep("HERMAN",datostfg2[,24])
datostfg2[grep663,24]
grep664=grep("herman",datostfg2[,24])
datostfg2[grep664,24]
grep665=grep("Abuel",datostfg2[,24])
datostfg2[grep665,24]
grep666=grep("ABUEL",datostfg2[,24])
datostfg2[grep666,24]
grep667=grep("abuel",datostfg2[,24])
datostfg2[grep667,24]
grep668=grep("TI",datostfg2[,24])
datostfg2[grep668,24]  ####En la componente 10,tenemos un caso de PTI, pero no lo eliminamos pues no habia encontrado casos de PTI antes
grep669=grep("^ti",datostfg2[,24])
datostfg2[grep669,24]
grep670=grep("^Ti",datostfg2[,24])
datostfg2[grep670,24]
grep671=grep("Hijo",datostfg2[,24])
datostfg2[grep671,24]
grep672=grep("HIJO",datostfg2[,24])
grep672=grep("hijo",datostfg2[,24])
grep672=grep("Prim",datostfg2[,24])
datostfg2[grep672,24]
grep673=grep("PRIM",datostfg2[,24])
datostfg2[grep673,24]
grep674=grep("prim",datostfg2[,24])
datostfg2[grep674,24]
grep675=grep("Sobrin",datostfg2[,24])
datostfg2[grep675,24]
grep676=grep("SOBRINO",datostfg2[,24])
grep676=grep("sobrino",datostfg2[,24])
datostfg2[grep676,24]
grep677=grep("Bisab",datostfg2[,24])
datostfg2[grep677,24]
grep678=grep("BISAB",datostfg2[,24])
datostfg2[grep678,24]
grep679=grep("bisab",datostfg2[,24])
datostfg2[grep679,24]


####Veamos si hay mas casos de PTI
grep680=grep("PTI",datostfg2[,24])
datostfg2[grep680,24] ###El caso que ya habiamos visto antes
grep681=grep("pti",datostfg2[,24])
grep681=grep("Pti",datostfg2[,24])


datostfg2[,12]=replace(datostfg2[,12],grep605,"0")
datostfg2[,12]=replace(datostfg2[,12],grep606,"0")
datostfg2[,12]=replace(datostfg2[,12],grep607,"0")
datostfg2[,12]=replace(datostfg2[,12],grep608,"0")
datostfg2[,12]=replace(datostfg2[,12],grep609,"0")
datostfg2[,12]=replace(datostfg2[,12],grep610,"0")
datostfg2[,12]=replace(datostfg2[,12],grep611,"0")
datostfg2[,12]=replace(datostfg2[,12],grep612,"0")
datostfg2[,12]=replace(datostfg2[,12],grep613,"0")
datostfg2[,12]=replace(datostfg2[,12],grep757,"0")
datostfg2[,12]=replace(datostfg2[,12],grep610_si,"1")
datostfg2[,12]=replace(datostfg2[,12],grep614,"1")
datostfg2[,12]=replace(datostfg2[,12],grep615,"1")
datostfg2[,12]=replace(datostfg2[,12],grep616,"1")
datostfg2[,12]=replace(datostfg2[,12],grep617,"1")
datostfg2[,12]=replace(datostfg2[,12],grep618,"1")
datostfg2[,12]=replace(datostfg2[,12],grep619,"1")
datostfg2[,12]=replace(datostfg2[,12],grep620,"1")
datostfg2[,12]=replace(datostfg2[,12],grep621,"1")
datostfg2[,12]=replace(datostfg2[,12],grep622,"1")
datostfg2[,12]=replace(datostfg2[,12],grep623,"1")
datostfg2[,12]=replace(datostfg2[,12],grep624,"1")
datostfg2[,12]=replace(datostfg2[,12],grep625,"1")
datostfg2[,12]=replace(datostfg2[,12],grep626,"1")
datostfg2[,12]=replace(datostfg2[,12],grep627,"1")
datostfg2[,12]=replace(datostfg2[,12],grep628,"1")
datostfg2[,12]=replace(datostfg2[,12],grep629,"1")
datostfg2[,12]=replace(datostfg2[,12],grep630,"1")
datostfg2[,12]=replace(datostfg2[,12],grep631,"1")
datostfg2[,12]=replace(datostfg2[,12],grep632,"1")
datostfg2[,12]=replace(datostfg2[,12],grep633,"1")
datostfg2[,12]=replace(datostfg2[,12],grep634,"1")
datostfg2[,12]=replace(datostfg2[,12],grep635,"1")
datostfg2[,12]=replace(datostfg2[,12],grep636,"1")
datostfg2[,12]=replace(datostfg2[,12],grep637,"1")
datostfg2[,12]=replace(datostfg2[,12],grep638,"1")
datostfg2[,12]=replace(datostfg2[,12],grep639,"1")
datostfg2[,12]=replace(datostfg2[,12],grep640,"1")
datostfg2[,12]=replace(datostfg2[,12],grep641,"1")
datostfg2[,12]=replace(datostfg2[,12],grep642,"1")
datostfg2[,12]=replace(datostfg2[,12],grep643,"1")
datostfg2[,12]=replace(datostfg2[,12],grep644,"1")
datostfg2[,12]=replace(datostfg2[,12],grep645,"1")
datostfg2[,12]=replace(datostfg2[,12],grep646,"1")
datostfg2[,12]=replace(datostfg2[,12],grep647,"1")
datostfg2[,12]=replace(datostfg2[,12],grep648,"1")
datostfg2[,12]=replace(datostfg2[,12],grep649,"1")
datostfg2[,12]=replace(datostfg2[,12],grep650,"1")
datostfg2[,12]=replace(datostfg2[,12],grep651,"1")
datostfg2[,12]=replace(datostfg2[,12],grep652,"1")
datostfg2[,12]=replace(datostfg2[,12],grep653,"1")
datostfg2[,12]=replace(datostfg2[,12],grep654,"1")
datostfg2[,12]=replace(datostfg2[,12],grep655,"1")
datostfg2[,12]=replace(datostfg2[,12],grep656,"1")
datostfg2[,12]=replace(datostfg2[,12],grep657,"1")
datostfg2[,12]=replace(datostfg2[,12],grep658,"1")
datostfg2[,12]=replace(datostfg2[,12],grep659,"1")
datostfg2[,12]=replace(datostfg2[,12],grep660,"1")
datostfg2[,12]=replace(datostfg2[,12],grep661,"1")
datostfg2[,12]=replace(datostfg2[,12],grep662,"1")
datostfg2[,12]=replace(datostfg2[,12],grep663,"1")
datostfg2[,12]=replace(datostfg2[,12],grep664,"1")
datostfg2[,12]=replace(datostfg2[,12],grep665,"1")
datostfg2[,12]=replace(datostfg2[,12],grep666,"1")
datostfg2[,12]=replace(datostfg2[,12],grep667,"1")
datostfg2[,12]=replace(datostfg2[,12],grep668,"1")
datostfg2[,12]=replace(datostfg2[,12],grep669,"1")
datostfg2[,12]=replace(datostfg2[,12],grep670,"1")
datostfg2[,12]=replace(datostfg2[,12],grep671,"1")
datostfg2[,12]=replace(datostfg2[,12],grep672,"1")
datostfg2[,12]=replace(datostfg2[,12],grep673,"1")
datostfg2[,12]=replace(datostfg2[,12],grep674,"1")
datostfg2[,12]=replace(datostfg2[,12],grep675,"1")
datostfg2[,12]=replace(datostfg2[,12],grep676,"1")
datostfg2[,12]=replace(datostfg2[,12],grep677,"1")
datostfg2[,12]=replace(datostfg2[,12],grep678,"1")
datostfg2[,12]=replace(datostfg2[,12],grep679,"1")
datostfg2[,12]=replace(datostfg2[,12],grep680,"1")
datostfg2[,12]=replace(datostfg2[,12],grep1036,"1")
datostfg2[,12]=replace(datostfg2[,12],grep1037,"1")
datostfg2[,12]=replace(datostfg2[,12],grep1038,"1")
datostfg2[,12]=replace(datostfg2[,12],grep1039,"1")
datostfg2[,12]=replace(datostfg2[,12],grep1040,"1")
datostfg2[,12]=replace(datostfg2[,12],grep1041,"1")
datostfg2[,12]=replace(datostfg2[,12],grep1042,"1")
datostfg2[,12]=replace(datostfg2[,12],grep1043,"1")
datostfg2[,12]=replace(datostfg2[,12],grep1044,"1")
datostfg2[,12]=replace(datostfg2[,12],grep1045,"1")
datostfg2[,12]=replace(datostfg2[,12],grep1046,"1")
datostfg2[,12]=replace(datostfg2[,12],grep1047,"1")
datostfg2[,12]=replace(datostfg2[,12],grep1048,"1")
datostfg2[,12]=replace(datostfg2[,12],grep1049,"1")




datostfg2[706,24]=datostfg[706,23]
datostfg2[706,12]="1"

grep2600=grep("1",datostfg2[,12])
datostfg2[grep2600,24]

###Bucle
for (i in 1:11984){comp=(
  is.na(datostfg2[i,24])==TRUE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,12]="0"
}else{
        datostfg2[i,12]=datostfg2[i,12]
}}
grep2600=grep("1",datostfg2[,12])
datostfg2[grep2600[1:1000],24]
datostfg2[grep2600[1001:2000],24]
datostfg2[grep2600[2001:3000],24]
datostfg2[grep2600[3001:4000],24]
datostfg2[grep2600[4001:5000],24]
datostfg2[grep2600[5001:5545],24]
datostfg2[grep2600[c(200,283,348,363,375,389,509,511,684,782,813,848,1124,1154,1189,1256,1266,1343,1352,1357,1403,1430,1432,1529,1543,1567,1721,1726,1848,2032,2123,2176,2240,2444,2462,2527,2597,2634,2727,2768,2775,2777,2865,3022,3103,3156,3164,3200,3210,3238,3265,3270,3414,3442,3490,3493,3497,3501,3525,3756,3791,3814,3866,3895,3905,3926,3966,3979,4075,4080,4083,4160,4194,4417,4510,4867,5123,5224,5402)],24]
datostfg2[grep2600[c(200,283,348,363,375,389,509,511,684,782,813,848,1124,1154,1189,1256,1266,1343,1352,1357,1403,1430,1432,1529,1543,1567,1721,1726,1848,2032,2123,2176,2240,2444,2462,2527,2597,2634,2727,2768,2775,2777,2865,3022,3103,3156,3164,3200,3210,3238,3265,3270,3414,3442,3490,3493,3497,3501,3525,3756,3791,3814,3866,3895,3905,3926,3966,3979,4075,4080,4083,4160,4194,4417,4510,4867,5123,5224,5402)],12]="0"
grep2601=grep("0",datostfg2[,12])
table(datostfg2[grep2601,24])
grep2602=grep("Abo",datostfg2[,24])
datostfg2[grep2602,24]
datostfg2[grep2602,12]
datostfg2[grep2602,12]="1"
grep2603=grep("Aba",datostfg2[,24])
datostfg2[grep2603,24]
datostfg2[grep2603,12]
datostfg2[grep2603,12]="1"
grep2604=grep("Ca.",datostfg2[,24])
datostfg2[grep2604,24]
datostfg2[grep2604,12]
datostfg2[grep2604,12]="1"
grep2605=grep("preguntado",datostfg2[,24])
datostfg2[grep2605,24]
datostfg2[grep2605,12]
grep2606=grep("ca.",datostfg2[,24])
datostfg2[grep2606,24]
datostfg2[grep2606,12]
datostfg2[grep2606,12]="1"
grep2601=grep("0",datostfg2[,12])
table(datostfg2[grep2601,24])
table(datostfg2[,12])

datostfg2[c(2676,3877,5871,5919,6123),24]=NA
datostfg2[c(2676,3877,5871,5919,6123),12]="0"


```

```{r,include=TRUE}
####Variable 25 (Hipertension_Multi)
####Variable categórica
table(datostfg2[,25]) #####Ninguna categoria se repite,en principio no tocar nada
datostfg2[706,25]=datostfg[706,24]
table(datostfg2[,25])
datostfg2[c(2676,3877,5871,5919,6123),25]

```

```{r,include=TRUE}
####Variable 26 (Dislipemia_txt)

####Si el paciente tiene antecedentes familiares de dislipemia la variable numérica debe presentar un 1,en caso contrario presentará un 0.

###Observamos que hay deportistas en tratamiento que no tienen el 1 asignado en la columna 15(dislipemia), esto se debe a  el tratamiento o al ejercicio.
####Aqui voy a crear una variable con un  1 si el deportista está en tratamiento(incluye la dieta) ,un 0 si no lo está y un 2 si no precisa de tratamiento porque lo controla con la practica deportiva y con nada más.

datostfg2[1:1000,26]
datostfg2[10984:11984,26]
grep681=grep("trat",datostfg2[,26])
datostfg2[grep681,26]
grep681_NoTrat=grep681[c(3,9,10,15)]
grep681_Ejer=grep681[c(20)]
grep681_Trat=grep681[-c(3,9,10,15,20)]
grep682=grep("Trat",datostfg2[,26])
datostfg2[grep682,26]
grep683=grep("TRAT",datostfg2[,26])
grep683=grep("TTO",datostfg2[,26])
grep683=grep("Tto",datostfg2[,26])
grep683=grep("tto",datostfg2[,26])
datostfg2[grep683,26]
grep683_NoTrat=grep683[c(9,16,19,20,43,58,63,102,104,114,118,128)]
grep683_Trat=grep683[-c(9,16,19,20,43,58,63,102,104,114,118,128)]
grep684=grep("MEDI ",datostfg2[,26])
grep684=grep("medi",datostfg2[,26])
datostfg2[grep684,26]
grep684_No=grep684
grep685=grep("Medi",datostfg2[,26])



grep685=grep("^no",datostfg2[,26])
datostfg2[grep685,26] ###Hay que quitar los no sabe o no precisa
grep685=grep685[-c(3,4,7,8,9,10,11,39,47,59,60,63,89,90,97,101,107,112,198,201,203,204,210)]
grep686=grep("^No",datostfg2[,26])
datostfg2[grep686,26]
grep686=grep686[-c(15)] ###Quitamos el "No se acuerda"
grep687=grep("^NO",datostfg2[,26])
datostfg2[grep687,26]
grep758=grep("NR",datostfg2[,26])
grep758=grep("N.R",datostfg2[,26])


grep688=grep("Controlad",datostfg2[,26])
datostfg2[grep688,26] 
grep689=grep("controlad",datostfg2[,26])
grep690=grep("CONTROLAD",datostfg2[,26])
###No lo seleccionamos
grep689=grep("deporte",datostfg2[,26])
grep689=grep("actividad",datostfg2[,26])
grep1051=grep("dieta",datostfg2[,26])
datostfg2[grep1051,26] 
grep1052=grep("Dieta",datostfg2[,26])
datostfg2[grep1052,26] 
grep1053=grep("DIETA",datostfg2[,26])
grep1054=grep("danacol",datostfg2[,26])
grep1055=grep("Danacol",datostfg2[,26])
datostfg2[grep1055,26] 
grep1056=grep("DANACOL",datostfg2[,26])


datostfg2[,178]=c(rep(NA,11984))

datostfg2[,178]=replace(datostfg2[,178],grep681_NoTrat,"0")
datostfg2[,178]=replace(datostfg2[,178],grep683_NoTrat,"0")
datostfg2[,178]=replace(datostfg2[,178],grep684,"0")
datostfg2[,178]=replace(datostfg2[,178],grep685,"0")
datostfg2[,178]=replace(datostfg2[,178],grep686,"0")
datostfg2[,178]=replace(datostfg2[,178],grep687,"0")
datostfg2[,178]=replace(datostfg2[,178],grep681_Trat,"1")
datostfg2[,178]=replace(datostfg2[,178],grep682,"1")
datostfg2[,178]=replace(datostfg2[,178],grep683_Trat,"1")
datostfg2[,178]=replace(datostfg2[,178],grep688,"1")
datostfg2[,178]=replace(datostfg2[,178],grep681_Ejer,"2")
datostfg2[,178]=replace(datostfg2[,178],grep1051,"1")
datostfg2[,178]=replace(datostfg2[,178],grep1052,"1")
datostfg2[,178]=replace(datostfg2[,178],grep1055,"1")



####Todos aquellos en los que se especifica que tienen tratamiento o que no lo tienen es porque tienen dislipemia.

datostfg2[grep681_NoTrat,15] ###Hay casos que no presentan un 1
datostfg2[grep683_NoTrat,15] ###Hay casos que no presentan un 1
datostfg2[grep684,15]        ###Hay casos que no presentan un 1
datostfg2[grep681_Trat,15]   ###Hay casos que no presentan un 1
datostfg2[grep682,15]
datostfg2[grep683_Trat,15]  ###Hay casos que no presentan un 1 
datostfg2[grep688,15]
datostfg2[grep681_Ejer,15]
datostfg2[grep1051,15]      ###Hay casos que no presentan un 1
datostfg2[grep1052,15]
datostfg2[grep1055,15]

datostfg2[,15]=replace(datostfg2[,15],grep685,"0")
datostfg2[,15]=replace(datostfg2[,15],grep686,"0")
datostfg2[,15]=replace(datostfg2[,15],grep687,"0")
datostfg2[,15]=replace(datostfg2[,15],grep681_NoTrat,"1")
datostfg2[,15]=replace(datostfg2[,15],grep683_NoTrat,"1")
datostfg2[,15]=replace(datostfg2[,15],grep684,"1")
datostfg2[,15]=replace(datostfg2[,15],grep681_Trat,"1")
datostfg2[,15]=replace(datostfg2[,15],grep683_Trat,"1")
datostfg2[,15]=replace(datostfg2[,15],grep1051,"1")

datostfg2[706,26]=datostfg[706,25]

grep1Dislipemia=grep("1",datostfg2[,15])
datostfg2[grep1Dislipemia,26] ###Hay NA's 


####Bucle


for (i in 1:11984){comp=(
  is.na(datostfg2[i,26])==TRUE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,15]="0"
}else{
        datostfg2[i,15]=datostfg2[i,15]
}}
####Revisar los 1's
grep1Dislipemia=grep("1",datostfg2[,15])
datostfg2[grep1Dislipemia,26] 

datostfg2[grep1Dislipemia[c(4)],26]

grep689=grep("Hiper",datostfg2[,26])
datostfg2[grep689,26]
grep690=grep("hiper",datostfg2[,26]) 
datostfg2[grep690,26]
grep691=grep("HIPER",datostfg2[,26])
datostfg2[grep691,26] 
grep692=grep("Obes",datostfg2[,26])
datostfg2[grep692,26]
grep693=grep("obes",datostfg2[,26])
datostfg2[grep693,26]
grep694=grep("OBES",datostfg2[,26])
grep695=grep("Colest",datostfg2[,26])
datostfg2[grep695,26]
grep696=grep("colest",datostfg2[,26]) 
datostfg2[grep696,26]
grep697=grep("COLEST",datostfg2[,26])
datostfg2[grep697,26] 
grep698=grep("Hiperu",datostfg2[,26])
datostfg2[grep698,26]
grep699=grep("HIPERU",datostfg2[,26]) 
grep699=grep("hiperu",datostfg2[,26])
datostfg2[grep699,26] 
grep700=grep("Herencia",datostfg2[,26])
datostfg2[grep700,26]
grep701=grep("HERENCIA",datostfg2[,26]) 
grep701=grep("herencia",datostfg2[,26])
grep701=grep("Sobrepeso",datostfg2[,26])
datostfg2[grep701,26]
grep702=grep("sobrepeso",datostfg2[,26]) 
datostfg2[grep702,26]
grep703=grep("SOBREPESO",datostfg2[,26])
grep703=grep("Familiar",datostfg2[,26])
grep703=grep("familiar",datostfg2[,26]) 
datostfg2[grep703,26]
grep704=grep("FAMILIAR",datostfg2[,26])
datostfg2[grep704,26] 
grep1053=grep("Dislipemia",datostfg2[,26])
datostfg2[grep1053,26] 
grep1054=grep("dislipemia",datostfg2[,26])
datostfg2[grep1054,26] 
grep1056=grep("dislipemia",datostfg2[,26])
datostfg2[grep1056,26] ###Igual que en grep1054
datostfg2[,178]=replace(datostfg2[,178],grep1054,"1")
grep1057=grep("ocasiones",datostfg2[,26])
datostfg2[grep1057,26]


####Veamos si en algun caso solo aparece el familiar,sin especificar la enfermedad.

grep705=grep("Padre",datostfg2[,26])
datostfg2[grep705,26]
grep706=grep("padre",datostfg2[,26])
datostfg2[grep706,26]
grep707=grep("PADRE",datostfg2[,26])
datostfg2[grep707,26]
grep708=grep("MADRE",datostfg2[,26])
datostfg2[grep708,26]
grep709=grep("Madre",datostfg2[,26])
datostfg2[grep709,26]
grep710=grep("madre",datostfg2[,26])
datostfg2[grep710,26]
grep711=grep("Herman",datostfg2[,26])
datostfg2[grep711,26]
grep712=grep("HERMAN",datostfg2[,26])
datostfg2[grep712,26]
grep713=grep("herman",datostfg2[,26])
datostfg2[grep713,26]
grep714=grep("Abuel",datostfg2[,26])
datostfg2[grep714,26]
grep715=grep("ABUEL",datostfg2[,26])
datostfg2[grep715,26]
grep716=grep("abuel",datostfg2[,26])
datostfg2[grep716,26]
grep717=grep("TI",datostfg2[,26])
grep707=grep("^ti",datostfg2[,26])
datostfg2[grep707,26]
grep708=grep("^Ti",datostfg2[,26])
datostfg2[grep708,26]
grep712=grep("Hijo",datostfg2[,26])
datostfg2[grep712,26]
grep715=grep("HIJO",datostfg2[,26])
grep715=grep("hijo",datostfg2[,26])
grep715=grep("Prim",datostfg2[,26])
datostfg2[grep715,26]
grep717=grep("PRIM",datostfg2[,26])
grep717=grep("prim",datostfg2[,26])
grep717=grep("Sobrin",datostfg2[,26])
datostfg2[grep717,26]
grep717=grep("SOBRINO",datostfg2[,26])
grep717=grep("sobrino",datostfg2[,26])
grep717=grep("Bisab",datostfg2[,26])
grep717=grep("BISAB",datostfg2[,26])
grep717=grep("bisab",datostfg2[,26])

datostfg2[,15]=replace(datostfg2[,15],grep689,"1")
datostfg2[,15]=replace(datostfg2[,15],grep690,"1")
datostfg2[,15]=replace(datostfg2[,15],grep691,"1")
datostfg2[,15]=replace(datostfg2[,15],grep692,"1")
datostfg2[,15]=replace(datostfg2[,15],grep693,"1")
datostfg2[,15]=replace(datostfg2[,15],grep694,"1")
datostfg2[,15]=replace(datostfg2[,15],grep695,"1")
datostfg2[,15]=replace(datostfg2[,15],grep696,"1")
datostfg2[,15]=replace(datostfg2[,15],grep697,"1")
datostfg2[,15]=replace(datostfg2[,15],grep698,"1")
datostfg2[,15]=replace(datostfg2[,15],grep699,"1")
datostfg2[,15]=replace(datostfg2[,15],grep700,"1")
datostfg2[,15]=replace(datostfg2[,15],grep701,"1")
datostfg2[,15]=replace(datostfg2[,15],grep702,"1")
datostfg2[,15]=replace(datostfg2[,15],grep703,"1")
datostfg2[,15]=replace(datostfg2[,15],grep704,"1")
datostfg2[,15]=replace(datostfg2[,15],grep705,"1")
datostfg2[,15]=replace(datostfg2[,15],grep706,"1")
datostfg2[,15]=replace(datostfg2[,15],grep707,"1")
datostfg2[,15]=replace(datostfg2[,15],grep708,"1")
datostfg2[,15]=replace(datostfg2[,15],grep709,"1")
datostfg2[,15]=replace(datostfg2[,15],grep710,"1")
datostfg2[,15]=replace(datostfg2[,15],grep711,"1")
datostfg2[,15]=replace(datostfg2[,15],grep712,"1")
datostfg2[,15]=replace(datostfg2[,15],grep713,"1")
datostfg2[,15]=replace(datostfg2[,15],grep714,"1")
datostfg2[,15]=replace(datostfg2[,15],grep715,"1")
datostfg2[,15]=replace(datostfg2[,15],grep716,"1")
datostfg2[,15]=replace(datostfg2[,15],grep1053,"1")
datostfg2[,15]=replace(datostfg2[,15],grep1054,"1")
datostfg2[,15]=replace(datostfg2[,15],grep1057,"1")




colnames(datostfg2)[178]="TratDisli"


####Vamos a revisar si hay información relevante en las variables 16,17 y 18.

###Revisamos la variable 16
grep1058=grep("Hipercol",datostfg2[,16])
datostfg2[grep1058,16]
grep1059=grep("hipercol",datostfg2[,16])
datostfg2[grep1059,16]
grep1060=grep("HIPERCOL",datostfg2[,16]) 
datostfg2[grep1060,16]
grep1064=grep("Colest",datostfg2[,16])
datostfg2[grep1064,16]
grep1065=grep("colest",datostfg2[,16]) 
datostfg2[grep1065,16]
grep1066=grep("COLEST",datostfg2[,16])
datostfg2[grep1066,16] 
grep1064=grep("Hiperu",datostfg2[,16])
datostfg2[grep1064,16]
grep1067=grep("HIPERU",datostfg2[,16]) 
datostfg2[grep1067,16]
grep1068=grep("hiperu",datostfg2[,16])
datostfg2[grep1068,16] 
grep1071=grep("Dislipemia",datostfg2[,16])
datostfg2[grep1071,16] 
datostfg2[grep1071[c(1,4,10,11,30,32,37,46,49,64,65,66,69,74,78,87,93,94,104,106,113,120,127,130,138,139,142,147,149,150,158,161,164,167,170)],16]
grep1071=grep1071[c(1,4,10,11,30,32,37,46,49,64,65,66,69,74,78,87,93,94,104,106,113,120,127,130,138,139,142,147,149,150,158,161,164,167,170)]
grep1072=grep("dislipemia",datostfg2[,16])
datostfg2[grep1072,16] 
grep1073=grep("DISLIPEMIA",datostfg2[,16])
datostfg2[grep1073,16] 
grep1074=grep("Hipertrigli",datostfg2[,16])
datostfg2[grep1074,16]
grep1075=grep("hipertrigli",datostfg2[,16])
datostfg2[grep1075,16]
grep1076=grep("HIPERTRIGLI",datostfg2[,16]) 
grep1077=grep("TGC",datostfg2[,16])

datostfg2[,15]=replace(datostfg2[,15],grep1058,"1")
datostfg2[,15]=replace(datostfg2[,15],grep1059,"1")
datostfg2[,15]=replace(datostfg2[,15],grep1060,"1")
datostfg2[,15]=replace(datostfg2[,15],grep1064,"1")
datostfg2[,15]=replace(datostfg2[,15],grep1065,"1")
datostfg2[,15]=replace(datostfg2[,15],grep1066,"1")
datostfg2[,15]=replace(datostfg2[,15],grep1067,"1")
datostfg2[,15]=replace(datostfg2[,15],grep1068,"1")
datostfg2[,15]=replace(datostfg2[,15],grep1071,"1")
datostfg2[,15]=replace(datostfg2[,15],grep1072,"1")
datostfg2[,15]=replace(datostfg2[,15],grep1073,"1")
datostfg2[,15]=replace(datostfg2[,15],grep1074,"1")
datostfg2[,15]=replace(datostfg2[,15],grep1075,"1")
datostfg2[,15]=replace(datostfg2[,15],grep1076,"1")
datostfg2[,15]=replace(datostfg2[,15],grep1077,"1")

####Revisamos la variable 17
grep1078=grep("Hipercol",datostfg2[,17])
grep1078=grep("hipercol",datostfg2[,17])
datostfg2[grep1078,17]
grep1079=grep("HIPERCOL",datostfg2[,17]) 
grep1079=grep("Obes",datostfg2[,17])
grep1080=grep("OBES",datostfg2[,17])
grep1080=grep("Colest",datostfg2[,17])
grep1080=grep("colest",datostfg2[,17]) 
datostfg2[grep1080,17]
grep1081=grep("COLEST",datostfg2[,17])
grep1081=grep("Hiperu",datostfg2[,17])
grep1081=grep("HIPERU",datostfg2[,17]) 
grep1081=grep("hiperu",datostfg2[,17])
grep1081=grep("Herencia",datostfg2[,17])
grep1081=grep("HERENCIA",datostfg2[,17]) 
grep1081=grep("herencia",datostfg2[,17])
grep1081=grep("Sobrepeso",datostfg2[,17])
grep1081=grep("sobrepeso",datostfg2[,17]) 
grep1081=grep("SOBREPESO",datostfg2[,17])
grep1081=grep("Dislipemia",datostfg2[,17])
grep1081=grep("dislipemia",datostfg2[,17])
datostfg2[grep1081,17] 
grep1082=grep("DISLIPEMIA",datostfg2[,17])
grep1082=grep("Hipertrigli",datostfg2[,17])
grep1082=grep("hipertrigli",datostfg2[,17])
grep1082=grep("HIPERTRIGLI",datostfg2[,17]) 
grep1082=grep("TGC",datostfg2[,17])
datostfg2[,15]=replace(datostfg2[,15],grep1078,"1")
datostfg2[,15]=replace(datostfg2[,15],grep1079,"1")
datostfg2[,15]=replace(datostfg2[,15],grep1080,"1")
datostfg2[,15]=replace(datostfg2[,15],grep1081,"1")
datostfg2[,15]=replace(datostfg2[,15],grep1082,"1")

####Revisamos la variable 18
grep1082=grep("Hipercol",datostfg2[,18])
grep1082=grep("hipercol",datostfg2[,18])
grep1082=grep("HIPERCOL",datostfg2[,18]) 
grep1082=grep("Obes",datostfg2[,18])
datostfg2[grep1082,18]
grep1083=grep("obes",datostfg2[,18])
datostfg2[grep1083,18]
grep1084=grep("OBES",datostfg2[,18])
grep1084=grep("Colest",datostfg2[,18])
grep1085=grep("colest",datostfg2[,18]) 
datostfg2[grep1085,18]
grep1086=grep("COLEST",datostfg2[,18])
grep1086=grep("Hiperu",datostfg2[,18])
grep1086=grep("HIPERU",datostfg2[,18]) 
grep1086=grep("hiperu",datostfg2[,18])
grep1086=grep("Herencia",datostfg2[,18])
grep1086=grep("HERENCIA",datostfg2[,18]) 
grep1086=grep("herencia",datostfg2[,18])
grep1086=grep("Sobrepeso",datostfg2[,18])
grep1086=grep("sobrepeso",datostfg2[,18]) 
grep1086=grep("SOBREPESO",datostfg2[,18])
grep1086=grep("Dislipemia",datostfg2[,18])
grep1086=grep("dislipemia",datostfg2[,18])
datostfg2[grep1086,18] 
grep1087=grep("DISLIPEMIA",datostfg2[,18])
grep1087=grep("Hipertrigli",datostfg2[,18])
grep1087=grep("hipertrigli",datostfg2[,18])
grep1087=grep("HIPERTRIGLI",datostfg2[,18]) 
grep1087=grep("TGC",datostfg2[,18])
datostfg2[,15]=replace(datostfg2[,15],grep1085,"1")
datostfg2[,15]=replace(datostfg2[,15],grep1086,"1")

datostfg2[c(2676,3877,5871,5919,6123),26]
datostfg2[c(2676,3877,5871,5919,6123),15]="0"
```


```{r,include=TRUE}
####Variable 27 (Dislipemia_Multi)
###Variable categórica

table(datostfg2[,27]) #####Ninguna categoria se repite,en principio no tocar nada
datostfg2[706,27]=datostfg[706,26]
table(datostfg2[,27])

for (i in 1:11984){comp=(
  is.na(datostfg2[i,27])==FALSE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,15]="1"
}else{
        datostfg2[i,15]=datostfg2[i,15]
}}

datostfg2[c(2676,3877,5871,5919,6123),27]
datostfg2[c(2676,3877,5871,5919,6123),15]="1"
```

```{r,include=TRUE}
####Variable 28 (Sin interes 28)
table(datostfg2[,28]) 
datostfg2[706,28]=datostfg[706,27]
table(datostfg2[,28])
```

```{r,include=TRUE}
####Variable 30(Hábitos) y 37(txt_otroshab)
table(datostfg2[,30]) 
datostfg2[706,37]=datostfg[706,36]
datostfg2[706,30]=datostfg[706,29]

 ###Seleccionamos aquellos casos en la variable Hábitos que tengan un 1 asignado,es decir,los éxitos.Al igual que en la variable anterior hay fallos.
grep1Habitos=grep("1",datostfg2[,30])
datostfg2[grep1Habitos,37]
grep1088=grep("^No",datostfg2[,37])
datostfg2[grep1088,37]
grep1088_Habitos=grep1088[c(1,2,5,8,11,12,13,14,15,16,21,23,24,25,26,27,28,29,31,31,32,33,34,35,36,39,44,45,46,47,50,56,60,64,79,81,84,90,91,92,113,120,127,153,172,173,181,184,194,198,200,202,203,204,205,207,209,211,212,214,219,221,222,224,289,321,322,357,385,392,396,403,415,421,423,426,427,428,429,430,437,450,455,471,561,568,577,584,598,656,662,681,685,732,734,738,742,745,747,757,771,781,843,226,228,229,231,233,235,237,238,241,244,245,247,250,254,257,259,261,263,266,268,271,272,273,274,276,277,278,280,281,282,284,287,288,291,300,302,303,304,305,306,308,310,312,314,317,318,319,320,323,324,325,326,327,328,329,330,331,332,333,334,335,336,338,339,340,341,342,343,344,345,346,348,350,353,355,358,361,364,365,366,368,370,371,377,378,379,380,401,404,407,412,432,434,436,438,439,442,445,446,447,448,449,451,452,453,454,458,459,460,461,462,464,468474,475,478,481,486,489,490,492,494,497,499,504,505,506,509,510,514,519,520,523,525,527,533,534,538,539,541,543,545,549,552,553,559,565,566,569,571,572,573,574,580,585,586,588,590,592,597,599,602,605,607,610,612,616,618,620,623,625,626,627,628,629,630,632,633,634,635,636,637,638,641,644,645,648,649,651,652,657,658,659,661,663,666,669,670,675,677,680,683,684,687,691,694,698,699,701,702,703,707,708,709,715,718,719,720,722,726,739,766,774,777,784,789,791,799,802,876,886,887)] ####Casos que no hay que eliminar.

grep1088_NoHabitos=grep1088[-c(1,2,5,8,11,12,13,14,15,16,21,23,24,25,26,27,28,29,31,31,32,33,34,35,36,39,44,45,46,47,50,56,60,64,79,81,84,90,91,92,113,120,127,153,172,173,181,184,194,198,200,202,203,204,205,207,209,211,212,214,219,221,222,224,289,321,322,357,385,392,396,403,415,421,423,426,427,428,429,430,437,450,455,471,561,568,577,584,598,656,662,681,685,732,734,738,742,745,747,757,771,781,843,226,228,229,231,233,235,237,238,241,244,245,247,250,254,257,259,261,263,266,268,271,272,273,274,276,277,278,280,281,282,284,287,288,291,300,302,303,304,305,306,308,310,312,314,317,318,319,320,323,324,325,326,327,328,329,330,331,332,333,334,335,336,338,339,340,341,342,343,344,345,346,348,350,353,355,358,361,364,365,366,368,370,371,377,378,379,380,401,404,407,412,432,434,436,438,439,442,445,446,447,448,449,451,452,453,454,458,459,460,461,462,464,468474,475,478,481,486,489,490,492,494,497,499,504,505,506,509,510,514,519,520,523,525,527,533,534,538,539,541,543,545,549,552,553,559,565,566,569,571,572,573,574,580,585,586,588,590,592,597,599,602,605,607,610,612,616,618,620,623,625,626,627,628,629,630,632,633,634,635,636,637,638,641,644,645,648,649,651,652,657,658,659,661,663,666,669,670,675,677,680,683,684,687,691,694,698,699,701,702,703,707,708,709,715,718,719,720,722,726,739,766,774,777,784,789,791,799,802,876,886,887)] ####Casos que no hay que eliminar.

datostfg2[grep1088_NoHabitos,30] ###Todo debe ser 0



grepEstudiar=grep1088[c(45,50,415,561,202,203,204,205,207,209,211,212,214,219,221,222,224,226,228,229,231,233,235,237,238,241,244,245,247,250,254,257,259,261,263,266,268,271,272,273,274,276,277,278,280,281,282,284,287,288,291,300,302,303,304,305,306,308,310,312,314,317,318,319,320,323,324,325,326,327,328,329,330,331,332,333,334,335,336,338,339,340,341,342,343,344,345,346,348,350,353,355,358,361,364,365,366,368,370,371,377,378,379,380,401,404,407,412,432,434,436,438,439,442,445,446,447,448,449,451,452,453,454,458,459,460,461,462,464,468474,475,478,481,486,489,490,492,494,497,499,504,505,506,509,510,514,519,520,523,525,527,533,534,538,539,541,543,545,549,552,553,559,565,566,569,571,572,573,574,580,585,586,588,590,592,597,599,602,605,607,610,612,616,618,620,623,625,626,627,628,629,630,632,633,634,635,636,637,638,641,644,645,648,649,651,652,657,658,659,661,663,666,669,670,675,677,680,683,684,687,691,694,698,699,701,702,703,707,708,709,715,718,719,720,722,726,739,766,774,777,784,789,791,799,802,876,886,887)]

datostfg2[grepEstudiar,37]
datostfg2[grepEstudiar[-c(1,2,3,4,55,62,130,165,245,246,247,248,242,243)],37] 
datostfg2[grepEstudiar[-c(1,2,3,4,55,62,130,165,245,246,247,248,242,243)],57] ###Casos en los que en paciente es no fumador,por lo tanto debe presentar 0 en la variable 57.Hay algunos 1,vamos a corregir esto.
grepsinfumar=grepEstudiar[-c(1,2,3,4,55,62,130,165,245,246,247,248,242,243)]
datostfg2[grepsinfumar,57] ###Hay 1's en las componentes 213,221,224,226,227,228,229,231,233,234
datostfg2[grepsinfumar[c(213,221,224,226,227,228,229,231,233,234)],37] ###Efectivamente,se trata de fallos

###datostfg2[grepEstudiar[-c(4,55,62,130,165,170,245,246,247,248)],57]="0"
###datostfg2[grepEstudiar[c(4,55,62,130,165,170,245,246,247,248)],37] 
###datostfg2[grepEstudiar[c(4,165,170,245,246,247,248)],37]###No tienen hábitos tóxicos
###datostfg2[grepEstudiar[c(4,165,170,245,246,247,248)],57] ####Deben ser todos 0
###datostfg2[grepEstudiar[c(4,165,170,245,246,247,248)],57]="0"
###datostfg2[grepEstudiar[c(1,2,3,195,242,243)],37] ###Exfumadores
###datostfg2[grepEstudiar[c(1,2,3,195,242,243)],57] ####Ya presentan un 1,no hay que cambiar nada

#####Estudiemos ahora el consumo de alcohol
datostfg2[grepEstudiar,37] ####Consumo de alcohol original
####5,6,7,8,9,11,12,16,18,19,21,23,24,25,27,28,29,31,32,36,37,38,40,42,43,45,46,47,48,49,50,51,52,54,57,58,59,60,61,63,64,65,66,67,68,69,76,77,78,80,83,84,87,89,90,94,96,97,99,100,102,103,104,105,106,107,108,110,111,112,113,114,115,116,117,118,119,120,122,123,124,127,128,132,133,134,136,137,138,139,140,143,144,145,150,151,153,154,156,157,166,171,172,173,176,177,178,179,181,182,184,185,186,189,190,193,195,196,199,203,204,205,206,207,209,211,212,215,216,218,219.221.222.223.224.227.228,229,231,232,236,237,240,241

# datostfg2[grepEstudiar[c(5,6,7,8,9,11,12,16,18,19,21,23,24,25,27,28,29,31,32,36,37,38,40,42,43,45,46,47,48,49,50,51,52,54,57,58,59,60,61,63,64,65,66,67,68,69,76,77,78,80,83,84,87,89,90,94,96,97,99,100,102,103,104,105,106,107,108,110,111,112,113,114,115,116,117,118,119,120,122,123,124,127,128,132,133,134,136,137,138,139,140,143,144,145,150,151,153,154,156,157,166,171,172,173,176,177,178,179,181,182,184,185,186,189,190,193,195,196,199,203,204,205,206,207,209,211,212,215,216,218,219.221,222,223,224,227,228,229,231,232,236,237,240,241)],60]####Todos deben ser 1
# 
# datostfg2[grepEstudiar[c(5,6,7,8,9,11,12,16,18,19,21,23,24,25,27,28,29,31,32,36,37,38,40,42,43,45,46,47,48,49,50,51,52,54,57,58,59,60,61,63,64,65,66,67,68,69,76,77,78,80,83,84,87,89,90,94,96,97,99,100,102,103,104,105,106,107,108,110,111,112,113,114,115,116,117,118,119,120,122,123,124,127,128,132,133,134,136,137,138,139,140,143,144,145,150,151,153,154,156,157,166,171,172,173,176,177,178,179,181,182,184,185,186,189,190,193,195,196,199,203,204,205,206,207,209,211,212,215,216,218,219.221,222,223,224,227,228,229,231,232,236,237,240,241)],60]="1"


datostfg2[grepEstudiar[c(33,34,53,86)],37]
datostfg2[grepEstudiar[c(33,34,53,86)],57]
grepestudiarsueno=grepEstudiar[-c(55,62,130)]

datostfg2[grepestudiarsueno,72] ####Faltan muchos registros,vamos a completarlo con la información disponible.Los pocos registros que tenemos son en muchos casos uno de los extremos del intervalo con el que se indican las horas de sueño,yo en caso de que aparezca un intervalo,tomo como horas de sueño el punto medio.
datostfg2[grepestudiarsueno,37]
grepestudiarsueno=grepestudiarsueno[-c(1,2,3,4,8,12,42,87,103,145,147,162,167,227,236,239,240,241,242,243,244,245)]
# datosperdidos=c(8,7.5,7.5,6.5,6,6,7,7.5,7,5.5,8,7,6,6,5.5,7,7.5,6,6,5.5,7.5,6.5,8,8,6.5,7,7.5,7.25,6.5,8,7.5,7,7.5,7,7.5,7.5,6,7,6,6,7,8,6.5,5.5,8,8,7,8,6.5,9.5,7,7,7,7,8,8,9,7,7,7.5,7,7,6.5,7,8,7.25,7.25,7,5.5,7.5,7.5,7.5,7.5,6.5,8,7.25,7.5,7.5,7.5,7.5,8.5,8,7,7,7.5,6.5,6.5,7.5,8,6,7,8,6,8,8.5,7,8,8,5.5,7.5,7.5,7,8,8,7.5,7.5,6,7,5.5,7.5,6.5,8,8,7.5,5,7,7,6.5,7.5,8.5,6,6.5,7,7,7.5,6.5,6,8,7.5,8,7.5,7,7.5,8,8,6.5,7,8,7,6.5,8,8.5,6.5,7,6.5,7,9,7.5,9,9,7.5,9,9,9,7,6.25,4.5,6.25,8,5.5,7.5,6,7,8.5,8,7.5,7,6.5,7,6.5,8,8,8,7.5,10,8,7,6.5,7,7,7.5,8,6.5,6.5,7,7,8,8.5,7,6.5,6,7.5,8,7,5.5,7,6.5,6.5,6,7,6,7,7.5,7.5,5.5,7.25,7.5,7,8,6,7.5,7,6.5,8,6,8,6.5,5.5,7,6,7.25,5.5,5.5)
# 
# for (i in 1:length(datosperdidos)){
#   datostfg2[grepestudiarsueno[c(i)],72]=datosperdidos[i]
# }
# 
# datostfg2[grepestudiarsueno,72]    ####Ya están introducidos los datos.
# datostfg2[grepestudiarsueno,70]="1"

####Veamos ahora los datos de descanso suplementario
datostfg2[grepEstudiar,37]
grepsindescansosuplementario=grepEstudiar[c(21,29,31,32,33,34,35,36,37,38,39,40,41,42,43,45,46,48,49,50,51,52,52,53,54,56,57,58,59,60,61,64,65,68,69,71,73,74,75,76,77,78,79,80,81,82,83,88,90,91,92,93,94,95,97,98,99,100,102,103,104,105,106,107,108,112,113,114,116,117,118,119,120,121,122,123,124,125,126,128,129,131,132,133,134,135,136,138,139,140,141,142,143,144,146,147,149,151,153,154,155,156,157,158,159,160,161,163,164,167,168,169,171,175,176,177,178,179,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,197,198,199,200,201,202,203,204,205,206,207,208,209,211,212,213,214,215,217,218,220,221,223,224,225,226,227,228,231,233,234,235,236,238)]
# datostfg2[grepsindescansosuplementario,71]="0"
# datostfg2[grepsindescansosuplementario,73]="0"
# grepcondescansosuplementario=grepEstudiar[c(6,7,9,12,15,27,44,47,63,66,67,70,72,84,85,86,89,96,109,110,111,115,127,137,145,152,162,166,172,173,174,180,196,210,216,219,222,229,240,241)]
# datostfg2[grepcondescansosuplementario,71]="1"
# datosperdidosdescanso=c(1,1,0.5,1,0.5,0.5,0.5,0.5,0.5,0.5,1,0.5,1,1,1,0.75,1,0.5,0.5,1,0.5,0.5,0.5,1,1,0.5,0.75,0.5,0.5,1,0.5,1,0.5,1,1,0.5,0.5,0.5,1,1)
# 
# for (i in 1:length(datosperdidosdescanso)){
#   datostfg2[grepcondescansosuplementario[c(i)],73]=datosperdidosdescanso[i]
# }
# datostfg2[grepcondescansosuplementario,73] ####Ya están introducidos los datos.

###Veamos ahora los casos que no refieren hábitos tóxicos
greptoxico=grep("t?xico",datostfg2[,37]) ###Sin hábitos tóxicos
datostfg2[greptoxico,37]
datostfg2[greptoxico,56]="0"

grepmenarquia=grep("menar",datostfg2[,37]) ###Sin menarquia
datostfg2[grepmenarquia,37]
datostfg2[grepmenarquia,87]="0"
grepMENARQUIA=grep("MENAR",datostfg2[,37])
grepMenarquia=grep("Menar",datostfg2[,37]) 
datostfg2[grepMenarquia,37]
###Introducimos la edad de la menarquia
datostfg2[grepMenarquia[c(2)],87]="11"
datostfg2[grepMenarquia[-c(2)],87]="12"
###Ciclos irregulares
datostfg2[grepMenarquia[c(2)],90]="1"
###Ciclos regulares
datostfg2[grepMenarquia[-c(2)],86]="1"
###Número de días que dura el ciclo
datostfg2[grepMenarquia[c(3,6,8,11)],88]="30"
datostfg2[grepMenarquia[c(5)],88]="28"
###Número de días de menstruación
datostfg2[grepMenarquia[c(2,8,11)],89]="4"
datostfg2[grepMenarquia[c(1)],89]="7"
datostfg2[grepMenarquia[c(3,6)],89]="6.5"
datostfg2[grepMenarquia[c(5)],89]="7.5"
datostfg2[grepMenarquia[c(9,10)],89]="5"
###Antecedentes.Ginecológicos
datostfg2[grepMenarquia[c(1,8,9,10,11)],91]="0"
datostfg2[grepMenarquia[c(1,8,9,10,11)],98]="No Dismenorrea"
datostfg2[grepMenarquia[c(2,3,5,6)],91]="1"
datostfg2[grepMenarquia[c(2,3,5,6)],98]="Dismenorrea"
####Anticonceptivos
datostfg2[grepMenarquia[c(1,9,10)],96]="ACO"

####
grepPulso=grep("Puls",datostfg2[,37])
datostfg2[grepPulso,37]
datostfg2[grepPulso,174]="Si"
greppulso=grep("puls",datostfg2[,37])
datostfg2[greppulso,37]
datostfg2[greppulso,174] ###Hay errores y contradicciones con lo anterior,aunque no tendremos en cuenta la variable en la que se registra si el paciente tiene o no pulsometro.


grep1089=grep("^no",datostfg2[,37])
datostfg2[grep1089,37]
grep1089_1=grep1089[-c(2)] ###Estudiar la última componente
grep1089_0=grep1089[c(2)] 
grep1090=grep("^NO",datostfg2[,37])
datostfg2[grep1090,37]
grep1090_0=grep1090[c(1)]
grep1091=grep("NR",datostfg2[,37])
datostfg2[grep1091,37] ###Estudiar
grep1092=grep("^N.R",datostfg2[,37])
grep1092=grep("^Ni",datostfg2[,37])
grep1092=grep("^NI",datostfg2[,37])
grep1092=grep("^ni",datostfg2[,37])
grep1092=grep("^SIN",datostfg2[,37])
grep1092=grep("^sin",datostfg2[,37])
datostfg2[grep1092,37] ###No considerar
grep1093=grep("^Sin",datostfg2[,37])
datostfg2[grep1093,37] ###No considerar

```

```{r,include=TRUE}
####Variable 31(Enfermedades) y 38(txt_enfermedades)
table(datostfg2[,31]) 
datostfg2[706,38]=datostfg[706,37]
datostfg2[706,31]=datostfg[706,30]


 ###Seleccionamos aquellos casos en la variable Enfermedades que tengan un 1 asignado,es decir,los éxitos.Al igual que en la variable anterior hay fallos.
grep1Enfermedad=grep("1",datostfg2[,31])
datostfg2[grep1Enfermedad,38]
grep1100=grep("^No",datostfg2[,38])
datostfg2[grep1100,38]
datostfg2[grep1100[1001:2000],38]
grep732=grep("^no",datostfg2[,38])
datostfg2[grep732,38]
grep733=grep("^NO",datostfg2[,38])
datostfg2[grep733,38]
grep731=grep("NR",datostfg2[,38])
datostfg2[grep731,38]
grep735=grep("^N.R",datostfg2[,38])
datostfg2[grep735,38]
grep736=grep("^Ni",datostfg2[,38])
grep736=grep("^NI",datostfg2[,38])
datostfg2[grep736,38] ###No considerar
datostfg2[grep736,31] ####Ya presenta un 1
grep736=grep("^ni",datostfg2[,38])
grep736=grep("^SIN",datostfg2[,38])
grep736=grep("^sin",datostfg2[,38])
datostfg2[grep736,38] ###No considerar
datostfg2[grep736,31] ###Ya presenta un 1
grep736=grep("^Sin",datostfg2[,38])
datostfg2[grep736,38]
datostfg2[grep736[-c(6)],31] ###Ya presentan 1's
grep736=grep736[c(6)] ###Sin interés


datostfg2[,31]=replace(datostfg2[,31],grep731,"0")
datostfg2[,31]=replace(datostfg2[,31],grep732,"0")
datostfg2[,31]=replace(datostfg2[,31],grep733,"0")
datostfg2[,31]=replace(datostfg2[,31],grep731,"0")
datostfg2[,31]=replace(datostfg2[,31],grep735,"0")
datostfg2[,31]=replace(datostfg2[,31],grep736,"0")


table(datostfg2[,31]) 

###Hay casos que presentan un 1 y después observamos "NA" en la variable de texto,estos casos hay que corregirlos también porque representan un 0 realmente.
#Bucle
for (i in 1:11984){comp=(
  is.na(datostfg2[i,38])==TRUE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,31]="0"
}else{
        datostfg2[i,31]=datostfg2[i,31]
}}


grep2343=grep("0",datostfg2[,31])
table(datostfg2[grep2343,38])     
####Variable muy difícil de corregir.


```

```{r,include=TRUE}
####Variable 32(Ausencia órgano par) y 39(txt_ausencia_organo)

####Si el paciente presenta la ausencia de algún órgano la variable numérica debe presentar un 1,en caso contrario presentará un 0.


table(datostfg2[,32]) 
 ###Seleccionamos aquellos casos en la variable Ausencia.órgano.par que tengan un 1 asignado,es decir,los éxitos,aquellos casos en los que haya ausencia de órganos.
grep1organo=grep("1",datostfg2[,32])
datostfg2[grep1organo,39]
datostfg2[grep1organo[1001:2000],39]
datostfg2[grep1organo[2001:2135],39]
####Hay incongruencias
####Tras consultar a los médicos,esto se debe a que para escribir en la variable txt debes marcar el éxito.Por ello, muchos médicos marcan el éxito(erroneamente) y despues escriben "No" en la variable txt o la dejan vacia.

#Vamos a corregir este fallo
grepfallos=grep1organo[-c(28,29,36,78,99,145,161,240,287,311,407,424,425,452,476,520,680,694,762,773,814,840,876,890,925,942,949,1004,1093,1176,1197,1227,1329,1370,1394,1477,1510,1569,1611,1794,1873,1877,2083,2046)]
datostfg2[grepfallos,39]
datostfg2[grepfallos[1000:2000],39]
datostfg2[grepfallos[2000:2091],39]
datostfg2[,32]=replace(datostfg2[,32],grepfallos,"0")
table(datostfg2[,32])
###Hemos arreglado los fallos presentes en la variable numérica ausencia.órgano.par
table(datostfg2[,32]) 

datostfg2[6272,52]=datostfg[6272,39]
datostfg2[6272,39]=NA
datostfg2[706,32]=datostfg[706,31]
datostfg2[706,39]=datostfg[706,38]
grep1organo=grep("1",datostfg2[,32])
datostfg2[grep1organo,39]
table(datostfg2[,32]) 
grep2910=grep("0",datostfg2[,32])
table(datostfg2[grep2910,39])
grep2911=grep("^Ampu",datostfg2[,39])
datostfg2[grep2911,39]
datostfg2[grep2911,32]
datostfg2[grep2911,32]="1"
grep2912=grep("ovario",datostfg2[,39])
datostfg2[grep2912,39]
datostfg2[grep2912,32]
datostfg2[grep2912,32]="1"
grep2910=grep("0",datostfg2[,32])
table(datostfg2[grep2910,39])

table(datostfg2[,32])
###Bucle
for (i in 1:11984){comp=(
  is.na(datostfg2[i,39])==TRUE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,32]="0"
}else{
        datostfg2[i,32]=datostfg2[i,32]
}}

for (i in 1:11984){comp=(is.na(datostfg2[i,32])==TRUE&&
  is.na(datostfg2[i,39])==FALSE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,32]="Revisar"
}else{
        datostfg2[i,32]=datostfg2[i,32]
}}

grep2904=grep("Revisar",datostfg2[,32])
datostfg2[grep2904,39]
datostfg2[grep2904,32]="0"

datostfg2[c(2676,3877,5871,5919,6123),39]
datostfg2[c(2676,3877,5871,5919,6123),32]="0"

```

```{r,include=TRUE}
####Variable 33(Hospitalizaciones) y 40(txt_hospitalizaciones)
####Si el paciente ha sido hospitalizado alguna vez la variable numérica debe presentar un 1,en caso contrario presentará un 0.


table(datostfg2[,33]) 
datostfg2[6272,53]=datostfg[6272,40]
datostfg2[706,40]=datostfg[706,39]
datostfg2[706,33]=datostfg[706,32]
datostfg2[7141,40]=datostfg[7141,39]
datostfg2[6272,40]=NA
datostfg2[7141,39]=NA

 ###Seleccionamos aquellos casos en la variable Hospitalizaciones que tengan un 1 asignado,es decir,los éxitos.Al igual que en la variable anterior hay fallos.
grep1Hospi=grep("1",datostfg2[,33])
datostfg2[grep1Hospi,40]
grep717=grep("^No",datostfg2[,40])
grep718=grep("^no",datostfg2[,40])
grep719=grep("^NO",datostfg2[,40])
grep720=grep("NR",datostfg2[,40])
datostfg2[grep720,40]
grep721=grep("^N.R",datostfg2[,40])
datostfg2[grep721,40]
grep722=grep("^Ni",datostfg2[,40])
datostfg2[grep722,40]
grep723=grep("^NI",datostfg2[,40])
grep723=grep("^ni",datostfg2[,40])
grep723=grep("^SIN",datostfg2[,40])
grep723=grep("^sin",datostfg2[,40])
grep723=grep("^Sin",datostfg2[,40])
datostfg2[grep723,40]
grep723=grep723[c(1)]

datostfg2[,33]=replace(datostfg2[,33],grep717,"0")
datostfg2[,33]=replace(datostfg2[,33],grep718,"0")
datostfg2[,33]=replace(datostfg2[,33],grep719,"0")
datostfg2[,33]=replace(datostfg2[,33],grep720,"0")
datostfg2[,33]=replace(datostfg2[,33],grep721,"0")
datostfg2[,33]=replace(datostfg2[,33],grep722,"0")
datostfg2[,33]=replace(datostfg2[,33],grep723,"0")


table(datostfg2[,33]) 
grep1Hospi=grep("1",datostfg2[,33])
datostfg2[grep1Hospi,40]

###Hay casos que presentan un 1 y después observamos "NA" en la variable de texto,estos casos hay que corregirlos también porque representan un 0 realmente.

#Bucle

for (i in 1:11984){comp=(
  is.na(datostfg2[i,40])==TRUE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,33]="0"
}else{
        datostfg2[i,33]=datostfg2[i,33]
}}
####Revisar los 1's
grep1Hospi=grep("1",datostfg2[,33])
datostfg2[grep1Hospi,40]
datostfg2[grep1Hospi[1001:2000],40]
datostfg2[grep1Hospi[2001:3000],40]
datostfg2[grep1Hospi[3001:3928],40]###Errores en 708,160,1814,1728,1714 y 1054
datostfg2[grep1Hospi[c(708,160,1814,1728,1714,1054)],40]
datostfg2[grep1Hospi[c(708,160,1814,1728,1714,1054)],33]="0"
table(datostfg2[,33]) 
grep2913=grep("0",datostfg2[,33])
table(datostfg2[grep2913,40])

grep2914=grep("^Por",datostfg2[,40])
datostfg2[grep2914,40]
datostfg2[grep2914,33]
datostfg2[grep2914,33]="1"
grep2914=grep("^por",datostfg2[,40])
datostfg2[grep2914,40]
datostfg2[grep2914,33]
datostfg2[grep2914,33]="1"
grep2914=grep("^T",datostfg2[,40])
datostfg2[grep2914,40]
datostfg2[grep2914,33]
datostfg2[grep2914,33]="1"
grep2914=grep("^SI",datostfg2[,40])
datostfg2[grep2914,40]
datostfg2[grep2914,33]
datostfg2[grep2914,33]="1"
grep2914=grep("^Si",datostfg2[,40])
datostfg2[grep2914,40]
datostfg2[grep2914,33]
datostfg2[grep2914,33]="1"
grep2914=grep("Cirug",datostfg2[,40])
datostfg2[grep2914,40]
datostfg2[grep2914,33]
datostfg2[grep2914,33]="1"
grep2914=grep("cirug",datostfg2[,40])
datostfg2[grep2914,40]
datostfg2[grep2914,33]
datostfg2[grep2914,33]="1"
grep2914=grep("hepatiti",datostfg2[,40])
datostfg2[grep2914,40]
datostfg2[grep2914,33]
datostfg2[grep2914,33]="1"
grep2914=grep("Neumo",datostfg2[,40])
datostfg2[grep2914,40]
datostfg2[grep2914,33]
datostfg2[grep2914,33]="1"
grep2914=grep("Infec",datostfg2[,40])
datostfg2[grep2914,40]
datostfg2[grep2914,33]
datostfg2[grep2914,33]="1"
grep2914=grep("IAM",datostfg2[,40])
datostfg2[grep2914,40]
datostfg2[grep2914,33]
datostfg2[grep2914,33]="1"
grep2914=grep("^Hospi",datostfg2[,40])
datostfg2[grep2914,40]
datostfg2[grep2914,33]
datostfg2[grep2914,33]="1"
grep2914=grep("^Hernia",datostfg2[,40])
datostfg2[grep2914,40]
datostfg2[grep2914,33]
datostfg2[grep2914,33]="1"
grep2914=grep("^Hace",datostfg2[,40])
datostfg2[grep2914,40]
datostfg2[grep2914,33]
datostfg2[grep2914,33]="1"
grep2914=grep("^Fistula",datostfg2[,40])
datostfg2[grep2914,40]
datostfg2[grep2914,33]
datostfg2[grep2914,33]="1"
grep2914=grep("^en",datostfg2[,40])
datostfg2[grep2914,40]
datostfg2[grep2914,33]
datostfg2[grep2914,33]="1"
grep2914=grep("^Dolor",datostfg2[,40])
datostfg2[grep2914,40]
datostfg2[grep2914,33]
datostfg2[grep2914,33]="1"
grep2914=grep("^Con",datostfg2[,40])
datostfg2[grep2914,40]
datostfg2[grep2914,33]
datostfg2[grep2914,33]="1"
grep2914=grep("^con",datostfg2[,40])
datostfg2[grep2914,40]
datostfg2[grep2914,33]
datostfg2[grep2914,33]="1"
grep2914=grep("^Astig",datostfg2[,40])
datostfg2[grep2914,40]
datostfg2[grep2914,33]
datostfg2[grep2914,33]="1"
grep2914=grep("^Acci",datostfg2[,40])
datostfg2[grep2914,40]
datostfg2[grep2914,33]
datostfg2[grep2914,33]="1"
grep2914=grep("^2",datostfg2[,40])
datostfg2[grep2914,40]
datostfg2[grep2914,33]
datostfg2[grep2914,33]="1"
grep2914=grep("^1",datostfg2[,40])
datostfg2[grep2914,40]
datostfg2[grep2914,33]
datostfg2[grep2914,33]="1"
grep2914=grep("^Implan",datostfg2[,40])
datostfg2[grep2914,40]
datostfg2[grep2914,33]
datostfg2[grep2914,33]="1"
grep2914=grep("^Ces",datostfg2[,40])
datostfg2[grep2914,40]
datostfg2[grep2914,33]
datostfg2[grep2914,33]="1"
grep2913=grep("0",datostfg2[,33])
table(datostfg2[grep2913,40])


for (i in 1:11984){comp=(is.na(datostfg2[i,33])==TRUE&&
  is.na(datostfg2[i,40])==FALSE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,33]="Revisar"
}else{
        datostfg2[i,33]=datostfg2[i,33]
}}

grep2904=grep("Revisar",datostfg2[,33])
datostfg2[grep2904,40]
datostfg2[grep2904[c(1)],33]="0"
datostfg2[grep2904[c(2)],33]="1"
table(datostfg2[,33])
####Ya hemos solucionado las incongruencias.

datostfg2[c(2676,3877,5871,5919,6123),40]
datostfg2[c(2676,3877,5871,5919,6123),33]="0"
```

```{r,include=TRUE}
####Variable 29(Alergias) y 36(txt_alergias)
####Si el paciente presenta alguna alergia la variable numérica debe presentar un 1,en caso contrario presentará un 0.


table(datostfg2[,29]) 
datostfg2[706,36]=datostfg[706,35]
datostfg2[706,29]=datostfg[706,28]


 ###Seleccionamos aquellos casos en la variable Alergías que tengan un 1 asignado,es decir,los éxitos.Al igual que en la variable anterior hay fallos.
grep1Alerg=grep("1",datostfg2[,29])
datostfg2[grep1Alerg,36]
grep724=grep("^No",datostfg2[,36])
grep725=grep("^no",datostfg2[,36])
grep726=grep("^NO",datostfg2[,36])
grep727=grep("NR",datostfg2[,36])
datostfg2[grep727,36]
grep728=grep("^N.R",datostfg2[,36])
grep728=grep("^Ni",datostfg2[,36])
datostfg2[grep728,36]
datostfg2[grep728[c(3,4)],36]
datostfg2[grep728[c(3,4)],29] ###Ya presentan 1's
grep728=grep728[c(1,2)]
grep729=grep("^NI",datostfg2[,36])
grep729=grep("^ni",datostfg2[,36])
grep729=grep("^SIN",datostfg2[,36])
grep729=grep("^sin",datostfg2[,36])
datostfg2[grep729,36]
datostfg2[grep729[c(6,7,9,10,11)],36]
datostfg2[grep729[c(6,7,9,10,11)],29] ####Ya presentan 1's
grep729=grep729[-c(6,7,9,10,11)]
grep730=grep("^Sin",datostfg2[,36])
datostfg2[grep730,36]
datostfg2[grep730[-c(4)],36]
datostfg2[grep730[-c(4)],29] ###Todos deben ser 1
datostfg2[grep730[-c(4)],29]="1"
grep730=grep730[c(4)]
grepNRA=grep("El deportista no refiere",datostfg2[,36])
datostfg2[grepNRA,36] ###Considerar 10,56,69,82,85,92,112,117,126,127,153,164,202 como un Si
datostfg2[grepNRA[c(10,56,69,82,85,92,112,117,126,127,153,164,202)],36]
datostfg2[grepNRA[c(10,56,69,82,85,92,112,117,126,127,153,164,202)],29]###Todos deben presentar un 1
datostfg2[grepNRA[c(10,56,69,82,85,92,112,117,126,127,153,164,202)],29]="1"
####Casos 47,48,109,112,164 refieren Hospitalizaciones por cirugía.
datostfg2[grepNRA[c(47,48,109,112,164)],36]
datostfg2[grepNRA[c(47,48,109,112,164)],33] ###Deben presentar 1's en la variable Hospitalizaciones
datostfg2[grepNRA[c(47,48,109,112,164)],33]="1"
datostfg2[grepNRA[c(47,48,109,112,164)],40]
datostfg2[grepNRA[c(47,112)],40]="Hospitalizado por cirugia"
datostfg2[grepNRA[c(47,48,109,112,164)],40]
grepNRA=grepNRA[-c(47,48,109,112,164,10,56,69,82,85,92,112,117,126,127,153,164,202)]
datostfg2[,29]=replace(datostfg2[,29],grep724,"0")
datostfg2[,29]=replace(datostfg2[,29],grep725,"0")
datostfg2[,29]=replace(datostfg2[,29],grep726,"0")
datostfg2[,29]=replace(datostfg2[,29],grep727,"0")
datostfg2[,29]=replace(datostfg2[,29],grep728,"0")
datostfg2[,29]=replace(datostfg2[,29],grep729,"0")
datostfg2[,29]=replace(datostfg2[,29],grep730,"0")
datostfg2[,29]=replace(datostfg2[,29],grepNRA,"0")

table(datostfg2[,29])

###Hay casos que presentan un 1 y después observamos "NA" en la variable de texto,estos casos hay que corregirlos también porque representan un 0 realmente.
###Bucle

for (i in 1:11984){comp=(
  is.na(datostfg2[i,36])==TRUE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,29]="0"
}else{
        datostfg2[i,29]=datostfg2[i,29]
}}
####Revisar los 1's
grep1Alerg=grep("1",datostfg2[,29])
datostfg2[grep1Alerg,36]
datostfg2[grep1Alerg[1001:2000],36]
datostfg2[grep1Alerg[2001:3000],36]
datostfg2[grep1Alerg[3001:4000],36]
datostfg2[grep1Alerg[4001:4015],36]
####Considerar 1393,1516,1636,2878,2818,2769,2564,2354,2200,2172,2097 como No
datostfg2[grep1Alerg[c(1393,1516,1636,2878,2818,2769,2564,2354,2200,2172,2097)],36]
datostfg2[grep1Alerg[c(1393,1516,1636,2878,2818,2769,2564,2354,2200,2172,2097)],29]="0"
###Hay que subtituir también los casos con NC,nc(No Conocidas)
grepNC=grep("NC",datostfg2[,36])
datostfg2[grepNC,36] ####Considerar 581,436,251,34 como un Si
datostfg2[grepNC[1001:2000],36] ####1559,1331,1317
datostfg2[grepNC[2001:2548],36] ###2317,2318,2191,2107
datostfg2[grepNC[c(581,436,251,34,1559,1331,1317,2317,2318,2191,2107)],36]
datostfg2[grepNC[c(581,436,251,34,1559,1331,1317,2317,2318,2191,2107)],29] ###Ya presentn 1's
grepNC=grepNC[-c(581,436,251,34,1559,1331,1317,2317,2318,2191,2107)]
grepnc=grep("^nc",datostfg2[,36])
datostfg2[grepnc,36]
datostfg2[,29]=replace(datostfg2[,29],grepNC,"0")
datostfg2[,29]=replace(datostfg2[,29],grepnc,"0")
table(datostfg2[,29]) ####2637 casos con Alergia
####Ya hemos solucionado las incongruencias.

grep2344=grep("0",datostfg2[,29])
table(datostfg2[grep2344,36]) ####Hay muchos fallos,vamos a considerar todos como 1 y después corregir.

###Bucle
for (i in 1:11984){comp=(
  is.na(datostfg2[i,36])==TRUE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,29]="0"
}else{
        datostfg2[i,29]="1"
}}
####Repetimos el proceso
grep724=grep("^No",datostfg2[,36])
grep725=grep("^no",datostfg2[,36])
grep726=grep("^NO",datostfg2[,36])
grep727=grep("NR",datostfg2[,36])
datostfg2[grep727,36]
grep728=grep("^N.R",datostfg2[,36])
grep728=grep("^Ni",datostfg2[,36])
datostfg2[grep728,36]
datostfg2[grep728[c(3,4)],36]
datostfg2[grep728[c(3,4)],29] ###Ya presentan 1's
grep728=grep728[c(1,2)]
grep729=grep("^NI",datostfg2[,36])
grep729=grep("^ni",datostfg2[,36])
grep729=grep("^SIN",datostfg2[,36])
grep729=grep("^sin",datostfg2[,36])
datostfg2[grep729,36]
datostfg2[grep729[c(6,7,9,10,11)],36]
datostfg2[grep729[c(6,7,9,10,11)],29] ####Ya presentan 1's
grep729=grep729[-c(6,7,9,10,11)]
grep730=grep("^Sin",datostfg2[,36])
datostfg2[grep730,36]
datostfg2[grep730[-c(4)],36]
datostfg2[grep730[-c(4)],29] ###Todos deben ser 1
datostfg2[grep730[-c(4)],29]="1"
grep730=grep730[c(4)]
grepNRA=grep("El deportista no refiere",datostfg2[,36])
datostfg2[grepNRA,36] ###Considerar 10,56,69,82,85,92,112,117,126,127,153,164,202 como un Si
datostfg2[grepNRA[c(10,56,69,82,85,92,112,117,126,127,153,164,202)],36]
datostfg2[grepNRA[c(10,56,69,82,85,92,112,117,126,127,153,164,202)],29]###Todos deben presentar un 1
datostfg2[grepNRA[c(10,56,69,82,85,92,112,117,126,127,153,164,202)],29]="1"
####Casos 47,48,109,112,164 refieren Hospitalizaciones por cirugía.
datostfg2[grepNRA[c(47,48,109,112,164)],36]
datostfg2[grepNRA[c(47,48,109,112,164)],33] ###Deben presentar 1's en la variable Hospitalizaciones
datostfg2[grepNRA[c(47,48,109,112,164)],33]="1"
datostfg2[grepNRA[c(47,48,109,112,164)],40]
datostfg2[grepNRA[c(47,112)],40]="Hospitalizado por cirugia"
datostfg2[grepNRA[c(47,48,109,112,164)],40]
grepNRA=grepNRA[-c(47,48,109,112,164,10,56,69,82,85,92,112,117,126,127,153,164,202)]
datostfg2[,29]=replace(datostfg2[,29],grep724,"0")
datostfg2[,29]=replace(datostfg2[,29],grep725,"0")
datostfg2[,29]=replace(datostfg2[,29],grep726,"0")
datostfg2[,29]=replace(datostfg2[,29],grep727,"0")
datostfg2[,29]=replace(datostfg2[,29],grep728,"0")
datostfg2[,29]=replace(datostfg2[,29],grep729,"0")
datostfg2[,29]=replace(datostfg2[,29],grep730,"0")
datostfg2[,29]=replace(datostfg2[,29],grepNRA,"0")
grepNC=grep("NC",datostfg2[,36])
datostfg2[grepNC,36] ####Considerar 581,436,251,34 como un Si
datostfg2[grepNC[1001:2000],36] ####1559,1331,1317
datostfg2[grepNC[2001:2548],36] ###2317,2318,2191,2107
datostfg2[grepNC[c(581,436,251,34,1559,1331,1317,2317,2318,2191,2107)],36]
datostfg2[grepNC[c(581,436,251,34,1559,1331,1317,2317,2318,2191,2107)],29] ###Ya presentn 1's
grepNC=grepNC[-c(581,436,251,34,1559,1331,1317,2317,2318,2191,2107)]
grepnc=grep("^nc",datostfg2[,36])
datostfg2[grepnc,36]
datostfg2[,29]=replace(datostfg2[,29],grepNC,"0")
datostfg2[,29]=replace(datostfg2[,29],grepnc,"0")

grep2344=grep("0",datostfg2[,29])
table(datostfg2[grep2344,36])
grep2345=grep("1",datostfg2[,29])
table(datostfg2[grep2345,36])
options(max.print =2384)
grep2345=grep("1",datostfg2[,29])
table(datostfg2[grep2345,36])

grep2346=grep("Olivo",datostfg2[,36])
datostfg2[grep2346,29]="1"
grep2347=grep("Ugmen",datostfg2[,36])
datostfg2[grep2347,29]="1"
grep2348=grep("Cloro",datostfg2[,36])
datostfg2[grep2348,29]="1"
grep2349=grep("Polen",datostfg2[,36])
datostfg2[grep2349,29]="1"
grep2350=grep("antihis",datostfg2[,36])
datostfg2[grep2350,29]="1"
grep2351=grep("insecto",datostfg2[,36])
datostfg2[grep2351,29]="1"
grep2352=grep("?caro",datostfg2[,36])
datostfg2[grep2352,29]="1"
grep2353=grep("gamba",datostfg2[,36])
datostfg2[grep2353,29]="1"
grep2354=grep("planta",datostfg2[,36])
datostfg2[grep2354,29]="1"
grep2355=grep("fructosa",datostfg2[,36])
datostfg2[grep2355,29]="1"
grep2356=grep("lactosa",datostfg2[,36])
datostfg2[grep2356,29]="1"
grep2357=grep("erup",datostfg2[,36])
datostfg2[grep2357,29]="1"
grep2358=grep("Buscap",datostfg2[,36])
datostfg2[grep2358,29]="1"
grep2359=grep("huevo",datostfg2[,36])
datostfg2[grep2359,29]="1"
grep2360=grep("Singulair",datostfg2[,36])
datostfg2[grep2360,29]="1"
grep2361=grep("polenes",datostfg2[,36])
datostfg2[grep2361,29]="1"
grep2362=grep("NOLOTI",datostfg2[,36])
datostfg2[grep2362,29]="1"
grep2363=grep("sol",datostfg2[,36])
datostfg2[grep2363,29]="1"
grep2364=grep("marisco",datostfg2[,36])
datostfg2[grep2364,29]="1"
grep2365=grep("asm?",datostfg2[,36])
datostfg2[grep2365,29]="1"
grep2366=grep("prueba",datostfg2[,36])
datostfg2[grep2366,36]
datostfg2[grep2366,29]="1"
grep2367=grep("testada",datostfg2[,36])
datostfg2[grep2367,36]
datostfg2[grep2367,29]="1"
grep2368=grep("diagnosticada",datostfg2[,36])
datostfg2[grep2368,36]
datostfg2[grep2368,29]="1"
grep2369=grep("estacional",datostfg2[,36])
datostfg2[grep2369,36]
datostfg2[grep2369,29]="1"
grep2370=grep("rinitis",datostfg2[,36])
datostfg2[grep2370,36]
datostfg2[grep2370,29]="1"
grep2371=grep("nasal",datostfg2[,36])
datostfg2[grep2371,36]
datostfg2[grep2371,29]="1"
grep2372=grep("levemente positivo",datostfg2[,36])
datostfg2[grep2372,36]
datostfg2[grep2372,29]="1"
grep2373=grep("sabe a",datostfg2[,36])
datostfg2[grep2373,36]
datostfg2[grep2373,29]="1"
grep2374=grep("primavera",datostfg2[,36])
datostfg2[grep2374,36]
datostfg2[grep2374,29]="1"
grep2375=grep("sabe de",datostfg2[,36])
datostfg2[grep2375,36]
datostfg2[grep2375,29]="1"
grep2376=grep("olivo",datostfg2[,36])
datostfg2[grep2376,36]
datostfg2[grep2376,29]="1"
grep2377=grep("Piel",datostfg2[,36])
datostfg2[grep2377,36]
datostfg2[grep2377,29]="1"
grep2378=grep("alergeno",datostfg2[,36])
datostfg2[grep2378,36]
datostfg2[grep2378,29]="1"
grep2379=grep("piensa",datostfg2[,36])
datostfg2[grep2379,36]
datostfg2[grep2379,29]="1"
grep2380=grep("filiada",datostfg2[,36])
datostfg2[grep2380,36]
datostfg[grep2380,29]
datostfg2[grep2380,29]="1"
grep2381=grep("especificidad",datostfg2[,36])
datostfg2[grep2381,36]
datostfg[grep2381,29]
datostfg2[grep2381,29]="1"
grep2382=grep("grano",datostfg2[,36])
datostfg2[grep2382,36]
datostfg[grep2382,29]
datostfg2[grep2382,29]="1"
grep2383=grep("determinada",datostfg2[,36])
datostfg2[grep2383,36]
datostfg[grep2383,29]
datostfg2[grep2383,29]="1"
grep2384=grep("^mo",datostfg2[,36])
datostfg2[grep2384,36]
datostfg2[grep2384,29]="0"
grep2385=grep("^N o",datostfg2[,36])
datostfg2[grep2385,36]
datostfg2[grep2385,29]="0"
grep2386=grep("^nO",datostfg2[,36])
datostfg2[grep2386,36]
datostfg2[grep2386,29]="0"
grep2387=grep("^N0",datostfg2[,36])
datostfg2[grep2387,36]
datostfg2[grep2387,29]="0"
grep2401=grep("preguntado",datostfg2[,36])
datostfg2[grep2401,36]
datostfg2[grep2401,29]="0"
grep2344=grep("0",datostfg2[,29])
table(datostfg2[grep2344,36])
options(max.print =2500)
grep2345=grep("1",datostfg2[,29])
table(datostfg2[grep2345,36])
options(max.print =2384)

grepNegA=grep("negativ",datostfg2[,36])
datostfg2[grepNegA,36]
datostfg2[grepNegA[-c(5)],29]="0"

table(datostfg2[,29])

datostfg2[c(2676,3877,5871,5919,6123),36]
datostfg2[c(2676,3877,5871,5919,6123),29]="0"
```

```{r,include=TRUE}
####Variable 41(txt_cirugia) y 34(Cirugía)
####Si el paciente ha sido sometido a alguna cirugía la variable numérica debe presentar un 1,en caso contrario presentará un 0.


table(datostfg2[,34]) 
datostfg2[6272,54]=datostfg[6272,41]
datostfg2[706,41]=datostfg[706,40]
datostfg2[706,34]=datostfg[706,33]
datostfg2[7141,41]=datostfg[7141,40]
datostfg2[6272,41]=NA
 ###Seleccionamos aquellos casos en la variable Cirugía que tengan un 1 asignado,es decir,los éxitos.Al igual que en la variable anterior hay fallos.
grep1Cirug=grep("1",datostfg2[,34])
datostfg2[grep1Cirug,41]
grep731=grep("^No",datostfg2[,41])
datostfg2[grep731,41]
grep732=grep("^no",datostfg2[,41])
datostfg2[grep732,41]
datostfg2[grep732[c(89)],41]
datostfg2[grep732[c(89)],34] ####Ya presenta un 1
grep732=grep732[-c(89)]
grep733=grep("^NO",datostfg2[,41])
datostfg2[grep733,41]
grep734=grep("NR",datostfg2[,41])
datostfg2[grep734,41]
grep735=grep("^N.R",datostfg2[,41])
datostfg2[grep735,41]
grep736=grep("^Ni",datostfg2[,41])
grep736=grep("^NI",datostfg2[,41])
datostfg2[grep736,41] ###No considerar
datostfg2[grep736,34] ####Ya presenta un 1
grep736=grep("^ni",datostfg2[,41])
grep736=grep("^SIN",datostfg2[,41])
grep736=grep("^sin",datostfg2[,41])
datostfg2[grep736,41] ###No considerar
datostfg2[grep736,34] ###Ya presenta un 1
grep736=grep("^Sin",datostfg2[,41])
datostfg2[grep736,41]
datostfg2[grep736[-c(6)],34] ###Ya presentan 1's
grep736=grep736[c(6)] ###Sin interés


datostfg2[,34]=replace(datostfg2[,34],grep731,"0")
datostfg2[,34]=replace(datostfg2[,34],grep732,"0")
datostfg2[,34]=replace(datostfg2[,34],grep733,"0")
datostfg2[,34]=replace(datostfg2[,34],grep734,"0")
datostfg2[,34]=replace(datostfg2[,34],grep735,"0")
datostfg2[,34]=replace(datostfg2[,34],grep736,"0")


table(datostfg2[,34]) 

###Hay casos que presentan un 1 y después observamos "NA" en la variable de texto,estos casos hay que corregirlos también porque representan un 0 realmente.
#Bucle
for (i in 1:11984){comp=(
  is.na(datostfg2[i,41])==TRUE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,34]="0"
}else{
        datostfg2[i,34]=datostfg2[i,34]
}}
####Revisar los 1's
grep1Cirug=grep("1",datostfg2[,34])
datostfg2[grep1Cirug,41]
datostfg2[grep1Cirug[1001:2000],41]
datostfg2[grep1Cirug[2001:3000],41]
datostfg2[grep1Cirug[3001:4000],41]
datostfg2[grep1Cirug[4001:5000],41]
datostfg2[grep1Cirug[5001:5572],41]
datostfg2[grep1Cirug[c(226,504,1163,1636,2658,2634,2772)],41] ###Errores,vamos a estudiar 226,504
grep1Cirug[c(504)] ###Caso 1167
###El caso 609 es un error,mientras que el caso 1167 puedo referirse a politraumatismo(no considerar como error).
datostfg2[grep1Cirug[c(226,1164,1636,2658,2634,2772)],34]="0"
grep2921=grep("0",datostfg2[,34])
table(datostfg2[grep2921,41])

grep2922=grep("^Vista",datostfg2[,41])
datostfg2[grep2922,41]
datostfg2[grep2922,34]
datostfg2[grep2922,34]="1"
grep2922=grep("^Vesi",datostfg2[,41])
datostfg2[grep2922,41]
datostfg2[grep2922,34]
datostfg2[grep2922,34]="1"
grep2922=grep("^vege",datostfg2[,41])
datostfg2[grep2922,41]
datostfg2[grep2922,34]
datostfg2[grep2922,34]="1"
grep2922=grep("Vasec",datostfg2[,41])
datostfg2[grep2922,41]
datostfg2[grep2922,34]
datostfg2[grep2922,34]="1"
grep2922=grep("Test",datostfg2[,41])
datostfg2[grep2922,41]
datostfg2[grep2922,34]
datostfg2[grep2922,34]="1"

grep2922=grep("^Si",datostfg2[,41])
datostfg2[grep2922,41]
datostfg2[grep2922,34]
datostfg2[grep2922[-c(10)],34]="1"
grep2922=grep("Septo",datostfg2[,41])
datostfg2[grep2922,41]
datostfg2[grep2922,34]
datostfg2[grep2922,34]="1"
grep2922=grep("^Rino",datostfg2[,41])
datostfg2[grep2922,41]
datostfg2[grep2922,34]
datostfg2[grep2922,34]="1"
grep2922=grep("Refiere",datostfg2[,41])
datostfg2[grep2922,41]
datostfg2[grep2922,34]
datostfg2[grep2922,34]="1"
grep2922=grep("^Quiste",datostfg2[,41])
datostfg2[grep2922,41]
datostfg2[grep2922,34]
datostfg2[grep2922,34]="1"

grep2922=grep("^Pro",datostfg2[,41])
datostfg2[grep2922,41]
datostfg2[grep2922,34]
datostfg2[grep2922,34]="1"
grep2922=grep("^Po",datostfg2[,41])
datostfg2[grep2922,41]
datostfg2[grep2922,34]
datostfg2[grep2922,34]="1"
grep2922=grep("^Pielo",datostfg2[,41])
datostfg2[grep2922,41]
datostfg2[grep2922,34]
datostfg2[grep2922,34]="1"
grep2922=grep("^osteo",datostfg2[,41])
datostfg2[grep2922,41]
datostfg2[grep2922,34]
datostfg2[grep2922,34]="1"
grep2922=grep("^Oper",datostfg2[,41])
datostfg2[grep2922,41]
datostfg2[grep2922,34]
datostfg2[grep2922,34]="1"

grep2922=grep("^Nodu",datostfg2[,41])
datostfg2[grep2922,41]
datostfg2[grep2922,34]
datostfg2[grep2922,34]="1"
grep2922=grep("Heman",datostfg2[,41])
datostfg2[grep2922,41]
datostfg2[grep2922,34]
datostfg2[grep2922,34]="1"
grep2922=grep("hernia",datostfg2[,41])
datostfg2[grep2922,41]
datostfg2[grep2922,34]
datostfg2[grep2922,34]="1"
grep2922=grep("^Hernia",datostfg2[,41])
datostfg2[grep2922,41]
datostfg2[grep2922,34]
datostfg2[grep2922,34]="1"
grep2922=grep("^Nevus",datostfg2[,41])
datostfg2[grep2922,41]
datostfg2[grep2922,34]
datostfg2[grep2922,34]="1"
grep2922=grep("^Neo",datostfg2[,41])
datostfg2[grep2922,41]
datostfg2[grep2922,34]
datostfg2[grep2922,34]="1"

grep2922=grep("Mio",datostfg2[,41])
datostfg2[grep2922,41]
datostfg2[grep2922,34]
datostfg2[grep2922,34]="1"
grep2922=grep("MI",datostfg2[,41])
datostfg2[grep2922,41]
datostfg2[grep2922,34]
datostfg2[grep2922,34]="1"
grep2922=grep("Menis",datostfg2[,41])
datostfg2[grep2922,41]
datostfg2[grep2922,34]
datostfg2[grep2922,34]="1"
grep2922=grep("^Maxilo",datostfg2[,41])
datostfg2[grep2922,41]
datostfg2[grep2922,34]
datostfg2[grep2922,34]="1"
grep2922=grep("manguit",datostfg2[,41])
datostfg2[grep2922,41]
datostfg2[grep2922,34]
datostfg2[grep2922,34]="1"
grep2922=grep("^Interve",datostfg2[,41])
datostfg2[grep2922,41]
datostfg2[grep2922,34]
datostfg2[grep2922,34]="1"
grep2922=grep("Ins",datostfg2[,41])
datostfg2[grep2922,41]
datostfg2[grep2922,34]
datostfg2[grep2922,34]="1"
grep2922=grep("Vist",datostfg2[,41])
datostfg2[grep2922,41]
datostfg2[grep2922,34]
datostfg2[grep2922,34]="1"
grep2922=grep("Hidroce",datostfg2[,41])
datostfg2[grep2922,41]
datostfg2[grep2922,34]
datostfg2[grep2922,34]="1"
grep2922=grep("^Hernia",datostfg2[,41])
datostfg2[grep2922,41]
datostfg2[grep2922,34]
datostfg2[grep2922,34]="1"
grep2922=grep("Fx",datostfg2[,41])
datostfg2[grep2922,41]
datostfg2[grep2922,34]
datostfg2[grep2922,34]="1"
grep2922=grep("^Fr",datostfg2[,41])
datostfg2[grep2922,41]
datostfg2[grep2922,34]
datostfg2[grep2922,34]="1"
grep2922=grep("^Fi",datostfg2[,41])
datostfg2[grep2922,41]
datostfg2[grep2922,34]
datostfg2[grep2922,34]="1"
grep2922=grep("^fi",datostfg2[,41])
datostfg2[grep2922,41]
datostfg2[grep2922,34]
datostfg2[grep2922,34]="1"
grep2922=grep("^Ex",datostfg2[,41])
datostfg2[grep2922,41]
datostfg2[grep2922,34]
datostfg2[grep2922,34]="1"
grep2922=grep("^Es",datostfg2[,41])
datostfg2[grep2922,41]
datostfg2[grep2922,34]
datostfg2[grep2922[-c(20)],34]="1"
grep2922=grep("^Dupuy",datostfg2[,41])
datostfg2[grep2922,41]
datostfg2[grep2922,34]
datostfg2[grep2922,34]="1"
grep2922=grep("^De",datostfg2[,41])
datostfg2[grep2922,41]
datostfg2[grep2922,34]
datostfg2[grep2922,34]="1"
grep2922=grep("^Colec",datostfg2[,41])
datostfg2[grep2922,41]
datostfg2[grep2922,34]
datostfg2[grep2922,34]="1"
grep2922=grep("^colec",datostfg2[,41])
datostfg2[grep2922,41]
datostfg2[grep2922,34]
datostfg2[grep2922,34]="1"
grep2922=grep("^Ces",datostfg2[,41])
datostfg2[grep2922,41]
datostfg2[grep2922,34]
datostfg2[grep2922,34]="1"
grep2922=grep("^Bas",datostfg2[,41])
datostfg2[grep2922,41]
datostfg2[grep2922,34]
datostfg2[grep2922,34]="1"
grep2922=grep("^Artro",datostfg2[,41])
datostfg2[grep2922,41]
datostfg2[grep2922,34]
datostfg2[grep2922,34]="1"
grep2922=grep("^Apen",datostfg2[,41])
datostfg2[grep2922,41]
datostfg2[grep2922,34]
datostfg2[grep2922,34]="1"
grep2922=grep("^Ampu",datostfg2[,41])
datostfg2[grep2922,41]
datostfg2[grep2922,34]
datostfg2[grep2922,34]="1"
grep2922=grep("^Amig",datostfg2[,41])
datostfg2[grep2922,41]
datostfg2[grep2922,34]
datostfg2[grep2922,34]="1"
grep2922=grep("^Ade",datostfg2[,41])
datostfg2[grep2922,41]
datostfg2[grep2922,34]
datostfg2[grep2922,34]="1"
grep2922=grep("^Acro",datostfg2[,41])
datostfg2[grep2922,41]
datostfg2[grep2922,34]
datostfg2[grep2922,34]="1"
grep2922=grep("^Absce",datostfg2[,41])
datostfg2[grep2922,41]
datostfg2[grep2922,34]
datostfg2[grep2922,34]="1"
grep2922=grep("^Abdo",datostfg2[,41])
datostfg2[grep2922,41]
datostfg2[grep2922,34]
datostfg2[grep2922,34]="1"
grep2922=grep("^-",datostfg2[,41])
datostfg2[grep2922,41]
datostfg2[grep2922,34]
datostfg2[grep2922,34]="1"
grep2922=grep("^2014",datostfg2[,41])
datostfg2[grep2922,41]
datostfg2[grep2922,34]
datostfg2[grep2922,34]="1"
grep2922=grep("^Histe",datostfg2[,41])
datostfg2[grep2922,41]
datostfg2[grep2922,34]
datostfg2[grep2922,34]="1"
grep2922=grep("^in",datostfg2[,41])
datostfg2[grep2922,41]
datostfg2[grep2922,34]
datostfg2[grep2922,34]="1"
grep2922=grep("^IN",datostfg2[,41])
datostfg2[grep2922,41]
datostfg2[grep2922,34]
datostfg2[grep2922,34]="1"
grep2921=grep("0",datostfg2[,34])
table(datostfg2[grep2921,41])
table(datostfg2[,34])

for (i in 1:11984){comp=(is.na(datostfg2[i,34])==TRUE&&
  is.na(datostfg2[i,41])==FALSE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,34]="Revisar"
}else{
        datostfg2[i,34]=datostfg2[i,34]
}}

grep2904=grep("Revisar",datostfg2[,34])
datostfg2[grep2904,41]
datostfg2[grep2904,34]="1"
####Ya hemos solucionado las incongruencias.
datostfg2[c(2676,3877,5871,5919,6123),41]
datostfg2[c(2676,3877,5871,5919,6123),34]="0"

grep2914=grep("Cirug",datostfg2[,40])
grep7000=grep("cirug",datostfg2[,40])
datostfg2[grep7000,40]
grep7001=grep("CIRUG",datostfg2[,40])
datostfg2[grep7001,40]

datostfg2[,34]=replace(datostfg2[,34],grep2914,"1")
datostfg2[,34]=replace(datostfg2[,34],grep7000,"1")
datostfg2[,34]=replace(datostfg2[,34],grep7001,"1")
```


```{r,include=TRUE}
####Variable 42(txt_medicacion) y 35(Medicación)
####Si el paciente presenta algún tipo de medicación la variable numérica debe presentar un 1,en caso contrario presentará un 0.


table(datostfg2[,35]) 
datostfg2[6272,55]=datostfg[6272,42]
datostfg2[706,42]=datostfg[706,41]
datostfg2[706,35]=datostfg[706,34]
datostfg2[7141,42]=datostfg[7141,41]
datostfg2[6272,42]=NA
 ###Seleccionamos aquellos casos en la variable Medicación que tengan un 1 asignado,es decir,los éxitos.Al igual que en la variable anterior hay fallos.
grep1Medic=grep("1",datostfg2[,35])
datostfg2[grep1Medic,42]
grep737=grep("^No",datostfg2[,42])
datostfg2[grep737,42]
datostfg2[grep737[1001:2000],42]
datostfg2[grep737[2001:3000],42]
datostfg2[grep737[3001:3720],42]
####Considerar casos 250,719,1886,455,490,1540 como un No
####Considerar casos 39,177,261,591,482,276,591,614,1025,1090,1297,1379,1474,1645,1963,1985,2277,2501,2517,2902,2929,3189,3313,3618,3711 como un Si
####Caso 3018,esto corresponde a la variable Suplementos
datostfg2[grep737[c(3018)],68]

datostfg2[grep737[c(250,719,1886,455,490,1540)],42]
datostfg2[grep737[c(39,177,261,591,482,276,591,614,1025,1090,1297,1379,1474,1645,1963,1985,2277,2501,2517,2902,2929,3189,3313,3618,3711)],42]
datostfg2[grep737[c(39,177,261,591,482,276,591,614,1025,1090,1297,1379,1474,1645,1963,1985,2277,2501,2517,2902,2929,3189,3313,3618,3711)],35] ###Los casos con "No medicación anticoagulante" deben ser considerados como 0
datostfg2[grep737[c(482)],42]
datostfg2[grep737[c(482)],35]
datostfg2[grep737[c(482)],35]="1"
grep737=grep737[-c(39,177,261,591,482,276,591,614,1025,1090,1297,1379,1474,1645,1963,1985,2277,2501,2517,2902,2929,3189,3313,3618,3711)]
grep738=grep("^no",datostfg2[,42])
datostfg2[grep738,42]
####Consideramos los casos 182 y 349 como un Si
datostfg2[grep738[c(182,349)],42]
datostfg2[grep738[c(182,349)],35]
datostfg2[grep738[c(182,349)],35]="1"
grep738=grep738[-c(182,349)]
grep739=grep("^NO",datostfg2[,42])
datostfg2[grep739,42]
####Considerar casos 49,57,63,152,188,228,319,320 como un Si
datostfg2[grep739[c(49,57,63,152,188,228,319,320)],42]
datostfg2[grep739[c(49,57,63,152,188,228,319,320)],35] ###Ya presentan 1's
####152,319 y 320 pueden ser considerados suplementos
grepPoli=grep("Poli",datostfg2[,69])
datostfg2[grepPoli,69]
datostfg2[grep739[c(152,319,320)],42]


grep739=grep739[-c(49,57,63,152,188,228,319,320)]
grep740=grep("NR",datostfg2[,42])
grep740=grep("^N.R",datostfg2[,42])
grep740=grep("^Ni",datostfg2[,42])
datostfg2[grep740,42]
datostfg2[grep740[c(2)],35] ##Ya presenta un 1
grep740=grep740[c(1)]
grep741=grep("^NI",datostfg2[,42])
grep741=grep("^ni",datostfg2[,42])
grep741=grep("^SIN",datostfg2[,42])
grep741=grep("^sin",datostfg2[,42])
datostfg2[grep741,42] ###No considerar
datostfg2[grep741,35]##Ya presenta un 1
grep741=grep("^Sin",datostfg2[,42])
datostfg2[grep741,42] ##No considerar
datostfg2[grep741,35] ##Ya presenta 1's

datostfg2[,35]=replace(datostfg2[,35],grep737,"0")
datostfg2[,35]=replace(datostfg2[,35],grep738,"0")
datostfg2[,35]=replace(datostfg2[,35],grep739,"0")
datostfg2[,35]=replace(datostfg2[,35],grep740,"0")

table(datostfg2[,35]) 

###Hay casos que presentan un 1 y después observamos "NA" en la variable de texto,estos casos hay que corregirlos también porque representan un 0 realmente.

###Bucle
for (i in 1:11984){comp=(
  is.na(datostfg2[i,42])==TRUE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,35]="0"
}else{
        datostfg2[i,35]=datostfg2[i,35]
}}
####Revisar los 1's
options(max.print=1000)
grep1Medic=grep("1",datostfg2[,35])
datostfg2[grep1Medic,42] 
datostfg2[grep1Medic[1001:2000],42]
datostfg2[grep1Medic[2001:2482],42]
datostfg2[grep1Medic[c(66,88,201,467,659,677,839,1097,1105,1135,1162,2130,2179)],42]###Errores,en el caso 201 la información corresponde a la variable Lesión
datostfg2[grep1Medic[c(66,88,201,467,659,677,839,1097,1105,1135,1162,2130,2179)],35]="0"
datostfg2[grep1Medic[c(201)],51]####Aquí es donde debemos completar la información
datostfg2[grep1Medic[c(201)],50]
####Ya hemos solucionado las incongruencias.
grep2346=grep("0",datostfg2[,35])
table(datostfg2[grep2346,42]) ####La mayoría de los casos son positivos

###Bucle
for (i in 1:11984){comp=(datostfg2[i,35]=="0"&&
  is.na(datostfg2[i,42])==FALSE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,35]="1"
}else{
        datostfg2[i,35]=datostfg2[i,35]
}}
####Repetimos el proceso
grep737=grep("^No",datostfg2[,42])
datostfg2[grep737,42]
datostfg2[grep737[1001:2000],42]
datostfg2[grep737[2001:3000],42]
datostfg2[grep737[3001:3720],42]
####Considerar casos 250,719,1886,455,490,1540 como un No
####Considerar casos 39,177,261,591,482,276,591,614,1025,1090,1297,1379,1474,1645,1963,1985,2277,2501,2517,2902,2929,3189,3313,3618,3711 como un Si
####Caso 3018,esto corresponde a la variable Suplementos
datostfg2[grep737[c(3018)],68]
datostfg2[grep737[c(250,719,1886,455,490,1540)],42]
datostfg2[grep737[c(39,177,261,591,482,276,591,614,1025,1090,1297,1379,1474,1645,1963,1985,2277,2501,2517,2902,2929,3189,3313,3618,3711)],42]
datostfg2[grep737[c(39,177,261,591,482,276,591,614,1025,1090,1297,1379,1474,1645,1963,1985,2277,2501,2517,2902,2929,3189,3313,3618,3711)],35] ###Los casos con "No medicación anticoagulante" deben ser considerados como 0
datostfg2[grep737[c(482)],42]
datostfg2[grep737[c(482)],35]
datostfg2[grep737[c(482)],35]="1"
grep737=grep737[-c(39,177,261,591,482,276,591,614,1025,1090,1297,1379,1474,1645,1963,1985,2277,2501,2517,2902,2929,3189,3313,3618,3711)]
grep738=grep("^no",datostfg2[,42])
datostfg2[grep738,42]
####Consideramos los casos 182 y 349 como un Si
datostfg2[grep738[c(182,349)],42]
datostfg2[grep738[c(182,349)],35]
datostfg2[grep738[c(182,349)],35]="1"
grep738=grep738[-c(182,349)]
grep739=grep("^NO",datostfg2[,42])
datostfg2[grep739,42]
####Considerar casos 49,57,63,152,188,228,319,320 como un Si
datostfg2[grep739[c(49,57,63,152,188,228,319,320)],42]
datostfg2[grep739[c(49,57,63,152,188,228,319,320)],35] ###Ya presentan 1's
####152,319 y 320 pueden ser considerados suplementos
grepPoli=grep("Poli",datostfg2[,69])
datostfg2[grepPoli,69]
datostfg2[grep739[c(152,319,320)],42]

grep739=grep739[-c(49,57,63,152,188,228,319,320)]
grep740=grep("NR",datostfg2[,42])
grep740=grep("^N.R",datostfg2[,42])
grep740=grep("^Ni",datostfg2[,42])
datostfg2[grep740,42]
datostfg2[grep740[c(2)],35] ##Ya presenta un 1
grep740=grep740[c(1)]
grep741=grep("^NI",datostfg2[,42])
grep741=grep("^ni",datostfg2[,42])
grep741=grep("^SIN",datostfg2[,42])
grep741=grep("^sin",datostfg2[,42])
datostfg2[grep741,42] ###No considerar
datostfg2[grep741,35]##Ya presenta un 1
grep741=grep("^Sin",datostfg2[,42])
datostfg2[grep741,42] ##No considerar
datostfg2[grep741,35] ##Ya presenta 1's

datostfg2[,35]=replace(datostfg2[,35],grep737,"0")
datostfg2[,35]=replace(datostfg2[,35],grep738,"0")
datostfg2[,35]=replace(datostfg2[,35],grep739,"0")
datostfg2[,35]=replace(datostfg2[,35],grep740,"0")
datostfg2[grep1Medic[c(66,88,201,467,659,677,839,1097,1105,1135,1162,2130,2179)],35]="0"

grep2347=grep("1",datostfg2[,35])
table(datostfg2[grep2347,42]) 
grep2348=grep("^-\t",datostfg2[,42])
datostfg2[grep2348,42]
datostfg2[grep2348,35]
datostfg2[grep2348,35]="0"
grep2349=grep("^.NO",datostfg2[,42])
datostfg2[grep2349,42]
datostfg2[grep2349,35]
datostfg2[grep2349,35]="0"
grep2350=grep("^:",datostfg2[,42])
datostfg2[grep2350,42]
datostfg2[grep2350,35]
datostfg2[grep2350,35]="0"
grep2351=grep("SIN",datostfg2[,42])
datostfg2[grep2351,42]
datostfg2[grep2351,35]
datostfg2[grep2351,35]="0"
grep2347=grep("1",datostfg2[,35])
table(datostfg2[grep2347,42]) 
grep2352=grep("Actualmente",datostfg2[,42])
datostfg2[grep2352,42]
datostfg2[grep2352[-c(2,5,6,8,10,11,12)],35]="0"
datostfg2[grep2352[c(2,5,6,8,10,11,12)],35]="1"
grep2353=grep("actualmente",datostfg2[,42])
datostfg2[grep2353,42]
datostfg2[grep2353[-c(2,4,6,8,9,10,11,12,14,15,16,17,18,19)],35]="0"
datostfg2[grep2353[c(2,4,6,8,9,10,11,12,14,15,16,17,18,19)],35]="1"
grep2346=grep("0",datostfg2[,35])
table(datostfg2[grep2346,42])
grep2354=grep("Adre",datostfg2[,42])
datostfg2[grep2354,42]
datostfg2[grep2354,35]="1"
grep2355=grep("^Anti",datostfg2[,42])
datostfg2[grep2355,42]
datostfg2[grep2355,35]="1"
grep2356=grep("^Concer",datostfg2[,42])
datostfg2[grep2356,42]
datostfg2[grep2356,35]="1"
grep2357=grep("^Depakine",datostfg2[,42])
datostfg2[grep2357,42]
datostfg2[grep2357,35]="1"
grep2358=grep("^Hierro",datostfg2[,42])
datostfg2[grep2358,42]
datostfg2[grep2358,35]="1"
grep2359=grep("^Hipertene",datostfg2[,42])
datostfg2[grep2359,42]
datostfg2[grep2359,35]="1"
grep2360=grep("^Mucolitico",datostfg2[,42])
datostfg2[grep2360,42]
datostfg2[grep2360,35]="1"
grep2361=grep("^Noctamid",datostfg2[,42])
datostfg2[grep2361,42]
datostfg2[grep2361,35]="1"
grep2362=grep("^Omeprazol",datostfg2[,42])
datostfg2[grep2362,42]
datostfg2[grep2362,35]="1"
grep2363=grep("^Vesicare",datostfg2[,42])
datostfg2[grep2363,42]
datostfg2[grep2363,35]="1"
grep2364=grep("^Zafiro",datostfg2[,42])
datostfg2[grep2364,42]
datostfg2[grep2364,35]="1"
grep2365=grep("^symbi",datostfg2[,42])
datostfg2[grep2365,42]
datostfg2[grep2365,35]="1"
grep2366=grep("hierro",datostfg2[,42])
datostfg2[grep2366,42]
datostfg2[grep2366,35]="1"
grep2367=grep("minerales",datostfg2[,42])
datostfg2[grep2367,42]
datostfg2[grep2367,35]="0"
grep2368=grep("no toma",datostfg2[,42])
datostfg2[grep2368,42]
grep2399=grep("preguntado",datostfg2[,42])
datostfg2[grep2399,42]
datostfg2[grep2399,35]="0"
grep2347=grep("1",datostfg2[,35])
table(datostfg2[grep2347,42]) 
grep2346=grep("0",datostfg2[,35])
table(datostfg2[grep2346,42])
grep2930=grep("piramidal",datostfg2[,42])
datostfg2[grep2930,50] ###Ya registrado
table(datostfg2[,35])

for (i in 1:11984){comp=(is.na(datostfg2[i,35])==TRUE&&
  is.na(datostfg2[i,42])==FALSE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,35]="Revisar"
}else{
        datostfg2[i,35]=datostfg2[i,35]
}}

grep2904=grep("Revisar",datostfg2[,35])
datostfg2[grep2904,42]
datostfg2[grep2904,35]="1"

datostfg2[c(2676,3877,5871,5919,6123),42]
datostfg2[c(2676,3877,5871,5919,6123),35]="0"
```

```{r,include=TRUE}
####Variable 43(Soplo.Cardíaco) y 48(txt_soplo)
####Si el paciente ha presentado alguna vez un soplo la variable numérica debe presentar un 1,en caso contrario presentará un 0.


table(datostfg2[,43]) 
datostfg2[6272,56]=datostfg[6272,43]
datostfg2[6272,61]=datostfg[6272,48]
datostfg2[706,48]=datostfg[706,47]
datostfg2[706,43]=datostfg[706,42]
datostfg2[7141,48]=datostfg[7141,47]
datostfg2[7141,43]=datostfg[7141,42]
datostfg2[6272,43]=NA
datostfg2[6272,48]=NA
 ###Seleccionamos aquellos casos en la variable Soplo.Cardiaco que tengan un 1 asignado,es decir,los éxitos.Al igual que en la variable anterior hay fallos.
grep1Soplo=grep("1",datostfg2[,43])
datostfg2[grep1Soplo,48]
grep741=grep("^No",datostfg2[,48])
datostfg2[grep741,48]
datostfg2[grep741[1001:2000],48]
datostfg2[grep741[2001:2552],48]
##Considerar casos 261,608,626,665,887,1193,1408,1456,2064,2441 como un No,eliminar caso 2098 porque refiere que el deportista no usa plantillas,esto corresponde a otra variable.
datostfg2[grep741[c(261,608,626,665,887,1193,1408,1456,2064,2441)],48]
###Considerar casos 378,560,889,1205,1469,2317,2338 como un Si,además 889 pérdida de conciencia.
datostfg2[grep741[c(889)],77] ####Ya presenta un 1
datostfg2[grep741[c(889)],82] ###Ya estaba recogida la información
datostfg2[grep741[c(378,560,889,1205,1469,2317,2338)],48]
datostfg2[grep741[c(378,560,889,1205,1469,2317,2338)],43] ####Ya presentan 1's
grep741=grep741[-c(378,560,889,1205,1469,2317,2338)]
grepextra=grep("extra",datostfg2[,48])
datostfg2[grepextra,48] ###No hay mas casos de extrasístole precedidos de un no

grep742=grep("^no",datostfg2[,48])
datostfg2[grep742,48] ###200,438 no sabe
datostfg2[grep742[c(200,438)],48]
datostfg2[grep742[c(200,438)],43]
grep743=grep("^NO",datostfg2[,48])
datostfg2[grep743,48]
grep744=grep("NR",datostfg2[,48])
datostfg2[grep744,48]
grep745=grep("^N.R",datostfg2[,48])
datostfg2[grep745,48]
grep746=grep("^Ni",datostfg2[,48])
datostfg2[grep746,48] ###No considerar
grep746=grep("^NI",datostfg2[,48])
grep746=grep("^ni",datostfg2[,48])
grep746=grep("^SIN",datostfg2[,48])
grep746=grep("^sin",datostfg2[,48])
grep746=grep("^Sin",datostfg2[,48])
datostfg2[grep746,48] 


datostfg2[,43]=replace(datostfg2[,43],grep741,"0")
datostfg2[,43]=replace(datostfg2[,43],grep742,"0")
datostfg2[,43]=replace(datostfg2[,43],grep743,"0")
datostfg2[,43]=replace(datostfg2[,43],grep744,"0")
datostfg2[,43]=replace(datostfg2[,43],grep745,"0")
datostfg2[,43]=replace(datostfg2[,43],grep746,"0")


table(datostfg2[,43])

###Hay casos que presentan un 1 y después observamos "NA" en la variable de texto,estos casos hay que corregirlos también porque representan un 0 realmente.


###Bucle
for (i in 1:11984){comp=(
  is.na(datostfg2[i,48])==TRUE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,43]="0"
}else{
        datostfg2[i,43]=datostfg2[i,43]
}}
####Revisar los 1's
grep1Soplo=grep("1",datostfg2[,43])
datostfg2[grep1Soplo,48]
datostfg2[grep1Soplo[c(30,151,241,334,338,359)],48] ###Errores
datostfg2[grep1Soplo[c(30,151,241,334,338,359)],43]="0"
####Ya hemos solucionado las incongruencias.
####Revisar los 0's
grep2389=grep("0",datostfg2[,43])
table(datostfg2[grep2389,48]) ###La mayoría son éxitos

###Bucle
for (i in 1:11984){comp=(datostfg2[i,43]=="0"&&
  is.na(datostfg2[i,48])==FALSE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,43]="1"
}else{
        datostfg2[i,43]=datostfg2[i,43]
}}

####Repetimos el proceso
grep741=grep("^No",datostfg2[,48])
datostfg2[grep741,48]
datostfg2[grep741[1001:2000],48]
datostfg2[grep741[2001:2552],48]
##Considerar casos 261,608,626,665,887,1193,1408,1456,2064,2441 como un No,eliminar caso 2098 porque refiere que el deportista no usa plantillas,esto corresponde a otra variable.
datostfg2[grep741[c(261,608,626,665,887,1193,1408,1456,2064,2441)],48]
###Considerar casos 378,560,889,1205,1469,2317,2338 como un Si,además 889 pérdida de conciencia.
datostfg2[grep741[c(889)],77] ####Ya presenta un 1
datostfg2[grep741[c(889)],82] ###Ya estaba recogida la información
datostfg2[grep741[c(378,560,889,1205,1469,2317,2338)],48]
datostfg2[grep741[c(378,560,889,1205,1469,2317,2338)],43] ####Ya presentan 1's
grep741=grep741[-c(378,560,889,1205,1469,2317,2338)]
grepextra=grep("extra",datostfg2[,48])
datostfg2[grepextra,48] ###No hay mas casos de extrasístole precedidos de un no

grep742=grep("^no",datostfg2[,48])
datostfg2[grep742,48] ###200,438 no sabe
datostfg2[grep742[c(200,438)],48]
datostfg2[grep742[c(200,438)],43]
grep743=grep("^NO",datostfg2[,48])
datostfg2[grep743,48]
grep744=grep("NR",datostfg2[,48])
datostfg2[grep744,48]
grep745=grep("^N.R",datostfg2[,48])
datostfg2[grep745,48]
grep746=grep("^Ni",datostfg2[,48])
datostfg2[grep746,48] ###No considerar
grep746=grep("^NI",datostfg2[,48])
grep746=grep("^ni",datostfg2[,48])
grep746=grep("^SIN",datostfg2[,48])
grep746=grep("^sin",datostfg2[,48])
grep746=grep("^Sin",datostfg2[,48])
datostfg2[grep746,48] 


datostfg2[,43]=replace(datostfg2[,43],grep741,"0")
datostfg2[,43]=replace(datostfg2[,43],grep742,"0")
datostfg2[,43]=replace(datostfg2[,43],grep743,"0")
datostfg2[,43]=replace(datostfg2[,43],grep744,"0")
datostfg2[,43]=replace(datostfg2[,43],grep745,"0")
datostfg2[,43]=replace(datostfg2[,43],grep746,"0")

datostfg2[grep1Soplo[c(30,151,241,334,338,359)],48] ###Errores
datostfg2[grep1Soplo[c(30,151,241,334,338,359)],43]="0"
grep2390=grep("1",datostfg2[,43])
table(datostfg2[grep2390,48]) 
grep2392=grep("aire libre",datostfg2[,48])####Corresponde a la variable 55
datostfg2[grep2392,55]=datostfg2[grep2392,48]
datostfg2[grep2392,43]="0"
grep2393=grep("preguntado",datostfg2[,48])
datostfg2[grep2393,48]
datostfg2[grep2393,43]="0"
grep2394=grep("sin hallazgos",datostfg2[,48])
datostfg2[grep2394,48]
datostfg2[grep2394,43]="1"
grep2395=grep("^n0",datostfg2[,48])
datostfg2[grep2395,48]
datostfg2[grep2395,43]="0"
grep2395=grep("N0",datostfg2[,48])
datostfg2[grep2395,48]
datostfg[grep2395,43]="0"
grep2396=grep("nada significativo",datostfg2[,48])
datostfg2[grep2396,48]
datostfg2[grep2396,43]="1"
grep2397=grep("Todo normal",datostfg2[,48])
datostfg2[grep2397,48]
datostfg2[grep2397,43]="1"
grep2398=grep("sin diag",datostfg2[,48])
datostfg2[grep2398,48]
datostfg2[grep2398,43]="1"
grep2390=grep("1",datostfg2[,43])
table(datostfg2[grep2390,48])
grep2389=grep("0",datostfg2[,43])
table(datostfg2[grep2389,48])

table(datostfg2[,43])

for (i in 1:11984){comp=(is.na(datostfg2[i,43])==TRUE&&
  is.na(datostfg2[i,48])==FALSE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,43]="Revisar"
}else{
        datostfg2[i,43]=datostfg2[i,43]
}}

grep2904=grep("Revisar",datostfg2[,43])
datostfg2[grep2904,48]
datostfg2[grep2904[c(2)],35]="1"
datostfg2[grep2904[c(1)],35]="0"

datostfg2[c(2676,3877,5871,5919,6123),48]
datostfg2[c(2676,3877,5871,5919,6123),43]="0"
```

```{r,include=TRUE}
####Variable 44 (Sintomas.asociados.al.deporte)
table(datostfg2[,44]) 
datostfg2[6272,57]=datostfg[6272,44]
datostfg2[706,44]=datostfg[706,43]
datostfg2[7141,44]=datostfg[7141,43]
datostfg2[6272,44]=NA
table(datostfg2[,44]) 
```

```{r,include=TRUE}
####Variable 45(HTA.) y 49(txt_HTA) Hipertensión Arterial
####Si el paciente presenta o ha presentado hipertensión arterial la variable numérica debe presentar un 1,en caso contrario presentará un 0.


table(datostfg2[,45]) 
datostfg2[6272,58]=datostfg[6272,45]
datostfg2[6272,62]=datostfg[6272,49]
datostfg2[706,49]=datostfg[706,48]
datostfg2[706,45]=datostfg[706,44]
datostfg2[7141,49]=datostfg[7141,48]
datostfg2[7141,45]=datostfg[7141,44]
datostfg2[6272,45]=NA
datostfg2[6272,49]=NA
 ###Seleccionamos aquellos casos en la variable HTA que tengan un 1 asignado,es decir,los éxitos.Al igual que en la variable anterior hay fallos.
grep1HTA=grep("1",datostfg2[,45])
datostfg2[grep1HTA,49]
grep747=grep("^No",datostfg2[,49])
datostfg2[grep747,49]
datostfg2[grep747[1001:2000],49]
datostfg2[grep747[2001:2351],49]
datostfg2[grep747[c(313)],49]
datostfg2[grep747[c(313)],45]
datostfg2[grep747[c(373)],49]
datostfg2[grep747[c(373)],45] ####Lo cambiamos por un 1
datostfg2[grep747[c(373)],45]="1"
datostfg2[grep747[c(673)],49]
datostfg2[grep747[c(673)],45] 
datostfg2[grep747[c(788)],49]
datostfg2[grep747[c(788)],45]
datostfg2[grep747[c(1231)],49]
datostfg2[grep747[c(1231)],45]
datostfg2[grep747[c(1433)],49] 
datostfg2[grep747[c(1433)],45] 
datostfg2[grep747[c(1450)],49]
datostfg2[grep747[c(1450)],45]
datostfg2[grep747[c(1589)],49]
datostfg2[grep747[c(1589)],45]
datostfg2[grep747[c(1603)],49]
datostfg2[grep747[c(1603)],45]
datostfg2[grep747[c(2081)],49]
datostfg2[grep747[c(2081)],45]
datostfg2[grep747[c(2349)],49]
datostfg2[grep747[c(2349)],45]
grep747_cambiar=grep747[-c(313,373,673,788,1231,1433,1450,1589,1603,2081,2349)]
grep748=grep("^no",datostfg2[,49])
datostfg2[grep748,49]
grep749=grep("^NO",datostfg2[,49])
datostfg2[grep749,49]
grep750=grep("NR",datostfg2[,49])
datostfg2[grep750,49]
grep751=grep("^N.R",datostfg2[,49])
datostfg2[grep751,49]
grep752=grep("^Ni",datostfg2[,49])
grep752=grep("^NI",datostfg2[,49])
grep752=grep("^ni",datostfg2[,49])
datostfg2[grep752,49]
grep753=grep("^SIN",datostfg2[,49])
grep753=grep("^sin",datostfg2[,49])
grep758=grep("^Sin",datostfg2[,49])


datostfg2[,45]=replace(datostfg2[,45],grep747_cambiar,"0")
datostfg2[,45]=replace(datostfg2[,45],grep748,"0")
datostfg2[,45]=replace(datostfg2[,45],grep749,"0")
datostfg2[,45]=replace(datostfg2[,45],grep750,"0")
datostfg2[,45]=replace(datostfg2[,45],grep751,"0")
datostfg2[,45]=replace(datostfg2[,45],grep752,"0")

table(datostfg2[,45]) 

###Hay casos que presentan un 1 y después observamos "NA" en la variable de texto,estos casos hay que corregirlos también porque representan un 0 realmente.

###Bucle
for (i in 1:11984){comp=(
  is.na(datostfg2[i,49])==TRUE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,45]="0"
}else{
        datostfg2[i,45]=datostfg2[i,45]
}}
####Revisar los 1's
grep1HTA=grep("1",datostfg2[,45])
datostfg2[grep1HTA,49]
datostfg2[grep1HTA[c(55,85,87,105,172,175,188,350,351,372)],49]###Errores
datostfg2[grep1HTA[c(55,85,87,105,172,175,188,350,351,372)],45]="0"
####Ya hemos solucionado las incongruencias.
grep2400=grep("0",datostfg2[,45])
table(datostfg2[grep2400,49])
grep2620=grep("Preecl",datostfg2[,49])
datostfg2[grep2620,49]
datostfg2[grep2620,45]
datostfg2[grep2620,45]="1"
grep2621=grep("^En",datostfg2[,49])
datostfg2[grep2621,49]
datostfg2[grep2621,45]
datostfg2[grep2621,45]="1"
grep2622=grep("^antecedente",datostfg2[,49])
datostfg2[grep2622,49]
datostfg2[grep2622,45]
datostfg2[grep2622,45]="1"
grep2623=grep("^Se aconseja",datostfg2[,49])
datostfg2[grep2623,49]
datostfg2[grep2623,45]
datostfg2[grep2623,45]="1"
grep2624=grep("^Al",datostfg2[,49])
datostfg2[grep2624,49]
datostfg2[grep2624,45]
datostfg2[grep2624,45]="1"
grep2625=grep("limite",datostfg2[,49])
datostfg2[grep2625,49]
datostfg2[grep2625,45]
datostfg2[grep2625,45]="1"
grep2626=grep("^Acude",datostfg2[,49])
datostfg2[grep2626,49]
datostfg2[grep2626,45]
datostfg2[grep2626,45]="1"
grep2627=grep("^TA",datostfg2[,49])
datostfg2[grep2627,49]
datostfg2[grep2627,45]
datostfg2[grep2627,45]="1"
grep2400=grep("0",datostfg2[,45])
table(datostfg2[grep2400,49])
grep2628=grep("^Fractura",datostfg2[,49])
datostfg2[grep2628,49]
datostfg2[grep2628,50] ###Ya hay registro de lesiones,aunque no está incluida esta información
grep2629=grep("^Rotura",datostfg2[,49])
datostfg2[grep2629,49]
datostfg2[grep2629,50]###Ya registrado
grep2400=grep("0",datostfg2[,45])
table(datostfg2[grep2400,49])


table(datostfg2[,45])
datostfg2[c(2676,3877,5871,5919,6123),45]
datostfg2[c(2676,3877,5871,5919,6123),49]="0"

```

```{r,include=TRUE}
####Variable 46(Lesiones.) y 50(txt_lesiones)
####Si el paciente ha presentado alguna lesión la variable numérica debe presentar un 1,en caso contrario presentará un 0.


table(datostfg2[,46]) 
datostfg2[6272,59]=datostfg[6272,46]
datostfg2[6272,63]=datostfg[6272,50]
datostfg2[706,50]=datostfg[706,49]
datostfg2[706,46]=datostfg[706,45]
datostfg2[7141,50]=datostfg[7141,49]
datostfg2[7141,46]=datostfg[7141,45]
datostfg2[6272,46]=NA
datostfg2[6272,50]=NA
 ###Seleccionamos aquellos casos en la variable Lesiones. que tengan un 1 asignado,es decir,los éxitos.Al igual que en la variable anterior hay fallos.
grep1Lesiones=grep("1",datostfg2[,46])
datostfg2[grep1Lesiones,50]
grep1094=grep("^No",datostfg2[,50])
datostfg2[grep1094,50]
datostfg2[grep1094[1001:2000],50]
datostfg2[grep1094[2001:2399],50]
####Considerar 702,762,891,941,1587 como un No
datostfg2[grep1094[c(702,762,891,941,1587)],50]
###Considerar 935,940,1313,1854,2013,2112,2192,2329 como un si
datostfg2[grep1094[c(935,940,1313,1854,2013,2112,2192,2329)],50]
datostfg2[grep1094[c(935,940,1313,1854,2013,2112,2192,2329)],46]="1"
grep1094=grep1094[-c(935,940,1313,1854,2013,2112,2192,2329)]
grep1095=grep("^no",datostfg2[,50])
datostfg2[grep1095,50]
grep1096=grep("^NO",datostfg2[,50])
datostfg2[grep1096,50]
grep1097=grep("NR",datostfg2[,50])
datostfg2[grep1097,50]
grep1098=grep("^N.R",datostfg2[,50])
datostfg2[grep1098,50]
grep1099=grep("^Ni",datostfg2[,50])
grep1099=grep("^NI",datostfg2[,50])
grep1099=grep("^ni",datostfg2[,50])
grep1099=grep("^SIN",datostfg2[,50])
grep1099=grep("^sin",datostfg2[,50])
grep1099=grep("^Sin",datostfg2[,50])
datostfg2[grep1099,50]
datostfg2[grep1099[c(2,3,10,47,48,49,66,82,83,86,98,104,108,109,110,120,127,131,134,138,142,157)],50]
datostfg2[grep1099[c(2,3,10,47,48,49,66,82,83,86,98,104,108,109,110,120,127,131,134,138,142,157)],46]="1"
####Los considero como un Si
####Considero 38,51,62,70,79,93,103,105,126,130,139,84 como un No
grep1099=grep1099[-c(2,3,10,47,48,49,66,82,83,86,98,104,108,109,110,120,127,131,134,138,142,157)]

datostfg2[,46]=replace(datostfg2[,46],grep1094,"0")
datostfg2[,46]=replace(datostfg2[,46],grep1095,"0")
datostfg2[,46]=replace(datostfg2[,46],grep1096,"0")
datostfg2[,46]=replace(datostfg2[,46],grep1097,"0")
datostfg2[,46]=replace(datostfg2[,46],grep1098,"0")
datostfg2[,46]=replace(datostfg2[,46],grep1099,"0")

table(datostfg2[,46]) 

###Hay casos que presentan un 1 y después observamos "NA" en la variable de texto,estos casos hay que corregirlos también porque representan un 0 realmente.

###Bucle
for (i in 1:11984){comp=(
  is.na(datostfg2[i,50])==TRUE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,46]="0"
}else{
        datostfg2[i,46]=datostfg2[i,46]
}}
####Revisar los 1's
grep1Lesiones=grep("1",datostfg2[,46])
datostfg2[grep1Lesiones,50]
datostfg2[grep1Lesiones[1001:2000],50]
datostfg2[grep1Lesiones[2001:3000],50]
datostfg2[grep1Lesiones[3001:4000],50]
datostfg2[grep1Lesiones[4001:5000],50]
datostfg2[grep1Lesiones[5001:6000],50]
datostfg2[grep1Lesiones[6001:6161],50]
datostfg2[grep1Lesiones[c(88,93,112,137,153,219,220,1179,1783,2627,2778,2802,2900)],50]
datostfg2[grep1Lesiones[c(88,93,112,137,153,219,220,1179,1783,2627,2778,2802,2900)],46]="0" ###Se trataba de errores.
###Revisando los datos las gonalgias,las sobrecargas y las contracturas se consideran como una lesión en algunos casos.Por tanto consideraré los siguientes casos como lesión
grep1099=grep("^Sin",datostfg2[,50])
datostfg2[grep1099[c(38,51,62,70,79,93,103,105,126,130,139,84)],46]="1"
grep2630=grep("0",datostfg2[,46])
table(datostfg2[grep2630,50])
table(datostfg2[,46])

grep2631=grep("^2007",datostfg2[,50])
datostfg2[grep2631,50]
datostfg2[grep2631,46]
datostfg2[grep2631,46]="1"
grep2632=grep("luxa",datostfg2[,50])
datostfg2[grep2632,50]
datostfg2[grep2632,46]
datostfg2[grep2632,46]="1"
grep2633=grep("Adduc",datostfg2[,50])
datostfg2[grep2633,50]
datostfg2[grep2633,46]
datostfg2[grep2633,46]="1"
grep2634=grep("Acorta",datostfg2[,50])
datostfg2[grep2634,50]
datostfg2[grep2634,46]
datostfg2[grep2634,46]="1"
grep2635=grep("Arranca",datostfg2[,50])
datostfg2[grep2635,50]
datostfg2[grep2635,46]
datostfg2[grep2635,46]="1"
grep2636=grep("Ausencia",datostfg2[,50])
datostfg2[grep2636,50]
datostfg2[grep2636,46]
datostfg2[grep2636,46]="1"
grep2637=grep("^Bursisti",datostfg2[,50])
datostfg2[grep2637,50]
datostfg2[grep2637,46]
datostfg2[grep2637,46]="1"
grep2638=grep("Condro",datostfg2[,50])
datostfg2[grep2638,50]
datostfg2[grep2638,46]
datostfg2[grep2638,46]="1"
grep2639=grep("Contrac",datostfg2[,50])
datostfg2[grep2639,50]
datostfg2[grep2639,46]
datostfg2[grep2639,46]="1"
grep2640=grep("Disten",datostfg2[,50])
datostfg2[grep2640,50]
datostfg2[grep2640,46]
datostfg2[grep2640,46]="1"
grep2641=grep("Dolor",datostfg2[,50])
datostfg2[grep2641,50]
datostfg2[grep2641,46]
datostfg2[grep2641,46]="1"
grep2642=grep("Esg",datostfg2[,50])
datostfg2[grep2642,50]
datostfg2[grep2642,46]
datostfg2[grep2642,46]="1"
grep2643=grep("esg",datostfg2[,50])
datostfg2[grep2643,50]
datostfg2[grep2643,46]
datostfg2[grep2643,46]="1"
grep2644=grep("entorsis",datostfg2[,50])
datostfg2[grep2644,50]
datostfg2[grep2644,46]
datostfg2[grep2644,46]="1"
grep2645=grep("fascit",datostfg2[,50])
datostfg2[grep2645,50]
datostfg2[grep2645,46]
datostfg2[grep2645,46]="1"
grep2646=grep("Fisura",datostfg2[,50])
datostfg2[grep2646,50]
datostfg2[grep2646,46]
datostfg2[grep2646,46]="1"
grep2647=grep("Frac",datostfg2[,50])
datostfg2[grep2647,50]
datostfg2[grep2647,46]
datostfg2[grep2647,46]="1"
grep2648=grep("frac",datostfg2[,50])
datostfg2[grep2648,50]
datostfg2[grep2648,46]
datostfg2[grep2648,46]="1"
grep2649=grep("Fx",datostfg2[,50])
datostfg2[grep2649,50]
datostfg2[grep2649,46]
datostfg2[grep2649,46]="1"
grep2650=grep("fisura",datostfg2[,50])
datostfg2[grep2650,50]
datostfg2[grep2650,46]
datostfg2[grep2650,46]="1"
grep2651=grep("Lumba",datostfg2[,50])
datostfg2[grep2651,50]
datostfg2[grep2651,46]
datostfg2[grep2651,46]="1"
grep2652=grep("LUMBA",datostfg2[,50])
datostfg2[grep2652,50]
datostfg2[grep2652,46]
datostfg2[grep2652,46]="1"
grep2653=grep("Luxa",datostfg2[,50])
datostfg2[grep2653,50]
datostfg2[grep2653,46]
datostfg2[grep2653,46]="1"
grep2654=grep("Inesta",datostfg2[,50])
datostfg2[grep2654,50]
datostfg2[grep2654,46]
datostfg2[grep2654,46]="1"
grep2655=grep("Hincha",datostfg2[,50])
datostfg2[grep2655,50]
datostfg2[grep2655,46]
datostfg2[grep2655,46]="1"
grep2656=grep("micro",datostfg2[,50])
datostfg2[grep2656,50]
datostfg2[grep2656,46]
datostfg2[grep2656,46]="1"
grep2657=grep("Micro",datostfg2[,50])
datostfg2[grep2657,50]
datostfg2[grep2657,46]
datostfg2[grep2657,46]="1"
grep2658=grep("Pubal",datostfg2[,50])
datostfg2[grep2658,50]
datostfg2[grep2658,46]
datostfg2[grep2658,46]="1"
grep2659=grep("Rotura",datostfg2[,50])
datostfg2[grep2659,50]
datostfg2[grep2659,46]
datostfg2[grep2659,46]="1"
grep2660=grep("Sobre",datostfg2[,50])
datostfg2[grep2660,50]
datostfg2[grep2660,46]
datostfg2[grep2660,46]="1"
grep2661=grep("Tendi",datostfg2[,50])
datostfg2[grep2661,50]
datostfg2[grep2661,46]
datostfg2[grep2661,46]="1"
grep2662=grep("tendon",datostfg2[,50])
datostfg2[grep2662,50]
datostfg2[grep2662,46]
datostfg2[grep2662,46]="1"
grep2663=grep("Triada",datostfg2[,50])
datostfg2[grep2663,50]
datostfg2[grep2663,46]
datostfg2[grep2663,46]="1"
grep2664=grep("Manis",datostfg2[,50])
datostfg2[grep2664,50]
datostfg2[grep2664,46]
datostfg2[grep2664,46]="1"
grep2665=grep("Menis",datostfg2[,50])
datostfg2[grep2665,50]
datostfg2[grep2665,46]
datostfg2[grep2665,46]="1"
grep2666=grep("manguit",datostfg2[,50])
datostfg2[grep2666,50]
datostfg2[grep2666,46]
datostfg2[grep2666,46]="1"
grep2667=grep("anteriormente",datostfg2[,50])
datostfg2[grep2667,50]
datostfg2[grep2667,46]
datostfg2[grep2667,46]="1"
grep2668=grep("coche",datostfg2[,50])
datostfg2[grep2668,50]
datostfg2[grep2668,46]
datostfg2[grep2668,46]="1"
grep2669=grep("gonalgia",datostfg2[,50])
datostfg2[grep2669,50]
datostfg2[grep2669,46]
datostfg2[grep2669,46]="1"
grep2670=grep("Molestia",datostfg2[,50])
datostfg2[grep2670,50]
datostfg2[grep2670,46]
datostfg2[grep2670,46]="1"
grep2671=grep("TCE",datostfg2[,50])
datostfg2[grep2671,50]
datostfg2[grep2671,46]
datostfg2[grep2671,46]="1"
grep2672=grep("^Ca",datostfg2[,50])
datostfg2[grep2672,50]
datostfg2[grep2672,46]
datostfg2[grep2672,46]="1"
grep2673=grep("Gonal",datostfg2[,50])
datostfg2[grep2673,50]
datostfg2[grep2673,46]
datostfg2[grep2673,46]="1"
grep2674=grep("menis",datostfg2[,50])
datostfg2[grep2674,50]
datostfg2[grep2674,46]
datostfg2[grep2674,46]="1"
grep2675=grep("moles",datostfg2[,50])
datostfg2[grep2675,50]
datostfg2[grep2675,46]
datostfg2[grep2675,46]="1"
grep2676=grep("pie dcho",datostfg2[,50])
datostfg2[grep2676,50]
datostfg2[grep2676,46]
datostfg2[grep2676,46]="1"
grep2677=grep("peron",datostfg2[,50])
datostfg2[grep2677,50]
datostfg2[grep2677,46]
datostfg2[grep2677,46]="1"
grep2678=grep("Contu",datostfg2[,50])
datostfg2[grep2678,50]
datostfg2[grep2678,46]
datostfg2[grep2678,46]="1"
grep2679=grep("sobre",datostfg2[,50])
datostfg2[grep2679,50]
datostfg2[grep2679,46]
datostfg2[grep2679,46]="1"
grep2680=grep("Herida",datostfg2[,50])
datostfg2[grep2680,50]
datostfg2[grep2680,46]
datostfg2[grep2680,46]="1"
grep2681=grep("pesa ",datostfg2[,50])
datostfg2[grep2681,50]
datostfg2[grep2681,46]
datostfg2[grep2681,46]="1"
grep2682=grep("1988",datostfg2[,50])
datostfg2[grep2682,50]
datostfg2[grep2682,46]
datostfg2[grep2682,46]="1"
grep2630=grep("0",datostfg2[,46])
table(datostfg2[grep2630,50])
datostfg2[5035,50]=datostfg2[5035,41]
datostfg2[5035,46]="1"

table(datostfg2[,46])
####Ya hemos solucionado las incongruencias.

for (i in 1:11984){comp=(is.na(datostfg2[i,46])==TRUE&&
  is.na(datostfg2[i,50])==FALSE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,46]="Revisar"
}else{
        datostfg2[i,46]=datostfg2[i,46]
}}

grep2904=grep("Revisar",datostfg2[,46])
datostfg2[grep2904,50]
datostfg2[grep2904,46]="1"

datostfg2[c(2676,3877,5871,5919,6123),50]
datostfg2[c(2676,3877,5871,5919,6123),46]="0"
```

```{r,include=TRUE}
####Variable 47(Lesión.actual.) y 51(txt_lesion_actual)
####Si el paciente presenta alguna lesión en el momento de la consulta la variable numérica debe presentar un 1,en caso contrario presentará un 0.


table(datostfg2[,47]) 
datostfg2[6272,60]=datostfg[6272,47]
datostfg2[6272,64]=datostfg[6272,51]
datostfg2[706,51]=datostfg[706,50]
datostfg2[706,47]=datostfg[706,46]
datostfg2[7141,51]=datostfg[7141,50]
datostfg2[7141,47]=datostfg[7141,46]
datostfg2[6272,47]=NA
datostfg2[6272,51]=NA
 ###Seleccionamos aquellos casos en la variable LesionActual que tengan un 1 asignado,es decir,los éxitos.Al igual que en la variable anterior hay fallos.
grep1LesionAct=grep("1",datostfg2[,47])
datostfg2[grep1LesionAct,51]
grep758=grep("^No",datostfg2[,51])
datostfg2[grep758,51] ###Casos 526 lo consideramos como un no,274,878,525,967 no hay que eliminarlos ya que representan lesiones.
datostfg2[grep758[c(526)],51]
datostfg2[grep758[c(526)],47] ###Hay que cambiarlo por un cero
datostfg2[grep758[c(274,525,878,967)],51]
datostfg2[grep758[c(274,525,878,967)],47] ####Ya presentan 1
datostfg2[grep758[1001:2000],51]###Estudiar 1325,1903
datostfg2[grep758[c(1325)],51] 
datostfg2[grep758[c(1903)],51] ####Lesiones
datostfg2[grep758[c(1325,1903)],47] ###Ya presentan 1
datostfg2[grep758[2001:3000],51]###2276 
datostfg2[grep758[c(2276)],51]  ###No eliminarlo
datostfg2[grep758[c(2276)],47] ###Ya presentan 1
datostfg2[grep758[3001:3796],51] 
datostfg2[grep758[c(3024,3120,3620)],51]  ###No eliminar
datostfg2[grep758[c(3024,3120,3620)],47] ####3620 Usuario de silla de ruedas presenta un 0,el resto un 1
datostfg2[grep758[c(299,2528)],51] ####Estudiar estos casos
datostfg2[grep758[c(299)],53]
datostfg2[grep758[c(2528)],68]
datostfg2[grep758[c(2528)],69]="Dificultad para la nutrición y suplementación durante la competición"
grep758=grep758[-c(274,525,878,967,1325,1903,2276,3024,3120,3620)]
grep759=grep("^no",datostfg2[,51])
datostfg2[grep759,51]
grep760=grep("^NO",datostfg2[,51])
datostfg2[grep760,51]
datostfg2[grep760[c(30)],51]
datostfg2[grep760[c(30)],47] ###Ya presenta un 1
grep760=grep760[-c(30)]
grep761=grep("NR",datostfg2[,51])
datostfg2[grep761,51]
grep762=grep("^N.R",datostfg2[,51])
grep762=grep("^Ni",datostfg2[,51])
grep762=grep("^NI",datostfg2[,51])
grep762=grep("^ni",datostfg2[,51])
grep762=grep("^SIN",datostfg2[,51])
grep762=grep("^sin",datostfg2[,51])
datostfg2[grep762,51] ###No considerar
datostfg2[grep762,47] ###Ya presenta un 1
grep762=grep("^Sin",datostfg2[,51])
datostfg2[grep762,51]
datostfg2[grep762[c(1,2)],51]
datostfg2[grep762[c(1,2)],47]
grep762=grep762[c(3)]
datostfg2[grep762,51]
datostfg2[grep762,47] ###Hay que cambiarlo por un cero
datostfg2[grep762,50]  ####No eliminar,existe la dolencia por el acortamiento del aquiles



datostfg2[,47]=replace(datostfg2[,47],grep758,"0")
datostfg2[,47]=replace(datostfg2[,47],grep759,"0")
datostfg2[,47]=replace(datostfg2[,47],grep760,"0")
datostfg2[,47]=replace(datostfg2[,47],grep761,"0")
datostfg2[,47]=replace(datostfg2[,47],grep762,"0")

table(datostfg2[,47]) 

###Hay casos que presentan un 1 y después observamos "NA" en la variable de texto,estos casos hay que corregirlos también porque representan un 0 realmente.

###Bucle
for (i in 1:11984){comp=(
  is.na(datostfg2[i,51])==TRUE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,47]="0"
}else{
        datostfg2[i,47]=datostfg2[i,47]
}}
####Revisar los 1's
grep1LesionAct=grep("1",datostfg2[,47])
datostfg2[grep1LesionAct,51]
datostfg2[grep1LesionAct[1001:1111],51]
#####Hay errores en 42,209,320,492,522,794,802, vamos a estudiar 198
datostfg2[grep1LesionAct[c(198)],51]
datostfg2[grep1LesionAct[c(198)],50] ###Se refiere a la microrotura,no eliminar
datostfg2[grep1LesionAct[c(42,209,320,489,493,523,795,803)],51] ####Errores
datostfg2[grep1LesionAct[c(42,209,320,489,493,523,795,803)],47]="0"
grep2683=grep("0",datostfg2[,47])
table(datostfg2[grep2683,51])

table(datostfg2[,47])

grep2684=grep("Bursi",datostfg2[,51])
datostfg2[grep2684,51]
datostfg2[grep2684,47]
datostfg2[grep2684,47]="1"
grep2684=grep("calci",datostfg2[,51])
datostfg2[grep2684,51]
datostfg2[grep2684,47]
datostfg2[grep2684,47]="1"
grep2684=grep("Contrac",datostfg2[,51])
datostfg2[grep2684,51]
datostfg2[grep2684,47]
datostfg2[grep2684,47]="1"
grep2684=grep("Contu",datostfg2[,51])
datostfg2[grep2684,51]
datostfg2[grep2684,47]
datostfg2[grep2684,47]="1"
grep2684=grep("Epicond",datostfg2[,51])
datostfg2[grep2684,51]
datostfg2[grep2684,47]
datostfg2[grep2684,47]="1"
grep2684=grep("Dolor",datostfg2[,51])
datostfg2[grep2684,51]
datostfg2[grep2684,47]
datostfg2[grep2684,47]="1"
grep2684=grep("dolor",datostfg2[,51])
datostfg2[grep2684,51]
datostfg2[grep2684,47]
datostfg2[grep2684,47]="1"
grep2684=grep("Erosion",datostfg2[,51])
datostfg2[grep2684,51]
datostfg2[grep2684,47]
datostfg2[grep2684,47]="1"
grep2684=grep("Fatiga",datostfg2[,51])
datostfg2[grep2684,51]
datostfg2[grep2684,47]
datostfg2[grep2684,47]="1"
grep2684=grep("Frac",datostfg2[,51])
datostfg2[grep2684,51]
datostfg2[grep2684,47]
datostfg2[grep2684,47]="1"
grep2684=grep("Gonalgia",datostfg2[,51])
datostfg2[grep2684,51]
datostfg2[grep2684,47]
datostfg2[grep2684,47]="1"
grep2684=grep("gonalgia",datostfg2[,51])
datostfg2[grep2684,51]
datostfg2[grep2684,47]
datostfg2[grep2684,47]="1"
grep2684=grep("Hema",datostfg2[,51])
datostfg2[grep2684,51]
datostfg2[grep2684,47]
datostfg2[grep2684,47]="1"
grep2684=grep("Hernia",datostfg2[,51])
datostfg2[grep2684,51]
datostfg2[grep2684,47]
datostfg2[grep2684,47]="1"
grep2684=grep("Inesta",datostfg2[,51])
datostfg2[grep2684,51]
datostfg2[grep2684,47]
datostfg2[grep2684,47]="1"
grep2684=grep("Inflama",datostfg2[,51])
datostfg2[grep2684,51]
datostfg2[grep2684,47]
datostfg2[grep2684,47]="1"
grep2684=grep("Lesi",datostfg2[,51])
datostfg2[grep2684,51]
datostfg2[grep2684,47]
datostfg2[grep2684,47]="1"
grep2684=grep("Lum",datostfg2[,51])
datostfg2[grep2684,51]
datostfg2[grep2684,47]
datostfg2[grep2684,47]="1"
grep2684=grep("esg",datostfg2[,51])
datostfg2[grep2684,51]
datostfg2[grep2684,47]
datostfg2[grep2684,47]="1"
grep2684=grep("Molestia",datostfg2[,51])
datostfg2[grep2684,51]
datostfg2[grep2684,47]
datostfg2[grep2684,47]="1"
grep2684=grep("referencia",datostfg2[,51])
datostfg2[grep2684,51]
datostfg2[grep2684,47]
datostfg2[grep2684,47]="1"
grep2684=grep("silla",datostfg2[,51])
datostfg2[grep2684,51]
datostfg2[grep2684,47]
datostfg2[grep2684,47]="1"
grep2684=grep("menis",datostfg2[,51])
datostfg2[grep2684,51]
datostfg2[grep2684,47]
datostfg2[grep2684,47]="1"
grep2684=grep("perios",datostfg2[,51])
datostfg2[grep2684,51]
datostfg2[grep2684,47]
datostfg2[grep2684,47]="1"
grep2684=grep("Rotura",datostfg2[,51])
datostfg2[grep2684,51]
datostfg2[grep2684,47]
datostfg2[grep2684,47]="1"
grep2684=grep("Sacro",datostfg2[,51])
datostfg2[grep2684,51]
datostfg2[grep2684,47]
datostfg2[grep2684,47]="1"
grep2684=grep("sobre",datostfg2[,51])
datostfg2[grep2684,51]
datostfg2[grep2684,47]
datostfg2[grep2684,47]="1"
grep2684=grep("Tendi",datostfg2[,51])
datostfg2[grep2684,51]
datostfg2[grep2684,47]
datostfg2[grep2684,47]="1"
grep2684=grep("tendi",datostfg2[,51])
datostfg2[grep2684,51]
datostfg2[grep2684,47]
datostfg2[grep2684,47]="1"
grep2684=grep("Tensor",datostfg2[,51])
datostfg2[grep2684,51]
datostfg2[grep2684,47]
datostfg2[grep2684,47]="1"
grep2684=grep("Trauma",datostfg2[,51])
datostfg2[grep2684,51]
datostfg2[grep2684,47]
datostfg2[grep2684,47]="1"
grep2684=grep("Sobre",datostfg2[,51])
datostfg2[grep2684,51]
datostfg2[grep2684,47]
datostfg2[grep2684,47]="1"
grep2684=grep("sobra",datostfg2[,51])
datostfg2[grep2684,51]
datostfg2[grep2684,47]
datostfg2[grep2684,47]="1"
grep2684=grep("GONAL",datostfg2[,51])
datostfg2[grep2684,51]
datostfg2[grep2684,47]
datostfg2[grep2684,47]="1"
grep2684=grep("tto por fisios",datostfg2[,51])
datostfg2[grep2684,51]
datostfg2[grep2684,47]
datostfg2[grep2684,47]="1"
grep2684=grep("alza",datostfg2[,51])
datostfg2[grep2684,51]
datostfg2[grep2684,47]
datostfg2[grep2684,47]="1"
grep2683=grep("0",datostfg2[,47])
table(datostfg2[grep2683,51])
grep2685=grep("^Vent",datostfg2[,51])
datostfg2[grep2685,51]
datostfg2[grep2685,47]
datostfg2[grep2685,42]=datostfg2[grep2685,51]
datostfg2[grep2685,35]="1"
####Ya hemos solucionado las incongruencias.

table(datostfg2[,47])
for (i in 1:11984){comp=(is.na(datostfg2[i,47])==TRUE&&
  is.na(datostfg2[i,51])==FALSE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,47]="Revisar"
}else{
        datostfg2[i,47]=datostfg2[i,47]
}}

grep2904=grep("Revisar",datostfg2[,47])
datostfg2[grep2904,51]
datostfg2[grep2904[c(1)],50]=datostfg2[grep2904[c(1)],51]
datostfg2[grep2904[c(1)],46]="1"
datostfg2[grep2904[c(1)],47]="0"
datostfg2[grep2904[c(2)],47]="1"

datostfg2[c(2676,3877,5871,5919,6123),51]
datostfg2[c(2676,3877,5871,5919,6123),47]="0"
```

```{r,include=TRUE}
####Variable 52,53,54 
 
datostfg2[6272,65]=datostfg[6272,52]
datostfg2[6272,66]=datostfg[6272,53]
datostfg2[6272,67]=datostfg[6272,54]
datostfg2[706,52]=datostfg[706,51]
datostfg2[7141,52]=datostfg[7141,51]
datostfg2[706,53]=datostfg[706,52]
datostfg2[7141,53]=datostfg[7141,52]
datostfg2[706,54]=datostfg[706,53]
datostfg2[7141,54]=datostfg[7141,53]
###Bucle
for (i in 1:11984){comp=(
  is.na(datostfg2[i,53])==TRUE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,53]="Compl"
}else{
        datostfg2[i,53]=datostfg2[i,53]
}}
table(datostfg2[,53])
grepCopl=grep("Compl",datostfg2[,53])
datostfg2[grepCopl,37] #####Hay muchas registros incompletos.


datostfg2[c(2676,3877,5871,5919,6123),55] ####Casos con fallos
datostfg2[c(2676,3877,5871,5919,6123),55]=NA
table(datostfg2[,55]) 

```

```{r,include=TRUE}
####Variable 55 (MotivoConsulta_txt)
table(datostfg2[,55]) 
datostfg2[6272,68]=datostfg[6272,55]
datostfg2[706,55]=datostfg[706,54]
datostfg2[7141,55]=datostfg[7141,54]
datostfg2[c(2676,3877,5871,5919,6123),55] ####Casos con fallos
datostfg2[c(2676,3877,5871,5919,6123),55]=NA
table(datostfg2[,55]) 

```

```{r,include=TRUE}
####Variable 57(Consumo.de.Tabaco),58(ConsTab_tab),59(cigdia_num)
####Tabaco
table(datostfg2[,58]) 
datostfg2[6272,71]=datostfg[6272,58] 
datostfg2[6272,70]=datostfg[6272,57]
datostfg2[6272,72]=datostfg[6272,59]


table(datostfg2[,58]) 


table(datostfg2[,57])
####Hay errores en la recogida de datos en los casos 706 y 7141.En estos casos hay que desplazar las columnas una posición.
datostfg2[c(706,7141),57]=datostfg[c(706,7141),56]
datostfg2[c(706,7141),58]=datostfg[c(706,7141),57]
datostfg2[c(706,7141),59]=datostfg[c(706,7141),58]

table(datostfg2[,57]) 
table(datostfg2[,59]) 
grep763=grep("^0",datostfg2[,59])
datostfg2[grep763,57]
datostfg2[grep763,59] ####Se trata de un error
datostfg2[grep763,57]="0"
datostfg2[grep763,59]=NA
grep1Tabaco=grep("1",datostfg2[,57])
datostfg2[grep1Tabaco,58]
grep1TabacoFallos=grep("No",datostfg2[,58])
datostfg2[,57]=replace(datostfg2[,57],grep1TabacoFallos,"0")
grep1Tabaco=grep("1",datostfg2[,57])
datostfg2[grep1Tabaco,58] ###Hay NA's

###Bucle
for (i in 1:11984){comp=(
  is.na(datostfg2[i,58])==TRUE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,57]="0"
}else{
        datostfg2[i,57]=datostfg2[i,57]
}}
table(datostfg2[,57])
grep1Tabaco=grep("1",datostfg2[,57])
datostfg2[grep1Tabaco,59]
####Con este bucle hemos eliminado más información de la necesaria,vamos a recuperarla.
###Bucle
for (i in 1:11984){comp=(
  is.na(datostfg2[i,59])==FALSE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,57]="1"
}else{
        datostfg2[i,57]=datostfg2[i,57]
}}
grep1Tabaco=grep("1",datostfg2[,57])
datostfg2[grep1Tabaco,59]
####Ya hemos recuperado la información que queriamos
grep1Tabaco=grep("1",datostfg2[,59])
datostfg2[grep1Tabaco,59]
datostfg2[grep1Tabaco[c(3,9,10,12,16,24,26,35,37,43)],59]
datostfg2[grep1Tabaco[c(3,9,10,12,16,24,26,35,37,43)],58]
datostfg2[grep1Tabaco[c(3)],58]="Ocasional"
grep10Tabaco=grep("10",datostfg2[,59])
datostfg2[grep10Tabaco,58]
datostfg2[grep10Tabaco,58]="Moderado"
grep11Tabaco=grep("11",datostfg2[,59])
datostfg2[grep11Tabaco,58]
grep12Tabaco=grep("12",datostfg2[,59])
datostfg2[grep12Tabaco,58]
grep20Tabaco=grep("20",datostfg2[,59])
datostfg2[grep20Tabaco,58] #######La categoría más repetida es Importante,además 20 cigarillos al día está muy por encima de la media española entre 2017-2019
datostfg2[grep20Tabaco,58]="Importante"
grep15Tabaco=grep("15",datostfg2[,59])
datostfg2[grep15Tabaco,58] 
datostfg2[grep15Tabaco,58]="Importante" ####Está por encima de la media
grep2Tabaco=grep("2",datostfg2[,59])
datostfg2[grep2Tabaco,59]
datostfg2[grep2Tabaco[c(2,5,8,10,11,15,16,17,18)],59]
datostfg2[grep2Tabaco[c(2,5,8,10,11,15,16,17,18)],58]
datostfg2[grep2Tabaco[c(2,5,8,10,11,15,16,17,18)],58]="Ocasional"
grep3Tabaco=grep("3",datostfg2[,59])
datostfg2[grep3Tabaco,58] ####Hay 9 casos con Moderado y 8 con Ocasional,los considero todos Moderado
datostfg2[grep3Tabaco,58]="Moderado"
grep35Tabaco=grep("3.5",datostfg2[,59])
datostfg2[grep35Tabaco,58] 
datostfg2[grep35Tabaco,58]="Moderado"
grep4Tabaco=grep("4",datostfg2[,59])
datostfg2[grep4Tabaco,58] 
datostfg2[grep4Tabaco,58]="Moderado"
grep5Tabaco=grep("5",datostfg2[,59])
datostfg2[grep5Tabaco,58] ###La categoría más repetida es Moderado
datostfg2[grep5Tabaco,58]="Moderado"
grep6Tabaco=grep("6",datostfg2[,59])
datostfg2[grep6Tabaco,58] ###La categoría más repetida es Moderado
datostfg2[grep6Tabaco,58]="Moderado"
grep77Tabaco=grep("77",datostfg2[,59])
datostfg2[grep77Tabaco,58] ####Este caso presenta múltiples fallos desde la variable 16
datostfg2[grep77Tabaco,57]=NA
datostfg2[grep77Tabaco,59]=NA
grep7Tabaco=grep("7",datostfg2[,59])
datostfg2[grep7Tabaco,58]
datostfg2[grep7Tabaco,58]="Moderado"
grep8Tabaco=grep("8",datostfg2[,59])
datostfg2[grep8Tabaco,58]
datostfg2[grep8Tabaco,58]="Moderado"
grep9Tabaco=grep("9",datostfg2[,59])
datostfg2[grep9Tabaco,58]
datostfg2[grep9Tabaco,58]="Moderado"


datostfg2[grepEstudiar[-c(4,55,62,130,165,170,245,246,247,248)],57]="0"
datostfg2[grepEstudiar[c(4,55,62,130,165,170,245,246,247,248)],37] 
datostfg2[grepEstudiar[c(4,165,170,245,246,247,248)],37]###No tienen hábitos tóxicos
datostfg2[grepEstudiar[c(4,165,170,245,246,247,248)],57] ####Deben ser todos 0
datostfg2[grepEstudiar[c(4,165,170,245,246,247,248)],57]="0"
datostfg2[grepEstudiar[c(1,2,3,195,242,243)],37] ###Exfumadores
datostfg2[grepEstudiar[c(1,2,3,195,242,243)],57] ####Ya presentan un 1,no hay que cambiar nada

```

```{r,include=TRUE}
####Variable 60(Consumo.de.Alcohol),61(ConsAlc_tab)
####Alcohol
table(datostfg2[,60])
table(datostfg2[,61]) 
datostfg2[6272,73]=datostfg[6272,60] 
datostfg2[6272,74]=datostfg[6272,61]
datostfg2[c(706,7141),60]=datostfg[c(706,7141),59]
datostfg2[c(706,7141),61]=datostfg[c(706,7141),60]

grep1Alc=grep("1",datostfg2[,60])
datostfg2[grep1Alc,61] ###Hay fallos
grep768=grep("No",datostfg2[,61])
datostfg2[,60]=replace(datostfg2[,60],grep768,"0")
grep1Alc=grep("1",datostfg2[,60])
datostfg2[grep1Alc,61] ####Hay NA´s
#Bucle
for (i in 1:11984){comp=(
  is.na(datostfg2[i,61])==TRUE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,60]="0"
}else{
        datostfg2[i,60]=datostfg2[i,60]
}}
grep1Alc=grep("1",datostfg2[,60])
datostfg2[grep1Alc,61]
datostfg2[grep1Alc[1000:1989],61]
grep0Alc=grep("0",datostfg2[,60])
datostfg2[grep0Alc,61] ####Hay fallos
#Bucle
for (i in 1:11984){comp=(
  is.na(datostfg2[i,61])==FALSE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,60]="1"
}else{
        datostfg2[i,60]=datostfg2[i,60]
}}
grep1Alc=grep("1",datostfg2[,60])
grep0Alc=grep("0",datostfg2[,60])
datostfg2[grep0Alc,61]

table(datostfg2[,60])
datostfg2[grepEstudiar[c(5,6,7,8,9,11,12,16,18,19,21,23,24,25,27,28,29,31,32,36,37,38,40,42,43,45,46,47,48,49,50,51,52,54,57,58,59,60,61,63,64,65,66,67,68,69,76,77,78,80,83,84,87,89,90,94,96,97,99,100,102,103,104,105,106,107,108,110,111,112,113,114,115,116,117,118,119,120,122,123,124,127,128,132,133,134,136,137,138,139,140,143,144,145,150,151,153,154,156,157,166,171,172,173,176,177,178,179,181,182,184,185,186,189,190,193,195,196,199,203,204,205,206,207,209,211,212,215,216,218,219.221,222,223,224,227,228,229,231,232,236,237,240,241)],60]####Todos deben ser 1

datostfg2[grepEstudiar[c(5,6,7,8,9,11,12,16,18,19,21,23,24,25,27,28,29,31,32,36,37,38,40,42,43,45,46,47,48,49,50,51,52,54,57,58,59,60,61,63,64,65,66,67,68,69,76,77,78,80,83,84,87,89,90,94,96,97,99,100,102,103,104,105,106,107,108,110,111,112,113,114,115,116,117,118,119,120,122,123,124,127,128,132,133,134,136,137,138,139,140,143,144,145,150,151,153,154,156,157,166,171,172,173,176,177,178,179,181,182,184,185,186,189,190,193,195,196,199,203,204,205,206,207,209,211,212,215,216,218,219.221,222,223,224,227,228,229,231,232,236,237,240,241)],60]="1"

```

```{r,include=TRUE}
####Variable 56(Consumo.Drogas),62(Gramodia_num),63(ConsDroga_tab)
####Drogas
table(datostfg2[,56]) 
table(datostfg2[,63]) 
datostfg2[6272,69]=datostfg[6272,56] 
datostfg2[6272,75]=datostfg[6272,62]
datostfg2[6272,76]=datostfg[6272,63]
datostfg2[c(706,7141),56]=datostfg[c(706,7141),55]
datostfg2[c(706,7141),62]=datostfg[c(706,7141),61]
datostfg2[c(706,7141),63]=datostfg[c(706,7141),62]
table(datostfg2[,56]) 
table(datostfg2[,63]) 

grep1Dr=grep("1",datostfg2[,56])
datostfg2[grep1Dr,63] ####Hay muchos fallos
grep775=grep("No",datostfg2[,63])
datostfg2[,56]=replace(datostfg2[,56],grep775,"0")
table(datostfg2[,56])
grep1Dr=grep("1",datostfg2[,56])
datostfg2[grep1Dr,63]
####Tambien hay que cambiar los casos que presentan NA
###Bucle
for (i in 1:11984){comp=(
  is.na(datostfg2[i,63])==TRUE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,56]="0"
}else{
        datostfg2[i,56]=datostfg2[i,56]
}}
grep1Dr=grep("1",datostfg2[,56])
datostfg2[grep1Dr,63]

table(datostfg2[,62])
grep769=grep("0",datostfg2[,62])
datostfg2[grep769,63] ###A pesar de que no consume el médico lo registra
datostfg2[grep769,62]=NA 
grep771=grep("8",datostfg2[,62])
datostfg2[grep771,63]
datostfg2[grep771,56]
datostfg2[grep771[c(1)],62]=NA ####Hay errores en la recogida de datos del paciente 597
###Ya corregimos tambien su registro de cig/dia
datostfg2[grep771[c(2)],62]=NA ####También se trata de un error
###No considerar la variable 62

table(datostfg2[,63])
grep772=grep("Coca",datostfg2[,63])
datostfg2[grep772,56]
datostfg2[grep772,62] ###No especifica cantidad
grep773=grep("Mari",datostfg2[,63])
datostfg2[grep773,63]
datostfg2[grep773,56] ###Hay dos errores,los substituyo por 1
datostfg2[grep773,56]="1"
datostfg2[grep773,62] ###No especifica cantidad
grep774=grep("1",datostfg2[,63])
table(datostfg2[,56])



####Ya hemos solucionado los errores
```

```{r,include=TRUE}
####Variable 64(Ant..Traumatológicos),65(AntTrauma_txt)

####Si el paciente presenta algún antecedente traumatológico la variable numérica debe presentar un 1,en caso contrario presentará un 0.

####Antecedentes Traumatológicos
table(datostfg2[,64])####Hay errores
grep778=grep("^No",datostfg2[,65])
datostfg2[grep778,65]
datostfg2[grep778[1001:1499],65]
grep778_=grep778[c(18,59,63,64,85,102,126,139,163,165,170,210,255,277,289,307,388,403,468,504,559,590,596,601,609,630,640,666,689,712,791,795,799,805,847,934,946,1036,1078,1089,1137,1169,1174,1180,1187,1192,1197,1305,1335,1341,1361,1412,1413,1440,1454)]
                 
datostfg2[grep778[c(847)],65]
datostfg2[grep778[c(847)],70]="1"
datostfg2[grep778[c(847)],71]="0"
datostfg2[grep778[c(847)],72]="7.5"
datostfg2[grep778[c(847)],73]

datostfg2[grep778[c(18,59,63,64,85,102,126,139,163,165,170,210,255,277,289,307,388,403,468,504,559,590,596,601,609,630,640,666,689,712,791,795,799,805,847,934,946,1036,1078,1089,1137,1169,1174,1180,1187,1192,1197,1305,1335,1341,1361,1412,1413,1440,1454)],65]

datostfg2[grep778_,65] ####Estos casos no hay que eliminarlos
datostfg2[grep778_,64]="1"
datostfg2[grep778_[c(25,51)],65]
grep778=grep778[-c(18,59,63,64,85,102,126,139,163,165,170,210,255,277,289,307,388,403,468,504,559,590,596,601,609,630,640,666,689,712,791,795,799,805,847,934,946,1036,1078,1089,1137,1169,1174,1180,1187,1192,1197,1305,1335,1341,1361,1412,1413,1440,1454)]
grep779=grep("^no",datostfg2[,65])
datostfg2[grep779,65] 
grep780=grep("^NO",datostfg2[,65])
datostfg2[grep780,65]
grep780_=grep780[c(1,2,96,120,125,139)] ####No eliminar estos
datostfg2[grep780_,64] ###Ya presentan 1's
grep780=grep780[-c(1,2,96,120,125,139)]
grep781=grep("NR",datostfg2[,65])
datostfg2[grep781,65]
grep782=grep("^N.R",datostfg2[,65])
datostfg2[grep782,65]
grep783=grep("^Ni",datostfg2[,65])
grep783=grep("^NI",datostfg2[,65])
grep783=grep("^ni",datostfg2[,65])
grep783=grep("^SIN",datostfg2[,65])
grep783=grep("^sin",datostfg2[,65])
grep783=grep("^Sin",datostfg2[,65])
datostfg2[grep783,65]
grep783=grep783[c(1,2)]

####Corregimos los fallos por desplazamientos de columnas


datostfg2[,64]=replace(datostfg2[,64],grep778,"0")
datostfg2[,64]=replace(datostfg2[,64],grep779,"0")
datostfg2[,64]=replace(datostfg2[,64],grep780,"0")
datostfg2[,64]=replace(datostfg2[,64],grep781,"0")
datostfg2[,64]=replace(datostfg2[,64],grep782,"0")
datostfg2[,64]=replace(datostfg2[,64],grep783,"0")

grep1Trauma=grep("1",datostfg2[,64])
datostfg2[grep1Trauma,65]
datostfg2[grep1Trauma[1001:2000],65]
datostfg2[grep1Trauma[2001:3000],65]
datostfg2[grep1Trauma[3001:3507],65]
datostfg2[grep1Trauma[c(990,684,1669,1602,1591,1503,1188,1165,1020,2748,2338,2329,2275,3145)],65] ####Errores
datostfg2[grep1Trauma[c(1503)],53]####Ya está registrado
datostfg2[grep1Trauma[c(1188,2337)],57]####Ya está registrado
datostfg2[grep1Trauma[c(2748)],52]
datostfg2[grep1Trauma[c(2748)],53]####Ya está registrado
datostfg2[grep1Trauma[c(2747)],77]
datostfg2[grep1Trauma[c(2747)],77]="1" 
datostfg2[grep1Trauma[c(2747)],82]="TCE  con perdida de conciencia"
datostfg2[grep1Trauma[c(642)],65]
datostfg2[grep1Trauma[c(642)],78]
datostfg2[grep1Trauma[c(642)],83]
datostfg2[grep1Trauma[c(990,684,1669,1602,1591,1503,1188,1165,1020,2748,2338,2329,2275,3145)],64]="0"
###Vamos a eliminar los NA's
for (i in 1:11984){comp=(
  is.na(datostfg2[i,65])==TRUE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,64]="0"
}else{
        datostfg2[i,64]=datostfg2[i,64]
}}

grep1Trauma=grep("1",datostfg2[,64])
datostfg2[grep1Trauma,65]
table(datostfg2[,64])
grep2690=grep("0",datostfg2[,64])
table(datostfg2[grep2690,65])

grep2691=grep("1991",datostfg2[,65])
datostfg2[grep2691,65]
datostfg2[grep2691,64]
datostfg2[grep2691,64]="1"
grep2691=grep("^1977",datostfg2[,65])
datostfg2[grep2691,65]
datostfg2[grep2691,64]
datostfg2[grep2691,64]="1"
grep2691=grep("metacar",datostfg2[,65])
datostfg2[grep2691,65]
datostfg2[grep2691,64]
datostfg2[grep2691,64]="1"
grep2691=grep("Acci",datostfg2[,65])
datostfg2[grep2691,65]
datostfg2[grep2691,64]
datostfg2[grep2691,64]="1"
grep2691=grep("acci",datostfg2[,65])
datostfg2[grep2691,65]
datostfg2[grep2691,64]
datostfg2[grep2691,64]="1"
grep2691=grep("acudio",datostfg2[,65])
datostfg2[grep2691,65]
datostfg2[grep2691,64]
datostfg2[grep2691,64]="1"
grep2691=grep("Arranca",datostfg2[,65])
datostfg2[grep2691,65]
datostfg2[grep2691,64]
datostfg2[grep2691,64]="1"
grep2691=grep("atraco",datostfg2[,65])
datostfg2[grep2691,65]
datostfg2[grep2691,64]
datostfg2[grep2691,64]="1"
grep2691=grep("Fx",datostfg2[,65])
datostfg2[grep2691,65]
datostfg2[grep2691,64]
datostfg2[grep2691,64]="1"
grep2691=grep("Contu",datostfg2[,65])
datostfg2[grep2691,65]
datostfg2[grep2691,64]
datostfg2[grep2691,64]="1"
grep2691=grep("Desgarro",datostfg2[,65])
datostfg2[grep2691,65]
datostfg2[grep2691,64]
datostfg2[grep2691,64]="1"
grep2691=grep("femoral",datostfg2[,65])
datostfg2[grep2691,65]
datostfg2[grep2691,64]
datostfg2[grep2691,64]="1"
grep2691=grep("desvia",datostfg2[,65])
datostfg2[grep2691,65]
datostfg2[grep2691,64]
datostfg2[grep2691,64]="1"
grep2691=grep("Disme",datostfg2[,65])
datostfg2[grep2691,65]
datostfg2[grep2691,64]
datostfg2[grep2691,64]="1"
grep2691=grep("disme",datostfg2[,65])
datostfg2[grep2691,65]
datostfg2[grep2691,64]
datostfg2[grep2691[c(131)],64]="1"
grep2691=grep("Dolor",datostfg2[,65])
datostfg2[grep2691,65]
datostfg2[grep2691,64]
datostfg2[grep2691,64]="1"
grep2691=grep("entors",datostfg2[,65])
datostfg2[grep2691,65]
datostfg2[grep2691,64]
datostfg2[grep2691,64]="1"
grep2691=grep("Epi",datostfg2[,65])
datostfg2[grep2691,65]
datostfg2[grep2691,64]
datostfg2[grep2691,64]="1"
grep2691=grep("Escol",datostfg2[,65])
datostfg2[grep2691,65]
datostfg2[grep2691,64]
datostfg2[grep2691,64]="1"
grep2691=grep("Esg",datostfg2[,65])
datostfg2[grep2691,65]
datostfg2[grep2691,64]
datostfg2[grep2691,64]="1"
grep2691=grep("falange",datostfg2[,65])
datostfg2[grep2691,65]
datostfg2[grep2691,64]
datostfg2[grep2691,64]="1"
grep2691=grep("fisura",datostfg2[,65])
datostfg2[grep2691,65]
datostfg2[grep2691,64]
datostfg2[grep2691,64]="1"
grep2691=grep("Fisura",datostfg2[,65])
datostfg2[grep2691,65]
datostfg2[grep2691,64]
datostfg2[grep2691,64]="1"
grep2691=grep("frac",datostfg2[,65])
datostfg2[grep2691,65]
datostfg2[grep2691,64]
datostfg2[grep2691[c(97)],64]="1"
grep2691=grep("Fr",datostfg2[,65])
datostfg2[grep2691,65]
datostfg2[grep2691,64]
datostfg2[grep2691,64]="1"
grep2691=grep("Hallux",datostfg2[,65])
datostfg2[grep2691,65]
datostfg2[grep2691,64]
datostfg2[grep2691,64]="1"
grep2691=grep("Herida",datostfg2[,65])
datostfg2[grep2691,65]
datostfg2[grep2691,64]
datostfg2[grep2691,64]="1"
grep2691=grep("Lati",datostfg2[,65])
datostfg2[grep2691,65]
datostfg2[grep2691,64]
datostfg2[grep2691,64]="1"
grep2691=grep("Leve",datostfg2[,65])
datostfg2[grep2691,65]
datostfg2[grep2691,64]
datostfg2[grep2691,64]="1"
grep2691=grep("Lesi",datostfg2[,65])
datostfg2[grep2691,65]
datostfg2[grep2691,64]
datostfg2[grep2691,64]="1"
grep2691=grep("luxa",datostfg2[,65])
datostfg2[grep2691,65]
datostfg2[grep2691,64]
datostfg2[grep2691,64]="1"
grep2691=grep("laxo",datostfg2[,65])
datostfg2[grep2691,65]
datostfg2[grep2691,64]
datostfg2[grep2691,50]
datostfg2[grep2691,64]="1"
grep2691=grep("^Ortesis",datostfg2[,65])
datostfg2[grep2691,65]
datostfg2[grep2691,64]
datostfg2[grep2691,64]="1"
grep2691=grep("^Paraple",datostfg2[,65])
datostfg2[grep2691,65]
datostfg2[grep2691,64]
datostfg2[grep2691,64]="1"
grep2691=grep("^Pies",datostfg2[,65])
datostfg2[grep2691,65]
datostfg2[grep2691,64]
datostfg2[grep2691,64]="1"
grep2691=grep("^Protu",datostfg2[,65])
datostfg2[grep2691,65]
datostfg2[grep2691,64]
datostfg2[grep2691,64]="1"
grep2691=grep("^Planti",datostfg2[,65])
datostfg2[grep2691,65]
datostfg2[grep2691,64]
datostfg2[grep2691,64]="1"
grep2691=grep("bipartita",datostfg2[,65])
datostfg2[grep2691,65]
datostfg2[grep2691,64]
datostfg2[grep2691,64]="1"
grep2691=grep("Rota",datostfg2[,65])
datostfg2[grep2691,65]
datostfg2[grep2691,64]
datostfg2[grep2691,64]="1"
grep2691=grep("TCE",datostfg2[,65])
datostfg2[grep2691,65]
datostfg2[grep2691,64]
datostfg2[grep2691,64]="1"
grep2691=grep("coche",datostfg2[,65])
datostfg2[grep2691,65]
datostfg2[grep2691,64]
datostfg2[grep2691,64]="1"
grep2691=grep("TRa",datostfg2[,65])
datostfg2[grep2691,65]
datostfg2[grep2691,64]
datostfg2[grep2691,64]="1"
grep2691=grep("zapato corrector",datostfg2[,65])
datostfg2[grep2691,65]
datostfg2[grep2691,64]
datostfg2[grep2691,64]="1"
grep2691=grep("lumba",datostfg2[,65])
datostfg2[grep2691,65]
datostfg2[grep2691,64]
datostfg2[grep2691,64]="1"
grep2691=grep("Trauma",datostfg2[,65])
datostfg2[grep2691,65]
datostfg2[grep2691,64]
datostfg2[grep2691,64]="1"
grep2691=grep("Con plantillas",datostfg2[,65])
datostfg2[grep2691,65]
datostfg2[grep2691,64]
datostfg2[grep2691,64]="1"
grep2691=grep("^Plantillas",datostfg2[,65])
datostfg2[grep2691,65]
datostfg2[grep2691,64]
datostfg2[grep2691,64]="1"
grep2691=grep("^Hernia",datostfg2[,65])
datostfg2[grep2691,65]
datostfg2[grep2691,64]
datostfg2[grep2691,64]="1"
grep2691=grep("^Ha usado",datostfg2[,65])
datostfg2[grep2691,65]
datostfg2[grep2691,64]
datostfg2[grep2691,64]="1"
grep2691=grep("fx",datostfg2[,65])
datostfg2[grep2691,65]
datostfg2[grep2691,64]
datostfg2[grep2691,64]="1"
grep2691=grep("Dism",datostfg2[,65])
datostfg2[grep2691,65]
datostfg2[grep2691,64]
datostfg2[grep2691,64]="1"
grep2691=grep("soporte plantar infancia",datostfg2[,65])
datostfg2[grep2691,65]
datostfg2[grep2691,64]
datostfg2[grep2691,64]="1"
grep2691=grep("Sobrecarga",datostfg2[,65])
datostfg2[grep2691,65]
datostfg2[grep2691,64]
datostfg2[grep2691,64]="1"
grep2690=grep("0",datostfg2[,64])
table(datostfg2[grep2690,65])
grep2931=grep("Ciclo 10",datostfg2[,65])
datostfg2[grep2931,53]="10"
datostfg2[6272,77]=datostfg[6272,64] 
datostfg2[6272,78]=datostfg[6272,65]
datostfg2[c(706,7141),65]=datostfg[c(706,7141),64]
datostfg2[c(706,7141),64]=datostfg[c(706,7141),63]
datostfg2[706,64]="0"
table(datostfg2[,64])
####Ya hemos solucionado los errores

for (i in 1:11984){comp=(is.na(datostfg2[i,64])==TRUE&&
  is.na(datostfg2[i,65])==FALSE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,64]="Revisar"
}else{
        datostfg2[i,64]=datostfg2[i,64]
}}

grep2904=grep("Revisar",datostfg2[,64])
datostfg2[grep2904,65]
datostfg2[grep2904[c(1)],64]="0"
datostfg2[grep2904[c(2,3,4,5)],64]="1"

datostfg2[c(2676,3877,5871,5919,6123),65]
datostfg2[c(2676,3877,5871,5919,6123),64]="0"
```

```{r,include=TRUE}

####Variable 66(MotConsulta_tabcon)
table(datostfg2[,66])
datostfg2[6272,79]=datostfg[6272,66] 
datostfg2[c(706,7141),66]=datostfg[c(706,7141),65]
table(datostfg2[,66])
grep786=grep("deportivo",datostfg2[,66])
datostfg2[,66]=replace(datostfg2[,66],grep786,"Reconocimiento medico deportivo")
grep787=grep("Doctor",datostfg2[,66])
datostfg2[,66]=replace(datostfg2[,66],grep787,"Indicacion del Doctor")
table(datostfg2[,66])
```

```{r,include=TRUE}
###Variable 67 (Sin.interés...67)
table(datostfg2[,67])
datostfg2[6272,80]=datostfg[6272,67]
datostfg2[7141,67]=datostfg[7141,66]
datostfg2[706,67]=datostfg[706,66]
table(datostfg2[,67])
```

```{r,include=TRUE}
###Variable 68(Suplementos.),69 (Suplementos_txt)
####Si el paciente toma algún suplemento la variable numérica debe presentar un 1,en caso contrario presentará un 0.


table(datostfg2[,68])
datostfg2[6272,82]=datostfg[6272,69]
datostfg2[6272,81]=datostfg[6272,68]
datostfg2[7141,69]=datostfg[7141,68]
datostfg2[706,69]=datostfg[706,68]
datostfg2[7141,68]=datostfg[7141,67]
datostfg2[706,68]=datostfg[706,67]
table(datostfg2[,68])

 
grep791=grep("^No",datostfg2[,69])
datostfg2[grep791,69]###813 considerar como un si,324,como un si y 396 como un No
datostfg2[grep791[1001:2000],69] ##1939,1300 como un si,
datostfg2[grep791[2001:3000],69] ###2942,2577,2082,2790 
datostfg2[grep791[3001:3430],69] ###3242
datostfg2[grep791[c(324,396,813,1939,1300,2942,2577,2082,2790,3242)],68] ###Ya presentan 1's
grep791=grep791[-c(324,396,813,1939,1300,2942,2577,2082,2790,3242)]
grep792=grep("^no",datostfg2[,69])
datostfg2[grep792,69]
grep793=grep("^NO",datostfg2[,69])
datostfg2[grep793,69]  #####Considerar 152 como un Si
datostfg2[grep793[c(152)],69] 
datostfg2[grep793[c(152)],68] ###Ya presenta un 1
grep793=grep793[-c(152)]
grep794=grep("NR",datostfg2[,69])
grep794=grep("^N.R",datostfg2[,69])
grep794=grep("^Ni",datostfg2[,69])
datostfg2[grep794,69]
grep795=grep("^NI",datostfg2[,69])
grep795=grep("^ni",datostfg2[,69])
grep795=grep("^SIN",datostfg2[,69])
grep796=grep("^sin",datostfg2[,69])
datostfg2[grep796,69] ###Fallo de recogida de datos,vamos a eliminarlo
datostfg2[grep796,77] ###Ya presenta un 1
grep797=grep("^Sin",datostfg2[,69])

datostfg2[,68]=replace(datostfg2[,68],grep791,"0")
datostfg2[,68]=replace(datostfg2[,68],grep792,"0")
datostfg2[,68]=replace(datostfg2[,68],grep793,"0")
datostfg2[,68]=replace(datostfg2[,68],grep794,"0")
datostfg2[,68]=replace(datostfg2[,68],grep795,"0")
datostfg2[,68]=replace(datostfg2[,68],grep796,"0")


grep1Suple=grep("1",datostfg2[,68])
datostfg2[grep1Suple,69]

####Hay que eliminar los NA con un bucle
for (i in 1:11984){comp=(
  is.na(datostfg2[i,69])==TRUE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,68]="0"
}else{
        datostfg2[i,68]=datostfg2[i,68]
}}

####Hay que revisar los 1's
grep1Suple=grep("1",datostfg2[,68])
datostfg2[grep1Suple,69]
datostfg2[grep1Suple[1001:2000],69]
datostfg2[grep1Suple[2001:2624],69]
datostfg2[grep1Suple[c(902,873,700,518,503,1261,1206,1189)],69] ####Errores
datostfg2[grep1Suple[c(902,873,700,518,503,1261,1206,1189)],68]="0"
datostfg2[grep1Suple[c(503)],96]###Ya registrado
grep2692=grep("0",datostfg2[,68])
table(datostfg2[grep2692,69])

grep2693=grep("^A veces",datostfg2[,69])
datostfg2[grep2693,69]
datostfg2[grep2693,68]
datostfg2[grep2693,68]="1"
grep2693=grep("^AA",datostfg2[,69])
datostfg2[grep2693,69]
datostfg2[grep2693,68]
datostfg2[grep2693,68]="1"
grep2693=grep("^Ar",datostfg2[,69])
datostfg2[grep2693,69]
datostfg2[grep2693,68]
datostfg2[grep2693,68]="1"
grep2693=grep("^AU",datostfg2[,69])
datostfg2[grep2693,69]
datostfg2[grep2693,68]
datostfg2[grep2693,68]="1"
grep2693=grep("^Barritas",datostfg2[,69])
datostfg2[grep2693,69]
datostfg2[grep2693,68]
datostfg2[grep2693,68]="1"
grep2693=grep("bati",datostfg2[,69])
datostfg2[grep2693,69]
datostfg2[grep2693,68]
datostfg2[grep2693,68]="1"
grep2693=grep("Bati",datostfg2[,69])
datostfg2[grep2693,69]
datostfg2[grep2693,68]
datostfg2[grep2693,68]="1"
grep2693=grep("BBCA",datostfg2[,69])
datostfg2[grep2693,69]
datostfg2[grep2693,68]
datostfg2[grep2693,68]="1"
grep2693=grep("^BCA",datostfg2[,69])
datostfg2[grep2693,69]
datostfg2[grep2693,68]
datostfg2[grep2693,68]="1"
grep2693=grep("^bca",datostfg2[,69])
datostfg2[grep2693,69]
datostfg2[grep2693,68]
datostfg2[grep2693,68]="1"
grep2693=grep("C.Multi",datostfg2[,69])
datostfg2[grep2693,69]
datostfg2[grep2693,68]
datostfg2[grep2693,68]="1"
grep2693=grep("Carti",datostfg2[,69])
datostfg2[grep2693,69]
datostfg2[grep2693,68]
datostfg2[grep2693,68]="1"
grep2693=grep("col",datostfg2[,69])
datostfg2[grep2693,69]
datostfg2[grep2693,68]
datostfg2[grep2693,68]="1"
grep2693=grep("Col",datostfg2[,69])
datostfg2[grep2693,69]
datostfg2[grep2693,68]
datostfg2[grep2693,68]="1"
grep2693=grep("Complejo",datostfg2[,69])
datostfg2[grep2693,69]
datostfg2[grep2693,68]
datostfg2[grep2693,68]="1"
grep2693=grep("Condro",datostfg2[,69])
datostfg2[grep2693,69]
datostfg2[grep2693,68]
datostfg2[grep2693,68]="1"
grep2693=grep("Creati",datostfg2[,69])
datostfg2[grep2693,69]
datostfg2[grep2693,68]
datostfg2[grep2693,68]="1"
grep2693=grep("Equina",datostfg2[,69])
datostfg2[grep2693,69]
datostfg2[grep2693,68]
datostfg2[grep2693,68]="1"
grep2693=grep("Espir",datostfg2[,69])
datostfg2[grep2693,69]
datostfg2[grep2693,68]
datostfg2[grep2693,68]="1"
grep2693=grep("Fe",datostfg2[,69])
datostfg2[grep2693,69]
datostfg2[grep2693,68]
datostfg2[grep2693,68]="1"
grep2693=grep("Frutas",datostfg2[,69])
datostfg2[grep2693,69]
datostfg2[grep2693,68]
datostfg2[grep2693,68]="1"
grep2693=grep("gel",datostfg2[,69])
datostfg2[grep2693,69]
datostfg2[grep2693,68]
datostfg2[grep2693,68]="1"
grep2693=grep("Geles",datostfg2[,69])
datostfg2[grep2693,69]
datostfg2[grep2693,68]
datostfg2[grep2693,68]="1"
grep2693=grep("Germen",datostfg2[,69])
datostfg2[grep2693,69]
datostfg2[grep2693,68]
datostfg2[grep2693,68]="1"
grep2693=grep("Glu",datostfg2[,69])
datostfg2[grep2693,69]
datostfg2[grep2693,68]
datostfg2[grep2693,68]="1"
grep2693=grep("Hierro",datostfg2[,69])
datostfg2[grep2693,69]
datostfg2[grep2693,68]
datostfg2[grep2693,68]="1"
grep2693=grep("Jalea",datostfg2[,69])
datostfg2[grep2693,69]
datostfg2[grep2693,68]
datostfg2[grep2693,68]="1"
grep2693=grep("Mag",datostfg2[,69])
datostfg2[grep2693,69]
datostfg2[grep2693,68]
datostfg2[grep2693,68]="1"
grep2693=grep("^L-",datostfg2[,69])
datostfg2[grep2693,69]
datostfg2[grep2693,68]
datostfg2[grep2693,68]="1"
grep2693=grep("Medi",datostfg2[,69])
datostfg2[grep2693,69]
datostfg2[grep2693,68]
datostfg2[grep2693,68]="1"
grep2693=grep("Mela",datostfg2[,69])
datostfg2[grep2693,69]
datostfg2[grep2693,68]
datostfg2[grep2693,68]="1"
grep2693=grep("Mg",datostfg2[,69])
datostfg2[grep2693,69]
datostfg2[grep2693,68]
datostfg2[grep2693,68]="1"
grep2693=grep("mg",datostfg2[,69])
datostfg2[grep2693,69]
datostfg2[grep2693,68]
datostfg2[grep2693,68]="1"
grep2693=grep("Multi",datostfg2[,69])
datostfg2[grep2693,69]
datostfg2[grep2693,68]
datostfg2[grep2693,68]="1"
grep2693=grep("Ocasion",datostfg2[,69])
datostfg2[grep2693,69]
datostfg2[grep2693,68]
datostfg2[grep2693,68]="1"
grep2693=grep("Pentasa",datostfg2[,69])
datostfg2[grep2693,69]
datostfg2[grep2693,68]
datostfg2[grep2693,68]="1"
grep2693=grep("Poli",datostfg2[,69])
datostfg2[grep2693,69]
datostfg2[grep2693,68]
datostfg2[grep2693,68]="1"
grep2693=grep("Pharmaton",datostfg2[,69])
datostfg2[grep2693,69]
datostfg2[grep2693,68]
datostfg2[grep2693,68]="1"
grep2693=grep("Pota",datostfg2[,69])
datostfg2[grep2693,69]
datostfg2[grep2693,68]
datostfg2[grep2693,68]="1"
grep2693=grep("Prot",datostfg2[,69])
datostfg2[grep2693,69]
datostfg2[grep2693,68]
datostfg2[grep2693,68]="1"
grep2693=grep("Rec",datostfg2[,69])
datostfg2[grep2693,69]
datostfg2[grep2693,68]
datostfg2[grep2693,68]="1"
grep2693=grep("Sales",datostfg2[,69])
datostfg2[grep2693,69]
datostfg2[grep2693,68]
datostfg2[grep2693,68]="1"
grep2693=grep("creatina",datostfg2[,69])
datostfg2[grep2693,69]
datostfg2[grep2693,68]
datostfg2[grep2693,68]="1"
grep2693=grep("Supra",datostfg2[,69])
datostfg2[grep2693,69]
datostfg2[grep2693,68]
datostfg2[grep2693,68]="1"
grep2693=grep("Tardy",datostfg2[,69])
datostfg2[grep2693,69]
datostfg2[grep2693,68]
datostfg2[grep2693,68]="1"
grep2693=grep("Tendi",datostfg2[,69])
datostfg2[grep2693,69]
datostfg2[grep2693,68]
datostfg2[grep2693,68]="1"
grep2693=grep("Vit",datostfg2[,69])
datostfg2[grep2693,69]
datostfg2[grep2693,68]
datostfg2[grep2693,68]="1"
grep2693=grep("vit",datostfg2[,69])
datostfg2[grep2693,69]
datostfg2[grep2693,68]
datostfg2[grep2693,68]="1"
grep2693=grep("COMPLEJO",datostfg2[,69])
datostfg2[grep2693,69]
datostfg2[grep2693,68]
datostfg2[grep2693,68]="1"
grep2693=grep("Gels",datostfg2[,69])
datostfg2[grep2693,69]
datostfg2[grep2693,68]
datostfg2[grep2693,68]="1"
grep2692=grep("0",datostfg2[,68])
table(datostfg2[grep2692,69])
grep2694=grep("Contract",datostfg2[,69])
datostfg2[grep2694,69]
datostfg2[grep2694,68]
datostfg2[grep2694,51]###Ya registrado
grep2695=grep("Ausc",datostfg2[,69])
datostfg2[grep2695,69]
datostfg2[grep2695,68]
datostfg2[grep2695,110]###Ya registrado
grep2696=grep("sin",datostfg2[,69])
datostfg2[grep2696,69]
datostfg2[grep2696,68]
datostfg2[grep2696[c(4)],82]###No registrado
datostfg2[grep737[c(3018)],69]="Sales minerales y barritas"
datostfg2[grep737[c(3018)],68]="1"

table(datostfg2[,68])

for (i in 1:11984){comp=(is.na(datostfg2[i,68])==TRUE&&
  is.na(datostfg2[i,69])==FALSE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,68]="Revisar"
}else{
        datostfg2[i,68]=datostfg2[i,68]
}}

grep2904=grep("Revisar",datostfg2[,68])
datostfg2[grep2904,69]
datostfg2[grep2904[-c(2)],68]="1"
datostfg2[grep2904[c(2)],68]="0"
####Ya hemos solucionado los errores

datostfg2[c(2676,3877,5871,5919,6123),69]
datostfg2[c(2676,3877,5871,5919,6123),68]="0"
```

```{r,include=TRUE}
###Variable 70 (Sueño)


table(datostfg2[,70])
datostfg2[7141,70]=datostfg[7141,69]
datostfg2[706,70]=datostfg[706,69]
datostfg2[6272,83]=datostfg[6272,70]
table(datostfg2[,70])

####Variable 71 (Descanso):Descanso suplementario
table(datostfg2[,71])
datostfg2[6272,84]=datostfg[6272,71]
datostfg2[7141,71]=datostfg[7141,70]
datostfg2[706,71]=datostfg[706,70]
table(datostfg2[,71])

####Variable 72 (Sueño_num)Horas de sueño
table(datostfg2[,72])
datostfg2[6272,85]=datostfg[6272,85]
datostfg2[7141,72]=datostfg[7141,71]
datostfg2[706,72]=datostfg[706,71]
table(datostfg2[,72])
grep797=grep("1",datostfg2[,72])
datostfg2[grep797,72]
datostfg2[grep797[c(26)],72]
datostfg2[grep797[c(26)],70]
grep797[c(26)] ####No es lógico
datostfg2[grep797[c(26)],72]="0"
datostfg2[grep797[c(26)],70]="0"
grep798=grep("77",datostfg2[,72])
grep798 ####No tiene sentido,lo voy a cambiar por un 7
datostfg2[grep798,72]="7"
table(datostfg2[,72])
grepNoSueno=grep("0",datostfg2[,70])
datostfg2[grepNoSueno,72]

###Bucle
for (i in 1:11984){comp=(
  is.na(datostfg2[i,72])==FALSE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,70]="1"
}else{
        datostfg2[i,70]=datostfg2[i,70]
}}
grepNoSueno=grep("0",datostfg2[,70])
datostfg2[grepNoSueno,72]
###Bucle
for (i in 1:11984){comp=(datostfg2[i,70]=="1"&&
  is.na(datostfg2[i,72])==TRUE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,70]="0"
}else{
        datostfg2[i,70]=datostfg2[i,70]
}}

grepNoSueno=grep("0",datostfg2[,70])
datostfg2[grepNoSueno,72]

####Variable 73 (Descanso_num):Horas de descanso suplementario
table(datostfg2[,73])
datostfg2[6272,86]=datostfg[6272,73]
datostfg2[7141,73]=datostfg[7141,72]
datostfg2[706,73]=datostfg[706,72]
table(datostfg2[,73])
grepNoDescanso=grep("0",datostfg2[,71])
datostfg2[grepNoDescanso,73]

###Bucle
for (i in 1:11984){comp=(
  is.na(datostfg2[i,73])==FALSE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,71]="1"
}else{
        datostfg2[i,71]=datostfg2[i,71]
}}
grepNoDescanso=grep("0",datostfg2[,71])
datostfg2[grepNoDescanso,73]

###Bucle
for (i in 1:11984){comp=(datostfg2[i,71]=="1"&&
  is.na(datostfg2[i,73])==TRUE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,71]="0"
}else{
        datostfg2[i,71]=datostfg2[i,71]
}}
grepNoDescanso=grep("0",datostfg2[,71])
datostfg2[grepNoDescanso,73]
grepSiDescanso=grep("1",datostfg2[,71])
datostfg2[grepSiDescanso,73]
grep0Descanso=grep("0",datostfg2[,73])
datostfg2[grep0Descanso,71]
datostfg2[,71]=replace(datostfg2[,71],grep0Descanso,"0")
datostfg2[,73]=replace(datostfg2[,73],grep0Descanso,NA)
table(datostfg2[,73])
grep3Descanso=grep("3",datostfg2[,73])
datostfg2[grep3Descanso,70]
datostfg2[grep3Descanso,71]
datostfg2[grep3Descanso,72]
datostfg2[grep3Descanso,73]
grep4Descanso=grep("4",datostfg2[,73])
datostfg2[grep4Descanso,70]
datostfg2[grep4Descanso,71]
datostfg2[grep4Descanso,72]
datostfg2[grep4Descanso,73]
grep6Descanso=grep("6",datostfg2[,73])
datostfg2[grep6Descanso,70]
datostfg2[grep6Descanso,71]
datostfg2[grep6Descanso,72]
datostfg2[grep6Descanso,73]
####Más horas de descanso que horas de sueño,obviamente se trata de un error
datostfg2[grep6Descanso,72]=datostfg[grep6Descanso,73]
datostfg2[grep6Descanso,73]=datostfg[grep6Descanso,72]
datostfg2[grep6Descanso[c(1)],70]=datostfg[grep6Descanso[c(1)],71]
datostfg2[grep6Descanso[c(1)],71]=datostfg[grep6Descanso[c(1)],70]
grep7Descanso=grep("7",datostfg2[,73])
datostfg2[grep7Descanso,70]
datostfg2[grep7Descanso,71]
datostfg2[grep7Descanso,72]
datostfg2[grep7Descanso,73]####Se trata de un error
datostfg2[grep7Descanso,71]=NA
datostfg2[grep7Descanso,73]=NA
grep8Descanso=grep("8",datostfg2[,73])
datostfg2[grep8Descanso,70]
datostfg2[grep8Descanso,71]
datostfg2[grep8Descanso,72]
datostfg2[grep8Descanso,73] ###Dos errores y dos cambios de columna
datostfg2[grep8Descanso[c(1,4)],72]=datostfg[grep8Descanso[c(1,4)],73]
datostfg2[grep8Descanso[c(1,4)],73]=datostfg[grep8Descanso[c(1,4)],72]
datostfg2[grep8Descanso[c(1)],70]=datostfg[grep8Descanso[c(1)],71]
datostfg2[grep8Descanso[c(1)],71]=datostfg[grep8Descanso[c(1)],70]
datostfg2[grep8Descanso[c(2,3)],71]=NA
datostfg2[grep8Descanso[c(2,3)],73]=NA



datosperdidos=c(8,7.5,7.5,6.5,6,6,7,7.5,7,5.5,8,7,6,6,5.5,7,7.5,6,6,5.5,7.5,6.5,8,8,6.5,7,7.5,7.25,6.5,8,7.5,7,7.5,7,7.5,7.5,6,7,6,6,7,8,6.5,5.5,8,8,7,8,6.5,9.5,7,7,7,7,8,8,9,7,7,7.5,7,7,6.5,7,8,7.25,7.25,7,5.5,7.5,7.5,7.5,7.5,6.5,8,7.25,7.5,7.5,7.5,7.5,8.5,8,7,7,7.5,6.5,6.5,7.5,8,6,7,8,6,8,8.5,7,8,8,5.5,7.5,7.5,7,8,8,7.5,7.5,6,7,5.5,7.5,6.5,8,8,7.5,5,7,7,6.5,7.5,8.5,6,6.5,7,7,7.5,6.5,6,8,7.5,8,7.5,7,7.5,8,8,6.5,7,8,7,6.5,8,8.5,6.5,7,6.5,7,9,7.5,9,9,7.5,9,9,9,7,6.25,4.5,6.25,8,5.5,7.5,6,7,8.5,8,7.5,7,6.5,7,6.5,8,8,8,7.5,10,8,7,6.5,7,7,7.5,8,6.5,6.5,7,7,8,8.5,7,6.5,6,7.5,8,7,5.5,7,6.5,6.5,6,7,6,7,7.5,7.5,5.5,7.25,7.5,7,8,6,7.5,7,6.5,8,6,8,6.5,5.5,7,6,7.25,5.5,5.5)

for (i in 1:length(datosperdidos)){
  datostfg2[grepestudiarsueno[c(i)],72]=datosperdidos[i]
}

datostfg2[grepestudiarsueno,72]    ####Ya están introducidos los datos.
datostfg2[grepestudiarsueno,70]="1"



datostfg2[grepsindescansosuplementario,71]="0"
datostfg2[grepsindescansosuplementario,73]="0"
grepcondescansosuplementario=grepEstudiar[c(6,7,9,12,15,27,44,47,63,66,67,70,72,84,85,86,89,96,109,110,111,115,127,137,145,152,162,166,172,173,174,180,196,210,216,219,222,229,240,241)]
datostfg2[grepcondescansosuplementario,71]="1"
datosperdidosdescanso=c(1,1,0.5,1,0.5,0.5,0.5,0.5,0.5,0.5,1,0.5,1,1,1,0.75,1,0.5,0.5,1,0.5,0.5,0.5,1,1,0.5,0.75,0.5,0.5,1,0.5,1,0.5,1,1,0.5,0.5,0.5,1,1)

for (i in 1:length(datosperdidosdescanso)){
  datostfg2[grepcondescansosuplementario[c(i)],73]=datosperdidosdescanso[i]
}
datostfg2[grepcondescansosuplementario,73] ####Ya están introducidos los datos.
```

```{r,include=TRUE}
###Variable 74 y 79 Dolor Torácico
####Si el paciente presenta o ha presentado dolor torácico la variable numérica debe presentar un 1,en caso contrario presentará un 0.

table(datostfg2[,74])
datostfg2[7141,74]=datostfg[7141,73]
datostfg2[706,74]=datostfg[706,73]
datostfg2[6272,74]

grep799=grep("^No",datostfg2[,79])
datostfg2[grep799,79]###105,920 considerar como un si,411 como un si,456,772,744 considerar como un no
####744 palpitaciones
datostfg2[grep799[c(744)],76]="1"
datostfg2[grep799[c(105,920,411)],74]
datostfg2[grep799[1001:2000],79] ####Estudiar 1997,estudiar 1991 si refiere dolor torácico, estudiar 1982
####1973,1974,1967,1964,1962,1959,1949,1945,1934,1927,1916 y así muchos más
####1895 ritmo cardiaco varia
datostfg2[grep799[c(1982)],79]
grep799[c(1982)] ###No refiere
datostfg2[5379,74]
datostfg2[5379,75]
datostfg2[5379,76]
datostfg2[5379,77]
datostfg2[5379,78] ####Mareo


datostfg2[grep799[c(1991)],79]####Refiere mareos y dolor torácico
grep799[c(1991)]
datostfg2[5403,74]##Fallo
datostfg2[5403,75]
datostfg2[5403,76]
datostfg2[5403,77]
datostfg2[5403,78]#Fallo
datostfg2[5403,74]="1"
datostfg2[5403,78]="1"


datostfg2[grep799[c(1997)],79]
grep799[c(1997)] ###No refiere
datostfg2[5423,74]
datostfg2[5423,75]
datostfg2[5423,76]
datostfg2[5423,77]
datostfg2[5423,78] ####Todo correcto

datostfg2[grep799[c(1973)],79]
grep799[c(1973)] ###Solo mareos
datostfg2[5358,74]
datostfg2[5358,75]
datostfg2[5358,76]
datostfg2[5358,77]
datostfg2[5358,78]#Fallo
datostfg2[5358,78]="1"
datostfg2[5358,83]

datostfg2[grep799[c(1974)],79]
grep799[c(1974)] 
datostfg2[5360,74]
datostfg2[5360,75]
datostfg2[5360,76]
datostfg2[5360,77]
datostfg2[5360,78]#Todo correcto

datostfg2[grep799[c(1967)],79]
grep799[c(1967)] ##Solo mareos
datostfg2[5343,74]
datostfg2[5343,75]
datostfg2[5343,76]
datostfg2[5343,77]
datostfg2[5343,78]#Fallo
datostfg2[5343,78]="1"

datostfg2[grep799[c(1964)],79]
grep799[c(1964)] 
datostfg2[5336,74]
datostfg2[5336,75]
datostfg2[5336,76]
datostfg2[5336,77]
datostfg2[5336,78]#Todo correcto


datostfg2[grep799[c(1962)],79]
grep799[c(1962)] 
datostfg2[5329,74]
datostfg2[5329,75]
datostfg2[5329,76]
datostfg2[5329,77]
datostfg2[5329,78]#Todo correcto

####Solo examinaré los casos que presenten algo relevante,pues parece que enlos casos sin síntomas están bien recogidos los datos
datostfg2[grep799[1001:2000],79] ###1376 lo considero como un no,estudiar 1327
datostfg2[grep799[c(1327)],74] ####Si refiere dolor torácico

datostfg2[grep799[c(1934)],79] ###Perdida de conciencia
grep799[c(1934)] 
datostfg2[5279,74]
datostfg2[5279,75]
datostfg2[5279,76]
datostfg2[5279,77]#Fallo
datostfg2[5279,78]
datostfg2[5279,77]="1"


datostfg2[grep799[c(1861)],79] #Mareo
grep799[c(1861)] 
datostfg2[5123,74]
datostfg2[5123,75]
datostfg2[5123,76]
datostfg2[5123,77]
datostfg2[5123,78]#Fallo
datostfg2[5123,78]="1"


datostfg2[grep799[c(1858)],79] #Mareo
grep799[c(1858)] 
datostfg2[5118,74]
datostfg2[5118,75]
datostfg2[5118,76]
datostfg2[5118,77]
datostfg2[5118,78]#Fallo
datostfg2[5118,78]="1"



datostfg2[grep799[2001:3000],79] ####2990 mareo, 2994 Y 2966 perdidas de conciencia por caida,2960 dolor torácico,2923 Mareo,2917mareo,2911 mareo,estudiar a fondo caso 2896,2874 mareo,2864 mareo,2863 mareo,2856 mareo,2844 mareo,2835 considerar como mareo,2823,2817 mareo, 2805 perdida de conciencia,2795 mareo,2789palpitacion,2756 mareo,2747 mareo,2651 mareo,2650 mareo,2637 mareo,2632 mareo,2628 taquicardia,2580 dolor torácico,2449 dolor torácico,2439 mareo y pérdida de conciencia,2437 mareo,2408 dolor torácico,2402 mareo,2374 mareo,2369 mareo,2363 mareo,2354 dolor torácico,2350 mareo,2342 mareo,2336 perdida de conciencia,2335 dolor torácico,2328 mareo,2321 mareo,2317 palpitaciones,2314 mareo,2257 perdida de conciencia,2208 mareo,2194,2184 dolor torácico,2177 perdida de conciencia,2166 perdida de conciencia y mareo,2122 mareo,2113 perdida de conciencia y mareo,2110 mareo,2104 mareo,2095 dolor torácico y perdida de conciencia,2093 palpitaciones,2090 dolor torácico,2081 mareo,2078 mareo,2070 consideraré el ortatismo como presencia de mareo,2043 perdida de conciencia y mareo,2028 dolor torácico

datostfg2[grep799[c(2896)],79]
datostfg2[grep799[c(2896)],57]
datostfg2[grep799[c(2896)],60]##Fallo
datostfg2[grep799[c(2896)],60]="1"
datostfg2[grep799[c(2896)],61]="Ocasional"
datostfg2[grep799[c(2896)],70]="1"
datostfg2[grep799[c(2896)],71]="1"
datostfg2[grep799[c(2896)],72]="7"
datostfg2[grep799[c(2896)],73]="1"
####Ya hemos introducido la información que faltaba

datostfg2[grep799[3001:4000],79] ###3810 mareo,3759 dolor torácico,3733 mareo y taquicardia,3700 taquicardia,3693 mareo y dolor torácico,3573 mareo,3505 mareo,3490 perdida de conciencia,3431 mareo,3425 mareo,3374 disnea y mareos,3371 palpitaciones,3368 mareos,3366 mareo,3359 dolor torácico,3358 perdida de conciencia,3346 mareos,3340 mareo,3323 mareo,3316 mareo,3284 mareo,3274 perdida de conciencia,3269 perdida de conciencia,3266 dolor torácico,estudiar 3251,,3238 mareo,3204 mareos,3170 mareos,3150 mareo y perdida de conciencia,3134 mareo,3131 mareo,3130 mareo,3120 mareo,3111 mareo,3053 taquicardia y mareo,3033 mareo,3032 mareo y perdida de conciencia,3013 taquicardia,3009 mareo

datostfg2[grep799[c(3251)],79]
datostfg2[grep799[c(3251)],74]

datostfg2[grep799[4001:4833],79]  ####4765 dolor torácico,estudiar 4673,4416,4398,4399,4315,4313,4310,4143 y 4656, 4504 dolor torácico,estudiar 4453,4452 dolor torácico,4326 mareo
datostfg2[grep799[c(4673,4416,4398,4399,4315,4313,4310,4143,4656,4453)],79]
datostfg2[grep799[c(4673,4416,4398,4399,4315,4313,4310,4143,4656,4453)],74] ####Nada reseñable

datostfg2[grep799[c(105,920,411,1991,1327,2960,2580,2449,2408,2354,2335,2184,2095,2090,2028,3759,3693,3359,3266,4765,4504,4452)],79]
datostfg2[grep799[c(105,920,411,1991,1327,2960,2580,2449,2408,2354,2335,2184,2095,2090,2028,3759,3693,3359,3266,4765,4504,4452)],74] ###Hay algunos que no presentan un 1
datostfg2[grep799[c(105,920,411,1991,1327,2960,2580,2449,2408,2354,2335,2184,2095,2090,2028,3759,3693,3359,3266,4765,4504,4452)],74]="1" ####Casos con dolor torácico

grepNoDtora=grep799[-c(105,920,411,1991,1327,2960,2580,2449,2408,2354,2335,2184,2095,2090,2028,3759,3693,3359,3266,4765,4504,4452)]

datostfg2[grep799[c(1991,1973,1967,1861,1858,2990,2923,2917,2911,2874,2864,2863,2856,2844,2835,2823,2817,2795,2756,2747,2651,2650,2637,2632,2439,2437,2402,2374,2369,2363,2350,2342,2328,2321,2314,2208,2194,2166,2122,2113,2110,2104,2081,2078,2070,2043,3810,3733,3693,3573,3505,3431,3425,3374,3368,3366,3346,3340,3323,3316,3284,3238,3204,3170,3150,3134,3131,3130,3120,3111,3053,3033,3032,3009,4326)],78]
####Hay casos que no presentan un 1

datostfg2[grep799[c(1991,1973,1967,1861,1858,2990,2923,2917,2911,2874,2864,2863,2856,2844,2835,2823,2817,2795,2756,2747,2651,2650,2637,2632,2439,2437,2402,2374,2369,2363,2350,2342,2328,2321,2314,2208,2194,2166,2122,2113,2110,2104,2081,2078,2070,2043,3810,3733,3693,3573,3505,3431,3425,3374,3368,3366,3346,3340,3323,3316,3284,3238,3204,3170,3150,3134,3131,3130,3120,3111,3053,3033,3032,3009,4326)],78]="1" #### Casos con mareo



datostfg2[grep799[c(1934,2994,2966,2805,2439,2336,2257,2177,2166,2113,2095,2043,3490,3358,3274,3150,3269,3032)],77] ###Deben presentar todos un 1
datostfg2[grep799[c(1934,2994,2966,2805,2439,2336,2257,2177,2166,2113,2095,2043,3490,3358,3274,3150,3269,3032)],77]="1" ####Casos con perdida de conciencia

grep808=grep("respi",datostfg2[,79])
datostfg2[grep808,79]
datostfg2[grep808[c(23)],79]
datostfg2[grep808[c(40)],79]
grep808[c(23)]
grep808[c(40)]

datostfg2[6364,79] ###Lo consideramos como dolor torácico
datostfg2[6364,74] 
datostfg2[11089,79] ###Lo consideramos como dolor torácico
datostfg2[11089,74]



datostfg2[grep799[c(1895,2789,2093,3733,3700,3053,3013)],76]="1" ###Casos con palpitaciones

grep800=grep("^no",datostfg2[,79])
datostfg2[grep800,79] ###853 considerar como no,estudiar 210,44,45,5
datostfg2[grep800[c(210,44,45,5)],79]
datostfg2[grep800[c(210,44,45,5)],74]
datostfg2[grep800[c(210,44,45,5)],74]="0"
datostfg2[grep800[1001:1127],79] ###Estudiar 1121
datostfg2[grep800[c(1121)],74]

grep801=grep("^NO",datostfg2[,79])
datostfg2[grep801,79]  #####Considerar 170 como un si
datostfg2[grep801[c(170)],74]
grep801=grep801[-c(170)]
grep802=grep("NR",datostfg2[,79])
datostfg2[grep802,79]
grep803=grep("^N.R",datostfg2[,79])
datostfg2[grep803,79]
grep804=grep("^Ni",datostfg2[,79])
datostfg2[grep804,79]
grep805=grep("^NI",datostfg2[,79])
grep805=grep("^ni",datostfg2[,79])
datostfg2[grep805,79]
grep806=grep("^SIN",datostfg2[,79])
grep806=grep("^sin",datostfg2[,79])
datostfg2[grep806,79]
grep807=grep("^Sin",datostfg2[,79])
datostfg2[grep807,79] ####Considerar como un Si en la variable dolor torácico
datostfg2[grep807,74]


datostfg2[,74]=replace(datostfg2[,74],grepNoDtora,"0")
datostfg2[,74]=replace(datostfg2[,74],grep800,"0")
datostfg2[,74]=replace(datostfg2[,74],grep801,"0")
datostfg2[,74]=replace(datostfg2[,74],grep802,"0")
datostfg2[,74]=replace(datostfg2[,74],grep803,"0")
datostfg2[,74]=replace(datostfg2[,74],grep804,"0")
datostfg2[,74]=replace(datostfg2[,74],grep805,"0")
datostfg2[,74]=replace(datostfg2[,74],grep806,"0")

datostfg2[6272,87]=datostfg[6272,74]
datostfg2[7141,79]=datostfg[7141,78]
datostfg2[706,79]=datostfg[706,78]
datostfg2[6272,92]=datostfg[6272,79]
grep1DToracico=grep("1",datostfg2[,74])
datostfg2[grep1DToracico,79]
grep1DToracoma=grep("^,",datostfg2[,79])
datostfg2[grep1DToracoma,79]
datostfg2[grep1DToracoma[c(34,15)],74]="1"
datostfg2[grep1DToracoma[-c(34,15)],74]="0"
grep1DToracico=grep("1",datostfg2[,74])
datostfg2[grep1DToracico,79]
###Quitamos también los NA's
for (i in 1:11984){comp=(
  is.na(datostfg2[i,79])==TRUE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,74]="0"
}else{
        datostfg2[i,74]=datostfg2[i,74]
}}
grep1DToracico=grep("1",datostfg2[,74])
datostfg2[grep1DToracico,79]
datostfg2[grep1DToracico[c(550,512,402,340,329,307,300,185,171,170,166,131,121,118,108,79,36,35)],79] #####Errores
datostfg2[grep1DToracico[c(550,512,402,340,329,307,300,185,171,170,166,131,121,118,108,79,36,35)],74]="0"
datostfg2[c(2676,3877,5871,5919,6123),79]
datostfg2[c(2676,3877,5871,5919,6123),74]="0"

####Variable 75(Disnea) y 80(Disnea_txt)
####Dificultad para respirar.
####Si el paciente presenta o ha presentado disnea la variable numérica debe presentar un 1,en caso contrario presentará un 0.

table(datostfg2[,75])
datostfg2[7141,75]=datostfg[7141,74]
datostfg2[706,75]=datostfg[706,74]
datostfg2[6272,75]
grep809=grep("^No",datostfg2[,80])
datostfg2[grep809,80] ####Observar 900,907,700,570,514,390,268,257,254
datostfg2[grep809[1001:2000],80] ##1068 considerar como un si
datostfg2[grep809[c(1068)],75]
datostfg2[grep809[c(900,907,700,570,514,390,268,257,254)],80]
####Consideramos 907,900,700,514,268,257,254 como un si
datostfg2[grep809[c(907,900,700,514,268,257,254)],75]="1"
datostfg2[grep809[2001:3000],80] ##2699,2594 considerar como un si
datostfg2[grep809[3001:3600],80]
grep809=grep809[-c(907,900,700,514,268,257,254,1068,2699,2594)]
grep810=grep("^no",datostfg2[,80])
datostfg2[grep810,80] ###596 considerar como un si
datostfg2[grep810[c(596)],75]
grep810=grep810[-c(596)]
grep811=grep("^NO",datostfg2[,80])
datostfg2[grep811,80] 
grep812=grep("NR",datostfg2[,80])
datostfg2[grep812,80] ###317 considerar como un si
datostfg2[grep812[c(317)],75]
grep812=grep812[-c(317)]
grep813=grep("^N.R",datostfg2[,80])
datostfg2[grep813,80]
grep814=grep("^Ni",datostfg2[,80])
datostfg2[grep814,80]
grep815=grep("^NI",datostfg2[,80])
grep815=grep("^ni",datostfg2[,80])
grep815=grep("^SIN",datostfg2[,80])
grep815=grep("^sin",datostfg2[,80])
grep815=grep("^Sin",datostfg2[,80])
datostfg2[grep815,80] 


datostfg2[,75]=replace(datostfg2[,75],grep809,"0")
datostfg2[,75]=replace(datostfg2[,75],grep810,"0")
datostfg2[,75]=replace(datostfg2[,75],grep811,"0")
datostfg2[,75]=replace(datostfg2[,75],grep812,"0")
datostfg2[,75]=replace(datostfg2[,75],grep813,"0")
datostfg2[,75]=replace(datostfg2[,75],grep814,"0")
datostfg2[,75]=replace(datostfg2[,75],grep815,"0")

datostfg2[6272,88]=datostfg[6272,75]
datostfg2[7141,80]=datostfg[7141,79]
datostfg2[706,80]=datostfg[706,79]
datostfg2[6272,93]=datostfg[6272,80]
datostfg2[7141,80]
datostfg2[7141,75]###Error
datostfg2[7141,75]="0"
datostfg2[706,80]
datostfg2[706,75]
grep1Disnea=grep("1",datostfg2[,75])
datostfg2[grep1Disnea,80]
grep1Disneacoma=grep("^,",datostfg2[,80])
datostfg2[grep1Disneacoma,80]
datostfg2[grep1Disneacoma[c(498,314)],75]
datostfg2[grep1Disneacoma[-c(498,314)],75]="0"



grep1Disnea=grep("1",datostfg2[,75])
datostfg2[grep1Disnea,80]
###Quitamos también los NA's
###Bucle
for (i in 1:11984){comp=(
  is.na(datostfg2[i,80])==TRUE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,75]="0"
}else{
        datostfg2[i,75]=datostfg2[i,75]
}}
grep1Disnea=grep("1",datostfg2[,75])
datostfg2[grep1Disnea,80]
datostfg2[grep1Disnea[c(422,348,329,327,280,260,254,139,135,110,103,96,62,20,19)],80] ###Errores
datostfg2[grep1Disnea[c(422,348,329,327,280,260,254,139,135,110,103,96,62,20,19)],80]="0" 

datostfg2[c(2676,3877,5871,5919,6123),80]
datostfg2[c(2676,3877,5871,5919,6123),75]="0"

####Variable 76(Palpitaciones) y 81Palpitaciones(Palpitaciones_txt)
####Si el paciente presenta o ha presentado palpitaciones la variable numérica debe presentar un 1,en caso contrario presentará un 0.

table(datostfg2[,76])
datostfg2[7141,76]=datostfg[7141,75]
datostfg2[706,76]=datostfg[706,75]
datostfg2[6272,76]
grep816=grep("^No",datostfg2[,81])
datostfg2[grep816,81]###Caso 915 ,estudiar 684,661 si,600 si,317 si
datostfg2[grep816[1001:2000],81]#caso 1802 ,1755 si,1195 si,1154 si,1105 estudiar,1004 si
datostfg2[grep816[2001:3000],81] ###2960 si,2911 no,474 y 475 estudiar,2065 si
datostfg2[grep816[3001:3674],81] ##3477 si
datostfg2[grep816[c(684)],81] ###Considerar como un 0
datostfg2[grep816[c(684)],76] 
datostfg2[grep816[c(1105)],81]###Considerar como un 1
datostfg2[grep816[c(1105)],76]
datostfg2[grep816[c(1802)],81]
datostfg2[grep816[c(1802)],76]
datostfg2[grep816[c(474)],81]
datostfg2[grep816[c(474)],76]
datostfg2[grep816[c(915)],81]
datostfg2[grep816[c(915)],76]
datostfg2[grep816[c(475)],81]
datostfg2[grep816[c(475)],76]
grep816=grep816[-c(1802,915,661,600,317,1755,1195,1154,1004,2960,2065,3477,1105)]
datostfg2[grep816[c(1802,915,661,600,317,1755,1195,1154,1004,2960,2065,3477,1105)],76] ####Deben ser todos 1
datostfg2[grep816[c(1802,915,661,600,317,1755,1195,1154,1004,2960,2065,3477,1105)],76]="1"
grep817=grep("^no",datostfg2[,81])
datostfg2[grep817,81] ###692,387,147 considerar como un si,estudiar 62 y 627 ,29 si
datostfg2[grep817[c(692,387,147,29)],76]
datostfg2[grep817[c(62,627)],81]
datostfg2[grep817[c(62,627)],76]
grep817=grep817[-c(692,387,147,29,62,627)]
grep818=grep("^NO",datostfg2[,81])
datostfg2[grep818,81] 
grep819=grep("NR",datostfg2[,81])
datostfg2[grep819,81] ###317 considerar como un si
grep820=grep("^N.R",datostfg2[,81])
datostfg2[grep820,81]
grep821=grep("^Ni",datostfg2[,81])
grep821=grep("^NI",datostfg2[,81])
grep821=grep("^ni",datostfg2[,81])
grep821=grep("^SIN",datostfg2[,81])
grep821=grep("^sin",datostfg2[,81])
grep821=grep("^Sin",datostfg2[,81])
datostfg2[grep821,81] 
datostfg2[grep821[c(2)],76]
grep821=grep821[c(1)]


datostfg2[,76]=replace(datostfg2[,76],grep816,"0")
datostfg2[,76]=replace(datostfg2[,76],grep817,"0")
datostfg2[,76]=replace(datostfg2[,76],grep818,"0")
datostfg2[,76]=replace(datostfg2[,76],grep819,"0")
datostfg2[,76]=replace(datostfg2[,76],grep820,"0")
datostfg2[,76]=replace(datostfg2[,76],grep821,"0")

datostfg2[6272,89]=datostfg[6272,76]
datostfg2[7141,81]=datostfg[7141,80]
datostfg2[706,81]=datostfg[706,80]
datostfg2[6272,94]=datostfg[6272,81]
datostfg2[7141,81]
datostfg2[7141,76]
datostfg2[706,81]
datostfg2[706,76]

grep1Palpita=grep("1",datostfg2[,76])
datostfg2[grep1Palpita,81]
grep1Palpitacoma=grep("^,",datostfg2[,81])
datostfg2[grep1Palpitacoma,81]
datostfg2[grep1Palpitacoma,76]="0"
grep1Palpita=grep("1",datostfg2[,76])
datostfg2[grep1Palpita,81]


####Quitamos los NA's
###Bucle
for (i in 1:11984){comp=(
  is.na(datostfg2[i,81])==TRUE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,76]="0"
}else{
        datostfg2[i,76]=datostfg2[i,76]
}}
grep1Palpita=grep("1",datostfg2[,76])
datostfg2[grep1Palpita,81]
datostfg2[grep1Palpita[c(625,618,549,538,488,383,137,369,370,366,360,317,301,134,299,296,284,264,213,192,86,185,186,182,180,148,138,80,79,78,77,34,28,27)],81] ###Errores
datostfg2[grep1Palpita[c(625,618,549,538,488,383,137,369,370,366,360,317,301,134,299,296,284,264,213,192,86,185,186,182,180,148,138,80,79,78,77,34,28,27)],76]="0"

datostfg2[c(2676,3877,5871,5919,6123),81]
datostfg2[c(2676,3877,5871,5919,6123),76]="0"

####Variable 77(Pérdida.de.conciencia) y 82(Pconciencia_txt) 
####Si el paciente presenta o ha presentado alguna vez la pérdida de la conciencia la variable numérica debe presentar un 1,en caso contrario presentará un 0.

table(datostfg2[,77])
datostfg2[7141,77]=datostfg[7141,76]
datostfg2[706,77]=datostfg[706,76]
datostfg2[6272,77]
grep822=grep("^No",datostfg2[,82])
datostfg2[grep822,82] ###438,433,1041,2415,3536,3517,3044  y 1812 si,aunque no relacionadas con el deporte
datostfg2[grep822[1001:2000],82]
datostfg2[grep822[2001:3000],82] 
datostfg2[grep822[3001:3859],82] 
datostfg2[grep822[c(438,433,1041,2415,3536,3517,3044,1812)],82] ####Ya presentan 1`s
grep822=grep822[-c(438,433,1041,2415,3536,3517,3044,1812)]
grep823=grep("^no",datostfg2[,82])
datostfg2[grep823,82] ###Aparece no en su práctica deportiva habitual,yo lo considero como un no
grep824=grep("^NO",datostfg2[,82])
datostfg2[grep824,82] 
grep825=grep("NR",datostfg2[,82])
datostfg2[grep825,82] 
grep826=grep("^N.R",datostfg2[,82])
datostfg2[grep826,82]
grep827=grep("^Ni",datostfg2[,82])
grep827=grep("^NI",datostfg2[,82])
datostfg2[grep827,82]
grep828=grep("^ni",datostfg2[,82])
grep828=grep("^SIN",datostfg2[,82])
grep828=grep("^sin",datostfg2[,82])
datostfg2[grep828,82]##No considerar
grep829=grep("^Sin",datostfg2[,82])
datostfg2[grep829,82] ##No considerar
datostfg2[c(grep828,grep829),77] ####Hay un error
datostfg2[c(grep828,grep829),77]="1"
datostfg2[,77]=replace(datostfg2[,77],grep822,"0")
datostfg2[,77]=replace(datostfg2[,77],grep823,"0")
datostfg2[,77]=replace(datostfg2[,77],grep824,"0")
datostfg2[,77]=replace(datostfg2[,77],grep825,"0")
datostfg2[,77]=replace(datostfg2[,77],grep826,"0")
datostfg2[,77]=replace(datostfg2[,77],grep827,"0")

grep1PConciencia=grep("1",datostfg2[,77])
datostfg2[grep1PConciencia,82]
grep1Perdidacoma=grep("^,",datostfg2[,82])
datostfg2[grep1Perdidacoma,82] ####Considerar 4 como un No
datostfg2[grep1Perdidacoma,77]="0"
grep1PConciencia=grep("1",datostfg2[,77])
datostfg2[grep1PConciencia,82]

####Hay que quitar los NA's
####Bucle
for (i in 1:11984){comp=(
  is.na(datostfg2[i,82])==TRUE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,77]="0"
}else{
        datostfg2[i,77]=datostfg2[i,77]
}}

grep1PConciencia=grep("1",datostfg2[,77])
datostfg2[grep1PConciencia,82]
grepy=grep("^y",datostfg2[,82])
datostfg2[grepy,82]
datostfg2[grepy,77]="0"
grep1PConciencia=grep("1",datostfg2[,77])
datostfg2[grep1PConciencia,82]

datostfg2[grep1PConciencia[c(2,11,23,26,31,37,90,96,101,108,138,180,193,213,217,220,222,229,245,267,270,271,340,350)],82] ####Casos que presentan Mareos
datostfg2[grep1PConciencia[c(2,11,23,26,31,37,90,96,101,108,138,180,193,213,217,220,222,229,245,267,270,271,340,350)],78] ####Casos que presentan Mareos
datostfg2[grep1PConciencia[c(2,11,23,26,31,37,90,96,101,108,138,180,193,213,217,220,222,229,245,267,270,271,340,350)],83]

datostfg2[grep1PConciencia[c(229)],75] ####Caso con disnea
datostfg2[grep1PConciencia[c(229)],75]
datostfg2[grep1PConciencia[c(229)],80] ####Ya registrado

datostfg2[grep1PConciencia[c(210,184,167,166,347,345,340,331,330,242,125,117,110,107,102,100,78,75,13)],82] ####Errores
datostfg2[grep1PConciencia[c(210,184,167,166,347,345,340,331,330,242,125,117,110,107,102,100,78,75,13)],77]="0"
datostfg2[grep1PConciencia[c(143)],82]
datostfg2[grep1PConciencia[c(143)],78]
datostfg2[grep1PConciencia[c(143)],83]
datostfg2[grep1PConciencia[c(143)],78]="1"
datostfg2[grep1PConciencia[c(143)],83]="Cuadro de Mareos en el Hospital tras pérdida de conciencia"

datostfg2[6272,90]=datostfg[6272,77]
datostfg2[7141,82]=datostfg[7141,81]
datostfg2[706,82]=datostfg[706,81]
datostfg2[6272,95]=datostfg[6272,82]
datostfg2[7141,82]
datostfg2[7141,77]###Error
datostfg2[7141,77]="1"
datostfg2[706,82]
datostfg2[706,77]###Error
datostfg2[706,77]="0"

datostfg2[c(2676,3877,5871,5919,6123),82]
datostfg2[c(2676,3877,5871,5919,6123),77]="0"


####Variable 78(Mareo) y 83(Mareo_txt)
table(datostfg2[,78])
datostfg2[7141,78]=datostfg[7141,77]
datostfg2[706,78]=datostfg[706,77]
datostfg2[6272,78]
grep830=grep("^No",datostfg2[,83])
datostfg2[grep830,83] ###732 no eliminar,713 por altura,693,537 vértigo,286 altura
datostfg2[grep830[1001:2000],83] ##1865,1464,1028
datostfg2[grep830[2001:3000],83] ###2802,2632
datostfg2[grep830[3001:3395],83] 
datostfg2[grep830[c(732,713,693,537,286,1865,1464,1028,2801,2631)],78]
grep830=grep830[-c(732,713,693,537,286,1865,1464,1028,2801,2631)]
grep831=grep("^no",datostfg2[,83])
datostfg2[grep831,83] ###367
datostfg2[grep831[c(367)],78]
grep831=grep831[-c(367)]
grep832=grep("^NO",datostfg2[,83]) ##100
datostfg2[grep832,83] 
datostfg2[grep832[c(100)],78] 
grep832=grep832[-c(100)]
grep833=grep("NR",datostfg2[,83])
datostfg2[grep833,83] 
grep834=grep("^N.R",datostfg2[,83])
datostfg2[grep834,83]
grep835=grep("^Ni",datostfg2[,83])
grep835=grep("^NI",datostfg2[,83])
grep835=grep("^ni",datostfg2[,83])
datostfg2[grep835,83]
grep836=grep("^SIN",datostfg2[,83])
grep836=grep("^sin",datostfg2[,83])
datostfg2[grep836,83]###No considerar
datostfg2[grep836,78]
grep836=grep("^Sin",datostfg2[,83])
datostfg2[grep836,83] ##No considerar
datostfg2[grep836,83]
datostfg2[grep836,78]

datostfg2[grep836[c(1)],82]
datostfg2[grep836[c(1)],77]
datostfg2[grep836[c(1)],82]=datostfg[grep836[c(1)],83]
datostfg2[grep836[c(1)],77] ="1"
datostfg2[grep836[c(2)],82]
datostfg2[grep836[c(2)],77]

datostfg2[,78]=replace(datostfg2[,78],grep830,"0")
datostfg2[,78]=replace(datostfg2[,78],grep831,"0")
datostfg2[,78]=replace(datostfg2[,78],grep832,"0")
datostfg2[,78]=replace(datostfg2[,78],grep833,"0")
datostfg2[,78]=replace(datostfg2[,78],grep834,"0")
datostfg2[,78]=replace(datostfg2[,78],grep835,"0")

datostfg2[6272,91]=datostfg[6272,78]
datostfg2[7141,83]=datostfg[7141,82]
datostfg2[706,83]=datostfg[706,82]
datostfg2[6272,96]=datostfg[6272,83]
datostfg2[7141,83]
datostfg2[7141,78]###Error
datostfg2[7141,78]="0"
datostfg2[706,83]
datostfg2[706,78]

grep1Mareo=grep("1",datostfg2[,78])
datostfg2[grep1Mareo,83]
grep1Mareocoma=grep("^,",datostfg2[,83])
datostfg2[grep1Mareocoma,83] ###Considerar 23 como un Si
datostfg2[grep1Mareocoma[-c(254,249,145,123,108,65,38,34,33,30,23,17,6,5)],78]="0"
grep1Mareo=grep("1",datostfg2[,78])
datostfg2[grep1Mareo,83]
####Hay que quitar los NA's
####Bucle
for (i in 1:11984){comp=(
  is.na(datostfg2[i,83])==TRUE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,78]="0"
}else{
        datostfg2[i,78]=datostfg2[i,78]
}}
grep1Mareo=grep("1",datostfg2[,78])
datostfg2[grep1Mareo,83]
datostfg2[grep1Mareo[1001:1064],83]
datostfg2[grep1Mareo[c(959,946,937,883,853,773,728,701,421,332,330,77)],83]
datostfg2[grep1Mareo[c(959,946,937,883,853,773,728,701,421,332,330,77)],77] ####Casos sin perdida de conocimiento,hay un fallo
datostfg2[grep1Mareo[c(959,946,937,883,853,773,728,701,421,332,330,77)],77]="0"

datostfg2[grep1Mareo[c(131,193)],83]
datostfg2[grep1Mareo[c(131,193)],77] ####Casos con pérdida de conocimiento
datostfg2[grep1Mareo[c(131,193)],77]="1"
datostfg2[grep1Mareo[c(131,193)],82]="P.Conciencia"
datostfg2[grep1Mareo[c(973,850,662,626,446,439,355,350,344,237,236,250,246,228,156,96,74,32)],83]###Errores
datostfg2[grep1Mareo[c(973,850,662,626,446,439,355,350,344,237,236,250,246,228,156,96,74,32)],78]="0"

###Vamos a realizar algunas comprobaciones
datostfg2[grep799[c(105,920,411,1991,1327,2960,2580,2449,2408,2354,2335,2184,2095,2090,2028,3759,3693,3359,3266,4765,4504,4452)],74] ####Casos con dolor torácico
datostfg2[grep799[c(105,920,411,1991,1327,2960,2580,2449,2408,2354,2335,2184,2095,2090,2028,3759,3693,3359,3266,4765,4504,4452)],79]

datostfg2[grep799[c(1991,1973,1967,1861,1858,2990,2923,2917,2911,2874,2864,2863,2856,2844,2835,2823,2817,2795,2756,2747,2651,2650,2637,2632,2439,2437,2402,2374,2369,2363,2350,2342,2328,2321,2314,2208,2194,2166,2122,2113,2110,2104,2081,2078,2070,2043,2028,3810,3733,3693,3573,3505,3431,3425,3374,3368,3366,3346,3340,3323,3316,3284,3238,3204,3170,3150,3134,3131,3130,3120,3111,3053,3033,3032,3009,4326)],78] #### Casos con mareo
datostfg2[grep799[c(1991,1973,1967,1861,1858,2990,2923,2917,2911,2874,2864,2863,2856,2844,2835,2823,2817,2795,2756,2747,2651,2650,2637,2632,2439,2437,2402,2374,2369,2363,2350,2342,2328,2321,2314,2208,2194,2166,2122,2113,2110,2104,2081,2078,2070,2043,2028,3810,3733,3693,3573,3505,3431,3425,3374,3368,3366,3346,3340,3323,3316,3284,3238,3204,3170,3150,3134,3131,3130,3120,3111,3053,3033,3032,3009,4326)],83]="Si refiere"


datostfg2[grep799[c(1934,2994,2966,2805,2439,2336,2257,2177,2166,2113,2095,2043,3490,3358,3274,3150,3269,3032)],77] ####Casos con pérdida de conciencia
datostfg2[grep799[c(1934,2994,2966,2805,2439,2336,2257,2177,2166,2113,2095,2043,3490,3358,3274,3150,3269,3032)],82] 
datostfg2[grep799[c(1934,2994,2966,2805,2439,2336,2257,2177,2166,2113,2095,2043,3490,3358,3274,3150,3269,3032)],82]="Si refiere" 

datostfg2[grep799[c(1895,2789,2093,3733,3700,3053,3013)],79] ###Casos con palpitaciones
datostfg2[grep799[c(1895,2789,2093,3733,3700,3053,3013)],81]="Si refiere"
grep2691=grep("TCE",datostfg2[,65])
datostfg2[grep2691,65]
datostfg2[grep2691[c(6,7)],83]="Mareo por TCE"
datostfg2[grep1Trauma[c(2746)],82]="Pérdida de conciencia por TCE"
datostfg2[grep1Trauma[c(642)],83]="Mareo por TCE"
datostfg2[grep2691[c(1,13,15,23,27,30,31)],82]="Pérdida de conciencia por TCE"
datostfg2[grep2696[c(4)],82]=datostfg2[grep2696[c(4)],69]


datostfg2[5403,78]="1"
datostfg2[5403,83]="Mareo"

datostfg2[5358,78]="1"
datostfg2[5358,83]="Mareo"

datostfg2[5343,78]="1"
datostfg2[5343,83]="Mareo"

datostfg2[5279,77]="1"
datostfg2[5279,82]="P.Conciencia"

datostfg2[5123,78]="1"
datostfg2[5123,83]="Mareo"

datostfg2[5118,78]="1"
datostfg2[5118,83]="Mareo"

datostfg2[grep799[c(1991,1973,1967,1861,1858,2990,2923,2917,2911,2874,2864,2863,2856,2844,2835,2823,2817,2795,2756,2747,2651,2650,2637,2632,2439,2437,2402,2374,2369,2363,2350,2342,2328,2321,2314,2208,2194,2166,2122,2113,2110,2104,2081,2078,2070,2043,3810,3733,3693,3573,3505,3431,3425,3374,3368,3366,3346,3340,3323,3316,3284,3238,3204,3170,3150,3134,3131,3130,3120,3111,3053,3033,3032,3009,4326)],78]="1"
datostfg2[grep799[c(1991,1973,1967,1861,1858,2990,2923,2917,2911,2874,2864,2863,2856,2844,2835,2823,2817,2795,2756,2747,2651,2650,2637,2632,2439,2437,2402,2374,2369,2363,2350,2342,2328,2321,2314,2208,2194,2166,2122,2113,2110,2104,2081,2078,2070,2043,3810,3733,3693,3573,3505,3431,3425,3374,3368,3366,3346,3340,3323,3316,3284,3238,3204,3170,3150,3134,3131,3130,3120,3111,3053,3033,3032,3009,4326)],83]="Mareo"
datostfg2[grep799[c(1934,2994,2966,2805,2439,2336,2257,2177,2166,2113,2095,2043,3490,3358,3274,3150,3269,3032)],77]="1" ####Casos con perdida de conciencia
datostfg2[grep799[c(1934,2994,2966,2805,2439,2336,2257,2177,2166,2113,2095,2043,3490,3358,3274,3150,3269,3032)],82]####Casos con perdida de conciencia
datostfg2[grep799[c(1934,2994,2966,2805,2439,2336,2257,2177,2166,2113,2095,2043,3490,3358,3269,3032)],82]="P.Conciencia"

datostfg2[grep799[c(1895,2789,2093,3733,3700,3053,3013)],76]="1"
datostfg2[grep799[c(1895,2789,2093,3733,3700,3053,3013)],81]="Palpitaciones"

datostfg2[grep1PConciencia[c(220,222,213,193,180,311,349,271,270,267,245,229,143,138,119,108,101,96,90,37,31,11)],78] ####Casos que presentan Mareos
datostfg2[grep1PConciencia[c(220,222,213,193,180,311,349,271,270,267,245,229,143,138,119,108,101,96,90,37,31,11)],83]
datostfg2[grep1PConciencia[c(143)],83]="Mareo"
datostfg2[5379,78]="1"
datostfg2[5379,83]="Mareo"




grep2697=grep("0",datostfg2[,74])
table(datostfg2[grep2697,79])
grep2698=grep("A veces",datostfg2[,79])
datostfg2[grep2698,79]
datostfg2[grep2698,74]
datostfg2[grep2698,74]="1"
grep2698=grep("^Actualmente",datostfg2[,79])
datostfg2[grep2698,79]
datostfg2[grep2698,74]
datostfg2[grep2698,74]="1"
grep2698=grep("^Alguna",datostfg2[,79])
datostfg2[grep2698,79]
datostfg2[grep2698,74]
datostfg2[grep2698,74]="1"
grep2698=grep("Cdo",datostfg2[,79])
datostfg2[grep2698,79]
datostfg2[grep2698,74]
datostfg2[grep2698,74]="1"
grep2698=grep("Cierta",datostfg2[,79])
datostfg2[grep2698,79]
datostfg2[grep2698,74]
datostfg2[grep2698,74]="1"
grep2698=grep("^Dolor",datostfg2[,79])
datostfg2[grep2698,79]
datostfg2[grep2698,74]
datostfg2[grep2698,74]="1"
grep2698=grep("Cuando",datostfg2[,79])
datostfg2[grep2698,79]
datostfg2[grep2698,74]
datostfg2[grep2698,74]="1"
grep2698=grep("^Durante",datostfg2[,79])
datostfg2[grep2698,79]
datostfg2[grep2698,74]
datostfg2[grep2698,74]="1"
grep2698=grep("^En",datostfg2[,79])
datostfg2[grep2698,79]
datostfg2[grep2698,74]
datostfg2[grep2698,74]="1"
grep2698=grep("^Espo",datostfg2[,79])
datostfg2[grep2698,79]
datostfg2[grep2698,74]
datostfg2[grep2698,74]="1"
grep2698=grep("^Estu",datostfg2[,79])
datostfg2[grep2698,79]
datostfg2[grep2698,74]
datostfg2[grep2698,74]="1"
grep2698=grep("^Hace",datostfg2[,79])
datostfg2[grep2698,79]
datostfg2[grep2698,74]
datostfg2[grep2698,74]="1"
grep2698=grep("^Lo",datostfg2[,79])
datostfg2[grep2698,79]
datostfg2[grep2698,74]
datostfg2[grep2698,74]="1"
grep2698=grep("^La",datostfg2[,79])
datostfg2[grep2698,79]
datostfg2[grep2698,74]
datostfg2[grep2698,74]="1"
grep2698=grep("pinchazo",datostfg2[,79])
datostfg2[grep2698,79]
datostfg2[grep2698,74]
datostfg2[grep2698,74]="1"
grep2698=grep("Pinchazo",datostfg2[,79])
datostfg2[grep2698,79]
datostfg2[grep2698,74]
datostfg2[grep2698,74]="1"
grep2698=grep("^Sensaci",datostfg2[,79])
datostfg2[grep2698,79]
datostfg2[grep2698,74]
datostfg2[grep2698,74]="1"
grep2698=grep("Sensaci",datostfg2[,79])
datostfg2[grep2698,79]
datostfg2[grep2698,74]
datostfg2[grep2698,74]="1"
grep2698=grep("hace tiempo",datostfg2[,79])
datostfg2[grep2698,79]
datostfg2[grep2698,74]
datostfg2[grep2698,74]="1"
grep2698=grep("Notaba",datostfg2[,79])
datostfg2[grep2698,79]
datostfg2[grep2698,74]
datostfg2[grep2698,74]="1"
grep2698=grep("^por",datostfg2[,79])
datostfg2[grep2698,79]
datostfg2[grep2698,74]
datostfg2[grep2698,74]="1"
grep2698=grep("nervios",datostfg2[,79])
datostfg2[grep2698,79]
datostfg2[grep2698,74]
datostfg2[grep2698,74]="1"
grep2698=grep("respi",datostfg2[,79])
datostfg2[grep2698,79]
datostfg2[grep2698,74]
datostfg2[grep2698,74]="1"
grep2698=grep("^Por",datostfg2[,79])
datostfg2[grep2698,79]
datostfg2[grep2698,74]
datostfg2[grep2698,74]="1"
grep2698=grep("^Paraple",datostfg2[,79])
datostfg2[grep2698,79]
datostfg2[grep2698,74]
datostfg2[grep2698,74]="1"
grep2698=grep("^Punza",datostfg2[,79])
datostfg2[grep2698,79]
datostfg2[grep2698,74]
datostfg2[grep2698,74]="1"
grep2698=grep("^Referi",datostfg2[,79])
datostfg2[grep2698,79]
datostfg2[grep2698,74]
datostfg2[grep2698,74]="1"
grep2698=grep("^Refiere",datostfg2[,79])
datostfg2[grep2698,79]
datostfg2[grep2698,74]
datostfg2[grep2698,74]="1"
grep2698=grep("^refiere",datostfg2[,79])
datostfg2[grep2698,79]
datostfg2[grep2698,74]
datostfg2[grep2698,74]="1"
grep2698=grep("REFIE",datostfg2[,79])
datostfg2[grep2698,79]
datostfg2[grep2698[c(1,3,4,7)],74]
datostfg2[grep2698,74]="1"
grep2698=grep("^Hace tiempo",datostfg2[,79])
datostfg2[grep2698,79]
datostfg2[grep2698,74]
datostfg2[grep2698,74]="1"
grep2698=grep("^Tras",datostfg2[,79])
datostfg2[grep2698,79]
datostfg2[grep2698,74]
datostfg2[grep2698,74]="1"
grep2698=grep("^una vez",datostfg2[,79])
datostfg2[grep2698,79]
datostfg2[grep2698,74]
datostfg2[grep2698,74]="1"
grep2698=grep("calor",datostfg2[,79])
datostfg2[grep2698,79]
datostfg2[grep2698,74]
datostfg2[grep2698[-c(1,3)],74]="0"
datostfg2[grep2698[c(1,3)],74]="1"
grep2698=grep("^Si",datostfg2[,79])
datostfg2[grep2698,79]
datostfg2[grep2698,74]
datostfg2[grep2698,74]="1"
grep2698=grep("taqui",datostfg2[,79])
datostfg2[grep2698,79]
datostfg2[grep2698,74]
datostfg2[grep2698,74]="1"
grep2698=grep("Frac",datostfg2[,79])
datostfg2[grep2698,79]
datostfg2[grep2698,50]
datostfg2[grep2698,51]###Ya registrado
grep2698=grep("palpi",datostfg2[,79])
datostfg2[grep2698,79]
datostfg2[grep2698[-c(11,5)],76]="1"
datostfg2[grep2698[c(2,3,4,9,10)],81]="SI"

grep2699=grep("0",datostfg2[,75])
table(datostfg2[grep2699,80])
grep2700=grep("Por",datostfg2[,80])
datostfg2[grep2700,80]
datostfg2[grep2700,75]
datostfg2[grep2700,75]="1"
grep2700=grep("Paraple",datostfg2[,80])
datostfg2[grep2700,80]
datostfg2[grep2700,75]
datostfg2[grep2700,75]="1"
grep2700=grep("agua",datostfg2[,80])
datostfg2[grep2700,80]
datostfg2[grep2700,75]
datostfg2[grep2700,75]="1"
grep2700=grep("alergia",datostfg2[,80])
datostfg2[grep2700,80]
datostfg2[grep2700,75]
datostfg2[grep2700,75]="1"
grep2700=grep("Falta",datostfg2[,80])
datostfg2[grep2700,80]
datostfg2[grep2700,75]
datostfg2[grep2700,75]="1"
datostfg2[grep2700,80]
datostfg2[grep2700,75]
datostfg2[grep2700,75]="1"
grep2700=grep("Junto",datostfg2[,80])
datostfg2[grep2700,80]
datostfg2[grep2700,75]
datostfg2[grep2700,75]="1"
datostfg2[grep2700,83]
datostfg2[grep2700,78]="1"
grep2700=grep("^En",datostfg2[,80])
datostfg2[grep2700,80]
datostfg2[grep2700,75]
datostfg2[grep2700,75]="1"
grep2700=grep("asma",datostfg2[,80])
datostfg2[grep2700,80]
datostfg2[grep2700,75]
datostfg2[grep2700,75]="1"
grep2700=grep("Emoc",datostfg2[,80])
datostfg2[grep2700,80]
datostfg2[grep2700,75]
datostfg2[grep2700,75]="1"
datostfg2[grep2700,80]
datostfg2[grep2700,75]
datostfg2[grep2700,75]="1"
grep2700=grep("Disnea",datostfg2[,80])
datostfg2[grep2700,80]
datostfg2[grep2700,75]
datostfg2[grep2700,75]="1"
grep2700=grep("Cuando",datostfg2[,80])
datostfg2[grep2700,80]
datostfg2[grep2700,75]
datostfg2[grep2700,75]="1"
grep2700=grep("^Al",datostfg2[,80])
datostfg2[grep2700,80]
datostfg2[grep2700,75]
datostfg2[grep2700,75]="1"
grep2700=grep("^A veces",datostfg2[,80])
datostfg2[grep2700,80]
datostfg2[grep2700,75]
datostfg2[grep2700,75]="1"
grep2700=grep("cON",datostfg2[,80])
datostfg2[grep2700,80]
datostfg2[grep2700,75]
datostfg2[grep2700,75]="1"
grep2700=grep("Rela",datostfg2[,80])
datostfg2[grep2700,80]
datostfg2[grep2700,75]
datostfg2[grep2700,75]="1"
grep2700=grep("^Refiere",datostfg2[,80])
datostfg2[grep2700,80]
datostfg2[grep2700,75]
datostfg2[grep2700,75]="1"
datostfg2[grep2700[c(36)],78]="1"
datostfg2[grep2700[c(36)],83]="Disnea con Mareo"
datostfg2[grep2700[c(31)],74]="1"
datostfg2[grep2700[c(36)],79]="Dolor Torácico"
grep2700=grep("rela",datostfg2[,80])
datostfg2[grep2700,80]
datostfg2[grep2700,75]
datostfg2[grep2700,75]="1"
grep2700=grep("nasal",datostfg2[,80])
datostfg2[grep2700,80]
datostfg2[grep2700,75]
datostfg2[grep2700,75]="1"
grep2700=grep("iniciar",datostfg2[,80])
datostfg2[grep2700,80]
datostfg2[grep2700,75]
datostfg2[grep2700,75]="1"
grep2700=grep("bici",datostfg2[,80])
datostfg2[grep2700,80]
datostfg2[grep2700,75]
datostfg2[grep2700,75]="1"
####No voy a considerar los casos en la montaña porque esto sucede de forma lógica y natural

grep2701=grep("0",datostfg2[,76])
table(datostfg2[grep2701,81])
grep2702=grep("Palpita",datostfg2[,81])
datostfg2[grep2702,81]
datostfg2[grep2702,76]
datostfg2[grep2702,76]="1"
grep2702=grep("^Refiere",datostfg2[,81])
datostfg2[grep2702,81]
datostfg2[grep2702,76]
datostfg2[grep2702[-c(74,79)],76]="1"
datostfg2[grep2702[c(74,79)],76]="0"
grep2702=grep("^refiere",datostfg2[,81])
datostfg2[grep2702,81]
datostfg2[grep2702,76]
datostfg2[grep2702,76]="1"
grep2702=grep("^Si",datostfg2[,81])
datostfg2[grep2702,81]
datostfg2[grep2702,76]
datostfg2[grep2702[-c(4)],76]="1"
grep2702=grep("taqui",datostfg2[,81])
datostfg2[grep2702,81]
datostfg2[grep2702,76]
datostfg2[grep2702,76]="1"
grep2702=grep("arrit",datostfg2[,81])
datostfg2[grep2702,81]
datostfg2[grep2702,76]
datostfg2[grep2702,76]="1"
grep2702=grep("^Tanto",datostfg2[,81])
datostfg2[grep2702,81]
datostfg2[grep2702,76]
datostfg2[grep2702,76]="1"
grep2702=grep("^REFIE",datostfg2[,81])
datostfg2[grep2702,81]
datostfg2[grep2702,76]
datostfg2[grep2702,76]="1"
grep2702=grep("^Paraple",datostfg2[,81])
datostfg2[grep2702,81]
datostfg2[grep2702,76]
datostfg2[grep2702,76]="1"
grep2702=grep("^Ocasio",datostfg2[,81])
datostfg2[grep2702,81]
datostfg2[grep2702,76]
datostfg2[grep2702[-c(4)],76]="1"
grep2702=grep("Nota",datostfg2[,81])
datostfg2[grep2702,81]
datostfg2[grep2702,76]
datostfg2[grep2702,76]="1"
grep2702=grep("deporte palpi",datostfg2[,81])
datostfg2[grep2702,81]
datostfg2[grep2702,76]
datostfg2[grep2702,76]="1"
grep2702=grep("calambre",datostfg2[,81])
datostfg2[grep2702,81]
datostfg2[grep2702,76]
datostfg2[grep2702,76]="1"
grep2702=grep("estricta",datostfg2[,81])
datostfg2[grep2702,81]
datostfg2[grep2702,76]
datostfg2[grep2702,76]="1"
grep2702=grep("^Lo",datostfg2[,81])
datostfg2[grep2702,81]
datostfg2[grep2702,76]
datostfg2[grep2702,76]="1"
grep2702=grep("Extra",datostfg2[,81])
datostfg2[grep2702,81]
datostfg2[grep2702,76]
datostfg2[grep2702,76]="1"
grep2702=grep("^Espo",datostfg2[,81])
datostfg2[grep2702,81]
datostfg2[grep2702,76]
datostfg2[grep2702,76]="1"
grep2702=grep("En",datostfg2[,81])
datostfg2[grep2702,81]
datostfg2[grep2702,76]
datostfg2[grep2702,76]="1"
grep2702=grep("^Alguna",datostfg2[,81])
datostfg2[grep2702,81]
datostfg2[grep2702,76]
datostfg2[grep2702,76]="1"
grep2702=grep("^A veces",datostfg2[,81])
datostfg2[grep2702,81]
datostfg2[grep2702,76]
datostfg2[grep2702,76]="1"
grep2702=grep("^en",datostfg2[,81])
datostfg2[grep2702,81]
datostfg2[grep2702,76]
datostfg2[grep2702,76]="1"
grep2702=grep("2010",datostfg2[,81])
datostfg2[grep2702,81]
datostfg2[grep2702,76]
datostfg2[grep2702,76]="1"
grep2702=grep("160",datostfg2[,81])
datostfg2[grep2702,81]
datostfg2[grep2702,76]
datostfg2[grep2702,76]="1"
grep2702=grep("200",datostfg2[,81])
datostfg2[grep2702,81]
datostfg2[grep2702,76]
datostfg2[grep2702,76]="1"
grep2702=grep("Arritmia",datostfg2[,81])
datostfg2[grep2702,81]
datostfg2[grep2702,76]
datostfg2[grep2702,76]="1"
grep2702=grep("se le sube",datostfg2[,81])
datostfg2[grep2702,81]
datostfg2[grep2702,76]
datostfg2[grep2702,76]="1"

grep2703=grep("0",datostfg2[,77])
table(datostfg2[grep2703,82])

grep2704=grep("UNA",datostfg2[,82])
datostfg2[grep2704,82]
datostfg2[grep2704,77]
datostfg2[grep2704,77]="1"
grep2704=grep("sincopes",datostfg2[,82])
datostfg2[grep2704,82]
datostfg2[grep2704,77]
datostfg2[grep2704,77]="1"
grep2704=grep("^Refiere haber",datostfg2[,82])
datostfg2[grep2704,82]
datostfg2[grep2704,77]
datostfg2[grep2704,77]="1"
grep2704=grep("^Por snd",datostfg2[,82])
datostfg2[grep2704,82]
datostfg2[grep2704,77]
datostfg2[grep2704,77]="1"
grep2704=grep("P?dida",datostfg2[,82])
datostfg2[grep2704,82]
datostfg2[grep2704,77]
datostfg2[grep2704[-c(56,54,52,46,45,33)],77]="1"
grep2704=grep("^Otros",datostfg2[,82])
datostfg2[grep2704,82]
datostfg2[grep2704,77]
datostfg2[grep2704,77]="1"
grep2704=grep("inyecc",datostfg2[,82])
datostfg2[grep2704,82]
datostfg2[grep2704,77]
datostfg2[grep2704,77]="1"
grep2704=grep("EPI",datostfg2[,82])
datostfg2[grep2704,82]
datostfg2[grep2704,77]
datostfg2[grep2704,77]="1"
grep2704=grep("^Lo",datostfg2[,82])
datostfg2[grep2704,82]
datostfg2[grep2704,77]
datostfg2[grep2704,77]="1"
grep2704=grep("^En",datostfg2[,82])
datostfg2[grep2704,82]
datostfg2[grep2704,77]
datostfg2[grep2704,77]="1"
grep2704=grep("^en",datostfg2[,82])
datostfg2[grep2704,82]
datostfg2[grep2704,77]
datostfg2[grep2704,77]="1"
grep2704=grep("^Despu",datostfg2[,82])
datostfg2[grep2704,82]
datostfg2[grep2704,77]
datostfg2[grep2704,77]="1"
grep2704=grep("orinar",datostfg2[,82])
datostfg2[grep2704,82]
datostfg2[grep2704,77]
datostfg2[grep2704,77]="1"
grep2704=grep("traumatis",datostfg2[,82])
datostfg2[grep2704,82]
datostfg2[grep2704,77]
datostfg2[grep2704,77]="1"
grep2703=grep("0",datostfg2[,77])
table(datostfg2[grep2703,82])
grep2704=grep("^Parapleji",datostfg2[,82])
datostfg2[grep2704,82]
datostfg2[grep2704,77]
datostfg2[grep2704,79] ####Ya registrado

grep2705=grep("0",datostfg2[,78])
table(datostfg2[grep2705,83])

grep2706=grep("^Verano",datostfg2[,83])
datostfg2[grep2706,83]
datostfg2[grep2706,78]
datostfg2[grep2706,78]="1"
grep2706=grep("^Una vez",datostfg2[,83])
datostfg2[grep2706,83]
datostfg2[grep2706,78]
datostfg2[grep2706,78]="1"
grep2706=grep("^Una sola",datostfg2[,83])
datostfg2[grep2706,83]
datostfg2[grep2706,78]
datostfg2[grep2706,78]="1"
grep2706=grep("TRas",datostfg2[,83])
datostfg2[grep2706,83]
datostfg2[grep2706,78]
datostfg2[grep2706,78]="1"
grep2706=grep("Sincopes",datostfg2[,83])
datostfg2[grep2706,83]
datostfg2[grep2706,78]
datostfg2[grep2706,78]="1"
grep2706=grep("^Si",datostfg2[,83])
datostfg2[grep2706,83]
datostfg2[grep2706,78]
datostfg2[grep2706,78]="1"
grep2706=grep("^si",datostfg2[,83])
datostfg2[grep2706,83]
datostfg2[grep2706,78]
datostfg2[grep2706,78]="1"
grep2706=grep("cevical",datostfg2[,83])
datostfg2[grep2706,83]
datostfg2[grep2706,78]
datostfg2[grep2706,78]="1"
grep2706=grep("^Refiere",datostfg2[,83])
datostfg2[grep2706,83]
datostfg2[grep2706,78]
datostfg2[grep2706,78]="1"
grep2706=grep("^REFI",datostfg2[,83])
datostfg2[grep2706,83]
datostfg2[grep2706,78]
datostfg2[grep2706,78]="1"
grep2706=grep("^refe",datostfg2[,83])
datostfg2[grep2706,83]
datostfg2[grep2706,78]
datostfg2[grep2706,78]="1"
grep2706=grep("^Presin",datostfg2[,83])
datostfg2[grep2706,83]
datostfg2[grep2706,78]
datostfg2[grep2706,78]="1"
grep2706=grep("^Por",datostfg2[,83])
datostfg2[grep2706,83]
datostfg2[grep2706,78]
datostfg2[grep2706,78]="1"
grep2706=grep("^Ocasionalmente",datostfg2[,83])
datostfg2[grep2706,83]
datostfg2[grep2706,78]
datostfg2[grep2706,78]="1"
grep2706=grep("perior",datostfg2[,83])
datostfg2[grep2706,83]
datostfg2[grep2706,78]
datostfg2[grep2706,78]="1"
grep2706=grep("lipo",datostfg2[,83])
datostfg2[grep2706,83]
datostfg2[grep2706,78]
datostfg2[grep2706,78]="1"
grep2706=grep("p?jara",datostfg2[,83])
datostfg2[grep2706,83]
datostfg2[grep2706,78]
datostfg2[grep2706,78]="1"
grep2706=grep("cefalea",datostfg2[,83])
datostfg2[grep2706,83]
datostfg2[grep2706,78]
datostfg2[grep2706,78]="1"
grep2706=grep("^Mareo",datostfg2[,83])
datostfg2[grep2706,83]
datostfg2[grep2706,78]
datostfg2[grep2706,78]="1"
grep2706=grep("^mareo",datostfg2[,83])
datostfg2[grep2706,83]
datostfg2[grep2706,78]
datostfg2[grep2706,78]="1"
grep2706=grep("^Ligero",datostfg2[,83])
datostfg2[grep2706,83]
datostfg2[grep2706,78]
datostfg2[grep2706,78]="1"
grep2706=grep("^Esp",datostfg2[,83])
datostfg2[grep2706,83]
datostfg2[grep2706,78]
datostfg2[grep2706,78]="1"
grep2706=grep("^Fue",datostfg2[,83])
datostfg2[grep2706,83]
datostfg2[grep2706,78]
datostfg2[grep2706,78]="1"
grep2706=grep("^fue",datostfg2[,83])
datostfg2[grep2706,83]
datostfg2[grep2706,78]
datostfg2[grep2706,78]="1"
grep2706=grep("^En",datostfg2[,83])
datostfg2[grep2706,83]
datostfg2[grep2706,78]
datostfg2[grep2706,78]="1"
grep2706=grep("^en",datostfg2[,83])
datostfg2[grep2706,83]
datostfg2[grep2706,78]
datostfg2[grep2706,78]="1"
grep2706=grep("^El",datostfg2[,83])
datostfg2[grep2706,83]
datostfg2[grep2706,78]
datostfg2[grep2706,78]="1"
grep2706=grep("^Cuando",datostfg2[,83])
datostfg2[grep2706,83]
datostfg2[grep2706,78]
datostfg2[grep2706,78]="1"
grep2706=grep("^Al",datostfg2[,83])
datostfg2[grep2706,83]
datostfg2[grep2706,78]
datostfg2[grep2706,78]="1"
grep2706=grep("^A veces",datostfg2[,83])
datostfg2[grep2706,83]
datostfg2[grep2706,78]
datostfg2[grep2706,78]="1"
grep2706=grep("^A mediado",datostfg2[,83])
datostfg2[grep2706,83]
datostfg2[grep2706,78]
datostfg2[grep2706,78]="1"
grep2706=grep("^2015",datostfg2[,83])
datostfg2[grep2706,83]
datostfg2[grep2706,78]
datostfg2[grep2706,78]="1"
grep2706=grep("^Dos",datostfg2[,83])
datostfg2[grep2706,83]
datostfg2[grep2706,78]
datostfg2[grep2706,78]="1"
grep2706=grep("patolo",datostfg2[,83])
datostfg2[grep2706,83]
datostfg2[grep2706,78]
datostfg2[grep2706,78]="1"
grep2706=grep("v?rtigo",datostfg2[,83])
datostfg2[grep2706,83]
datostfg2[grep2706,78]
datostfg2[grep2706,78]="1"
grep2706=grep("Refia",datostfg2[,83])
datostfg2[grep2706,83]
datostfg2[grep2706,78]
datostfg2[grep2706,78]="1"
grep2705=grep("0",datostfg2[,78])
table(datostfg2[grep2705,83])



table(datostfg2[,74])
for (i in 1:11984){comp=(is.na(datostfg2[i,74])==TRUE&&
  is.na(datostfg2[i,79])==FALSE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,74]="Revisar"
}else{
        datostfg2[i,74]=datostfg2[i,74]
}}

grep2904=grep("Revisar",datostfg2[,74])
datostfg2[grep2904,79]
datostfg2[grep2904,74]="1"

table(datostfg2[,75])
for (i in 1:11984){comp=(is.na(datostfg2[i,75])==TRUE&&
  is.na(datostfg2[i,80])==FALSE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,75]="Revisar"
}else{
        datostfg2[i,75]=datostfg2[i,75]
}}
grep2904=grep("Revisar",datostfg2[,75])
datostfg2[grep2904,80]
datostfg2[grep2904,75]="1"


table(datostfg2[,76])
for (i in 1:11984){comp=(is.na(datostfg2[i,76])==TRUE&&
  is.na(datostfg2[i,81])==FALSE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,76]="Revisar"
}else{
        datostfg2[i,76]=datostfg2[i,76]
}}
grep2904=grep("Revisar",datostfg2[,76])
datostfg2[grep2904,81]
datostfg2[grep2904,76]="1"

table(datostfg2[,77])
for (i in 1:11984){comp=(is.na(datostfg2[i,77])==TRUE&&
  is.na(datostfg2[i,82])==FALSE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,77]="Revisar"
}else{
        datostfg2[i,77]=datostfg2[i,77]
}}
grep2904=grep("Revisar",datostfg2[,77])
datostfg2[grep2904,82]
datostfg2[grep2904,77]="1"

table(datostfg2[,78])
for (i in 1:11984){comp=(is.na(datostfg2[i,78])==TRUE&&
  is.na(datostfg2[i,83])==FALSE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,78]="Revisar"
}else{
        datostfg2[i,78]=datostfg2[i,78]
}}
grep2904=grep("Revisar",datostfg2[,78])
datostfg2[grep2904,83]
datostfg2[grep2904[-c(3)],78]="1"
datostfg2[grep2904[c(3)],78]="0"

datostfg2[c(2676,3877,5871,5919,6123),83]
datostfg2[c(2676,3877,5871,5919,6123),78]="0"
```


```{r,include=TRUE}
###Variable 84 Otros hábitos
table(datostfg2[,84])
datostfg2[7141,84]=datostfg[7141,83]
datostfg2[706,84]=datostfg[706,83]
datostfg2[6272,97]=datostfg[6272,84]


for (i in 1:11984){comp=(
  is.na(datostfg2[i,37])==FALSE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,84]="1"
}else{
        datostfg2[i,84]="0"
}}



table(datostfg2[,84])
```

```{r,include=TRUE}
###Variable 85 ###FechaConsulta
table(datostfg2[,85])
datostfg2[7141,85]##Fecha errónea
datostfg2[7141,85]=NA
datostfg2[706,85]###Fecha errónea
datostfg2[706,85]=NA
datostfg2[6272,98]=datostfg[6272,85]
table(datostfg2[,85])
```

```{r,include=TRUE}
###Variable 86 (Ciclos.regulares.)
table(datostfg2[,86])
datostfg2[7141,86]##Error
datostfg2[7141,86]=NA
datostfg2[706,86]=datostfg[706,85]
datostfg2[6272,99]=datostfg[6272,86]
table(datostfg2[,86])

```

```{r,include=TRUE}
###Variable 87(num_edad_menarquia):Número de edad de la menarquía(Primera menstruación)
table(datostfg2[,87])
datostfg2[7141,87]=datostfg[7141,86]
datostfg2[706,87]=datostfg[706,86]
datostfg2[6272,100]=datostfg[6272,87]
table(datostfg2[,87])
datostfg2[597,87]=NA ####Hay fallos en el caso 597
grep20Menar=grep("20",datostfg2[,87]) ###Caso 3626 parece que no hay error
table(datostfg2[,87])

```

```{r,include=TRUE}
###Variable 88(num_ciclo):Número de días entre cada ciclo.
table(datostfg2[,88])
datostfg2[7141,88]=datostfg[7141,87]
datostfg2[706,88]=datostfg[706,87]
datostfg2[6272,101]=datostfg[6272,88]
grep838=grep("^0",datostfg2[,88]) ####Estudiar caso 7761
datostfg2[grep838,87] 
###Se tratará de un error
datostfg2[grep838,88]=NA
table(datostfg2[,88])

```

```{r,include=TRUE}
###Variable 89(num_duracion_menstruacion):Número de días que dura la menstruación
table(datostfg2[,89])
datostfg2[7141,89]=datostfg[7141,88]
datostfg2[706,89]=datostfg[7141,88]
datostfg2[6272,102]=datostfg[6272,89]
table(datostfg2[,89])
grep23Mens=grep("23",datostfg2[,89])
datostfg2[grep23Mens,88]####Caso 597
datostfg2[grep23Mens,89]=NA
grep28Mens=grep("28",datostfg2[,89])
datostfg2[grep28Mens,88] ###Caso 1077
datostfg2[grep28Mens,88]=datostfg[grep28Mens,89]
datostfg2[grep28Mens,89]=NA
table(datostfg2[,89])
```

```{r,include=TRUE}
###Variable 90(Ciclos.irregulares)
table(datostfg2[,90])
datostfg2[7141,90]=datostfg[7141,89]
datostfg2[706,90]=datostfg[706,89]
datostfg2[6272,103]=datostfg[6272,90]
table(datostfg2[,90])

```

```{r,include=TRUE}
###Variable 91 ###Antecedentes Ginecológicos
table(datostfg2[,91])
datostfg2[7141,91]=datostfg[7141,90]
datostfg2[706,91]=datostfg[706,90]
datostfg2[6272,104]=datostfg[6272,91]
table(datostfg2[,91])

```

```{r,include=TRUE}
###Variable 92  ###Nota
table(datostfg2[,92])
datostfg2[7141,92]=datostfg[7141,91]
datostfg2[706,92]=datostfg[706,91]
datostfg2[6272,105]=datostfg[6272,92] 
datostfg2[129,102]=datostfg[129,92] 
datostfg2[129,92]=NA
table(datostfg2[,92])
grep839=grep("1",datostfg2[.92])
grep840=grep("768",datostfg2[.92])
grep841=grep("menarq",datostfg2[.92])
grep842=grep("PENDIENTE",datostfg2[.92])
table(datostfg2[,92])
####Da igual,porque esta variable es irrelevante.
```

```{r,include=TRUE}
####Variable 93 Sexo del deportista

datostfg2[,7]==datostfg2[,93]
table(datostfg2[,7]) ####Me fiaré de esta variable que contiene más casos registrados.
table(datostfg2[,93])
datostfg2[7141,93]=datostfg[7141,92]
datostfg2[706,93]=datostfg[706,92]
datostfg2[6272,93]####Corresponde a la variable 106
datostfg2[6272,106]=datostfg[6272,93]
datostfg2[129,103]=datostfg[129,93]###Caso 129,hay fallos en la recogida de datos
####No considerar,esta información ya la tenemos en la variable 7 Sexo
datostfg2[129,93]=NA
table(datostfg2[,93])
```

```{r,include=TRUE}
####Variable 94(Si) y 95(No)


table(datostfg2[,94])
table(datostfg2[,95])
datostfg2[7141,94]=datostfg[7141,93]
datostfg2[7141,95]=datostfg[7141,94]
datostfg2[706,94]=datostfg[706,93]
datostfg2[706,95]=datostfg[706,94]
datostfg2[6272,107]=datostfg[6272,94]
datostfg2[6272,108]=datostfg[6272,95]
datostfg2[129,104]=datostfg[129,94]
datostfg2[129,105]=datostfg[129,95]
datostfg2[129,94]=NA
datostfg2[129,95]=NA
table(datostfg2[,94])
table(datostfg2[,95])


```

```{r,include=TRUE}
####Variable 96(ConsAnticoncep_tab)y 97(ConsAnticoncep_txt)
###Consumo de Anticonceptivos


table(datostfg2[,96])
table(datostfg2[,97])
datostfg2[7141,96]=datostfg[7141,95]
datostfg2[7141,97]=datostfg[7141,96]
datostfg2[706,96]=datostfg[706,95]
datostfg2[706,97]=datostfg[706,96]
datostfg2[6272,109]=datostfg[6272,96]
datostfg2[6272,110]=datostfg[6272,97]
datostfg2[129,106]=datostfg[129,96]
datostfg2[129,107]=datostfg[129,97]
datostfg2[129,96]=NA
datostfg2[129,97]=NA
grepACO97=grep("ACO",datostfg2[,97])
grepconcep97=grep("concep",datostfg2[,97])
grepCONCEP97=grep("CONCEP",datostfg2[,97])
grepConcep97=grep("Consep",datostfg2[,97])
datostfg2[grepACO97,97]
datostfg2[grepACO97,96] ####Ya está registrado
grepAnillo97=grep("Anillo",datostfg2[,97])
grepanillo97=grep("anillo",datostfg2[,97])
grepANILLO97=grep("ANILLO",datostfg2[,97])
grepDIU97=grep("DIU",datostfg2[,97])
grepDiu97=grep("Diu",datostfg2[,97])
grepdiu97=grep("diu",datostfg2[,97])
grepOtros97=grep("Otros",datostfg2[,97])
grepotros97=grep("otros",datostfg2[,97])
grepOTROS97=grep("OTROS",datostfg2[,97])
table(datostfg2[,96])
table(datostfg2[,97])
grep2402=grep("ACO",datostfg2[,42])
datostfg2[grep2402,42]
datostfg2[grep2402,96]="ACO"

datostfg2[c(2676,3877,5871,5919,6123),97]
datostfg2[c(2676,3877,5871,5919,6123),96]

```

```{r,include=TRUE}
####Variable 98 (ComentariosGine_txt)

table(datostfg2[,98])
datostfg2[7141,98]=datostfg[7141,97]
datostfg2[706,98]=datostfg[706,97]
datostfg2[6272,111]=datostfg[6272,98]
datostfg2[129,108]=datostfg[129,98]
datostfg2[129,98]=NA


grepACO97=grep("ACO",datostfg2[,98])
datostfg2[grepACO97,98]
datostfg2[grepACO97,96]
datostfg2[grepACO97[c(5,7,10,11)],96]="ACO"
grepAco97=grep("Aco",datostfg2[,98])
grepaco97=grep("aco",datostfg2[,98])
grepconcep97=grep("concep",datostfg2[,98])
datostfg2[grepconcep97,98]
datostfg2[grepconcep97,96]
datostfg2[grepconcep97,96]="ACO"
grepCONCEP97=grep("CONCEP",datostfg2[,98])
datostfg2[grepCONCEP97,98]
datostfg2[grepCONCEP97,96]
grepConcep97=grep("Consep",datostfg2[,98])
grepAnillo97=grep("Anillo",datostfg2[,98])
datostfg2[grepAnillo97,98]
datostfg2[grepAnillo97,96] ####Tuvo Anillo Vaginal
grepanillo97=grep("anillo",datostfg2[,98])
grepANILLO97=grep("ANILLO",datostfg2[,98])
grepDIU97=grep("DIU",datostfg2[,98])
datostfg2[grepDIU97,98]
datostfg2[grepDIU97,96]
datostfg2[grepDIU97,96]="DIU"
grepDiu97=grep("Diu",datostfg2[,98])
grepdiu97=grep("diu",datostfg2[,98])
grepOtros97=grep("Otros",datostfg2[,98])
grepotros97=grep("otros",datostfg2[,98])
grepOTROS97=grep("OTROS",datostfg2[,98])

####Información de ciclos regulares e irregulares
grep2300=grep("regular",datostfg2[,98])
datostfg2[grep2300,98]
datostfg2[grep2300[c(3,5,13,20,22)],86]
datostfg2[grep2300[c(3)],86]="1"
datostfg2[grep2300[c(22)],88]="60"
grep2301=grep("Regular",datostfg2[,98])
datostfg2[grep2301,98]
datostfg2[grep2301,86]="1"
grep2302=grep("REGULAR",datostfg2[,98])
datostfg2[grep2302,98]
datostfg2[grep2302,90]="1"
grep2303=grep("irregular",datostfg2[,98])
datostfg2[grep2303,98]
datostfg2[grep2303,90]
datostfg2[grep2303[c(2)],90]="1"
grep2304=grep("Irregular",datostfg2[,98])
datostfg2[grep2304,98]
datostfg2[grep2304,90]
```

```{r,include=TRUE}
####Variable 99 Aspecto y 106


table(datostfg2[,99])
datostfg2[7141,99]=datostfg[7141,98]
datostfg2[7141,106]=datostfg[7141,105]
datostfg2[706,99]=datostfg[706,98]
datostfg2[706,106]=datostfg[706,105]
datostfg2[6272,112]=datostfg[6272,99]
datostfg2[6272,119]=datostfg[6272,106]
datostfg2[129,109]=datostfg[129,99]
datostfg2[129,116]=datostfg[129,106]
datostfg2[129,109]=NA
datostfg2[129,116]=NA
table(datostfg2[,99])

table(datostfg2[,106])
grep845=grep("marfanoide",datostfg2[,106])
datostfg2[grep845,99] ####Problemas esqueléticos
datostfg2[grep845,99]
grep846=grep("^Acent",datostfg2[,106])
datostfg2[grep846,106]
datostfg2[grep846[c(1,4,5)],99]="0" ####Lordosis lumbar
grep847=grep("Alineaci",datostfg2[,106])
datostfg2[grep847,106]
datostfg2[grep847[c(1)],99]
grep848=grep("Inspec",datostfg2[,106]) ####Test de Adams positivo(desviación de la columna)
datostfg2[grep848,106]
datostfg2[grep848,99]
grep849=grep("Adams positivo",datostfg2[,106])
datostfg2[grep849[c(3)],106]
grep850=grep("Arrastra",datostfg2[,106])
datostfg2[grep850,106]
grep851=grep("cabestrillo",datostfg2[,106])
datostfg2[grep851,106]

```

```{r,include=TRUE}
####Variable 100 (ORL) y 108(txt_oidos)
###La otorrinolaringología es la especialidad médico-quirúrgica que se encarga de las enfermedades del oído,tanto auditivas como de equilibrio,de las vías respiratorias superiores y parte de las inferiores(nariz,senos paranasales,faringe y laringe) y también de la cirugía relacionada con la glándula tiroides.La cirugía traumatológica,oncológica,plástica,estética y reparadora de la cara y el cuello también se incluyen en el ámbito de esta especialidad médico-quirúrgica.
####Si el paciente presenta algo reseñable a nivel otorrinolaringología,la variable numérica debe presentar un 1.
table(datostfg2[,100])
datostfg2[7141,100]=datostfg[7141,99]
datostfg2[706,100]=datostfg[706,99]
datostfg2[6272,113]=datostfg[6272,100]
datostfg2[129,110]=datostfg[129,100]
datostfg2[129,100]=NA
table(datostfg2[,100])

datostfg2[7141,108]=datostfg[7141,107]
datostfg2[706,108]=datostfg[706,107]
datostfg2[6272,121]=datostfg[6272,108]
datostfg2[129,108] ####Corresponde a la variable 118
datostfg2[129,118]=datostfg[129,108]
table(datostfg2[,108])

grep1142=grep("^No",datostfg2[,108])
datostfg2[grep1142,108]##659,512,493,464,457,444,435,427,414,406,332,268,249,122,101
datostfg2[grep1142[c(659,512,493,464,457,444,435,427,414,406,332,268,249,122,101)],100] 
datostfg2[grep1142[c(659,512,493,464,457,444,435,427,414,406,332,268,249,122,101)],100]="1"
grep1142=grep1142[-c(659,512,493,464,457,444,435,427,414,406,332,268,249,122,101)]
grep1143=grep("^no",datostfg2[,108])
grep1143=grep("^NO",datostfg2[,108])
datostfg2[grep1143,108]
grep1144=grep("NR",datostfg2[,108])
grep1144=grep("^N.R",datostfg2[,108])
grep1144=grep("^Ni",datostfg2[,108])
grep1144=grep("^NI",datostfg2[,108])
grep1144=grep("^ni",datostfg2[,108])
grep1144=grep("^SIN",datostfg2[,108])
grep1144=grep("^sin",datostfg2[,108])
grep1144=grep("^Sin",datostfg2[,108])
datostfg2[grep1144,108]
datostfg2[grep1144[c(6,7)],108]
datostfg2[grep1144[c(6,7)],100]###Ya presentan 1's
grep1144=grep1144[-c(6,7)]


grep1145=grep("Mucos",datostfg2[,108])
datostfg2[grep1145,108]
datostfg2[grep1145,100] ###Ya presntan 1's
grep1146=grep("mucos",datostfg2[,108])
datostfg2[grep1146,108]
datostfg2[grep1146[c(2,3,5,30)],108] ###2,3,5 y 30 corresponden a la variable piel_txt,aunque en 5 también hay información correcta
datostfg2[grep1146[c(2,3,30)],100]
datostfg2[grep1146[c(2,3,30)],100]=NA
datostfg2[grep1146[c(5)],100]
datostfg2[grep1146[c(5)],100]="0"
datostfg2[grep1146[-c(2,3,5,30)],100] ####Todos deben ser igual a 1
datostfg2[grep1146[-c(2,3,5,30)],100]="1"
datostfg2[grep1146[c(2,3,5,30)],116] ###Ya existen registros
grep1147=grep("MUCOS",datostfg2[,108])
grep1147=grep("erite",datostfg2[,108])
datostfg2[grep1147,108]
datostfg2[grep1147,100]
datostfg2[grep1147,100]="1"
grep1148=grep("Erite",datostfg2[,108])
grep1148=grep("ERITE",datostfg2[,108])
grep1148=grep("PLACA",datostfg2[,108])
grep1148=grep("Placa",datostfg2[,108])
datostfg2[grep1148,108]
datostfg2[grep1148,100] ###Ya presentan 1's
grep1149=grep("placa",datostfg2[,108])
datostfg2[grep1149,108]
datostfg2[grep1149,100]###Ya presentan 1's
grep1150=grep("EPISTAXIS",datostfg2[,108]) ###Hemorragia nasal
grep1150=grep("Epistaxis",datostfg2[,108])
datostfg2[grep1150,108]
datostfg2[grep1150,100] ###Ya presentan 1's
grep1151=grep("epistaxis",datostfg2[,108])
datostfg2[grep1151,108]
datostfg2[grep1151,100]###Ya presentan 1's
grep1152=grep("ENROJ",datostfg2[,108]) 
grep1152=grep("Enroj",datostfg2[,108])
grep1152=grep("enroj",datostfg2[,108])
datostfg2[grep1152,108]
datostfg2[grep1152,100] ###Ya presentan 1's
grep1153=grep("CATARRO",datostfg2[,108]) 
grep1153=grep("Catarro",datostfg2[,108])
datostfg2[grep1153,108]
datostfg2[grep1153,100] ###Ya presentan 1's
grep1154=grep("catarro",datostfg2[,108])
datostfg2[grep1154,108]
datostfg2[grep1154,100] ###Ya presentan 1's
grep1155=grep("DISMINU",datostfg2[,108]) 
grep1155=grep("Disminu",datostfg2[,108])
datostfg2[grep1155,108]
datostfg2[grep1155,100] ###Ya presentan 1's
grep1156=grep("disminu",datostfg2[,108])
datostfg2[grep1156,108]
datostfg2[grep1156,100] ###Ya presentan 1's
grep1157=grep("DIFI",datostfg2[,108]) 
grep1157=grep("Difi",datostfg2[,108])
datostfg2[grep1157,108]
datostfg2[grep1157,100] ###Ya presentan 1's
grep1158=grep("difi",datostfg2[,108])
datostfg2[grep1158,108]
datostfg2[grep1158,100] ###Ya presentan 1's
grep1159=grep("Desvi",datostfg2[,108]) 
datostfg2[grep1159,108]
datostfg2[grep1159,100] ###Ya presentan 1's
grep1160=grep("DESVI",datostfg2[,108])
grep1161=grep("desvi",datostfg2[,108])
datostfg2[grep1161,108]
datostfg2[grep1161,100] ###Ya presentan 1's
grep1162=grep("hipo",datostfg2[,108]) 
datostfg2[grep1162,108]
datostfg2[grep1162,100] ###Ya presentan 1's
grep1163=grep("HIPO",datostfg2[,108])
grep1163=grep("Hipo",datostfg2[,108])
datostfg2[grep1163,108]
datostfg2[grep1163,100]
datostfg2[grep1163,100]="1"
grep1164=grep("hipe",datostfg2[,108]) 
datostfg2[grep1164,108]
datostfg2[grep1164,100]
datostfg2[grep1164,100]="1"
grep1165=grep("HIPER",datostfg2[,108])
grep1165=grep("Hipe",datostfg2[,108])
datostfg2[grep1165,108]
datostfg2[grep1165,100]
datostfg2[grep1165,100]="1"
grep1166=grep("pala",datostfg2[,108]) 
datostfg2[grep1166,108]
datostfg2[grep1166,100] ###Ya presentan 1's
grep1167=grep("PALA",datostfg2[,108])
grep1167=grep("Pala",datostfg2[,108])
grep1167=grep("Sordera",datostfg2[,108]) 
datostfg2[grep1167,108]
datostfg2[grep1167,100] ###Ya presentan 1's
grep1168=grep("SORDERA",datostfg2[,108])
grep1168=grep("sordera",datostfg2[,108])
grep1168=grep("Insu",datostfg2[,108]) 
datostfg2[grep1168,108]
datostfg2[grep1168,100] ###Ya presenta un 1
grep1169=grep("INSU",datostfg2[,108])
grep1169=grep("insu",datostfg2[,108])
grep1169=grep("Mame",datostfg2[,108]) 
grep1169=grep("MAME",datostfg2[,108])
grep1169=grep("mame",datostfg2[,108])
datostfg2[grep1169,108]
datostfg2[grep1169,100] ###Ya presentan 1's
grep1170=grep("Faringo",datostfg2[,108]) 
grep1170=grep("FARINGO",datostfg2[,108])
grep1170=grep("faringo",datostfg2[,108])
datostfg2[grep1170,108]
datostfg2[grep1170,100] ###Ya presentan 1's
grep1171=grep("Hema",datostfg2[,108]) 
grep1171=grep("HEMA",datostfg2[,108])
grep1171=grep("hema",datostfg2[,108])
datostfg2[grep1171,108]
datostfg2[grep1171,100] ###Ya presentan 1's

grep1172=grep("Oste",datostfg2[,108]) 
grep1172=grep("OSTE",datostfg2[,108])
grep1172=grep("osteoma",datostfg2[,108])
datostfg2[grep1172,108]
datostfg2[grep1172,100] 
datostfg2[grep1172,100]="1"
grep1173=grep("Membra",datostfg2[,108]) 
datostfg2[grep1173,108]
datostfg2[grep1173,100] 
datostfg2[grep1173,100]="1"
grep1174=grep("MEMBRA",datostfg2[,108])
grep1174=grep("membra",datostfg2[,108])
datostfg2[grep1174,108]
datostfg2[grep1174,100] ###Está bien registrado el caso 3 de este grep ya que lo normal es que los conductos auditivos sean permeables aunque hay un fallo en el caso 4.
datostfg2[grep1174[c(4)],100]="1"
grep1175=grep("Amig",datostfg2[,108]) 
datostfg2[grep1175,108]
datostfg2[grep1175,100] ####Ya presentan 1´s
grep1176=grep("AMIG",datostfg2[,108])
grep1176=grep("amig",datostfg2[,108])
datostfg2[grep1176,108]
datostfg2[grep1176,100] ###Todos bien registrados menos 7,51,67,68 y 83
datostfg2[grep1176[c(7)],100]="0"
datostfg2[grep1176[c(51,67,68,83)],100]="1"
grep1177=grep("p?rdida",datostfg2[,108]) 
datostfg2[grep1177,108]
datostfg2[grep1177,100] 
datostfg2[grep1177,100]="1"
grep1178=grep("P?RDI",datostfg2[,108])
grep1178=grep("P?rdida",datostfg2[,108]) ##Igual que grep1177
grep1179=grep("tinitus",datostfg2[,108]) 
datostfg2[grep1179,108]
datostfg2[grep1179,100] ###Ya presenta un 1
grep1180=grep("TINITU",datostfg2[,108])
grep1180=grep("Tinitu",datostfg2[,108])
grep1181=grep("infla",datostfg2[,108]) 
datostfg2[grep1181,108]
datostfg2[grep1181,100] ###Ya presentan 1's
grep1182=grep("INFLA",datostfg2[,108])
grep1182=grep("Infla",datostfg2[,108]) 
datostfg2[grep1182,108]
datostfg2[grep1182,100] ###Ya presenta un 1
grep1183=grep("vascu",datostfg2[,108]) 
datostfg2[grep1183,108]
datostfg2[grep1183,100] ###Ya presentan 1's
grep1184=grep("VASCU",datostfg2[,108])
grep1184=grep("Vascu",datostfg2[,108]) 
grep1184=grep("lustre",datostfg2[,108]) 
datostfg2[grep1184,108]
datostfg2[grep1184,100] ###Ya presentan 1's
grep1185=grep("Lustre",datostfg2[,108])
grep1185=grep("LUSTRE",datostfg2[,108]) 
grep1186=grep("desca",datostfg2[,108]) 
datostfg2[grep1186,108]
datostfg2[grep1186,100] ###Ya presentan 1's
grep1187=grep("Desca",datostfg2[,108])
grep1187=grep("DESCA",datostfg2[,108]) 
grep1187=grep("mareo",datostfg2[,108]) 
datostfg2[grep1187,108]
datostfg2[grep1187,100] ###Ya presentan 1's
grep1188=grep("Mareo",datostfg2[,108])
grep1188=grep("MAREO",datostfg2[,108]) 
grep1188=grep("v?rtigo",datostfg2[,108]) 
datostfg2[grep1188,108]
datostfg2[grep1188,100] ###Ya presentan 1's
grep1189=grep("V?rtigo",datostfg2[,108])###Igual que grep1188
grep1189=grep("V?RTIGO",datostfg2[,108]) 
grep1189=grep("discon",datostfg2[,108]) 
datostfg2[grep1189,108]
datostfg2[grep1189,100] ###Ya presenta un 1
grep1190=grep("Discon",datostfg2[,108])
grep1190=grep("DISCON",datostfg2[,108])
grep1190=grep("tap?n",datostfg2[,108]) 
datostfg2[grep1190,108]
datostfg2[grep1190,100] ###Ya presentan 1's
grep1191=grep("Tap?n",datostfg2[,108])
grep1191=grep("TAP?N",datostfg2[,108]) 
grep1191=grep("caries",datostfg2[,108])
grep1191=grep("CARIES",datostfg2[,108])
grep1191=grep("Caries",datostfg2[,108])
datostfg2[grep1191,108] ####Tiene información de la variable 122(Odontología)
datostfg2[grep1191,100]###Error
datostfg2[grep1191,100]="0"
datostfg2[grep1191,122] ####Vamos a corregirlo en la variable 122
grep1192=grep("visual",datostfg2[,108])
datostfg2[grep1192,108]
datostfg2[grep1192[c(21)],108]####Información correspondiente a la variable 109(txt_ojos)
datostfg2[grep1192[c(21)],100]###Error
datostfg2[grep1192[c(21)],100]=NA
datostfg2[grep1192[c(21)],109]
datostfg2[grep1192[c(21)],109]=datostfg[grep1192[c(21)],108]
grep1193=grep("Visual",datostfg2[,108])
grep1193=grep("VISUAL",datostfg2[,108])
grep1193=grep("Colabo",datostfg2[,108])
grep1193=grep("COLABO",datostfg2[,108])
grep1194=grep("colabo",datostfg2[,108])
datostfg2[grep1194,108] 
datostfg2[grep1194,100]
datostfg2[grep1194[c(3,4,5)],100]=NA
grep1195=grep("disme",datostfg2[,108])
datostfg2[grep1195,108] ####Contiene información de la variable 106(txt_aspecto)
datostfg2[grep1195,100] ###Error
datostfg2[grep1195,100]="0"
datostfg2[grep1195,106]###Ya registrado
grep1196=grep("Disme",datostfg2[,108])
grep1196=grep("DISME",datostfg2[,108])
datostfg2[,100]=replace(datostfg2[,100],grep1142,"0")
datostfg2[,100]=replace(datostfg2[,100],grep1143,"0")
datostfg2[,100]=replace(datostfg2[,100],grep1144,"0")

grep1ORL=grep("1",datostfg2[,100])
datostfg2[grep1ORL,108]

####Hay que quitar los NA's
####Bucle
for (i in 1:11984){comp=(
  is.na(datostfg2[i,108])==TRUE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,100]="0"
}else{
        datostfg2[i,100]=datostfg2[i,100]
}}
####Hay que revisar los 1's
grep1ORL=grep("1",datostfg2[,100])
datostfg2[grep1ORL,108]
datostfg2[grep1ORL[1001:2000],108]
datostfg2[grep1ORL[2001:3000],108]
datostfg2[grep1ORL[3001:4000],108]
datostfg2[grep1ORL[4001:5000],108]
datostfg2[grep1ORL[5001:5300],108]

datostfg2[grep1ORL[c(780,478)],108]###Corresponde a la variable 107(txt_ojos)
datostfg2[grep1ORL[c(780,478)],107]###Ya registrado
datostfg2[grep1ORL[c(3095)],108] ###Contiene información de (txt_aspecto)
datostfg2[grep1ORL[c(3095)],106]
datostfg2[grep1ORL[c(3095)],106]="Buen estado general.Buena coloración de piel y mucosas.Exploración neurológica normal.Actitud cifotica anteposición de cadera derecha"
datostfg2[grep1ORL[c(3042)],108]
datostfg2[grep1ORL[c(2066)],108] ###Palpación

datostfg2[grep1ORL[c(996,994,990,989,987,982,979,977,976,973,966,964,949,948,947,945,919,918,916,905,893,889,887,886,885,881,864,859,858,852,839,834,822,819,818,817,812,810,809,808,807,801,800,795,793,791,789,781,778,766,764,750,748,740,739,738,709,704,702,699,697,696,679,667,660,652,651,650,647,637,621,601,582,579,575,570,569,565,558,557,556,551,550,546,541,527,525,516,515,510,498, 475,471,470,459,453,452,448,441,437,433,428,419,418,415,413,411,403,397,391,387,383,381,370,362,356,355,353,351,346,333,326,323,321,318,317,316,310,307,306,304,299,295,294,292,290,288,285,283,280,278,274,273,271,270,268,264,260,259,253,251,250,249,248,247,246,245,244,242,241,238,237,235,228,224,223,219,212,209,201,197,193,186,185,175,168,167,163,161,147,132,126,117,110,108,107,106,101,100,99,97,83,82,66,65,63,61,58,54,39,31,29,17,15,11,1,1999,1996,1994,1990,1988,1980,1975,1973,1970,1960,1954,1952,1949,1946,1940,1937,1933,1932,1926,1924,1922,1919,1918,1907,1905,1901,1899,1897,1894,1890,1888,1886,1880,1875,1871,1868,1867,1863,1861,1856,1852,1849,1845,1844,1840,1834,1828,1822,1805,1782,1774,1763,1758,1751,1746,1741,1740,1739,1734,1727,1723,1721,1713,1712,1710,1698,1697,1678,1675,1653,1645,1640,1631,1627,1624,1616,1612,1600,1595,1591,1587,1576,1573,1569,1566,1562,1560,1551,1548,1542,1539,1523,1521,1519,1518,1517,1513,1508,1503,1502,1500,1497,1494,1487,1485,1484,1483,1478,1475,1460,1458,1454,1451,1438,1436,1427,1417,1410,1406,1405,1393,1390,1389,1387,1374,1366,1365,1357,1355,1351,1349,1345,1332,1327,1315,1310,1305,1293,1291,1288,1287,1280,1278,1277,1276,1275,1267,1265,1261,1260,1258,1257,1256,1248,1246,1244,1243,1241,1233,1230,1229,1214,1210,1209,1208,1204,1200,1199,1198,1194,1188,1165,1164,1147,1145,1134,1124,1123,1119,1117,1116,1114,1105,1103,1101,1094,1092,1085,1082,1075,1073,1070,1067,1066,1065,1062,1061,1060,1058,1056,1055,1054,1052,1049,1045,1044,1041,1039,1038,1037,1031,1028,1020,1014,1011,1010,1006,2984,2982,2976,2966,2964,2958,2950,2945,2943,2940,2938,2932,2928,2926,2917,2913,2910,2902,2897,2891,2884,2876,2871,2863,2855,2846,2839,2835,2834,2832,2829,2825,2821,2813,2812,2805,2804,2801,2797,2793,2792,2784,2778,2775,2774,2768,2766,2764,2761,2760,2755,2754,2752,2749,2736,2733,2728,2727,2719,2707,2705,2702,2698,2693,2690,2676,2674,2673,2657,2641,2640,2639,2638,2633,2627,2618,2608,2599,2595,2574,2568,2566,2564,2554,2552,2549,2547,2540,2538,2529,2522,2514,2513,2508,2495,2492,2481,2474,2467,2464,2459,2457,2454,2453,2444,2439,2425,2422,2419,2415,2402,2394,2391,2390,2389,2388,2379,2375,2373,2371,2370,2368,2366,2363,2361,2356,2355,2354,2352,2351,2345,2344,2342,2337,2327,2320,2313,2306,2304,2303,2288,2283,2270,2269,2268,2264,2261,2254,2251,2240,2233,2231,2230,2226,2225,2214,2212,2205,2191,2189,2184,2182,2179,2171,2161,2159,2158,2157,2146,2135,2133,2130,2128,2125,2120,2117,2111,2109,2108,2103,2102,2094,2092,2089,2086,2084,2083,2082,2080,2078,2070,2067,2066,2064,2063,2058,2057,2052,2048,2046,2045,2044,2043,2040,2039,2036,2019,2011,2009,2007,2006,2003,3989,3988,3983,3978,3973,3970,3969,3966,3965,3961,3958,3957,3951,3948,3933,3931,3921,3919,3898,3896,3868,3866,3855,3854,3853,3847,3837,3832,3830,3818,3815,3812,3809,3806,3801,3793,3789,3786,3783,3782,3781,3780,3777,3772,3760,3753,3748,3742,3741,3740,3738,3735,3731,3728,3724,3723,3716,3711,3708,3693,3691,3688,3684,3682,3681,3676,3674,3671,3659,3651,3650,3647,3632,3628,3624,3621,3615,3613,3609,3604,3601,3599,3592,3591,3589,3587,3582,3577,3574,3573,3572,3564,3561,3555,3536,3533,3528,3526,3525,3520,3518,3517,3514,3511,3510,3509,3508,3505,3503,3499,3494,3489,3487,3485,3476,3475,3472,3470,3464,3462,3457,3454,3452,3451,3444,3439,3425,3421,3415,3411,3410,3403,3401,3400,3397,3392,3379,3378,3377,3375,3370,3369,3361,3359,3357,3350,3348,3343,3330,3329,3323,3322,3318,3317,3315,3304,3300,3297,3295,3292,3291,3290,3289,3278,3270,3269,3263,3259,3258,3256,3254,3243,3234,3209,3206,3205,3204,3185,3174,3172,3170,3168,3166,3160,3149,3144,3137,3124,3116,3115,3109,3107,3106,3103,3102,3098,3097,3094,3092,3088,3084,3083,3081,3079,3078,3077,3076,3072,3059,3055,3051,3050,3049,3045,3043,3042,3035,3031,3029,3018,3017,3014,3013)],108] ###Casos que presentan algo reseñable


grepFallosORL=grep1ORL[-c(996,994,990,989,987,982,979,977,976,973,966,964,949,948,947,945,919,918,916,905,893,889,887,886,885,881,864,859,858,852,839,834,822,819,818,817,812,810,809,808,807,801,800,795,793,791,789,781,778,766,764,750,748,740,739,738,709,704,702,699,697,696,679,667,660,652,651,650,647,637,621,601,582,579,575,570,569,565,558,557,556,551,550,546,541,527,525,516,515,510,498,475,471,470,459,453,452,448,441,437,433,428,419,418,415,413,411,403,397,391,387,383,381,370,362,356,355,353,351,346,333,326,323,321,318,317,316,310,307,306,304,299,295,294,292,290,288,285,283,280,278,274,273,271,270,268,264,260,259,253,251,250,249,248,247,246,245,244,242,241,238,237,235,228,224,223,219,212,209,201,197,193,186,185,175,168,167,163,161,147,132,126,117,110,108,107,106,101,100,99,97,83,82,66,65,63,61,58,54,39,31,29,17,15,11,1,1999,1996,1994,1990,1988,1980,1975,1973,1970,1960,1954,1952,1949,1946,1940,1937,1933,1932,1926,1924,1922,1919,1918,1907,1905,1901,1899,1897,1894,1890,1888,1886,1880,1875,1871,1868,1867,1863,1861,1856,1852,1849,1845,1844,1840,1834,1828,1822,1805,1782,1774,1763,1758,1751,1746,1741,1740,1739,1734,1727,1723,1721,1713,1712,1710,1698,1697,1678,1675,1653,1645,1640,1631,1627,1624,1616,1612,1600,1595,1591,1587,1576,1573,1569,1566,1562,1560,1551,1548,1542,1539,1523,1521,1519,1518,1517,1513,1508,1503,1502,1500,1497,1494,1487,1485,1484,1483,1478,1475,1460,1458,1454,1451,1438,1436,1427,1417,1410,1406,1405,1393,1390,1389,1387,1374,1366,1365,1357,1355,1351,1349,1345,1332,1327,1315,1310,1305,1293,1291,1288,1287,1280,1278,1277,1276,1275,1267,1265,1261,1260,1258,1257,1256,1248,1246,1244,1243,1241,1233,1230,1229,1214,1210,1209,1208,1204,1200,1199,1198,1194,1188,1165,1164,1147,1145,1134,1124,1123,1119,1117,1116,1114,1105,1103,1101,1094,1092,1085,1082,1075,1073,1070,1067,1066,1065,1062,1061,1060,1058,1056,1055,1054,1052,1049,1045,1044,1041,1039,1038,1037,1031,1028,1020,1014,1011,1010,1006,2984,2982,2976,2966,2964,2958,2950,2945,2943,2940,2938,2932,2928,2926,2917,2913,2910,2902,2897,2891,2884,2876,2871,2863,2855,2846,2839,2835,2834,2832,2829,2825,2821,2813,2812,2805,2804,2801,2797,2793,2792,2784,2778,2775,2774,2768,2766,2764,2761,2760,2755,2754,2752,2749,2736,2733,2728,2727,2719,2707,2705,2702,2698,2693,2690,2676,2674,2673,2657,2641,2640,2639,2638,2633,2627,2618,2608,2599,2595,2574,2568,2566,2564,2554,2552,2549,2547,2540,2538,2529,2522,2514,2513,2508,2495,2492,2481,2474,2467,2464,2459,2457,2454,2453,2444,2439,2425,2422,2419,2415,2402,2394,2391,2390,2389,2388,2379,2375,2373,2371,2370,2368,2366,2363,2361,2356,2355,2354,2352,2351,2345,2344,2342,2337,2327,2320,2313,2306,2304,2303,2288,2283,2270,2269,2268,2264,2261,2254,2251,2240,2233,2231,2230,2226,2225,2214,2212,2205,2191,2189,2184,2182,2179,2171,2161,2159,2158,2157,2146,2135,2133,2130,2128,2125,2120,2117,2111,2109,2108,2103,2102,2094,2092,2089,2086,2084,2083,2082,2080,2078,2070,2067,2066,2064,2063,2058,2057,2052,2048,2046,2045,2044,2043,2040,2039,2036,2019,2011,2009,2007,2006,2003,3989,3988,3983,3978,3973,3970,3969,3966,3965,3961,3958,3957,3951,3948,3933,3931,3921,3919,3898,3896,3868,3866,3855,3854,3853,3847,3837,3832,3830,3818,3815,3812,3809,3806,3801,3793,3789,3786,3783,3782,3781,3780,3777,3772,3760,3753,3748,3742,3741,3740,3738,3735,3731,3728,3724,3723,3716,3711,3708,3693,3691,3688,3684,3682,3681,3676,3674,3671,3659,3651,3650,3647,3632,3628,3624,3621,3615,3613,3609,3604,3601,3599,3592,3591,3589,3587,3582,3577,3574,3573,3572,3564,3561,3555,3536,3533,3528,3526,3525,3520,3518,3517,3514,3511,3510,3509,3508,3505,3503,3499,3494,3489,3487,3485,3476,3475,3472,3470,3464,3462,3457,3454,3452,3451,3444,3439,3425,3421,3415,3411,3410,3403,3401,3400,3397,3392,3379,3378,3377,3375,3370,3369,3361,3359,3357,3350,3348,3343,3330,3329,3323,3322,3318,3317,3315,3304,3300,3297,3295,3292,3291,3290,3289,3278,3270,3269,3263,3259,3258,3256,3254,3243,3234,3209,3206,3205,3204,3185,3174,3172,3170,3168,3166,3160,3149,3144,3137,3124,3116,3115,3109,3107,3106,3103,3102,3098,3097,3094,3092,3088,3084,3083,3081,3079,3078,3077,3076,3072,3059,3055,3051,3050,3049,3045,3043,3042,3035,3031,3029,3018,3017,3014,3013)]

datostfg2[grepFallosORL,100]="0"
grep1ORL=grep("1",datostfg2[,100])
datostfg2[grep1ORL,108]
options(max.print = 4000)
grep2404=grep("0",datostfg2[,100])
table(datostfg2[grep2404,108])

grep1145=grep("Mucos",datostfg2[,108])
datostfg2[grep1145,108]
datostfg2[grep1145,100]="1" ###Ya presntan 1's
grep1146=grep("mucos",datostfg2[,108])
datostfg2[grep1146,108]
datostfg2[grep1146[c(2,3,5,30)],108] ###2,3,5 y 30 corresponden a la variable piel_txt,aunque en 5 también hay información correcta
datostfg2[grep1146[c(2,3,30)],100]
datostfg2[grep1146[c(2,3,30)],100]=NA
datostfg2[grep1146[c(5)],100]
datostfg2[grep1146[c(5)],100]="0"
datostfg2[grep1146[-c(2,3,5,30)],100] ####Todos deben ser igual a 1
datostfg2[grep1146[-c(2,3,5,30)],100]="1"
datostfg2[grep1146[c(2,3,5,30)],116] ###Ya existen registros
grep1147=grep("MUCOS",datostfg2[,108])
grep1147=grep("erite",datostfg2[,108])
datostfg2[grep1147,108]
datostfg2[grep1147,100]
datostfg2[grep1147,100]="1"
grep1148=grep("Erite",datostfg2[,108])
grep1148=grep("ERITE",datostfg2[,108])
grep1148=grep("PLACA",datostfg2[,108])
grep1148=grep("Placa",datostfg2[,108])
datostfg2[grep1148,108]
datostfg2[grep1148,100]="1" ###Ya presentan 1's
grep1149=grep("placa",datostfg2[,108])
datostfg2[grep1149,108]
datostfg2[grep1149,100]="1"###Ya presentan 1's
grep1150=grep("EPISTAXIS",datostfg2[,108]) ###Hemorragia nasal
grep1150=grep("Epistaxis",datostfg2[,108])
datostfg2[grep1150,108]
datostfg2[grep1150,100]="1" ###Ya presentan 1's
grep1151=grep("epistaxis",datostfg2[,108])
datostfg2[grep1151,108]
datostfg2[grep1151,100]="1"###Ya presentan 1's
grep1152=grep("ENROJ",datostfg2[,108])
grep1152=grep("Enroj",datostfg2[,108])
grep1152=grep("enroj",datostfg2[,108])
datostfg2[grep1152,108]
datostfg2[grep1152,100]="1" ###Ya presentan 1's
grep1153=grep("CATARRO",datostfg2[,108])
grep1153=grep("Catarro",datostfg2[,108])
datostfg2[grep1153,108]
datostfg2[grep1153,100]="1" ###Ya presentan 1's
grep1154=grep("catarro",datostfg2[,108])
datostfg2[grep1154,108]
datostfg2[grep1154,100]="1" ###Ya presentan 1's
grep1155=grep("DISMINU",datostfg2[,108])
grep1155=grep("Disminu",datostfg2[,108])
datostfg2[grep1155,108]
datostfg2[grep1155,100]="1" ###Ya presentan 1's
grep1156=grep("disminu",datostfg2[,108])
datostfg2[grep1156,108]
datostfg2[grep1156,100] ###Ya presentan 1's
grep1157=grep("DIFI",datostfg2[,108])
grep1157=grep("Difi",datostfg2[,108])
datostfg2[grep1157,108]
datostfg2[grep1157,100]="1" ###Ya presentan 1's
grep1158=grep("difi",datostfg2[,108])
datostfg2[grep1158,108]
datostfg2[grep1158,100]="1" ###Ya presentan 1's
grep1159=grep("Desvi",datostfg2[,108])
datostfg2[grep1159,108]
datostfg2[grep1159,100]="1" ###Ya presentan 1's
grep1160=grep("DESVI",datostfg2[,108])
grep1161=grep("desvi",datostfg2[,108])
datostfg2[grep1161,108]
datostfg2[grep1161,100]="1" ###Ya presentan 1's
grep1162=grep("hipo",datostfg2[,108])
datostfg2[grep1162,108]
datostfg2[grep1162,100]="1" ###Ya presentan 1's
grep1163=grep("HIPO",datostfg2[,108])
grep1163=grep("Hipo",datostfg2[,108])
datostfg2[grep1163,108]
datostfg2[grep1163,100]
datostfg2[grep1163,100]="1"
grep1164=grep("hipe",datostfg2[,108])
datostfg2[grep1164,108]
datostfg2[grep1164,100]
datostfg2[grep1164,100]="1"
grep1165=grep("HIPER",datostfg2[,108])
grep1165=grep("Hipe",datostfg2[,108])
datostfg2[grep1165,108]
datostfg2[grep1165,100]
datostfg2[grep1165,100]="1"
grep1166=grep("pala",datostfg2[,108])
datostfg2[grep1166,108]
datostfg2[grep1166,100]="1" ###Ya presentan 1's
grep1167=grep("PALA",datostfg2[,108])
grep1167=grep("Pala",datostfg2[,108])
grep1167=grep("Sordera",datostfg2[,108])
datostfg2[grep1167,108]
datostfg2[grep1167,100] ###Ya presentan 1's
grep1168=grep("SORDERA",datostfg2[,108])
grep1168=grep("sordera",datostfg2[,108])
grep1168=grep("Insu",datostfg2[,108])
datostfg2[grep1168,108]
datostfg2[grep1168,100]="1" ###Ya presenta un 1
grep1169=grep("INSU",datostfg2[,108])
grep1169=grep("insu",datostfg2[,108])
grep1169=grep("Mame",datostfg2[,108])
grep1169=grep("MAME",datostfg2[,108])
grep1169=grep("mame",datostfg2[,108])
datostfg2[grep1169,108]
datostfg2[grep1169,100]="1" ###Ya presentan 1's
grep1170=grep("Faringo",datostfg2[,108])
grep1170=grep("FARINGO",datostfg2[,108])
grep1170=grep("faringo",datostfg2[,108])
datostfg2[grep1170,108]
datostfg2[grep1170,100]="1" ###Ya presentan 1's
grep1171=grep("Hema",datostfg2[,108])
grep1171=grep("HEMA",datostfg2[,108])
grep1171=grep("hema",datostfg2[,108])
datostfg2[grep1171,108]
datostfg2[grep1171,100]="1" ###Ya presentan 1's

grep1172=grep("Oste",datostfg2[,108])
grep1172=grep("OSTE",datostfg2[,108])
grep1172=grep("osteoma",datostfg2[,108])
datostfg2[grep1172,108]
datostfg2[grep1172,100]
datostfg2[grep1172,100]="1"
grep1173=grep("Membra",datostfg2[,108])
datostfg2[grep1173,108]
datostfg2[grep1173,100]
datostfg2[grep1173,100]="1"
grep1174=grep("MEMBRA",datostfg2[,108])
grep1174=grep("membra",datostfg2[,108])
datostfg2[grep1174,108]
datostfg2[grep1174,100] ###Está bien registrado el caso 3 de este grep ya que lo normal es que los conductos auditivos sean permeables.
datostfg2[grep1174[c(3)],100]="0"
grep1175=grep("Amig",datostfg2[,108])
datostfg2[grep1175,108]
datostfg2[grep1175,100]="1" ####Ya presentan 1´s
grep1176=grep("AMIG",datostfg2[,108])
grep1176=grep("amig",datostfg2[,108])
datostfg2[grep1176,108]
datostfg2[grep1176,100]="1"
datostfg2[grep1176[c(7)],100]="0"
datostfg2[grep1176[c(51,67,68,83)],100]="1"
grep1177=grep("p?rdida",datostfg2[,108])
datostfg2[grep1177,108]
datostfg2[grep1177,100]
datostfg2[grep1177,100]="1"
grep1178=grep("P?RDI",datostfg2[,108])
grep1178=grep("P?rdida",datostfg2[,108]) ##Igual que grep1177
grep1179=grep("tinitus",datostfg2[,108])
datostfg2[grep1179,108]
datostfg2[grep1179,100]="1" ###Ya presenta un 1
grep1180=grep("TINITU",datostfg2[,108])
grep1180=grep("Tinitu",datostfg2[,108])
grep1181=grep("infla",datostfg2[,108])
datostfg2[grep1181,108]
datostfg2[grep1181,100]="1" ###Ya presentan 1's
grep1182=grep("INFLA",datostfg2[,108])
grep1182=grep("Infla",datostfg2[,108])
datostfg2[grep1182,108]
datostfg2[grep1182,100]="1" ###Ya presenta un 1
grep1183=grep("vascu",datostfg2[,108])
datostfg2[grep1183,108]
datostfg2[grep1183,100]="1" ###Ya presentan 1's
grep1184=grep("VASCU",datostfg2[,108])
grep1184=grep("Vascu",datostfg2[,108])
grep1184=grep("lustre",datostfg2[,108])
datostfg2[grep1184,108]
datostfg2[grep1184,100]="1" ###Ya presentan 1's
grep1185=grep("Lustre",datostfg2[,108])
grep1185=grep("LUSTRE",datostfg2[,108])
grep1186=grep("desca",datostfg2[,108])
datostfg2[grep1186,108]
datostfg2[grep1186,100]="1" ###Ya presentan 1's
grep1187=grep("Desca",datostfg2[,108])
grep1187=grep("DESCA",datostfg2[,108])
grep1187=grep("mareo",datostfg2[,108])
datostfg2[grep1187,108]
datostfg2[grep1187,100]="1" ###Ya presentan 1's
grep1188=grep("Mareo",datostfg2[,108])
grep1188=grep("MAREO",datostfg2[,108])
grep1188=grep("v?rtigo",datostfg2[,108])
datostfg2[grep1188,108]
datostfg2[grep1188,100]="1" ###Ya presentan 1's
grep1189=grep("V?rtigo",datostfg2[,108])###Igual que grep1188
grep1189=grep("V?RTIGO",datostfg2[,108])
grep1189=grep("discon",datostfg2[,108])
datostfg2[grep1189,108]
datostfg2[grep1189,100]="1" ###Ya presenta un 1
grep1190=grep("Discon",datostfg2[,108])
grep1190=grep("DISCON",datostfg2[,108])
grep1190=grep("tap?n",datostfg2[,108])
datostfg2[grep1190,108]
datostfg2[grep1190,100]="1" ###Ya presentan 1's
grep1191=grep("Tap?n",datostfg2[,108])
grep1191=grep("TAP?N",datostfg2[,108])
grep1191=grep("caries",datostfg2[,108])
grep1191=grep("CARIES",datostfg2[,108])
grep1191=grep("Caries",datostfg2[,108])
datostfg2[grep1191,108] ####Tiene información de la variable 122(Odontología)
datostfg2[grep1191,100]###Error
datostfg2[grep1191,100]="0"
datostfg2[grep1191,122] ####Vamos a corregirlo en la variable 122
grep1192=grep("visual",datostfg2[,108])
datostfg2[grep1192,108]
datostfg2[grep1192[c(21)],108]####Información correspondiente a la variable 109(txt_ojos)
datostfg2[grep1192[c(21)],100]###Error
datostfg2[grep1192[c(21)],100]=NA
datostfg2[grep1192[c(21)],109]
datostfg2[grep1192[c(21)],109]=datostfg[grep1192[c(21)],108]
grep1193=grep("Visual",datostfg2[,108])
grep1193=grep("VISUAL",datostfg2[,108])
grep1193=grep("Colabo",datostfg2[,108])
grep1193=grep("COLABO",datostfg2[,108])
grep1194=grep("colabo",datostfg2[,108])
datostfg2[grep1194,108]
datostfg2[grep1194,100]
datostfg2[grep1194[c(3,4,5)],100]=NA
grep1195=grep("disme",datostfg2[,108])
datostfg2[grep1195,108] ####Contiene información de la variable 106(txt_aspecto)
datostfg2[grep1195,100] ###Error
datostfg2[grep1195,100]="0"
datostfg2[grep1195,106]###Ya registrado
grep1196=grep("Disme",datostfg2[,108])
grep1196=grep("DISME",datostfg2[,108])
datostfg2[,100]=replace(datostfg2[,100],grep1142,"0")
datostfg2[,100]=replace(datostfg2[,100],grep1143,"0")
datostfg2[,100]=replace(datostfg2[,100],grep1144,"0")

grep2405=grep("estreca",datostfg2[,108])
datostfg2[grep2405,108]
datostfg2[grep2405,100]
datostfg2[grep2405,100]="1"
grep2406=grep("afta",datostfg2[,108])
datostfg2[grep2406,108]
datostfg2[grep2406,100]
datostfg2[grep2406,100]="1"
grep2407=grep("odino",datostfg2[,108])
datostfg2[grep2407,108]
datostfg2[grep2407,100]
datostfg2[grep2407,100]="1"
grep2408=grep("Herpe",datostfg2[,108])
datostfg2[grep2408,108]
datostfg2[grep2408,100]
datostfg2[grep2408,100]="1"
grep2409=grep("imposible",datostfg2[,108])
datostfg2[grep2409,108]
datostfg2[grep2409,100]
datostfg2[grep2409,100]="1"
grep2410=grep("otitis",datostfg2[,108])
datostfg2[grep2410,108]
datostfg2[grep2410,100]
datostfg2[grep2410,100]="1"
grep2411=grep("miringo",datostfg2[,108])
datostfg2[grep2411,108]
datostfg2[grep2411,100]
datostfg2[grep2411,100]="1"
grep2412=grep("resfriado",datostfg2[,108])
datostfg2[grep2412,108]
datostfg2[grep2412,100]
datostfg2[grep2412,100]="1"
grep2413=grep("vello",datostfg2[,108])
datostfg2[grep2413,108]
datostfg2[grep2413,100]
datostfg2[grep2413,100]="1"
grep2414=grep("cerumen",datostfg2[,108])
datostfg2[grep2414,108]
datostfg2[grep2414,100]
datostfg2[grep2414,100]="1"
grep2415=grep("otoscopio",datostfg2[,108])
datostfg2[grep2415,108]
datostfg2[grep2415,100]
datostfg2[grep2415,100]="1"
grep2416=grep("canula",datostfg2[,108])
datostfg2[grep2416,108]
datostfg2[grep2416,100]
datostfg2[grep2416,100]="1"
grep2417=grep("agrietada",datostfg2[,108])
datostfg2[grep2417,108]
datostfg2[grep2417,100]
datostfg2[grep2417,100]="1"
grep2418=grep("sinusitis",datostfg2[,108])
datostfg2[grep2418,108]
datostfg2[grep2418,100]
datostfg2[grep2418,100]="1"
grep2419=grep("Vege",datostfg2[,108])
datostfg2[grep2419,108]
datostfg2[grep2419,100]
datostfg2[grep2419,100]="1"
grep2420=grep("senos",datostfg2[,108])
datostfg2[grep2420,108]
datostfg2[grep2420,100]
datostfg2[grep2420,100]="1"
grep2421=grep("oclusivo",datostfg2[,108])
datostfg2[grep2421,108]
datostfg2[grep2421,100]
datostfg2[grep2421,100]="1"
grep2422=grep("Faringit",datostfg2[,108])
datostfg2[grep2422,108]
datostfg2[grep2422,100]
datostfg2[grep2422,100]="1"
grep2423=grep("molest",datostfg2[,108])
datostfg2[grep2423,108]
datostfg2[grep2423,100]
datostfg2[grep2423,100]="1"
grep2424=grep("molest",datostfg2[,108])
datostfg2[grep2424,108]
datostfg2[grep2424,100]
datostfg2[grep2424,100]="1"
grep2425=grep("herida",datostfg2[,108])
datostfg2[grep2425,108]
datostfg2[grep2425,100]
datostfg2[grep2425,100]="1"
grep2426=grep("cicatri",datostfg2[,108])
datostfg2[grep2426,108]
datostfg2[grep2426,100]
datostfg2[grep2426,100]="1"
grep2427=grep("Polipo",datostfg2[,108])
datostfg2[grep2427,108]
datostfg2[grep2427,100]
datostfg2[grep2427,100]="1"
grep2428=grep("engrosami",datostfg2[,108])
datostfg2[grep2428,108]
datostfg2[grep2428,100]
datostfg2[grep2428,100]="1"
grep2429=grep("irritado",datostfg2[,108])
datostfg2[grep2429,108]
datostfg2[grep2429,100]
datostfg2[grep2429,100]="1"
grep2430=grep("p?dida",datostfg2[,108])
datostfg2[grep2430,108]
datostfg2[grep2430,100]
datostfg2[grep2430,100]="1"
grep2431=grep("blanque",datostfg2[,108])
datostfg2[grep2431,108]
datostfg2[grep2431,100]
datostfg2[grep2431,100]="1"
grep2432=grep("marginal",datostfg2[,108])
datostfg2[grep2432,108]
datostfg2[grep2432,100]
datostfg2[grep2432,100]="1"
grep2433=grep("serumen",datostfg2[,108])
datostfg2[grep2433,108]
datostfg2[grep2433,100]
datostfg2[grep2433,100]="1"
grep2434=grep("Tapones",datostfg2[,108])
datostfg2[grep2434,108]
datostfg2[grep2434,100]
datostfg2[grep2434,100]="1"
grep2435=grep("nasal",datostfg2[,108])
datostfg2[grep2435,108]
datostfg2[grep2435,100]
datostfg2[grep2435,100]="1"
grep2436=grep("arcada",datostfg2[,108])
datostfg2[grep2436,108]
datostfg2[grep2436,100]
datostfg2[grep2436,100]="1"
grep2437=grep("disminuci",datostfg2[,108])
datostfg2[grep2437,108]
datostfg2[grep2437,100]
datostfg2[grep2437,100]="1"
grep2438=grep("estrecho",datostfg2[,108])
datostfg2[grep2438,108]
datostfg2[grep2438,100]
datostfg2[grep2438,100]="1"
grep2439=grep("tapones",datostfg2[,108])
datostfg2[grep2439,108]
datostfg2[grep2439,100]
datostfg2[grep2439,100]="1"
grep2439=grep("Sinusitis",datostfg2[,108])
datostfg2[grep2439,108]
datostfg2[grep2439,100]
datostfg2[grep2439,100]="1"
grep2439=grep("^Caries",datostfg2[,108])
datostfg2[grep2439,108]
datostfg2[grep2439,122]

grep2404=grep("0",datostfg2[,100])
table(datostfg2[grep2404,108])

table(datostfg2[,100])

for (i in 1:11984){comp=(is.na(datostfg2[i,100])==TRUE&&
  is.na(datostfg2[i,108])==FALSE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,100]="Revisar"
}else{
        datostfg2[i,100]=datostfg2[i,100]
}}
grep2904=grep("Revisar",datostfg2[,100])
datostfg2[grep2904,108]
datostfg2[grep2904[-c(17)],100]="0"
datostfg2[grep2904[c(17)],100]="1"

datostfg2[c(2676,3877,5871,5919,6123),108]
datostfg2[c(2676,3877,5871,5919,6123),100]="0"
```

```{r,include=TRUE}
####Variable 101(Ganglios.linfáticos.)  y 109 (txt_linfaticos)
#######Si el paciente presenta o ha presentado algún ganglio linfático la variable numérica debe presentar un 1,en caso contrario presentará un 0.


table(datostfg2[,101])
datostfg2[7141,101]=datostfg[7141,100]
datostfg2[706,101]=datostfg[706,100]
datostfg2[6272,114]=datostfg[6272,101]
datostfg2[129,101] ####Esto corresponde a la variable 111
datostfg2[129,111]=datostfg[129,101]
datostfg2[129,101]=NA
table(datostfg2[,101])

datostfg2[7141,109]=datostfg[7141,108]
datostfg2[706,109]=datostfg[706,108]
datostfg2[6272,122]=datostfg[6272,109]
datostfg2[129,109] ####Esto corresponde a la variable 119
datostfg2[129,119]=datostfg2[129,109]
datostfg2[129,109]=NA


grep852=grep("^No",datostfg2[,109])
datostfg2[grep852,109] ##13 y 18 Normal fallo en recogida de datos,616 si, estudiar 706 y 726
datostfg2[grep852[1001:2000],109]###1647 Discreta tiroidemegalia,eso corresponde a la variable 100
datostfg2[grep852[c(1647)],100] ####Ya presenta un 1 no hay que cambiar nada
datostfg2[grep852[2001:3000],109] ####2076,2074 No explorado,lo interpretaré como que no tienen un ganglio linfático 
datostfg2[grep852[3001:3363],109]
grep852[c(13,18)]
datostfg2[grep852[c(13,18)],111]
datostfg2[grep852[c(13,18)],109]=NA
datostfg2[grep852[c(13,18)],101]=NA
datostfg2[grep852[c(706,726)],109]
datostfg2[grep852[c(706)],107]
datostfg2[grep852[c(706)],109]=NA ###Ya presenta un registro correcto en la variable 107
datostfg2[grep852[c(726)],112]="Murmullo vesicular conservado en todos los campos auscultatorios no se aprecian roncus ni sibilancias."
datostfg2[grep852[c(616)],101]
grep852=grep852[-c(616)]
grep853=grep("^no",datostfg2[,109])
datostfg2[grep853,109]
grep854=grep("^NO",datostfg2[,109])
grep854=grep("NR",datostfg2[,109])
grep854=grep("^N.R",datostfg2[,109])
grep854=grep("^Ni",datostfg2[,109])
grep854=grep("^NI",datostfg2[,109])
grep854=grep("^ni",datostfg2[,109])
grep854=grep("^SIN",datostfg2[,109])
grep854=grep("^sin",datostfg2[,109])
grep854=grep("^Sin",datostfg2[,109])
datostfg2[grep854,109] 
grep855=grep("^En la exploraci",datostfg2[,109])
datostfg2[grep855,109] 
datostfg2[grep855[1001:1453],109]
datostfg2[grep855[c(182)],109] ####Considerar como un si

datostfg2[grep855[c(10,42,52,111,113,119,120,140,166,169,182,184,194,218,237,248,257,267,271,272,273,277,286,291,303,312,324,326,333,339,345,408,469,497,550,554,566,582,602,621,644,655,661,672,695,696,698,717,737,743,772,797,823,824,832,835,843,846,848,854,867,868,870,893,894,899,900,915,918,937,943,949,950,951,952,961,965,966,968,970,976,977,978,981,1001,1003,1037,1048,1063,1068,1070,1071,1107,1120,1140,1199,1208,1234,1249,1296,1306,1317,1320,1324,1332,1343.1355,1382,1387,1405,1410,1418,1425,1426,1435)],109] ####Casos con ganglios

datostfg2[grep855[c(10,42,52,111,113,119,120,140,166,169,182,184,194,218,237,248,257,267,271,272,273,277,286,291,303,312,324,326,333,339,345,408,469,497,550,554,566,582,602,621,644,655,661,672,695,696,698,717,737,743,772,797,823,824,832,835,843,846,848,854,867,868,870,893,894,899,900,915,918,937,943,949,950,951,952,961,965,966,968,970,976,977,978,981,1001,1003,1037,1048,1063,1068,1070,1071,1107,1120,1140,1199,1208,1234,1249,1296,1306,1317,1320,1324,1332,1343.1355,1382,1387,1405,1410,1418,1425,1426,1435)],101] ####Hay casos que no presentan un 1
datostfg2[grep855[c(10,42,52,111,113,119,120,140,166,169,182,184,194,218,237,248,257,267,271,272,273,277,286,291,303,312,324,326,333,339,345,408,469,497,550,554,566,582,602,621,644,655,661,672,695,696,698,717,737,743,772,797,823,824,832,835,843,846,848,854,867,868,870,893,894,899,900,915,918,937,943,949,950,951,952,961,965,966,968,970,976,977,978,981,1001,1003,1037,1048,1063,1068,1070,1071,1107,1120,1140,1199,1208,1234,1249,1296,1306,1317,1320,1324,1332,1343.1355,1382,1387,1405,1410,1418,1425,1426,1435)],101]="1"

grep855=grep855[-c(10,42,52,111,113,119,120,140,166,169,182,184,194,218,237,248,257,267,271,272,273,277,286,291,303,312,324,326,333,339,345,408,469,497,550,554,566,582,602,621,644,655,661,672,695,696,698,717,737,743,772,797,823,824,832,835,843,846,848,854,867,868,870,893,894,899,900,915,918,937,943,949,950,951,952,961,965,966,968,970,976,977,978,981,1001,1003,1037,1048,1063,1068,1070,1071,1107,1120,1140,1199,1208,1234,1249,1296,1306,1317,1320,1324,1332,1343.1355,1382,1387,1405,1410,1418,1425,1426,1435)]


datostfg2[,101]=replace(datostfg2[,101],grep852,"0")
datostfg2[,101]=replace(datostfg2[,101],grep853,"0")
datostfg2[,101]=replace(datostfg2[,101],grep854,"0")
datostfg2[,101]=replace(datostfg2[,101],grep855,"0")

####Bucle
grep1Ganglio=grep("1",datostfg2[,101])
datostfg2[grep1Ganglio,109]

####Hay que quitar los NA's
####Bucle
for (i in 1:11984){comp=(
  is.na(datostfg2[i,109])==TRUE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,101]="0"
}else{
        datostfg2[i,101]=datostfg2[i,101]
}}
####Hay que revisar los 1's
grep1Ganglio=grep("1",datostfg2[,101])
datostfg2[grep1Ganglio,109]
datostfg2[grep1Ganglio[c(418,101,55,36,37,38,34,31,29,28,27,26,25)],109] ####Errores
datostfg2[grep1Ganglio[c(418,101,55,36,37,38,34,31,29,28,27,26,25)],101]="0"
grep2495=grep("0",datostfg2[,101])
table(datostfg2[grep2495,109])
grep2496=grep("ingui",datostfg2[,109])
datostfg2[grep2496,109]
datostfg2[grep2496,101]
datostfg2[grep2496,101]="1"
grep2497=grep("subman",datostfg2[,109])
datostfg2[grep2497,109]
datostfg2[grep2497,101]
datostfg2[grep2497,101]="1"
grep2498=grep("quiste",datostfg2[,109])
datostfg2[grep2498,109]
datostfg2[grep2498,101]
datostfg2[grep2498,101]="1"
grep2499=grep("quiste",datostfg2[,109])
datostfg2[grep2499,109]
datostfg2[grep2499,101]
datostfg2[grep2499,101]="1"
grep2500=grep("tiroide",datostfg2[,109])
datostfg2[grep2500,109]
datostfg2[grep2500,101]
datostfg2[grep2500,101]="1"
grep2501=grep("^Microade",datostfg2[,109])
datostfg2[grep2501,109]
datostfg2[grep2501,101]
datostfg2[grep2501,101]="1"
grep2502=grep("cervical izquierda",datostfg2[,109])
datostfg2[grep2502,109] ####Consideraré el segundo caso como un éxito
datostfg2[grep2502,101]
datostfg2[grep2502,101]="1"
grep2502=grep("Carotide",datostfg2[,109])
datostfg2[grep2502,109] 
datostfg2[grep2502,111]
grep2940=grep("sincr",datostfg2[,109])
datostfg2[grep2940,109] 
datostfg2[grep2940,111] ####Ya registrado
grep2941=grep("urmullo",datostfg2[,109])
datostfg2[grep2941,109] 
datostfg2[grep2941,112] ####Ya registrado
grep2495=grep("0",datostfg2[,101])
table(datostfg2[grep2495,109])

for (i in 1:11984){comp=(is.na(datostfg2[i,101])==TRUE&&
  is.na(datostfg2[i,109])==FALSE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,101]="Revisar"
}else{
        datostfg2[i,101]=datostfg2[i,101]
}}
grep2904=grep("Revisar",datostfg2[,101])
datostfg2[grep2904,109]
datostfg2[grep2904,101]="0"

datostfg2[c(2676,3877,5871,5919,6123),109]
datostfg2[c(2676,3877,5871,5919,6123),101]="0"
```

```{r,include=TRUE}
####Variable 102(Auscultación.cardíaca)  y 110(txt_auscultacion_cardiaca)
####Si la auscultación cardíaca ha sido realizada la variable numérica debe presentar un 1,en caso contrario presentará un 0.


table(datostfg2[,102])
datostfg2[7141,102]=datostfg[7141,101]
datostfg2[706,102]=datostfg[706,101]
datostfg2[6272,115]=datostfg[6272,102]
datostfg2[129,102] ####Esto corresponde a la variable 112
datostfg2[129,112]=datostfg[129,102]

table(datostfg2[,102])
table(datostfg2[,110])
datostfg2[7141,110]=datostfg[7141,109]
datostfg2[706,110]=datostfg[706,109]
datostfg2[6272,123]=datostfg[6272,110]###Corresponde a la variable 123
datostfg2[129,110] ####Esto corresponde a la variable 120
datostfg2[129,120]=datostfg[129,110]




grep1102=grep("^No",datostfg2[,110])
datostfg2[grep1102,110] 
datostfg2[grep1102[1001:1520],110]####Estudiar 1001,1140 y 1460
datostfg2[grep1102[c(1001,1140,1460)],110]
datostfg2[grep1102[c(1001,1140,1460)],43]
grep1103=grep("^no",datostfg2[,110])
datostfg2[grep1103,110]
grep1104=grep("^NO",datostfg2[,110])
datostfg2[grep1104,110]
grep1105=grep("NR",datostfg2[,110])
grep1105=grep("^N.R",datostfg2[,110])
datostfg2[grep1105,110] ###Igual que grep1104
grep1105=grep("^Ni",datostfg2[,110])
grep1105=grep("^NI",datostfg2[,110])
grep1105=grep("^ni",datostfg2[,110])
grep1105=grep("^SIN",datostfg2[,110])
grep1105=grep("^sin",datostfg2[,110])
grep1105=grep("^Sin",datostfg2[,110])
datostfg2[grep1105,110] 

###Bucles
for (i in 1:11984){comp=
  is.na(datostfg2[i,110]==TRUE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,102]="0"
}else{
        datostfg2[i,102]="1"
}}

####Revisar los 1's
grep1AusC=grep("1",datostfg2[,102])
datostfg2[grep1AusC,110]
datostfg2[c(2676,3877,5871,5919,6123),110]
datostfg2[3877,102]="0"
####Revisar los 0
grep0AusC=grep("0",datostfg2[,102])
datostfg2[grep0AusC,110]

datostfg2[c(2676,3877,5871,5919,6123),110]
datostfg2[c(2676,3877,5871,5919,6123),102]="0"
```

```{r,include=TRUE}
####Variable 103(Pulsos.) y 111(txt_pulsos)


table(datostfg2[,103])
datostfg2[7141,103]=datostfg[7141,102]
datostfg2[706,103]=datostfg[706,102]
datostfg2[6272,116]=datostfg[6272,103]
datostfg2[129,113]=datostfg[129,103]
table(datostfg2[,103])

datostfg2[7141,111]=datostfg[7141,110]
datostfg2[706,111]=datostfg[706,111]
datostfg2[6272,111]###Corresponde a la variable 124
datostfg2[6272,124]=datostfg[6272,111]
datostfg2[129,121]=datostfg[129,111]


###Voy a cambiar la variable numérica,para que solo tengan un uno los casos con pulso arrítmico.
grep2305=grep("Arrit",datostfg2[,111])
datostfg2[grep2305,111]
grep2306=grep("arrit",datostfg2[,111])
datostfg2[grep2306,111]
grep2307=grep("ARRIT",datostfg2[,111])

grep2307=grep("0",datostfg2[,103])
datostfg2[grep2307,103]="0"
grep2308=grep("1",datostfg2[,103])
datostfg2[grep2308,103]="0"
datostfg2[grep2305,103]="1"
datostfg2[grep2306,103]="1"
table(datostfg2[,103])
datostfg2[grep2502,103]
datostfg2[grep2502,111]=datostfg[grep2502,109]
table(datostfg2[,103])

for (i in 1:11984){comp=(is.na(datostfg2[i,103])==TRUE&&
  is.na(datostfg2[i,111])==FALSE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,103]="Revisar"
}else{
        datostfg2[i,103]=datostfg2[i,103]
}}
grep2904=grep("Revisar",datostfg2[,103])
datostfg2[grep2904,111]
datostfg2[grep2904,103]="0"

datostfg2[c(2676,3877,5871,5919,6123),111]
datostfg2[c(2676,3877,5871,5919,6123),103]="0"
```


```{r,include=TRUE}
####Variable 104(Auscultación.Respiratoria)  y 112(auscultación pulmonar)
####Si la auscultación respiratoria ha sido realizada la variable numérica debe presentar un 1,en caso contrario presentará un 0.

table(datostfg2[,104])
datostfg2[7141,104]=datostfg[7141,103]
datostfg2[706,104]=datostfg[706,103]
datostfg2[6272,117]=datostfg[6272,104]
datostfg2[129,114]=datostfg[129,104]
table(datostfg2[,104])

datostfg2[7141,112]=datostfg[7141,111]
datostfg2[706,112]=datostfg[706,111]
datostfg2[6272,112]#####Hay que desplazar el registro 13 posiciones(13 columnas)
datostfg2[6272,125]=datostfg[6272,112]
datostfg2[129,112]####Correcto
datostfg2[129,122]=datostfg[129,112]
grep1AusR=grep("1",datostfg2[,104])
datostfg2[grep1AusR,112]
grep0AusR=grep("0",datostfg2[,104])
datostfg2[grep0AusR,112]
###Bucle
for (i in 1:11984){comp=
  is.na(datostfg2[i,112]==TRUE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,104]="0"
}else{
        datostfg2[i,104]="1"
}}

####Presentará un 1 si se ha realizado la Auscultación respiratoria.

####Revisar los 1's
grep1AusR=grep("1",datostfg2[,104])
datostfg2[grep1AusR,112]
####Revisar los 0
grep0AusR=grep("0",datostfg2[,104])
datostfg2[grep0AusR,112]
datostfg2[3877,112]###Error
datostfg2[3877,104]="0"

datostfg2[c(2676,3877,5871,5919,6123),112]
datostfg2[c(2676,3877,5871,5919,6123),104]="0"
```


```{r,include=TRUE}
####Variable 105(Abdomen.) y 113(txt_abdomen)
####Voy a modificar la variable dicotómica.Presentarán un 1 aquellos casos en los que el paciente refiera dolor o molestia a la exploración abdominal,así como aquellos que presenten hernias o hallazgos relevantes relacionados con el abdomen, como estrías,cicatrices,etcétera.A aquellos casos que no presenten nada reseñable a nivel abdominal les asignaré un 0.

table(datostfg2[,105])
datostfg2[7141,105]=datostfg[7141,104]
datostfg2[706,105]=datostfg[706,104]
datostfg2[6272,105] ####Desplazar 13 posiciones
datostfg2[6272,118]=datostfg[6272,105]
datostfg2[129,115]= datostfg[129,105]
table(datostfg2[,105])

datostfg2[7141,113]=datostfg[7141,112]
datostfg2[706,113]=datostfg[706,112]
datostfg2[6272,126]=datostfg[6272,113]
datostfg2[129,113] ####Esto corresponde a la variable 123
datostfg2[129,123]=datostfg[129,113]

grep2309=grep("0",datostfg2[,105])
datostfg2[grep2309,105]="0"
grep2310=grep("1",datostfg2[,105])
datostfg2[grep2310,105]="0"

datostfg2[,113]=datostfg[,113]
table(datostfg2[,113]) 
grep859=grep("dolor",datostfg2[,113])####Examinar los casos dolorosos
datostfg2[grep859,113] 
datostfg2[grep859[1001:2000],113]
datostfg2[grep859[2001:3000],113]
datostfg2[grep859[3001:4000],113]
datostfg2[grep859[4001:5000],113]
datostfg2[grep859[5001:5599],113]

datostfg2[grep859[c(114,115,125,176,311,331,342,356,391,392,395,410,423,429,450,453,484,499,501,544,574,619,639,642,643,730,737,759,786,795,861,870,908,995,1113,1190,1221,1222,1260,1288,1316,1337,1371,1430,1452,1461,1469,1470,1505,1563,1584,1586,1612,1619,1644,1656,1702,1712,1729,1731,1732,1742,1750,1756,1796,1799,1810,1811,1830,1868,1872,1885,1953,1978,2017,2061,2066,2118,2127,2128,2201,2219,2237,2239,2259,2274,2382,2393,2466,2486,2492,2496,2497,2507,2521,2536,2537,2549,2555,2557,2566,2667,2680,2702,2708,2758,2760,2761,2780,2836,2974,2991,3026,3104,3105,3108,3112,3118,3123,3141,3150,3171,3192,3222,3245,3249,3261,3264,3271,3272,3274,3298,3333,3404,3458,3505,3591,3596,3621,3622,3632,3641,3739,3750,3751,3781,3831,3902,3940,3978,4056,4079,4085,4089,4106,4165,4207,4242,4317,4325,4328,4336,4349,4359,4372,4387,4436,4437,4489,4497,4521,4525,4649,4652,4658,4659,4721,4729,4734,4849,4990,5022,5024,5034,5055,5058,5081,5086,5131,5138,5174,5205,5209,5212,5230,5238,5239,5240,5279,5283,5286,5287,5297,5299,5323,5331,5336,5343,5351,5373,5383,5398,5438,5441,5473,5475,5487,5548,5561,5587)],113] ####Casos con algo reseñable

datostfg2[grep859[c(114,115,125,176,311,331,342,356,391,392,395,410,423,429,450,453,484,499,501,544,574,619,639,642,643,730,737,759,786,795,861,870,908,995,1113,1190,1221,1222,1260,1288,1316,1337,1371,1430,1452,1461,1469,1470,1505,1563,1584,1586,1612,1619,1644,1656,1702,1712,1729,1731,1732,1742,1750,1756,1796,1799,1810,1811,1830,1868,1872,1885,1953,1978,2017,2061,2066,2118,2127,2128,2201,2219,2237,2239,2259,2274,2382,2393,2466,2486,2492,2496,2497,2507,2521,2536,2537,2549,2555,2557,2566,2667,2680,2702,2708,2758,2760,2761,2780,2836,2974,2991,3026,3104,3105,3108,3112,3118,3123,3141,3150,3171,3192,3222,3245,3249,3261,3264,3271,3272,3274,3298,3333,3404,3458,3505,3591,3596,3621,3622,3632,3641,3739,3750,3751,3781,3831,3902,3940,3978,4056,4079,4085,4089,4106,4165,4207,4242,4317,4325,4328,4336,4349,4359,4372,4387,4436,4437,4489,4497,4521,4525,4649,4652,4658,4659,4721,4729,4734,4849,4990,5022,5024,5034,5055,5058,5081,5086,5131,5138,5174,5205,5209,5212,5230,5238,5239,5240,5279,5283,5286,5287,5297,5299,5323,5331,5336,5343,5351,5373,5383,5398,5438,5441,5473,5475,5487,5548,5561,5587)],105]="1"

grep2311=grep("Dolor",datostfg2[,113])
datostfg2[grep2311,113] 
datostfg2[grep2311,105]
datostfg2[grep2311,105]="1"
grep2312=grep("DOLOR",datostfg2[,113])
datostfg2[grep2312,113] 
datostfg2[grep2312,105]
datostfg2[grep2312[c(2)],105]="1"
grep2313=grep("mete",datostfg2[,113])
datostfg2[grep2313,113] 
datostfg2[grep2313,105]
datostfg2[grep2313,105]="1"
grep2314=grep("Mete",datostfg2[,113])
datostfg2[grep2314,113] 
datostfg2[grep2314,105] ###Ya presentan un 1
grep2315=grep("METE",datostfg2[,113])
grep2315=grep("t?mpan",datostfg2[,113])
datostfg2[grep2315,113] 
datostfg2[grep2315,105]
datostfg2[grep2315[-c(10)],105]="1"
grep2316=grep("T?mpan",datostfg2[,113]) ###Igual que grep2315
datostfg2[grep2315,113] 
datostfg2[grep2315,105]
grep2316=grep("T?IMPAN",datostfg2[,113])
grep2316=grep("abdo",datostfg2[,113])
datostfg2[grep2316,113] 
datostfg2[grep2316[-c(1,2,9,28,29,32)],105]
datostfg2[grep2316[-c(1,2,9,28,29,32)],105]="1"
grep2317=grep("Abdo",datostfg2[,113])
datostfg2[grep2317,113] ###No considerar
grep2317=grep("ABDO",datostfg2[,113])
grep2317=grep("Lipo",datostfg2[,113]) 
datostfg2[grep2317,113] 
datostfg2[grep2317,105]###Ya presentan 1's
grep2318=grep("lipo",datostfg2[,113]) 
datostfg2[grep2318,113] 
datostfg2[grep2318,105] ###Ya presenta un 1
grep2319=grep("LIPO",datostfg2[,113]) 
grep2319=grep("ing",datostfg2[,113])
datostfg2[grep2319,113] 
datostfg2[grep2319,105]
datostfg2[grep2319,105]="1"
grep2320=grep("Ing",datostfg2[,113])
grep2320=grep("ING",datostfg2[,113])
grep2320=grep("umb",datostfg2[,113])
datostfg2[grep2320,113] 
datostfg2[grep2320,105]
datostfg2[grep2320,105]="1"
grep2321=grep("Umb",datostfg2[,113])
datostfg2[grep2321,113] 
datostfg2[grep2321,105] ###Ya presentan 1's
grep2322=grep("UMB",datostfg2[,113])
datostfg2[grep2322,113] 
datostfg2[grep2322,105]
datostfg2[grep2322,105]="1"
grep2323=grep("recto",datostfg2[,113])
datostfg2[grep2323,113] 
datostfg2[grep2323,105]
datostfg2[grep2323,105]="1"
grep2324=grep("Recto",datostfg2[,113])
datostfg2[grep2324,113] 
datostfg2[grep2324,105] ###Ya presenta un 1
grep2325=grep("RECTO",datostfg2[,113])
grep2325=grep("increm",datostfg2[,113])
datostfg2[grep2325,113] 
datostfg2[grep2325,105]
datostfg2[grep2325,105]="1"
grep2326=grep("Increm",datostfg2[,113])
grep2326=grep("INCREM",datostfg2[,113])
grep2326=grep("aume",datostfg2[,113])
datostfg2[grep2326,113] 
datostfg2[grep2326,105]
datostfg2[grep2326,105]="1"
grep2327=grep("Aume",datostfg2[,113])
datostfg2[grep2327,113] 
datostfg2[grep2327,105] ###Ya presentan 1's
grep2328=grep("AUME",datostfg2[,113])
grep2328=grep("Cica",datostfg2[,113])
datostfg2[grep2328,113] 
datostfg2[grep2328,105] 
datostfg2[grep2328,105]="1"
grep2329=grep("cica",datostfg2[,113])
datostfg2[grep2329,113] 
datostfg2[grep2329,105] 
datostfg2[grep2329,105]="1"
grep2330=grep("CICA",datostfg2[,113])
grep2330=grep("estr",datostfg2[,113])
datostfg2[grep2330,113] 
datostfg2[grep2330,105] ###Ya presentan 1's
grep2331=grep("Estr",datostfg2[,113])
datostfg2[grep2331,113] 
datostfg2[grep2331,105] ###Ya presentan 1's
grep2332=grep("ESTR",datostfg2[,113])
grep2332=grep("Bulto",datostfg2[,113])
grep2332=grep("bulto",datostfg2[,113])
datostfg2[grep2332,113] 
datostfg2[grep2332,105]###Ya presentan 1's
grep2333=grep("BULTO",datostfg2[,113])
grep2334=grep("quiste",datostfg2[,113])
datostfg2[grep2334,113] 
datostfg2[grep2334,105]###Ya presentan 1's
grep2335=grep("Quiste",datostfg2[,113])
datostfg2[grep2335,113] 
datostfg2[grep2335,105] ###Ya presenta un 1
grep2336=grep("QUISTE",datostfg2[,113])
grep2309=grep("0",datostfg2[,105])
table(datostfg2[grep2309,113]) ####Para comprobar si me olvidé de considerar algo
grep2337=grep("Ili",datostfg2[,113])
grep2337=grep("ILI",datostfg2[,113])
datostfg2[grep2337,113] 
datostfg2[grep2337,105]
grep2337=grep("ili",datostfg2[,113])
datostfg2[grep2337,113] 
datostfg2[grep2337,105]
datostfg2[grep2337[c(45)],105]="1"
grep2338=grep("gastr",datostfg2[,113])
datostfg2[grep2338,113] 
datostfg2[grep2338,105]
datostfg2[grep2338[c(6)],105]="1"
grep2339=grep("molestia",datostfg2[,113])
datostfg2[grep2339,113] 
datostfg2[grep2339,105]
datostfg2[grep2339,105]="1"
grep2340=grep("Molestia",datostfg2[,113])
datostfg2[grep2340,113] 
datostfg2[grep2340,105] ###Ya presentan 1's
grep2341=grep("MOLES",datostfg2[,113])
grep2341=grep("Hipo",datostfg2[,113])
grep2341=grep("hipo",datostfg2[,113])
datostfg2[grep2341,113] 
datostfg2[grep2341,105]
datostfg2[grep2341,105]="1"
grep2342=grep("HIPO",datostfg2[,113])
grep2309=grep("0",datostfg2[,105])
table(datostfg2[grep2309,113])
grep2503=grep("Caroti",datostfg2[,113]) ####Pertenece a txt_pulso
datostfg2[grep2503,110] ###Ya registrado
grep2504=grep("^Present",datostfg2[,113]) ####Pertenece a txt_pulso
datostfg2[grep2504,110] ###Ya registrado

####Revisar los unos
grep2505=grep("1",datostfg2[,105]) ####Pertenece a txt_pulso
datostfg2[grep2505,113]

table(datostfg2[,105])
datostfg2[7141,105]=datostfg[7141,104]
datostfg2[706,105]=datostfg[706,104]
datostfg2[6272,105] ####Desplazar 13 posiciones
datostfg2[6272,118]=datostfg[6272,105]
datostfg2[129,115]= datostfg[129,105]
table(datostfg2[,105])
grep2309=grep("0",datostfg2[,105])
table(datostfg2[grep2309,113])

for (i in 1:11984){comp=(is.na(datostfg2[i,105])==TRUE&&
  is.na(datostfg2[i,113])==FALSE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,105]="Revisar"
}else{
        datostfg2[i,105]=datostfg2[i,105]
}}
grep2904=grep("Revisar",datostfg2[,105])
datostfg2[grep2904,113]
datostfg2[grep2904,105]="0"

datostfg2[c(2676,3877,5871,5919,6123),113]
datostfg2[c(2676,3877,5871,5919,6123),105]="0"
```

```{r,include=TRUE}
####Variable 107
table(datostfg2[,107])
datostfg2[7141,107]=datostfg[7141,106]
datostfg2[706,107]=datostfg[706,106]
datostfg2[6272,120]=datostfg[6272,107]
datostfg2[129,107] ####Desplazar 10 columnas
datostfg2[129,117]=datostfg[129,107]
table(datostfg2[,107])


####Variable 120 Agudeza visual

table(datostfg2[,120])
datostfg2[7141,120]=datostfg[7141,119]
datostfg2[706,120]=datostfg[706,119]
datostfg2[6272,120] ####Desplazar 13 posiciones
datostfg2[6272,133]=datostfg[6272,120]
datostfg2[6272,120]=NA
datostfg2[129,130]=datostfg[129,120]



```

```{r,include=TRUE}
####Variable 114(Piel.)  y 116(txt_piel)


table(datostfg2[,114])
datostfg2[7141,114]=datostfg[7141,113]
datostfg2[706,114]=datostfg[706,113]
datostfg2[6272,127]=datostfg[6272,114]
datostfg2[129,114] ####Desplazar 10 columnas
datostfg2[129,124]=datostfg[129,114]
table(datostfg2[,114])

datostfg2[7141,116]=datostfg[7141,115]
datostfg2[706,116]=datostfg[706,115]
datostfg2[6272,129]=datostfg[6272,116]
datostfg2[129,116] ####Corresponde a la variable 126
datostfg2[129,126]=datostfg[129,116]


table(datostfg2[,116]) ####Examinar los casos con acné,piel atópica ....
grep860=grep("0",datostfg2[,114])
datostfg2[grep860,116] #####Hay casos que no son NA y presentan un 0 en la variable numérica.

```

```{r,include=TRUE}
####Variable 115(Genitourinario.varón..)  y 117 (txt_genitourinario)
###La variable 115 presentará un 1 en aquellos hombres que presenten algo reseñable en su sistema genitourinario,en caso contrario presentará un 0.

table(datostfg2[,115])
datostfg2[7141,115]=datostfg[7141,114]
datostfg2[706,115]=datostfg[706,114]
datostfg2[6272,115] ####Desplazar 13 posiciones
datostfg2[6272,128]=datostfg[6272,115]
datostfg2[129,125]=datostfg[129,115]
table(datostfg2[,115])

datostfg2[7141,117]=datostfg[7141,116]
datostfg2[706,117]=datostfg[706,116]
datostfg2[6272,117]
datostfg2[6272,130]=datostfg[6272,117]
datostfg2[129,117] ####Esto corresponde a la variable 127
datostfg2[129,127]=datostfg[129,117]



table(datostfg2[,117]) 
grep861=grep("depresible",datostfg[,117])
datostfg2[grep861,117] #####Errores,esto corresponde a la variable txt_abdomen
datostfg2[grep861,113]

datostfg2[grep861[c(1)],113] ####Esto corresponde al pulso
datostfg2[grep861[c(1)],111]=datostfg[grep861[c(1)],113]
datostfg2[grep861[c(1)],113]=NA

datostfg2[grep861,113]=datostfg[grep861,117]
datostfg2[grep861,105]="0"
datostfg2[grep861,117]=NA
datostfg2[grep861[c(3,8)],113] ####Esto corresponde a Odontología
datostfg2[grep861[c(3,8)],122] ####Ya está registrado
grep862=grep("Pu",datostfg2[,117])
datostfg2[grep862,117] 
datostfg2[grep862[c(309,304,303,298,288,277,262,259,255,250)],117] ###Casos que hay que estudiar
datostfg2[grep862[1001:1027],117] 
datostfg2[grep862[c(502,484,323,281)],117] ####Casos a considerar como positivos
datostfg2[grep862[c(502,484,323,281)],115]="1" ####Ya presentan 1's
grep862=grep862[-c(502,484,323,281)]
grep1106=grep("pu",datostfg2[,117])
datostfg2[grep1106,117] ###Casos ya estudiados anteriormente
grep1106=grep("PU",datostfg2[,117])

grep1106=grep("dentales",datostfg2[,117])
datostfg2[grep1106,117] ###Corresponden a Odontología
datostfg2[grep1106,122]
grep1107=grep("Dentales",datostfg2[,117])

grep1107=grep("DENTA",datostfg2[,117])
datostfg2[grep1107,117]
datostfg2[grep1107,122]###No registrado,realizar cambio en la variable Odontología
grep1108=grep("Disu",datostfg2[,117])
grep1108=grep("DISU",datostfg2[,117])
grep1108=grep("disu",datostfg2[,117])
datostfg2[grep1108,117] ###Considerar como un Si
datostfg2[grep1108,115] ###Ya presenta un 1
grep1109=grep("nictu",datostfg2[,117])
grep1109=grep("Nictu",datostfg2[,117])
datostfg2[grep1109,117]###Si
datostfg2[grep1109,115]###Ya presenta un 1
grep1110=grep("NICTU",datostfg2[,117])
grep1110=grep("Incont",datostfg2[,117])
datostfg2[grep1110,117]###Si
datostfg2[grep1110,115]###Ya presenta un 1
grep1111=grep("incont",datostfg2[,117])
grep1111=grep("INCONT",datostfg2[,117])
grep1111=grep("reflujo",datostfg2[,117])
datostfg2[grep1111,117] ##Si
datostfg2[grep1111,115]###Ya presenta un 1
grep1112=grep("Reflujo",datostfg2[,117])
grep1112=grep("REFLUJO",datostfg2[,117])
grep1112=grep("QUISTE",datostfg2[,117])
grep1112=grep("Quiste",datostfg2[,117])
grep1112=grep("quiste",datostfg2[,117])
datostfg2[grep1112,117] ##Si
datostfg2[grep1112,115]###Ya presenta un 1
grep1113=grep("antecedente",datostfg2[,117])
datostfg2[grep1113,117] ##Si
datostfg2[grep1113,115]###Ya presenta un 1
grep1114=grep("Antecedente",datostfg2[,117])
grep1114=grep("ANTECEDENTE",datostfg2[,117])
grep1114=grep("explorado",datostfg2[,117])
datostfg2[grep1114,117] ##No
datostfg2[grep1114,115]###Error
datostfg2[grep1114,115]="0"
grep1115=grep("Explorado",datostfg2[,117])
grep1115=grep("EXPLORADO",datostfg2[,117])
grep1115=grep("esf",datostfg2[,117])
datostfg2[grep1115,117] ###Si
datostfg2[grep1115,115] ###Ya presenta un 1
grep1115=grep("Esf",datostfg2[,117])
grep1115=grep("ESF",datostfg2[,117])
grep1116=grep("Menar",datostfg2[,117])
datostfg2[grep1116,117] ##No
datostfg2[grep1116,115]###Error
datostfg2[grep1116,115]="0"
datostfg2[grep1116[c(3)],90] ###Ya registrado
datostfg2[grep1116,98]
datostfg2[grep1116[c(3)],98]=datostfg[grep1116[c(3)],117]
grep1117=grep("menar",datostfg2[,117])
datostfg2[grep1117,117] ##No
datostfg2[grep1117,115]###Errores
datostfg2[grep1117,115]="0"
datostfg2[grep1117,98] ###Ya registrado
grep1118=grep("MENAR",datostfg2[,117])
grep1118=grep("MENO",datostfg2[,117])
grep1118=grep("meno",datostfg2[,117])
datostfg2[grep1118,117] ##No
datostfg2[grep1118,115]###Errores
datostfg2[grep1118,115]="0"
datostfg2[grep1118,98]
datostfg2[grep1118[c(7)],98]=datostfg[grep1118[c(7)],117]
grep1119=grep("Meno",datostfg2[,117])
datostfg2[grep1119,117] ##No
datostfg2[grep1119,115]###Errores
datostfg2[grep1119,115]="0"
datostfg2[grep1119[c(1)],86] ####Ya registrado
datostfg2[grep1119,98] ###Ya registrado
grep1120=grep("menstrual",datostfg2[,117])
datostfg2[grep1120,117] ##No
datostfg2[grep1120,115]###Errores
datostfg2[grep1120,115]="0"
datostfg2[grep1120,98]
datostfg2[grep1120[c(19,24,25)],98]=datostfg[grep1120[c(19,24,25)],117]
grep1121=grep("regular",datostfg2[,117])
datostfg2[grep1121,117] ##No
datostfg2[grep1121,115]###Errores
datostfg2[grep1121,115]="0"
datostfg2[grep1121,86]="1"
datostfg2[grep1121,98]
datostfg2[grep1121[c(21)],98]=datostfg[grep1121[c(21)],117]
grep1122=grep("irregular",datostfg2[,117])
datostfg2[grep1122,117] ##No
datostfg2[grep1122,115]###Errores
datostfg2[grep1122,90]="1"
datostfg2[grep1122,98]
datostfg2[grep1122[c(15)],98]=datostfg[grep1122[c(15)],117]
grep1123=grep("Menstrual",datostfg2[,117])
grep1123=grep("MENSTRUAL",datostfg2[,117])
grep1123=grep("DISMENORREA",datostfg2[,117])
grep1123=grep("Dismenorrea",datostfg2[,117])
datostfg2[grep1123,117] ##No
datostfg2[grep1123,115]###Errores
datostfg2[grep1123,115]="0"
datostfg2[grep1123,98] ###Ya registrado
grep1124=grep("dismenorrea",datostfg2[,117])
grep1124=grep("AMENORREA",datostfg2[,117])
grep1124=grep("Amenorrea",datostfg2[,117])
datostfg2[grep1124,117] ##No
datostfg2[grep1124,115]###Errores
datostfg2[grep1124,115]="0"
datostfg2[grep1124,98] ###Ya registrado
grep1125=grep("amenorrea",datostfg2[,117])
grep1125=grep("Impedan",datostfg2[,117])
datostfg2[grep1125,117] ##No
datostfg2[grep1125,115]
datostfg2[grep1125,123] ###Ya registrado
datostfg2[grep1125,124] ###Ya registado

datostfg2[,115]=replace(datostfg2[,115],grep861,"0")
datostfg2[,115]=replace(datostfg2[,115],grep862,"0")
datostfg2[,115]=replace(datostfg2[,115],grep1106,"0")
datostfg2[,115]=replace(datostfg2[,115],grep1107,"0")

###Hay que quitar NA's
####Bucle
for (i in 1:11984){comp=(
  is.na(datostfg2[i,117])==TRUE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,115]="0"
}else{
        datostfg2[i,115]=datostfg2[i,115]
}}

for (i in 1:11984){comp=(datostfg2[i,115]=="1"&&
  datostfg2[i,7]=="F")
if(!is.na(comp)) if (comp) {
   datostfg2[i,115]="2"
}else{
        datostfg2[i,115]=datostfg2[i,115]
}}

grep2GenUr=grep("2",datostfg2[,115])
datostfg2[grep2GenUr,117] ###Son fallos que aún no había corregido
datostfg2[grep2GenUr,115]="0"
grep1GenUr=grep("1",datostfg2[,115])

grep1GenUr=grep("1",datostfg2[,115])
datostfg2[grep1GenUr,117]
grep1126=grep("NR",datostfg2[,117])
grep1126=grep("^N.R",datostfg2[,117])
grep1126=grep("^Ni",datostfg2[,117])
datostfg2[grep1126,117] ###No considerar
grep1126=grep("^NI",datostfg2[,117])
grep1126=grep("^ni",datostfg2[,117])
grep1126=grep("^SIN",datostfg2[,117])
grep1126=grep("^sin",datostfg2[,117])
grep1126=grep("^Sin",datostfg2[,117])
datostfg2[grep1126,117] 
datostfg2[,115]=replace(datostfg2[,115],grep1126,"0")
grep1GenUr=grep("1",datostfg2[,115])
datostfg2[grep1GenUr,117]
datostfg2[grep1GenUr[c(310,307,306,221,216,163,158,144,133,102,66,24,7)],117] ###Casos con algo reseñable
datostfg2[grep1GenUr[-c(310,307,306,221,216,163,158,144,133,102,66,24,7)],115]="0"

for (i in 1:11984){comp=(
  datostfg2[i,7]=="F")
if(!is.na(comp)) if (comp) {
   datostfg2[i,115]=NA
}else{
        datostfg2[i,115]=datostfg2[i,115]
}}
grep2506=grep("0",datostfg2[,115])
table(datostfg2[grep2506,117])
####Podriamos completar información de la variable 91 con la variable 117.

for (i in 1:11984){comp=(is.na(datostfg2[i,115])==TRUE&&
  is.na(datostfg2[i,117])==FALSE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,115]="Revisar"
}else{
        datostfg2[i,115]=datostfg2[i,115]
}}
grep2904=grep("Revisar",datostfg2[,115])
datostfg2[grep2904,117]
datostfg2[grep2904,115]="0"

grep3000=grep("irregular",datostfg2[,117])
datostfg2[grep3000,117]
datostfg2[grep3000,90]="1"
grep3001=grep("regular",datostfg2[,117])
datostfg2[grep3001,117]
datostfg2[grep3001[c(2,3,5,6,7)],86]="1"

datostfg2[c(2676,3877,5871,5919,6123),117]
datostfg2[c(2676,3877,5871,5919,6123),115]="0"
```

```{r,include=TRUE}
####Variable 118(num_PAD) Presión arterial diastólica


table(datostfg2[,118])
datostfg2[7141,118]=datostfg[7141,117]
datostfg2[706,118]=datostfg[706,117]
datostfg2[6272,118] ####Desplazar 13 posiciones
datostfg2[6272,131]=datostfg[6272,118]
datostfg2[129,118] ###Desplazar 10 posiciones
datostfg2[129,128]=datostfg[129,118]
table(datostfg2[,118])

grep863=grep("^0",datostfg2[,118])
datostfg2[grep863,118]
datostfg2[grep863,119]
datostfg2[grep863,118]=NA
datostfg2[grep863,119]=NA
grep864=grep("^990",datostfg2[,118])
datostfg2[grep864,118] ##Error,considero que el registro correcto es 90,ya que aparece más veces que 99 y es un error común teclear un número una segunda vez por error.
datostfg2[grep864,118]="90"
datostfg2[grep864,119]
grep865=grep("^10",datostfg2[,118]) ###Hay registros muy atos y  dos "10" que obviamente son fallos
datostfg2[grep865,118]
datostfg2[grep865,119]
datostfg2[grep865[c(3)],118]=100 ###Ya que la presión arterial sistólica es 150
grep865[c(27)]
datostfg2[grep865[c(27)],119] 
####Veamos cual es la moda en estos casos y sustituimos por ese valor
grep866=grep("100",datostfg2[,119])
datostfg2[grep866,118]
table(datostfg2[grep866[-c(725)],118]) ###La moda es 60
datostfg2[grep865[c(27)],118]="60"
grep867=grep("4.9",datostfg2[,118])
datostfg2[grep867,119]
datostfg2[grep867,118]="49"
grep868=grep("159",datostfg2[,118])
datostfg2[grep868,118] 
datostfg2[grep868,119] 
grep870=grep("59",datostfg2[,118])
table(datostfg2[grep870,119]) #####Puede ser 59
datostfg2[grep868,118]="59"
grep869=grep("178",datostfg2[,118])
datostfg2[grep869,119]
datostfg2[grep869,124]=datostfg[grep869,118]
datostfg2[grep869,123]=datostfg[grep869,119]
datostfg2[grep869,118]=datostfg[grep869,124]
datostfg2[grep869,119]=datostfg[grep869,123]
table(datostfg2[,118])
grep871=grep("185",datostfg2[,118])
datostfg2[grep871,119]
datostfg2[grep871,118]=datostfg[grep871,119]
datostfg2[grep871,119]=datostfg[grep871,118]
table(datostfg2[,118])
####Variable 119(num_PAS) Presión arterial sistólica

table(datostfg2[,119])
datostfg2[7141,119]=datostfg[7141,118]
datostfg2[706,119]=datostfg[706,118]
datostfg2[6272,119] ###Esto hay que moverlo 13 columnas
datostfg2[6272,132]=datostfg[6272,119]
datostfg2[129,129]=datostfg[129,119]
table(datostfg2[,119])
#####Veamos si hay fallos en los valores más bajos

grep872=grep("^7",datostfg2[,119])
datostfg2[grep872,118]
grep873=grep("^8",datostfg2[,119])
datostfg2[grep873,118]
grep874=grep("^9",datostfg2[,119])
datostfg2[grep874,119]
datostfg2[grep874,118] ####Hay un caso sin registrar
grep874[(732)]
datostfg2[grep874[(732)],119]
grep875=grep("95",datostfg2[,119])
table(datostfg2[grep875,118]) ####La moda es 60
datostfg2[grep874[(732)],118]="60"
grep1127=grep("^4",datostfg2[,119])
datostfg2[grep1127,119]
datostfg2[grep1127,118]
datostfg2[grep1127,119]=datostfg[grep1127,118]
datostfg2[grep1127,118]=datostfg[grep1127,119]
grep1128=grep("^6",datostfg2[,119])
datostfg2[grep1128,119]
datostfg2[grep1128,118]

table(datostfg2[,119])
```


```{r,include=TRUE}
####Variable 121 (Odontología) y 122 (Odontologia_txt)
###La variable 121 es una variable dicotómica y la variable 122 es una variable de texto.
####La variable 121 presentará un 1 en aquellos casos que presenten algún problema,reparación o tratamiento relevante a nivel odontológico,en caso contrario presentará un 0.

table(datostfg2[,121])
datostfg2[7141,121]=datostfg[7141,120]
datostfg2[706,121]=datostfg[706,120]
datostfg2[6272,121] ####Desplazar 13 posiciones
datostfg2[6272,134]=datostfg[6272,121]
datostfg2[129,121] ####Desplazar 10 posiciones
datostfg2[129,131]=datostfg[129,121]
table(datostfg2[,121])

datostfg2[7141,122]=datostfg[7141,121]
datostfg2[706,122]=datostfg[706,121]
datostfg2[6272,122]
datostfg2[6272,135]=datostfg[6272,122]
datostfg2[129,122] ####Esto corresponde a la variable 132
datostfg2[129,132]=datostfg[129,122]


grep878=grep("0",datostfg2[,121])
datostfg2[grep878,122]  ####Los ceros corresponden a casos que no presentan nada relevante a nivel odontológico o en los cuales la información no ha sido proporcionada.

grep876=grep("^No",datostfg2[,122])
datostfg2[grep876,122]
datostfg2[grep876[1001:2000],122]
datostfg2[grep876[2001:3000],122]
datostfg2[grep876[3001:3427],122]

datostfg2[grep876[c(160)],122] ####Lo tendré en cuenta como un 1
datostfg2[grep876[c(160)],121]="1"
datostfg2[grep876[c(437)],122]
datostfg2[grep876[c(437)],121] 
datostfg2[grep876[c(1291)],122]
datostfg2[grep876[c(1291)],121]="0"  ###Considero que el paciente no aporta la información,ya que en muchas otras variables tampoco hay registro
datostfg2[grep876[c(2200)],122]
datostfg2[grep876[c(2200)],121]="1"


datostfg2[grep876[c(12,13,20,23,24,25,26,28,53,54,64,75,79,81,91,93,98,118,120,129,140,157,172,180,182,186,187,200,202,204,209,212,215,216,218,221,224,243,244,245,246,249,251,256,259,272,273,280,288,296,300,302,305,310,313,318,324,326,333,338,346,360,362,369,373,384,389,390,393,395,399,400,401,411,425,430,435,440,457,458,467,470,474,477,478,484,499,504,521,523,529,535,538,539,540,543,548,561,564,570,571,572,577,586,596,599,600,603,606,611,619,626,633,635,641,642,643,644,645,652,653,662,693,697,707,712,713,716,717,718,721,726,728,729,731,732,734,736,737,738,739,740,743,745,746,748,749,750,751,753,754,755,758,760,761,762,766,767,769,770,772,773,774,778,779,782,786,787,789,790,791,792,793,794,795,797,798,800,801,804,805,806,810,811,812,814,816,817,818,820,822,823,824,825,828,830,833,834,837,840,841,847,852,854,855,858,860,867,874,877,882,886,887,899,906,907,908,909,912,914,915,923,924,925,928,931,933,938,943,944,947,951,963,967,970,975,976,979,985,988,991,995,1010,1011,1017,1020,1026,1033,1036,1044,1051,1052,1062,1066,1070,1079,1080,1082,1098,1100,1102,1108,1116,1117,1118,1121,1123,1130,1131,1132,1136,1138,1143,1145,1146,1147,1150,1151,1152,1153,1157,1159,1166,1169,1170,1178,1179,1184,1187,1207,1212,1218,1219,1221,1232,1233,1243,1244,1245,1271,1278,1280,1281,1288,1295,1299,1304,1305,1308,1311,1313,1320,1326,1327,1328,1330,1345,1346,1349,1354,1361,1390,1392,1412,1413,1415,1416,1418,1420,1425,1428,1430,1447,1448,1450,1453,1459,1475,1476,1478,1481,1482,1483,1486,1491,1500,1502,1505,1512,1515,1519,1527,1530,1531,1532,1542,1544,1548,1551,1563,1577,1578,1583,1584,1586,1587,1588,1592,1596,1599,1600,1602,1603,1604,1605,1607,1608,1610,1612,1613,1615,1617,1620,1623,1624,1625,1628,1634,1635,1636,1639,1643,1644,1645,1647,1648,1649,1650,1651,1656,1659,1660,1661,1663,1671,1676,1679,1680,1691,1692,1695,1696,1704,1716,1717,1719,1720,1724,1726,1729,1735,1738,1740,1749,1751,1753,1757,1763,1769,1770,1772,1775,1778,1781,1784,1786,1787,1793,1801,1802,1803,1804,1808,1810,1818,1822,1826,1827,1835,1839,1842,1843,1848,1849,1851,1853,1854,1857,1859,1862,1866,1868,1869,1870,1872,1873,1874,1875,1876,1877,1879,1880,1881,1886,1893,1894,1896,1898,1899,1901,1905,1911,1923,1925,1926,1928,1932,1935,1936,1938,1939,1942,1947,1948,1949,1952,1958,1966,1968,1970,1972,1982,1984,1986,1989,1990,1991,1995,2020,2026,2027,2032,2041,2049,2052,2053,2084,2086,2094,2101,2102,2103,2105,2108,2117,2119,2121,2122,2125,2127,2130,2135,2162,2170,2172,2174,2175,2177,2179,2184,2187,2188,2191,2200,2208,2210,2211,2213,2215,2220,2221,2222,2227,2230,2236,2237,2240,2241,2244,2247,2248,2249,2252,2254,2255,2258,2259,2260,2262,2263,2264,2265,2269,2272,2273,2274,2275,2276,2279,2282,2284,2285,2288,2289,2292,2295,2299,2306,2307,2310,2314,2320,2322,2323,2333,2339,2340,2342,2343,2347,2351,2367,2368,2372,2379,2385,2389,2391,2393,2398,2410,2411,2418,2427,2443,2446,2451,2460,2469,2474,2475,2477,2478,2488,2491,2497,2511,2513,2514,2516,2521,2522,2526,2529,2532,2533,2538,2540,2542,2546,2548,2550,2552,2553,2554,2560,2565,2569,2570,2582,2589,2592,2594,2595,2596,2604,2610,2611,2619,2621,2622,2623,2626,2627,2628,2630,2632,2636,2637,2638,2639,2643,2647,2648,2651,2652,2654,2657,2659,2660,2661,2662,2663,2667,2668,2670,2673,2675,2677,2683,2684,2687,2690,2691,2695,2697,2702,2704,2706,2709,2711,2712,2720,2721,2726,2746,2768,2769,2775,2784,2786,2787,2789,2790,2805,2808,2822,2828,2837,2839,2844,2846,2851,2852,2853,2854,2858,2859,2861,2866,2871,2873,2876,2881,2889,2890,2891,2900,2901,2910.2918,2928,2933,2940,2949,2955,2957,2958,2959,2962,2971,2972,2973,2974,2979,2984,2985,2987,2999,3001,3003,3007,3008,3009,3011,3013,3015,3016,3020,3022,3023,3027,3028,3029,3030,3043,3049,3059,3075,3076,3080,3101,3103,3106,3112,3113,3116,3118,3121,3133,3137,3138,3143,3160,3168,3180,3183,3185,3186,3187,3191,3196,3197,3198,3200,3202,3203,3207,3213,3217,3224,3226,3229,3230,3240,3242,3244,
3245,3247,3272,3273,3278,3283,3284,3285,3292,3293,3294,3295,3300,3309,3318,3322,3327,3332,3338,3348,3349,3352,3353,3354,3355,3358,3364,3366,3368,3372,3373,3377,3378,3380,3382,3384,3389,3393,3395,3401,3406,3408,3412,3419,3421,3425,3426,160,437,2200)],122] 
#####Casos con obturación,ortodoncia,caries,piezas dentales dañadas o algo relevante a nivel odontológico
datostfg2[grep876[c(12,13,20,23,24,25,26,28,53,54,64,75,79,81,91,93,98,118,120,129,140,157,172,180,182,186,187,200,202,204,209,212,215,216,218,221,224,243,244,245,246,249,251,256,259,272,273,280,288,296,300,302,305,310,313,318,324,326,333,338,346,360,362,369,373,384,389,390,393,395,399,400,401,411,425,430,435,440,457,458,467,470,474,477,478,484,499,504,521,523,529,535,538,539,540,543,548,561,564,570,571,572,577,586,596,599,600,603,606,611,619,626,633,635,641,642,643,644,645,652,653,662,693,697,707,712,713,716,717,718,721,726,728,729,731,732,734,736,737,738,739,740,743,745,746,748,749,750,751,753,754,755,758,760,761,762,766,767,769,770,772,773,774,778,779,782,786,787,789,790,791,792,793,794,795,797,798,800,801,804,805,806,810,811,812,814,816,817,818,820,822,823,824,825,828,830,833,834,837,840,841,847,852,854,855,858,860,867,874,877,882,886,887,899,906,907,908,909,912,914,915,923,924,925,928,931,933,938,943,944,947,951,963,967,970,975,976,979,985,988,991,995,1010,1011,1017,1020,1026,1033,1036,1044,1051,1052,1062,1066,1070,1079,1080,1082,1098,1100,1102,1108,1116,1117,1118,1121,1123,1130,1131,1132,1136,1138,1143,1145,1146,1147,1150,1151,1152,1153,1157,1159,1166,1169,1170,1178,1179,1184,1187,1207,1212,1218,1219,1221,1232,1233,1243,1244,1245,1271,1278,1280,1281,1288,1295,1299,1304,1305,1308,1311,1313,1320,1326,1327,1328,1330,1345,1346,1349,1354,1361,1390,1392,1412,1413,1415,1416,1418,1420,1425,1428,1430,1447,1448,1450,1453,1459,1475,1476,1478,1481,1482,1483,1486,1491,1500,1502,1505,1512,1515,1519,1527,1530,1531,1532,1542,1544,1548,1551,1563,1577,1578,1583,1584,1586,1587,1588,1592,1596,1599,1600,1602,1603,1604,1605,1607,1608,1610,1612,1613,1615,1617,1620,1623,1624,1625,1628,1634,1635,1636,1639,1643,1644,1645,1647,1648,1649,1650,1651,1656,1659,1660,1661,1663,1671,1676,1679,1680,1691,1692,1695,1696,1704,1716,1717,1719,1720,1724,1726,1729,1735,1738,1740,1749,1751,1753,1757,1763,1769,1770,1772,1775,1778,1781,1784,1786,1787,1793,1801,1802,1803,1804,1808,1810,1818,1822,1826,1827,1835,1839,1842,1843,1848,1849,1851,1853,1854,1857,1859,1862,1866,1868,1869,1870,1872,1873,1874,1875,1876,1877,1879,1880,1881,1886,1893,1894,1896,1898,1899,1901,1905,1911,1923,1925,1926,1928,1932,1935,1936,1938,1939,1942,1947,1948,1949,1952,1958,1966,1968,1970,1972,1982,1984,1986,1989,1990,1991,1995,2020,2026,2027,2032,2041,2049,2052,2053,2084,2086,2094,2101,2102,2103,2105,2108,2117,2119,2121,2122,2125,2127,2130,2135,2162,2170,2172,2174,2175,2177,2179,2184,2187,2188,2191,2200,2208,2210,2211,2213,2215,2220,2221,2222,2227,2230,2236,2237,2240,2241,2244,2247,2248,2249,2252,2254,2255,2258,2259,2260,2262,2263,2264,2265,2269,2272,2273,2274,2275,2276,2279,2282,2284,2285,2288,2289,2292,2295,2299,2306,2307,2310,2314,2320,2322,2323,2333,2339,2340,2342,2343,2347,2351,2367,2368,2372,2379,2385,2389,2391,2393,2398,2410,2411,2418,2427,2443,2446,2451,2460,2469,2474,2475,2477,2478,2488,2491,2497,2511,2513,2514,2516,2521,2522,2526,2529,2532,2533,2538,2540,2542,2546,2548,2550,2552,2553,2554,2560,2565,2569,2570,2582,2589,2592,2594,2595,2596,2604,2610,2611,2619,2621,2622,2623,2626,2627,2628,2630,2632,2636,2637,2638,2639,2643,2647,2648,2651,2652,2654,2657,2659,2660,2661,2662,2663,2667,2668,2670,2673,2675,2677,2683,2684,2687,2690,2691,2695,2697,2702,2704,2706,2709,2711,2712,2720,2721,2726,2746,2768,2769,2775,2784,2786,2787,2789,2790,2805,2808,2822,2828,2837,2839,2844,2846,2851,2852,2853,2854,2858,2859,2861,2866,2871,2873,2876,2881,2889,2890,2891,2900,2901,2910.2918,2928,2933,2940,2949,2955,2957,2958,2959,2962,2971,2972,2973,2974,2979,2984,2985,2987,2999,3001,3003,3007,3008,3009,3011,3013,3015,3016,3020,3022,3023,3027,3028,3029,3030,3043,3049,3059,3075,3076,3080,3101,3103,3106,3112,3113,3116,3118,3121,3133,3137,3138,3143,3160,3168,3180,3183,3185,3186,3187,3191,3196,3197,3198,3200,3202,3203,3207,3213,3217,3224,3226,3229,3230,3240,3242,3244,
3245,3247,3272,3273,3278,3283,3284,3285,3292,3293,3294,3295,3300,3309,3318,3322,3327,3332,3338,3348,3349,3352,3353,3354,3355,3358,3364,3366,3368,3372,3373,3377,3378,3380,3382,3384,3389,3393,3395,3401,3406,3408,3412,3419,3421,3425,3426,160,437,2200)],121] 

#####Hay casos que no presentan un 1

datostfg2[grep876[c(12,13,20,23,24,25,26,28,53,54,64,75,79,81,91,93,98,118,120,129,140,157,172,180,182,186,187,200,202,204,209,212,215,216,218,221,224,243,244,245,246,249,251,256,259,272,273,280,288,296,300,302,305,310,313,318,324,326,333,338,346,360,362,369,373,384,389,390,393,395,399,400,401,411,425,430,435,440,457,458,467,470,474,477,478,484,499,504,521,523,529,535,538,539,540,543,548,561,564,570,571,572,577,586,596,599,600,603,606,611,619,626,633,635,641,642,643,644,645,652,653,662,693,697,707,712,713,716,717,718,721,726,728,729,731,732,734,736,737,738,739,740,743,745,746,748,749,750,751,753,754,755,758,760,761,762,766,767,769,770,772,773,774,778,779,782,786,787,789,790,791,792,793,794,795,797,798,800,801,804,805,806,810,811,812,814,816,817,818,820,822,823,824,825,828,830,833,834,837,840,841,847,852,854,855,858,860,867,874,877,882,886,887,899,906,907,908,909,912,914,915,923,924,925,928,931,933,938,943,944,947,951,963,967,970,975,976,979,985,988,991,995,1010,1011,1017,1020,1026,1033,1036,1044,1051,1052,1062,1066,1070,1079,1080,1082,1098,1100,1102,1108,1116,1117,1118,1121,1123,1130,1131,1132,1136,1138,1143,1145,1146,1147,1150,1151,1152,1153,1157,1159,1166,1169,1170,1178,1179,1184,1187,1207,1212,1218,1219,1221,1232,1233,1243,1244,1245,1271,1278,1280,1281,1288,1295,1299,1304,1305,1308,1311,1313,1320,1326,1327,1328,1330,1345,1346,1349,1354,1361,1390,1392,1412,1413,1415,1416,1418,1420,1425,1428,1430,1447,1448,1450,1453,1459,1475,1476,1478,1481,1482,1483,1486,1491,1500,1502,1505,1512,1515,1519,1527,1530,1531,1532,1542,1544,1548,1551,1563,1577,1578,1583,1584,1586,1587,1588,1592,1596,1599,1600,1602,1603,1604,1605,1607,1608,1610,1612,1613,1615,1617,1620,1623,1624,1625,1628,1634,1635,1636,1639,1643,1644,1645,1647,1648,1649,1650,1651,1656,1659,1660,1661,1663,1671,1676,1679,1680,1691,1692,1695,1696,1704,1716,1717,1719,1720,1724,1726,1729,1735,1738,1740,1749,1751,1753,1757,1763,1769,1770,1772,1775,1778,1781,1784,1786,1787,1793,1801,1802,1803,1804,1808,1810,1818,1822,1826,1827,1835,1839,1842,1843,1848,1849,1851,1853,1854,1857,1859,1862,1866,1868,1869,1870,1872,1873,1874,1875,1876,1877,1879,1880,1881,1886,1893,1894,1896,1898,1899,1901,1905,1911,1923,1925,1926,1928,1932,1935,1936,1938,1939,1942,1947,1948,1949,1952,1958,1966,1968,1970,1972,1982,1984,1986,1989,1990,1991,1995,2020,2026,2027,2032,2041,2049,2052,2053,2084,2086,2094,2101,2102,2103,2105,2108,2117,2119,2121,2122,2125,2127,2130,2135,2162,2170,2172,2174,2175,2177,2179,2184,2187,2188,2191,2200,2208,2210,2211,2213,2215,2220,2221,2222,2227,2230,2236,2237,2240,2241,2244,2247,2248,2249,2252,2254,2255,2258,2259,2260,2262,2263,2264,2265,2269,2272,2273,2274,2275,2276,2279,2282,2284,2285,2288,2289,2292,2295,2299,2306,2307,2310,2314,2320,2322,2323,2333,2339,2340,2342,2343,2347,2351,2367,2368,2372,2379,2385,2389,2391,2393,2398,2410,2411,2418,2427,2443,2446,2451,2460,2469,2474,2475,2477,2478,2488,2491,2497,2511,2513,2514,2516,2521,2522,2526,2529,2532,2533,2538,2540,2542,2546,2548,2550,2552,2553,2554,2560,2565,2569,2570,2582,2589,2592,2594,2595,2596,2604,2610,2611,2619,2621,2622,2623,2626,2627,2628,2630,2632,2636,2637,2638,2639,2643,2647,2648,2651,2652,2654,2657,2659,2660,2661,2662,2663,2667,2668,2670,2673,2675,2677,2683,2684,2687,2690,2691,2695,2697,2702,2704,2706,2709,2711,2712,2720,2721,2726,2746,2768,2769,2775,2784,2786,2787,2789,2790,2805,2808,2822,2828,2837,2839,2844,2846,2851,2852,2853,2854,2858,2859,2861,2866,2871,2873,2876,2881,2889,2890,2891,2900,2901,2910.2918,2928,2933,2940,2949,2955,2957,2958,2959,2962,2971,2972,2973,2974,2979,2984,2985,2987,2999,3001,3003,3007,3008,3009,3011,3013,3015,3016,3020,3022,3023,3027,3028,3029,3030,3043,3049,3059,3075,3076,3080,3101,3103,3106,3112,3113,3116,3118,3121,3133,3137,3138,3143,3160,3168,3180,3183,3185,3186,3187,3191,3196,3197,3198,3200,3202,3203,3207,3213,3217,3224,3226,3229,3230,3240,3242,3244,
3245,3247,3272,3273,3278,3283,3284,3285,3292,3293,3294,3295,3300,3309,3318,3322,3327,3332,3338,3348,3349,3352,3353,3354,3355,3358,3364,3366,3368,3372,3373,3377,3378,3380,3382,3384,3389,3393,3395,3401,3406,3408,3412,3419,3421,3425,3426,160,437,2200)],121]="1"

datostfg2[grep876[c(161,167,173,174,455,465,469,476,491,839,916,1222,1931,1963)],122] ###Casos normales,sin nada relevante


grep876=grep876[-c(12,13,20,23,24,25,26,28,53,54,64,75,79,81,91,93,98,118,120,129,140,157,172,180,182,186,187,200,202,204,209,212,215,216,218,221,224,243,244,245,246,249,251,256,259,272,273,280,288,296,300,302,305,310,313,318,324,326,333,338,346,360,362,369,373,384,389,390,393,395,399,400,401,411,425,430,435,440,457,458,467,470,474,477,478,484,499,504,521,523,529,535,538,539,540,543,548,561,564,570,571,572,577,586,596,599,600,603,606,611,619,626,633,635,641,642,643,644,645,652,653,662,693,697,707,712,713,716,717,718,721,726,728,729,731,732,734,736,737,738,739,740,743,745,746,748,749,750,751,753,754,755,758,760,761,762,766,767,769,770,772,773,774,778,779,782,786,787,789,790,791,792,793,794,795,797,798,800,801,804,805,806,810,811,812,814,816,817,818,820,822,823,824,825,828,830,833,834,837,840,841,847,852,854,855,858,860,867,874,877,882,886,887,899,906,907,908,909,912,914,915,923,924,925,928,931,933,938,943,944,947,951,963,967,970,975,976,979,985,988,991,995,1010,1011,1017,1020,1026,1033,1036,1044,1051,1052,1062,1066,1070,1079,1080,1082,1098,1100,1102,1108,1116,1117,1118,1121,1123,1130,1131,1132,1136,1138,1143,1145,1146,1147,1150,1151,1152,1153,1157,1159,1166,1169,1170,1178,1179,1184,1187,1207,1212,1218,1219,1221,1232,1233,1243,1244,1245,1271,1278,1280,1281,1288,1295,1299,1304,1305,1308,1311,1313,1320,1326,1327,1328,1330,1345,1346,1349,1354,1361,1390,1392,1412,1413,1415,1416,1418,1420,1425,1428,1430,1447,1448,1450,1453,1459,1475,1476,1478,1481,1482,1483,1486,1491,1500,1502,1505,1512,1515,1519,1527,1530,1531,1532,1542,1544,1548,1551,1563,1577,1578,1583,1584,1586,1587,1588,1592,1596,1599,1600,1602,1603,1604,1605,1607,1608,1610,1612,1613,1615,1617,1620,1623,1624,1625,1628,1634,1635,1636,1639,1643,1644,1645,1647,1648,1649,1650,1651,1656,1659,1660,1661,1663,1671,1676,1679,1680,1691,1692,1695,1696,1704,1716,1717,1719,1720,1724,1726,1729,1735,1738,1740,1749,1751,1753,1757,1763,1769,1770,1772,1775,1778,1781,1784,1786,1787,1793,1801,1802,1803,1804,1808,1810,1818,1822,1826,1827,1835,1839,1842,1843,1848,1849,1851,1853,1854,1857,1859,1862,1866,1868,1869,1870,1872,1873,1874,1875,1876,1877,1879,1880,1881,1886,1893,1894,1896,1898,1899,1901,1905,1911,1923,1925,1926,1928,1932,1935,1936,1938,1939,1942,1947,1948,1949,1952,1958,1966,1968,1970,1972,1982,1984,1986,1989,1990,1991,1995,2020,2026,2027,2032,2041,2049,2052,2053,2084,2086,2094,2101,2102,2103,2105,2108,2117,2119,2121,2122,2125,2127,2130,2135,2162,2170,2172,2174,2175,2177,2179,2184,2187,2188,2191,2200,2208,2210,2211,2213,2215,2220,2221,2222,2227,2230,2236,2237,2240,2241,2244,2247,2248,2249,2252,2254,2255,2258,2259,2260,2262,2263,2264,2265,2269,2272,2273,2274,2275,2276,2279,2282,2284,2285,2288,2289,2292,2295,2299,2306,2307,2310,2314,2320,2322,2323,2333,2339,2340,2342,2343,2347,2351,2367,2368,2372,2379,2385,2389,2391,2393,2398,2410,2411,2418,2427,2443,2446,2451,2460,2469,2474,2475,2477,2478,2488,2491,2497,2511,2513,2514,2516,2521,2522,2526,2529,2532,2533,2538,2540,2542,2546,2548,2550,2552,2553,2554,2560,2565,2569,2570,2582,2589,2592,2594,2595,2596,2604,2610,2611,2619,2621,2622,2623,2626,2627,2628,2630,2632,2636,2637,2638,2639,2643,2647,2648,2651,2652,2654,2657,2659,2660,2661,2662,2663,2667,2668,2670,2673,2675,2677,2683,2684,2687,2690,2691,2695,2697,2702,2704,2706,2709,2711,2712,2720,2721,2726,2746,2768,2769,2775,2784,2786,2787,2789,2790,2805,2808,2822,2828,2837,2839,2844,2846,2851,2852,2853,2854,2858,2859,2861,2866,2871,2873,2876,2881,2889,2890,2891,2900,2901,2910.2918,2928,2933,2940,2949,2955,2957,2958,2959,2962,2971,2972,2973,2974,2979,2984,2985,2987,2999,3001,3003,3007,3008,3009,3011,3013,3015,3016,3020,3022,3023,3027,3028,3029,3030,3043,3049,3059,3075,3076,3080,3101,3103,3106,3112,3113,3116,3118,3121,3133,3137,3138,3143,3160,3168,3180,3183,3185,3186,3187,3191,3196,3197,3198,3200,3202,3203,3207,3213,3217,3224,3226,3229,3230,3240,3242,3244,
3245,3247,3272,3273,3278,3283,3284,3285,3292,3293,3294,3295,3300,3309,3318,3322,3327,3332,3338,3348,3349,3352,3353,3354,3355,3358,3364,3366,3368,3372,3373,3377,3378,3380,3382,3384,3389,3393,3395,3401,3406,3408,3412,3419,3421,3425,3426,160,437,2200)]


grep877=grep("^no",datostfg2[,122])
datostfg2[grep877,122]
datostfg2[grep877[c(1,3,6,10)],121] ###Deben ser todos 1
datostfg2[grep877[c(1,3,6,10)],121]="1"
grep877=grep877[-c(1,3,6,10)]
grep879=grep("^NO",datostfg2[,122])
datostfg2[grep879,122]  ###Normal
grep880=grep("NR",datostfg2[,122])
grep880=grep("^N.R",datostfg2[,122])
datostfg2[grep880,122]
grep880=grep("^Ni",datostfg2[,122])
grep880=grep("^NI",datostfg2[,122])
grep880=grep("^ni",datostfg2[,122])
grep880=grep("^SIN",datostfg2[,122])
datostfg2[grep880,122]
grep881=grep("^sin",datostfg2[,122])
grep881=grep("^Sin",datostfg2[,122])
datostfg2[grep881,122]
datostfg2[grep881[c(24,25,58,69,103)],121]
grep881=grep881[-c(24,25,58,69,103)]

datostfg2[,121]=replace(datostfg2[,121],grep876,"0")
datostfg2[,121]=replace(datostfg2[,121],grep877,"0")
datostfg2[,121]=replace(datostfg2[,121],grep878,"0")
datostfg2[,121]=replace(datostfg2[,121],grep879,"0")
datostfg2[,121]=replace(datostfg2[,121],grep880,"0")
datostfg2[,121]=replace(datostfg2[,121],grep881,"0")

datostfg2[grep1106[c(9,10,11,12)],122]=datostfg[grep863[c(9,10,11,12)],117]
datostfg2[grep1106,122]
datostfg2[grep1107,122]=datostfg[grep1107,117]

###Hay que quitar NA's
####Bucle
for (i in 1:11984){comp=(
  is.na(datostfg2[i,122])==TRUE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,121]="0"
}else{
        datostfg2[i,121]=datostfg2[i,121]
}}

####Hay que revisar los 1's
grep1Odon=grep("1",datostfg2[,121])
datostfg2[grep1Odon,122]
datostfg2[grep1Odon[1001:2000],122]
datostfg2[grep1Odon[2001:2519],122]
datostfg2[grep1Odon[c(986,981,978,976,960,954,950,941,932,928,911,906,905,896,885,886,880,870,786,783,773,769,747,704,690,681,666,656,645,640,634,632,623,616,604,599,591,579,573,572,569,567,552,550,547,533,529,515,508,509,504,499,496,494,484,478,472,371,369,280,1986,1978,1951,1948,1943,1941,1935,1886,1861,1837,1819,1805,1794,1785,1772,1767,1765,1747,1745,1726,1723,1722,1721,1720,1710,1707,1682,1680,1675,1672,1670,1668,1665,1660,1658,1656,1653,1652,1651,1648,1646,1644,1642,1640,1639,1636,1635,1625,1618,1616,1614,1611,1608,1605,1604,1603,1601,1583,1582,1580,1579,1570,1568,1565,1558,1556,1555,1551,1550,1548,1546,1544,1538,1531,1522,1520,1515,1507,1503,1502,1500,1498,1484,1478,1473,1471,1462,1460,1459,1457,1456,1442,1434,1425,1396,1392,1383,1382,1370,1354,1308,1307,1306,1299,1291,1285,1277,1274,1270,1267,1266,1225,1200,1184,1177,1168,1163,1156,1153,1147,1141,1130,1129,1110,1086,1074,1071,1058,1049,1046,1042,1039,1035,1033,1031,1022,1018,1014,2500,2488,2485,2484,2479,2474,2471,2470,2469,2467,2465,2464,2461,2457,2455,2444,2438,2428,2426,2423,2422,2417,2400,2397,2391,2386,2384,2380,2377,2374,2373,2365,2362,2357,2353,2352,2351,2348,2347,2339,2336,2334,2324,2321,2317,2314,2310,2305,2304,2298,2297,2291,2287,2282,2277,2273,2271,2264,2263,2262,2258,2251,2249,2248,2246,2245,2238,2236,2231,2213,2212,2207,2205,2204,2158,2145,2140,2111,2097,2084,2058,2047,45,2067)],122] ####Casos que no presentan nada reseñable


datostfg2[grep1Odon[c(45)],122] ####Corresponde a la variable abdomen_txt
datostfg2[grep1Odon[c(45)],113] ####Ya registrado
datostfg2[grep1Odon[c(26)],122] ####Considerar como un Si
datostfg2[grep1Odon[c(1654)],122] ####Prótesis removible parcial(si)
datostfg2[grep1Odon[c(1409)],122] ####Contiene mucha información,mirar si está toda registrada y en caso de contradicción que prevalezca la información que está ya en su campo correcto.
datostfg2[grep1Odon[c(1409)],106] ####Ya registrado
datostfg2[grep1Odon[c(1409)],108]###Ya registrado
datostfg2[grep1Odon[c(1409)],109]###Ya registrado
datostfg2[grep1Odon[c(1409)],112] ####Ya registrado
datostfg2[grep1Odon[c(1409)],110] ###Ya registrado
datostfg2[grep1Odon[c(1409)],113]###Ya registrado
datostfg2[grep1Odon[c(1409)],111]###Ya registrado
datostfg2[grep1Odon[c(1409)],116] ####Ya registrado
datostfg2[grep1Odon[c(1409)],107]###Ya registrado
datostfg2[grep1Odon[c(2067)],122] ####Contiene información de la variable abdomen_txt
datostfg2[grep1Odon[c(2067)],113] ###Ya registrado

datostfg2[grep1Odon[c(986,981,978,976,960,954,950,941,932,928,911,906,905,896,885,886,880,870,786,783,773,769,747,704,690,681,666,656,645,640,634,632,623,616,604,599,591,579,573,572,569,567,552,550,547,533,529,515,508,509,504,499,496,494,484,478,472,371,369,280,1986,1978,1951,1948,1943,1941,1935,1886,1861,1837,1819,1805,1794,1785,1772,1767,1765,1747,1745,1726,1723,1722,1721,1720,1710,1707,1682,1680,1675,1672,1670,1668,1665,1660,1658,1656,1653,1652,1651,1648,1646,1644,1642,1640,1639,1636,1635,1625,1618,1616,1614,1611,1608,1605,1604,1603,1601,1583,1582,1580,1579,1570,1568,1565,1558,1556,1555,1551,1550,1548,1546,1544,1538,1531,1522,1520,1515,1507,1503,1502,1500,1498,1484,1478,1473,1471,1462,1460,1459,1457,1456,1442,1434,1425,1396,1392,1383,1382,1370,1354,1308,1307,1306,1299,1291,1285,1277,1274,1270,1267,1266,1225,1200,1184,1177,1168,1163,1156,1153,1147,1141,1130,1129,1110,1086,1074,1071,1058,1049,1046,1042,1039,1035,1033,1031,1022,1018,1014,2500,2488,2485,2484,2479,2474,2471,2470,2469,2467,2465,2464,2461,2457,2455,2444,2438,2428,2426,2423,2422,2417,2400,2397,2391,2386,2384,2380,2377,2374,2373,2365,2362,2357,2353,2352,2351,2348,2347,2339,2336,2334,2324,2321,2317,2314,2310,2305,2304,2298,2297,2291,2287,2282,2277,2273,2271,2264,2263,2262,2258,2251,2249,2248,2246,2245,2238,2236,2231,2213,2212,2207,2205,2204,2158,2145,2140,2111,2097,2084,2058,2047,45,2067)],121]="0"

datostfg2[grep1191,122]="Caries empastada"
datostfg2[grep1191,121]="1"

grep2507=grep("0",datostfg2[,121])
table(datostfg2[grep2507,122])
grep2508=grep("reparada",datostfg2[,122])
datostfg2[grep2508,122]
datostfg2[grep2508,121]
datostfg2[grep2508,121]="1"
grep2509=grep("obtura",datostfg2[,122])
datostfg2[grep2509,122]
datostfg2[grep2509,121]
datostfg2[grep2509,121]="1"
grep2510=grep("^ausencia",datostfg2[,122])
datostfg2[grep2510,122]
datostfg2[grep2510,121]
datostfg2[grep2510,121]="1"
grep2511=grep("^Ausencia",datostfg2[,122])
datostfg2[grep2511,122]
datostfg2[grep2511,121]
datostfg2[grep2511,121]="1"
grep2512=grep("falta",datostfg2[,122])
datostfg2[grep2512,122]
datostfg2[grep2512,121]
datostfg2[grep2512[-c(11,25)],121]="1"
grep2513=grep("Falta",datostfg2[,122])
datostfg2[grep2513,122]
datostfg2[grep2513,121]
datostfg2[grep2513,121]="1"
grep2514=grep("FALTA",datostfg2[,122])
datostfg2[grep2514,122]
datostfg2[grep2514,121]
datostfg2[grep2514,121]="1"
grep2515=grep("Ortodon",datostfg2[,122])
datostfg2[grep2515,122]
datostfg2[grep2515,121]
datostfg2[grep2515,121]="1"
grep2516=grep("ortodon",datostfg2[,122])
datostfg2[grep2516,122]
datostfg2[grep2516,121]
datostfg2[grep2516,121]="1"
grep2517=grep("empast",datostfg2[,122])
datostfg2[grep2517,122]
datostfg2[grep2517,121]
datostfg2[grep2517,121]="1"
grep2518=grep("amalg",datostfg2[,122])
datostfg2[grep2518,122]
datostfg2[grep2518,121]
datostfg2[grep2518,121]="1"
grep2519=grep("Odontolisis",datostfg2[,122])
datostfg2[grep2519,122]
datostfg2[grep2519,121]
datostfg2[grep2519,121]="1"
grep2520=grep("^se aprecia",datostfg2[,122])
datostfg2[grep2520,122]
datostfg2[grep2520,121]
datostfg2[grep2520,121]="1"
grep2521=grep("^se aprecia",datostfg2[,122])
datostfg2[grep2521,122]
datostfg2[grep2521,121]
datostfg2[grep2521,121]="1"
grep2522=grep("endo",datostfg2[,122])
datostfg2[grep2522,122]
datostfg2[grep2522,121]
datostfg2[grep2522,121]="1"
grep2523=grep("Break",datostfg2[,122])
datostfg2[grep2523,122] 
datostfg2[grep2523,121]
datostfg2[grep2523,121]="1"
grep2524=grep("break",datostfg2[,122])
datostfg2[grep2524,122] 
datostfg2[grep2524,121]
datostfg2[grep2524,121]="1"
grep2525=grep("brake",datostfg2[,122])
datostfg2[grep2525,122] 
datostfg2[grep2525,121]
datostfg2[grep2525,121]="1"
grep2526=grep("braq",datostfg2[,122])
datostfg2[grep2526,122] 
datostfg2[grep2526,121]
datostfg2[grep2526,121]="1"
grep2527=grep("brack",datostfg2[,122])
datostfg2[grep2527,122] 
datostfg2[grep2527,121]
datostfg2[grep2527,121]="1"
grep2528=grep("Mordida",datostfg2[,122])
datostfg2[grep2528,122] 
datostfg2[grep2528,121]
datostfg2[grep2528,121]="1"
grep2529=grep("odontolisis",datostfg2[,122])
datostfg2[grep2529,122] 
datostfg2[grep2529,121]
datostfg2[grep2529,121]="1"
grep2530=grep("muela",datostfg2[,122])
datostfg2[grep2530,122] 
datostfg2[grep2530,121]
datostfg2[grep2530,121]="1"
grep2531=grep("molar",datostfg2[,122])
datostfg2[grep2531,122] 
datostfg2[grep2531,121]
datostfg2[grep2531,121]="1"
grep2532=grep("una caries",datostfg2[,122])
datostfg2[grep2532,122] 
datostfg2[grep2532,121]
datostfg2[grep2532,121]="1"
grep2533=grep("dos caries",datostfg2[,122])
datostfg2[grep2533,122] 
datostfg2[grep2533,121]
datostfg2[grep2533,121]="1"
grep2534=grep("Varias caries",datostfg2[,122])
datostfg2[grep2534,122] 
datostfg2[grep2534,121]
datostfg2[grep2534,121]="1"
grep2535=grep("Endo",datostfg2[,122])
datostfg2[grep2535,122] 
datostfg2[grep2535,121]
datostfg2[grep2535,121]="1"
grep2536=grep("brux",datostfg2[,122])
datostfg2[grep2536,122] 
datostfg2[grep2536,121]
datostfg2[grep2536,121]="1"
grep2537=grep("Brux",datostfg2[,122])
datostfg2[grep2537,122] 
datostfg2[grep2537,121]
datostfg2[grep2537,121]="1"
grep2538=grep("funda",datostfg2[,122])
datostfg2[grep2538,122] 
datostfg2[grep2538,121]
datostfg2[grep2538,121]="1"
grep2539=grep("Funda",datostfg2[,122])
datostfg2[grep2539,122] 
datostfg2[grep2539,121]
datostfg2[grep2539,121]="1"
grep2540=grep("Malposi",datostfg2[,122])
datostfg2[grep2540,122] 
datostfg2[grep2540,121]
datostfg2[grep2540,121]="1"
grep2541=grep("malposi",datostfg2[,122])
datostfg2[grep2541,122] 
datostfg2[grep2541,121]
datostfg2[grep2541,121]="1"
grep2542=grep("mal colocado",datostfg2[,122])
datostfg2[grep2542,122] 
datostfg2[grep2542,121]
datostfg2[grep2542,121]="1"
grep2543=grep("mal puestos",datostfg2[,122])
datostfg2[grep2543,122] 
datostfg2[grep2543,121]
datostfg2[grep2543,121]="1"
grep2544=grep("Fijador",datostfg2[,122])
datostfg2[grep2544,122] 
datostfg2[grep2544,121]
datostfg2[grep2544,121]="1"
grep2545=grep("Rot",datostfg2[,122])
datostfg2[grep2545,122] 
datostfg2[grep2545,121]
datostfg2[grep2545,121]="1"
grep2546=grep("Eduntul",datostfg2[,122])
datostfg2[grep2546,122] 
datostfg2[grep2546,121]
datostfg2[grep2546,121]="1"
grep2547=grep("eduntul",datostfg2[,122])
datostfg2[grep2547,122] 
datostfg2[grep2547,121]
datostfg2[grep2547,121]="1"
grep2548=grep("recambio",datostfg2[,122])
datostfg2[grep2548,122] 
datostfg2[grep2548,121]
datostfg2[grep2548,121]="1"
grep2549=grep("Subluxa",datostfg2[,122])
datostfg2[grep2549,122] 
datostfg2[grep2549,121]
datostfg2[grep2549,121]="1"
grep2550=grep("Retracc",datostfg2[,122])
datostfg2[grep2550,122] 
datostfg2[grep2550,121]
datostfg2[grep2550,121]="1"
grep2551=grep("retracc",datostfg2[,122])
datostfg2[grep2551,122] 
datostfg2[grep2551,121]
datostfg2[grep2551,121]="1"
grep2552=grep("Desgaste",datostfg2[,122])
datostfg2[grep2552,122] 
datostfg2[grep2552,121]
datostfg2[grep2552,121]="1"
grep2553=grep("desgaste",datostfg2[,122])
datostfg2[grep2553,122] 
datostfg2[grep2553,121]
datostfg2[grep2553,121]="1"
grep2554=grep("rota",datostfg2[,122])
datostfg2[grep2554,122] 
datostfg2[grep2554,121]
datostfg2[grep2554,121]="1"
grep2555=grep("implante",datostfg2[,122])
datostfg2[grep2555,122] 
datostfg2[grep2555,121]
datostfg2[grep2555,121]="1"
grep2556=grep("enclavada",datostfg2[,122])
datostfg2[grep2556,122] 
datostfg2[grep2556,121]
datostfg2[grep2556,121]="1"
grep2557=grep("Reconstruc",datostfg2[,122])
datostfg2[grep2557,122] 
datostfg2[grep2557,121]
datostfg2[grep2557,121]="1"
grep2558=grep("dos grandes",datostfg2[,122])
datostfg2[grep2558,122] 
datostfg2[grep2558,121]
datostfg2[grep2558,121]="1"
grep2559=grep("mordida",datostfg2[,122])
datostfg2[grep2559,122] 
datostfg2[grep2559,121]
datostfg2[grep2559,121]="1"
grep2560=grep("esmalte",datostfg2[,122])
datostfg2[grep2560,122] 
datostfg2[grep2560,121]
datostfg2[grep2560,121]="1"
grep2561=grep("^Refiere enfermedad",datostfg2[,122])
datostfg2[grep2561,122] 
datostfg2[grep2561,121]
datostfg2[grep2561,121]="1"
grep2562=grep("duplicado",datostfg2[,122])
datostfg2[grep2562,122] 
datostfg2[grep2562,121]
datostfg2[grep2562,121]="1"
grep2563=grep("extracc",datostfg2[,122])
datostfg2[grep2563,122] 
datostfg2[grep2563,121]
datostfg2[grep2563,121]="1"
grep2564=grep("Chasqui",datostfg2[,122])
datostfg2[grep2564,122] 
datostfg2[grep2564,121]
datostfg2[grep2564,121]="1"
grep2565=grep("congruencia",datostfg2[,122])
datostfg2[grep2565,122] 
datostfg2[grep2565,121]
datostfg2[grep2565,121]="1"
grep2566=grep("cruji",datostfg2[,122])
datostfg2[grep2566,122] 
datostfg2[grep2566,121]
datostfg2[grep2566,121]="1"
grep2567=grep("pico",datostfg2[,122])
datostfg2[grep2567,122] 
datostfg2[grep2567,121]
datostfg2[grep2567,121]="1"
grep2568=grep("Placa",datostfg2[,122])
datostfg2[grep2568,122] 
datostfg2[grep2568,121]
datostfg2[grep2568,121]="1"
grep2569=grep("Existen ausencia",datostfg2[,122])
datostfg2[grep2569,122] 
datostfg2[grep2569,121]
datostfg2[grep2569,121]="1"
grep2570=grep("Pendiente",datostfg2[,122])
datostfg2[grep2570,122] 
datostfg2[grep2570,121]
datostfg2[grep2570,121]="1"
grep2571=grep("Ortesis",datostfg2[,122])
datostfg2[grep2571,122] 
datostfg2[grep2571,121]
datostfg2[grep2571,121]="1"
grep2572=grep("orto",datostfg2[,122])
datostfg2[grep2572,122] 
datostfg2[grep2572,121]
datostfg2[grep2572,121]="1"
grep2573=grep("entre",datostfg2[,122])
datostfg2[grep2573,122] 
datostfg2[grep2573,121]
datostfg2[grep2573,121]="1"
grep2574=grep("sarro",datostfg2[,122])
datostfg2[grep2574,122] 
datostfg2[grep2574,121]
datostfg2[grep2574,121]="1"
grep2575=grep("Api?",datostfg2[,122])
datostfg2[grep2575,122] 
datostfg2[grep2575,121]
datostfg2[grep2575,121]="1"
grep2576=grep("Brack",datostfg2[,122])
datostfg2[grep2576,122] 
datostfg2[grep2576,121]
datostfg2[grep2576,121]="1"
grep2577=grep("sublu",datostfg2[,122])
datostfg2[grep2577,122] 
datostfg2[grep2577,121]
datostfg2[grep2577,121]="1"
grep2578=grep("Brak",datostfg2[,122])
datostfg2[grep2578,122] 
datostfg2[grep2578,121]
datostfg2[grep2578,121]="1"
grep2579=grep("Sarro",datostfg2[,122])
datostfg2[grep2579,122] 
datostfg2[grep2579,121]
datostfg2[grep2579,121]="1"
grep2580=grep("Esmalte",datostfg2[,122])
datostfg2[grep2580,122] 
datostfg2[grep2580,121]
datostfg2[grep2580,121]="1"
grep2581=grep("Empaste",datostfg2[,122])
datostfg2[grep2581,122] 
datostfg2[grep2581,121]
datostfg2[grep2581,121]="1"
grep2582=grep("Presencia",datostfg2[,122])
datostfg2[grep2582,122] 
datostfg2[grep2582,121]
datostfg2[grep2582,121]="1"
grep2583=grep("placa",datostfg2[,122])
datostfg2[grep2583,122] 
datostfg2[grep2583,121]
datostfg2[grep2583,121]="1"
grep2584=grep("2 caries",datostfg2[,122])
datostfg2[grep2584,122] 
datostfg2[grep2584,121]
datostfg2[grep2584,121]="1"
grep2585=grep("4 piezas",datostfg2[,122])
datostfg2[grep2585,122] 
datostfg2[grep2585,121]
datostfg2[grep2585,121]="1"
grep2586=grep("de una pieza dental",datostfg2[,122])
datostfg2[grep2586,122] 
datostfg2[grep2586,121]
datostfg2[grep2586,121]="1"
grep2587=grep("Se aprecia",datostfg2[,122])
datostfg2[grep2587,122] 
datostfg2[grep2587,121]
datostfg2[grep2587,121]="1"
grep2588=grep("ni enfermedad periodontal, caries",datostfg2[,122])
datostfg2[grep2588,122]
datostfg[grep2588,121]
datostfg2[grep2588,121]
datostfg2[grep2588,121]="1"
grep2589=grep("no enfermedad periodontal, caries",datostfg2[,122])
datostfg2[grep2589,122] 
datostfg[grep2589,121]
datostfg2[grep2589,121]
datostfg2[grep2589,121]="1"
grep2590=grep("si caries",datostfg2[,122])
datostfg2[grep2590,122] 
datostfg2[grep2590,121]
datostfg2[grep2590,121]="1"
grep2591=grep("Desvi",datostfg2[,122])
datostfg2[grep2591,122] 
datostfg2[grep2591,121]
datostfg2[grep2591,121]="1"
grep2592=grep("Implante",datostfg2[,122])
datostfg2[grep2592,122] 
datostfg2[grep2592,121]
datostfg2[grep2592,121]="1"
grep2593=grep("odontol",datostfg2[,122])
datostfg2[grep2593,122] 
datostfg2[grep2593,121]
datostfg2[grep2593[c(31)],121]="1"
grep2594=grep("Blando",datostfg2[,122]) ####Corresponde a la variable abdomen_txt
datostfg2[grep2594,122] 
datostfg2[grep2594,121]="0"
datostfg2[grep2594,113]###Ya registrado
datostfg2[grep2594,105]="0"
grep2507=grep("0",datostfg2[,121])
table(datostfg2[grep2507,122])
datostfg2[grep2439,122]="Caries empastada"
datostfg2[grep2439,121]="1"

datostfg2[grep1106[c(4,8,13)],122]=datostfg2[grep1106[c(4,8,13)],117]
datostfg2[grep1106[c(4,8,13)],121]="1"

for (i in 1:11984){comp=(is.na(datostfg2[i,121])==TRUE&&
  is.na(datostfg2[i,122])==FALSE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,121]="Revisar"
}else{
        datostfg2[i,121]=datostfg2[i,121]
}}
grep2904=grep("Revisar",datostfg2[,121])
datostfg2[grep2904,122]
datostfg2[grep2904,121]="0"

datostfg2[c(2676,3877,5871,5919,6123),122]
datostfg2[c(2676,3877,5871,5919,6123),121]="0"
```

```{r,include=TRUE}
####Variable 123(peso_num) Se refleja el peso en Kilogramos de cada paciente. 

table(datostfg2[,123])
datostfg2[7141,123]=datostfg[7141,122]
datostfg2[706,123]=datostfg[706,122]
datostfg2[6272,123] ####Desplazar 13 posiciones
datostfg2[6272,136]=datostfg[6272,123]
datostfg2[129,123] ####Desplazar 10 posiciones
datostfg2[129,133]=datostfg[129,123]
table(datostfg2[,123])
grep882=grep("^1",datostfg2[,123])
datostfg2[grep882,123]
datostfg2[grep882[c(115)],123]
datostfg2[grep882[c(115)],124]
grep882[c(115)] ####Voy a estudiar este caso,4011
###Errores en la recogida de datos
datostfg2[grep882[c(115)],123]=NA
datostfg2[grep882[c(115)],124]=NA

grep883=grep("10.9",datostfg2[,123])
datostfg2[grep883,123]
datostfg2[grep883[c(2)],123]
datostfg2[grep883[c(2)],124]####Obviamente hay un fallo en este caso
datostfg2[grep883[c(2)],106] #####No disponemos de su IMC,tiene obesidad tipo 2,IMC de 35 a 39.9
####Con su altura,para tener obesidad de tipo 2,tiene que tener como mínimo 105,85kg para tener obesidad de tipo 2.Se trta por tanto de un fallo al poner el punto.
datostfg2[grep883[c(2)],123]="109"


####Comprobemos que los valores más bajos son correctos.
grep885=grep("^2",datostfg2[,123])
datostfg2[grep885,123]
datostfg2[grep885,124] ####Tiene sentido,porque las estaturas correspondientes son bajas.

####Comprobemos que los valores más altos son correctos.
grep906=grep("^10",datostfg2[,123])
datostfg2[grep906,123]
datostfg2[grep906,124] ###Correcto
grep907=grep("^11",datostfg2[,123])
datostfg2[grep907,123]
datostfg2[grep907,124] ###Correcto
grep908=grep("^12",datostfg2[,123])
datostfg2[grep908,123]
datostfg2[grep908,124] ###Correcto,excepto grep908[c(12,15,16)]
grep909=grep("^13",datostfg2[,123])
datostfg2[grep909,123]
datostfg2[grep909,124] ###Correcto
datostfg2[grep909,106]

grep910=grep("^14",datostfg2[,123])
datostfg2[grep910,123]
datostfg2[grep910,124] ###Error en el segundo caso,estudiemos el primero
grep910[c(1)] ####En la variable dislipemia tenemos un 0 no refiere que tenga obesidad
datostfg2[grep910[c(1)],106] ####No disponemos de su IMC
grep929=grep("182",datostfg2[,124])
table(datostfg2[grep929,123]) ###No lo modificaré,el registro es correcto


grep915=grep("148.5",datostfg2[,124])
datostfg2[grep910[c(2)],106]####No disponemos de su IMC
datostfg2[grep910[c(2)],127] ####No disponemos de su edad
datostfg2[grep915,123]
table(datostfg2[grep915,123]) ###La moda es 48.4,por lo que seguramente el valor correcto es 48.5
datostfg2[grep910[c(2)],123]="48.5"


grep911=grep("^15",datostfg2[,123])
datostfg2[grep911,123]
datostfg2[grep911,124]##Errores,en la quinta componente hay un cambio de columna,
###El  tercer y cuarto caso presentan obesidad
###En el primer y en el segundo caso tenemos que inferir
datostfg2[grep911,106] ####No disponemos de su IMC
grep916=grep("158.2",datostfg2[,124])
datostfg2[grep916,123]
datostfg2[grep916[c(5)],127] ###No disponemos de su edad
datostfg2[grep916[c(5)],7]
datostfg2[grep916[c(5)],4] ###Práctica atletismo y es una mujer,el fallo debe estar en el peso.
mean(as.numeric(datostfg2[grep916[-c(5)],123]))
datostfg2[grep911[c(1)],123]=mean(as.numeric(datostfg2[grep916[-c(5)],123]))
grep917=grep("172",datostfg2[,124])
datostfg2[grep917,123]
datostfg2[grep917[c(97)],123]
datostfg2[grep917[c(97)],106]
datostfg2[grep917[c(97)],127]
####Investigando este caso,pone en hábitos que lleva una dieta saludable,se trata de un error
mean(as.numeric(datostfg2[grep917[-c(97)],123]))
table(datostfg2[grep917[-c(97)],123]) ###Fallo al poner el punto
datostfg2[grep911[c(2)],123]="59"

datostfg2[grep911[c(5)],123]=datostfg[grep911[c(5)],124]
datostfg2[grep911[c(5)],124]=datostfg[grep911[c(5)],123]


grep912=grep("^16",datostfg2[,123])
datostfg2[grep912,123]
datostfg2[grep912,124] ##Errores,hay casos en los que hay un cambio de columnas,en otros tenemos que inferir o mirar si tenemos su IMC
datostfg2[grep912[-c(6,7,9,10,12)],123]=datostfg[grep912[-c(6,7,9,10,12)],124]
datostfg2[grep912[-c(6,7,9,10,12)],124]=datostfg[grep912[-c(6,7,9,10,12)],123]
datostfg2[grep912[c(6,7,9,10,12)],124]
datostfg2[grep912[c(6,7,9,10,12)],106] ###No disponemos de su IMC
datostfg2[grep912,123]
datostfg2[grep912,124]
grep919=grep("164.2",datostfg2[,124])
datostfg2[grep919,123]
mean(as.numeric(datostfg2[grep919[-c(5)],123]))
datostfg2[grep912[c(6)],123]=mean(as.numeric(datostfg2[grep919[-c(5)],123]))
grep920=grep("169.4",datostfg2[,124])
datostfg2[grep920,123]
mean(as.numeric(datostfg2[grep920[-c(4)],123]))
datostfg2[grep912[c(7)],123]=mean(as.numeric(datostfg2[grep920[-c(4)],123]))
grep921=grep("172.9",datostfg2[,124])
datostfg2[grep921,123]
datostfg2[grep921[c(3)],123]
datostfg2[grep921[c(3)],106]
datostfg2[grep921[c(3)],127]
datostfg2[grep921[-c(3)],123]
mean(as.numeric(datostfg2[grep921[-c(3)],123])) ###Fallo al poner el punto
datostfg2[grep912[c(9)],123]="67.9"
grep922=grep("175.3",datostfg2[,124])
datostfg2[grep922,123]
datostfg2[grep922,124]
datostfg2[grep922[c(4)],106]
datostfg2[grep922[-c(4)],123]
mean(as.numeric(datostfg2[grep922[-c(4)],123])) ###Fallo al poner el punto
datostfg2[grep912[c(10)],123]="65.9"
grep923=grep("167.8",datostfg2[,124])
datostfg2[grep923,123]
datostfg2[grep923[c(6)],106]
mean(as.numeric(datostfg2[grep923[-c(6)],123]))
datostfg2[grep912[c(12)],123]=mean(as.numeric(datostfg2[grep923[-c(6)],123]))

grep913=grep("^17",datostfg2[,123]) 
datostfg2[grep913,123]
datostfg2[grep913,124] ##Errores,hay casos en los que hay un cambio de columnas,en otros tenemos que inferir o ver si disponemos de su IMC
datostfg2[grep913[-c(12,19)],124]=datostfg[grep913[-c(12,19)],123]
datostfg2[grep913[-c(12,19)],123]=datostfg[grep913[-c(12,19)],124] ####Cambios de columna
datostfg2[grep913[c(12,19)],124]
datostfg2[grep913[c(12,19)],123]
datostfg2[grep913[c(12,19)],106] ###No disponemos del IMC
grep924=grep("176.5",datostfg2[,124])
datostfg2[grep924,123]
mean(as.numeric(datostfg2[grep924[-c(27)],123]))
datostfg2[grep913[c(12)],123]=mean(as.numeric(datostfg2[grep924[-c(27)],123]))
grep925=grep("166.2",datostfg2[,124])
datostfg2[grep925,123]
datostfg2[grep925[c(22)],106]
grep925[c(22)]
mean(as.numeric(datostfg2[grep925[-c(22)],123]))
table(datostfg2[grep925[-c(22)],123]) ###Lo interpreto como un fallo
datostfg2[grep913[c(19)],123]="73"


grep914=grep("^18",datostfg2[,123])
datostfg2[grep914,123]
datostfg2[grep914,124] ##Errores,hay casos en los que hay un cambio de columnas,en otros tenemos que inferir o ver si disponemos de su IMC
datostfg2[grep914[-c(1,7)],123]=datostfg[grep914[-c(1,7)],124]
datostfg2[grep914[-c(1,7)],124]=datostfg[grep914[-c(1,7)],123]
datostfg2[grep914[c(1,7)],123] 
datostfg2[grep914[c(1,7)],124]
datostfg2[grep914[c(1,7)],126] ####No disponemos del indice de masa corporal
grep927=grep("181.9",datostfg2[,124])
datostfg2[grep927,123]
datostfg2[grep927[-c(1)],123]
mean(as.numeric(datostfg2[grep927[-c(1)],123]))
datostfg2[grep914[c(1)],123]=mean(as.numeric(datostfg2[grep927[-c(1)],123]))
grep928=grep("180.8",datostfg2[,124])
datostfg2[grep928,123]
mean(as.numeric(datostfg2[grep928[-c(6)],123]))
datostfg2[grep914[c(7)],123]=mean(as.numeric(datostfg2[grep928[-c(6)],123]))
grep930=grep("^19",datostfg2[,123])
datostfg2[grep930,123]
datostfg2[grep930,124] ###En el primer caso hay un fallo,tenemos que cambiar las columnas
datostfg2[grep930[c(1)],123]=datostfg[grep930[c(1)],124]
datostfg2[grep930[c(1)],124]=datostfg[grep930[c(1)],123]

table(datostfg2[,123])




####Variable 124(talla_num) Altura en centimetros

table(datostfg2[,124])
datostfg2[7141,124]=datostfg[7141,123]
datostfg2[706,124]=datostfg[706,123]
datostfg2[6272,124]
datostfg2[6272,137]=datostfg[6272,124]
datostfg2[129,124] ####Esto corresponde a la variable 134
datostfg2[129,134]=datostfg[129,124]
table(datostfg2[,124])

####Comprobemos que los valores más bajos son correctos.
grep886=grep("^1.7",datostfg2[,124])
datostfg2[grep886,124]
datostfg2[grep886[c(912)],124]
datostfg2[grep886[c(912)],123]
datostfg2[grep886[c(912)],106] ####No disponemos de su IMC
grep887=grep("^82.3",datostfg2[,123])
datostfg2[grep887,124]
mean(as.numeric(datostfg2[grep887[-c(9)],124]))
datostfg2[grep886[c(912)],124]="177"
grep888=grep("^11.4",datostfg2[,124])
datostfg2[grep888,124]
datostfg2[grep888,123]
datostfg2[grep888,106]  ####No disponemos de su IMC
grep889=grep("^65.1",datostfg2[,123])
datostfg2[grep889,124]
mean(as.numeric(datostfg2[grep889[-c(10)],124]))
datostfg2[grep888,124]="174"
grep890=grep("^12.6",datostfg2[,124])
datostfg2[grep890,124]
datostfg2[grep890,123]
datostfg2[grep890,106] ####No disponemos de su IMC
grep891=grep("^72",datostfg2[,123])
mean(as.numeric(datostfg2[grep891[-c(49)],124]))
datostfg2[grep891,124]
table(datostfg2[grep891[-c(50)],124])
mean(as.numeric(datostfg2[grep891[-c(50)],124]))
datostfg2[grep890,124]="172.6"
grep892=grep("^13",datostfg2[,124])
datostfg2[grep892,124]
datostfg2[grep892[c(33,44,45)],124]
datostfg2[grep892[c(33,44,45)],123]
datostfg2[grep892[c(33,44,45)],106] ###No disponemos de su IMC
###Estos casos presentan un fallo.
####Tras estudiarlo,en este paciente no tienen sentido muchos registros
datostfg2[grep892[c(33,44,45)],124]=NA
datostfg2[grep892[c(33,44,45)],123]=NA
grep893=grep("^14.5",datostfg2[,124])
datostfg2[grep893,124]
datostfg2[grep893,123]
datostfg2[grep893,127]
datostfg2[grep893,106] ###En el segundo caso disponemos de su IMC,a partir de él podemos calcular la altura
sqrt((as.numeric(datostfg2[grep893[c(2)],123]))/26.7)*100
datostfg2[grep893[c(2)],124]="145" ####El registro correcto es 145
grep894=grep("^68.3",datostfg2[,123])
datostfg2[grep894,124]
mean(as.numeric(datostfg2[grep894[-c(17)],124]))
table(datostfg2[grep894[-c(17)],124])
datostfg2[grep893[c(1)],124]="174.5"

grep896=grep("^16.5",datostfg2[,124])
datostfg2[grep896,124]
datostfg2[grep896,123]
datostfg2[grep896,106] ####Disponemos de su IMC
datostfg2[grep896,124]=sqrt((as.numeric(datostfg2[grep896,123]))/21.3)*100 ####Por lo que el registro correcto es 165
datostfg2[grep896,124]="165"
grep898=grep("^18",datostfg2[,124])
datostfg2[grep898,124]
datostfg2[grep898[1001:2000],124]
datostfg2[grep898[c(1620)],124]
datostfg2[grep898[c(1620)],123]
datostfg2[grep898[c(1620)],106] #####No disponemos de su IMC
grep899=grep("^96.9",datostfg2[,123])
datostfg2[grep899,124]
mean(as.numeric(datostfg2[grep899[-c(6)],124]))
datostfg2[grep898[c(1620)],124]="184"
grep900=grep("^18.4",datostfg2[,124])
datostfg2[grep900,124]
datostfg2[grep900,123]
datostfg2[grep900,106] ###No disponemos de su IMC
grep901=grep("^62",datostfg2[,123])
datostfg2[grep901,124]
datostfg2[grep901[c(218)],124]
mean(as.numeric(datostfg2[grep901[-c(218)],124]))
table(datostfg2[grep901[-c(218)],124])
datostfg2[grep900,124]="184"
grep902=grep("^5",datostfg2[,124])
datostfg2[grep902,124]
datostfg2[grep902[c(2)],124]
datostfg2[grep902[c(2)],123]
datostfg2[grep902[c(2)],106] ###No disponemos de su IMC
grep903=grep("^78.4",datostfg2[,123])
datostfg2[grep903,124]
mean(as.numeric(datostfg2[grep903[-c(12)],124]))
table(datostfg2[grep903[-c(12)],124])
datostfg2[grep902[c(2)],124]="175.2"
grep904=grep("^1.1",datostfg2[,124])
datostfg2[grep904,124]
datostfg2[grep904[c(894)],124]
datostfg2[grep904[c(894)],123]
datostfg2[grep904[c(894)],106] ###No disponemos de su IMC
grep905=grep("^56.5",datostfg2[,123])
datostfg2[grep905,124]
mean(as.numeric(datostfg2[grep905[-c(24)],124]))
table(datostfg2[grep905[-c(24)],124])
datostfg2[grep904[c(894)],124]="161"




table(datostfg2[,124]) ####Hay casos extremadamente bajos,seguramente se deba a un cambio de columnas,
###vamos a estudiarlo


grep932=grep("^5",datostfg2[,124])
datostfg2[grep932,124] 
datostfg2[grep932,123]

grep937=grep("54.6",datostfg2[,123])
datostfg2[grep937,124]
mean(as.numeric(datostfg2[grep937[-c(4)],124]))
datostfg2[grep932,124]=mean(as.numeric(datostfg2[grep937[-c(4)],124]))
grep933=grep("^6",datostfg2[,124])
datostfg2[grep933,124] 
datostfg2[grep933,123]
grep938=grep("64.7",datostfg2[,123])
datostfg2[grep938,124]
mean(as.numeric(datostfg2[grep938[-c(3)],124]))
datostfg2[grep933,124]=mean(as.numeric(datostfg2[grep938[-c(3)],124]))
grep934=grep("^7",datostfg2[,124])
datostfg2[grep934,124] 
datostfg2[grep934,123]

grep939=grep("99.7",datostfg2[,123])
datostfg2[grep939,124]
mean(as.numeric(datostfg2[grep939[-c(4)],124]))
datostfg2[grep934,124]="197"

grep935=grep("^8",datostfg2[,124])
datostfg2[grep935,124] #####Hay que cambiar las columnas
datostfg2[grep935,123]
datostfg2[grep935,123]=datostfg[grep935,119]
datostfg2[grep935,119]=datostfg[grep935,123]
datostfg2[grep935,124]=datostfg[grep935,118]
datostfg2[grep935,118]=datostfg[grep935,124]

table(datostfg2[,123]) 
table(datostfg2[,124])  

```

```{r,include=TRUE}
####Variable 125(Sin.interés...125)  Sin interés

table(datostfg2[,125])
datostfg2[7141,125]=datostfg[7141,124]
datostfg2[706,125]=datostfg[706,124]
datostfg2[6272,125] ####Desplazar 13 posiciones
datostfg2[6272,138]=datostfg[6272,125]
datostfg2[129,125] ####Desplazar 10 posiciones
datostfg2[129,135]=datostfg[129,125]
table(datostfg2[,125])
grep2751=grep("1",datostfg2[,125])
grep2751 ####No considerar
```

```{r,include=TRUE}
####Variable 126  Anomalia_txt

table(datostfg2[,126])
datostfg2[7141,126]=datostfg[7141,125]
datostfg2[706,126]=datostfg[706,125]
datostfg2[6272,126] ####Desplazar 13 posiciones
datostfg2[6272,139]=datostfg[6272,126]
datostfg2[129,126] ####Desplazar 10 posiciones
datostfg2[129,136]=datostfg[129,126]
table(datostfg2[,126])
####Tan solo hay dos registros que presenta dificultades para la recogida de datos.
```

```{r,include=TRUE}
####Variable 127  Edad

table(datostfg2[,127])
datostfg2[7141,127]=datostfg[7141,126]
datostfg2[706,127]=datostfg[706,126]
datostfg2[6272,127] ####Desplazar 13 posiciones
datostfg2[6272,140]=datostfg[6272,127]
datostfg2[129,127] ####Desplazar 10 posiciones
datostfg2[129,137]=datostfg[129,127]
table(datostfg2[,127])


grep940=grep("216",datostfg2[,127])###Habrá que estudiarlo
datostfg2[grep940,52]####En los casos con pocos años de entrenamiento,consideraré que la edad del paciente es 16,sin embargo hay un caso con 7 años de entrenamiento,en este caso considero que lo más normal es que tenga 21 años.

###Veamos también la altura,por si nos ayuda a determinar la edad.
datostfg2[grep940,124] ###En el segundo caso la altura es considerablemente mayor que  en el resto por lo que parece que mi hipótesis es correcta.
datostfg2[grep940[-c(2)],127]="16"
datostfg2[grep940[c(2)],127]="21"
grep941=grep("189",datostfg2[,127]) ###Error al teclear seguramente,como hay más casos con 18 años,consideraré que el registro correcto es 18
datostfg2[grep941,127]="18"
grep942=grep("^0",datostfg2[,127])###Errores
datostfg2[grep942,127]=NA
grep1129=grep("^3",datostfg2[,127])###Errores
datostfg2[grep1129[c(60)],127]
datostfg2[grep1129[c(60)],124]
datostfg2[grep1129[c(60)],123]
grep1130=grep("169.3",datostfg2[,124])
table(datostfg2[grep1130,127])
grep1131=grep("63.1",datostfg2[,123])
table(datostfg2[grep1131,127])
datostfg2[grep1129[c(60)],127]="35"
grep1132=grep("^5",datostfg2[,127])###Errores
datostfg2[grep1132,127]
datostfg2[grep1132[c(8)],127]
datostfg2[grep1132[c(8)],124]
grep1133=grep("154.2",datostfg2[,124])
table(datostfg2[grep1133,127])
grep1133=grep("154",datostfg2[,124])
table(datostfg2[grep1133,127])
datostfg2[grep1132[c(8)],123]
grep1134=grep("48.3",datostfg2[,123])
table(datostfg2[grep1134,127])
grep1134=grep("48",datostfg2[,123])
table(datostfg2[grep1134,127])
####Estudiando este caso,164,vemos en la variable Odontología que la Dentición no es definitiva,por lo que lo más probable es que tenga 15 años.
datostfg2[grep1132[c(8)],127]="15"

table(datostfg2[,127])

```

```{r,include=TRUE}
####Variable 128(num_FVC:esperado)  FVC Esperado. FVC:Capacidad vital forzada.Se expresa en mililitros y es el volumen total que expulsa el paciente desde la inspiración máxima a la espiración máxima.

table(datostfg2[,128])

datostfg2[7141,128]=datostfg[7141,127]
datostfg2[706,128]=datostfg[706,127]
datostfg2[6272,128] ####Desplazar 13 posiciones
datostfg2[6272,141]=datostfg[6272,128]

datostfg2[129,128] ####Desplazar 10 posiciones
datostfg2[129,138]=datostfg[129,128]

table(datostfg2[,128]) ####Vamos a estudiar los valores excesivamente altos
grep943=grep("^10",datostfg2[,128]) 
datostfg2[grep943,128]
grep943 ###Vamos a estudiar el caso 603
####Caso con registros repetidos en distintas variables,no tiene sentido
datostfg2[grep943,128]=NA
grep944=grep("^32",datostfg2[,128]) ###Errores
datostfg2[grep944,128]
grep944 ####Caso 4207,tiene múltiples registros que no se corresponden con las variables adecuadas
datostfg2[grep944,128]=NA
grep945=grep("^33.99",datostfg2[,128]) ###Errores
datostfg2[grep945,128]
grep945 ####Caso 9797,cambio de columna en este caso hacia la derecha
datostfg2[grep944,127]=datostfg[grep944,128]
datostfg2[grep944,128]=datostfg[grep944,129]
grep946=grep("^45.8",datostfg2[,128]) ###Errores
datostfg2[grep946,128]
grep946 ####Caso 79,fallo al poner el punto
datostfg2[grep946,128]="4.58"
grep947=grep("^90.15",datostfg2[,128]) ###Errores
datostfg2[grep947,128]
grep947 ####Caso 2077,fallo al poner el punto
datostfg2[grep947,128]="9.15"
grep2707=grep("^25",datostfg2[,128]) ###Errores
datostfg2[grep2707,128]
datostfg2[grep2707,128]="2.5"
grep2707 ####Caso 4207,fallo al poner el punto
datostfg2[grep947,128]="9.15"
table(datostfg2[,128])
datostfg2[,128]=round(datostfg2[,138],2)
datostfg2[603,128]=NA
datostfg2[3877,128]=NA
datostfg2[4207,128]=NA
datostfg2[609,128]=NA

```

```{r,include=TRUE}
####Variable 129(num_FEV1_esperado) FEV1 Esperado.FEV1:Volumen espiratorio forzado el primer segundo. Se expresa en mililitros.

table(datostfg2[,129])

datostfg2[7141,129]=datostfg[7141,128]
datostfg2[706,129]=datostfg[706,128]
datostfg2[6272,129] ####Desplazar 13 posiciones
datostfg2[6272,142]=datostfg[6272,129]
datostfg2[129,129] ####Desplazar 10 posiciones
datostfg2[129,139]=datostfg[129,129]


table(datostfg2[,129]) ####Vamos a estudiar los valores excesivamente altos
grep948=grep("^10",datostfg2[,129]) 
datostfg2[grep948,129]
grep948 ###Vamos a estudiar el caso 603
####Caso con registros repetidos en distintas variables,no tiene sentido
datostfg2[grep948,129]=NA
grep949=grep("^25",datostfg2[,129]) ###Errores
datostfg2[grep949,129]
grep949 ####Caso 4207,tiene múltiples registros que no se corresponden con las variables adecuadas
datostfg2[grep949,129]=NA
grep950=grep("^44.15",datostfg2[,129]) ###Errores
datostfg2[grep950,129]
grep950 ####Caso 5693,fallo al poner el punto
datostfg2[grep950,129]="4.15"
grep951=grep("^45.33",datostfg2[,129]) ###Errores
datostfg2[grep951,129]
grep951 ####Caso 6194,fallo al poner el punto,consideraré que el registro correcto es 4.53
datostfg2[grep951,129]="4.53"
table(datostfg2[,129])
datostfg2[,129]=as.numeric(datostfg2[,129])
datostfg2[,129]=round(datostfg2[,129],2)
datostfg2[603,129]=NA
datostfg2[3877,129]=NA
datostfg2[4207,129]=NA
datostfg2[609,129]=NA
```
```{r,include=TRUE}
####Variable 130(num_FEV25_esperado)  FEV25 Esperado.FEV25:Volumen espiratorio forzado en el  segundo 25. Se expresa en mililitros.

table(datostfg2[,130])

datostfg2[7141,130]=datostfg[7141,129]
datostfg2[706,130]=datostfg[706,129]
datostfg2[6272,143]=datostfg[6272,130]
datostfg2[129,130] ####Desplazar 10 posiciones
datostfg2[129,140]=datostfg[129,130]


table(datostfg2[,130]) ####Vamos a estudiar los valores excesivamente altos
grep952=grep("^10",datostfg2[,130]) 
datostfg2[grep952,130]
grep952 ###Vamos a estudiar el caso 603
####Caso con registros repetidos en distintas variables,no tiene sentido
datostfg2[grep952,130]=NA
grep953=grep("^38.2",datostfg2[,130]) ###Errores
datostfg2[grep953,130]
grep953 ####Caso 22,fallo al poner el punto
datostfg2[grep953,130]="3.82"
grep954=grep("^40.9",datostfg2[,130]) ###Errores
datostfg2[grep954,130]
grep954 ####Caso 4719,fallo al poner el punto
datostfg2[grep954,130]="4.90"
grep955=grep("^52.4",datostfg2[,130]) ###Errores
datostfg2[grep955,130]
grep955 ####Caso 38,fallo al poner el punto,consideraré que el registro correcto es 5.24
datostfg2[grep955,130]="5.24"
grep956=grep("^65",datostfg2[,130]) ###Errores
datostfg2[grep956,130]
grep956 ####Caso 4207,tiene múltiples registros que no se corresponden con las variables adecuadas
datostfg2[grep956,130]=NA
grep957=grep("^74.2",datostfg2[,130]) ###Errores
datostfg2[grep957,130]
grep957 ####Caso 9226,fallo al poner el punto
datostfg2[grep957,130]="7.42"
grep958=grep("^74.4",datostfg2[,130]) ###Errores
datostfg2[grep958,130]
grep958 ####Caso 9283,fallo al poner el punto
datostfg2[grep958,130]="7.44"
grep959=grep("^76.4",datostfg2[,130]) ###Errores
datostfg2[grep959,130]
grep959 ####Caso 9248,fallo al poner el punto
datostfg2[grep959,130]="7.64"
grep960=grep("^76.6",datostfg2[,130]) ###Errores
datostfg2[grep960,130]
grep960 ####Caso 9250,fallo al poner el punto
datostfg2[grep960,130]="7.66"
grep961=grep("^77.2",datostfg2[,130]) ###Errores
datostfg2[grep961,130]
grep961 ####Caso 4946,fallo al poner el punto
datostfg2[grep961,130]="77.2"
grep962=grep("^77.8",datostfg2[,130]) ###Errores
datostfg2[grep962,130]
grep962 ####Caso 5038,fallo al poner el punto
datostfg2[grep962,130]="7.78"
grep963=grep("^78.2",datostfg2[,130]) ###Errores
datostfg2[grep963,130]
grep963 ####Caso 9262,fallo al poner el punto
datostfg2[grep963,130]="7.82"
grep964=grep("^78.4",datostfg2[,130]) ###Errores
datostfg2[grep964,130]
grep964 ####Caso 9266,fallo al poner el punto
datostfg2[grep964,130]="7.84"
grep965=grep("^80.3",datostfg2[,130]) ###Errores
datostfg2[grep965,130]
grep965 ####Caso 9136,fallo al poner el punto
datostfg2[grep965,130]="8.03"
datostfg2[,130]=as.numeric(datostfg2[,130])
datostfg2[,130]=round(datostfg2[,130],2)
table(datostfg2[,130])
datostfg2[603,130]=NA
datostfg2[3877,130]=NA
datostfg2[4207,130]=NA
datostfg2[609,130]=NA
```

```{r,include=TRUE}
####Variable 131(num_PEF_esperado) PEF Esperado, PEF:Flujo espiratorio máximo. Se expresa en mililitros.

table(datostfg2[,131])

datostfg2[7141,131]=datostfg[7141,130]
datostfg2[706,131]=datostfg[706,130]
datostfg2[6272,144]=datostfg[6272,131] 
datostfg2[129,131] ####Desplazar 10 posiciones
datostfg2[129,141]=datostfg[129,131]


table(datostfg2[,131]) ####Vamos a estudiar los valores excesivamente altos
datostfg2[603,131]=NA
grep966=grep("^40.02",datostfg2[,131]) 
datostfg2[grep966,131]
grep966 ###Vamos a estudiar el caso 2924
datostfg2[grep966,131]="4.02"
grep967=grep("^61.2",datostfg2[,131]) ###Errores
datostfg2[grep967,131]
grep967 ####Caso 22,fallo al poner el punto
datostfg2[grep967,131]="6.12"
grep968=grep("^75.5",datostfg2[,131]) ###Errores
datostfg2[grep968,131]
grep968####Caso 4820,fallo al poner el punto
datostfg2[grep968,131]="7.55"
grep969=grep("^75.88",datostfg2[,131]) ###Errores
datostfg2[grep969,131]
grep969 ####Caso 1969,fallo al poner el punto,consideraré que el registro correcto es 7.58
datostfg2[grep969,131]="7.58"
grep970=grep("^77.3",datostfg2[,131]) ###Errores
datostfg2[grep970,131]
grep970 ####Caso 891,fallo al poner el punto
datostfg2[grep970,131]="7.73"
grep971=grep("^79.11",datostfg2[,131]) ###Errores
datostfg2[grep971,131]
grep971 ####Caso 9542,fallo al poner el punto
datostfg2[grep971,131]="7.91"
grep972=grep("^79.29",datostfg2[,131]) ###Errores
datostfg2[grep972,131]
grep972 ####Caso 1605,fallo al poner el punto
datostfg2[grep972,131]="7.92"
grep973=grep("^83.2",datostfg2[,131]) ###Errores
datostfg2[grep973,131]
grep973 ####Caso 4791,fallo al poner el punto
datostfg2[grep973,131]="8.32"
grep974=grep("^83.5",datostfg2[,131]) ###Errores
datostfg2[grep974,131]
grep974 ####Caso 2528,fallo al poner el punto
datostfg2[grep974,131]="8.35"
grep975=grep("^85.3",datostfg2[,131]) ###Errores
datostfg2[grep975,131]
grep975 ####Caso 3356,fallo al poner el punto
datostfg2[grep975,131]="8.53"
grep976=grep("^85.6",datostfg2[,131]) ###Errores
datostfg2[grep976,131]
grep976 ####Caso 6948,fallo al poner el punto
datostfg2[grep976,131]="8.56"
grep977=grep("^86.73",datostfg2[,131]) ###Errores
datostfg2[grep977,131]
grep977 ####Caso 2239,fallo al poner el punto
datostfg2[grep977,131]="8.67"
grep978=grep("^88.8",datostfg2[,131]) ###Errores
datostfg2[grep978,131]
grep978 ####Caso 6672,fallo al poner el punto
datostfg2[grep978,131]="8.88"
grep979=grep("^89",datostfg2[,131]) ###Errores
datostfg2[grep979,131]
grep979 ##fallo al poner el punto
datostfg2[grep979,131]="8.9"
grep980=grep("^89.1",datostfg2[,131]) ###Errores
datostfg2[grep980,131]
grep980 ##Caso 8126,fallo al poner el punto
datostfg2[grep980,131]="8.91"
grep981=grep("^89.4",datostfg2[,131]) ###Errores
datostfg2[grep981,131]
grep981 ##Caso 4068,fallo al poner el punto
datostfg2[grep981,131]="8.94"
grep982=grep("^89.8",datostfg2[,131]) ###Errores
datostfg2[grep982,131]
grep982 ##Caso 3773,fallo al poner el punto
datostfg2[grep982,131]="8.98"
grep983=grep("^90.1",datostfg2[,131]) ###Errores
datostfg2[grep983,131]
grep983 ##Caso 3773,fallo al poner el punto
datostfg2[grep983,131]="9.01"
datostfg2[,131]=as.numeric(datostfg2[,131])
datostfg2[,131]=round(datostfg2[,131],2)
table(datostfg2[,131])
datostfg2[603,131]=NA
datostfg2[3877,131]=NA
datostfg2[4207,131]=NA
datostfg2[609,131]=NA
```


```{r,include=TRUE}
####Variable 132(num_TIFFENAU_esperado) TIFFENAU Esperado  TIFFENAU=FEV1/FVC

table(datostfg2[,132])

datostfg2[7141,132]=datostfg[7141,131]
datostfg2[706,132]=datostfg[706,131]
datostfg2[6272,145]=datostfg[6272,132] 
datostfg2[129,132] ####Desplazar 10 posiciones
datostfg2[129,142]=datostfg[129,132]


table(datostfg2[,132]) ####Vamos a estudiar los valores excesivamente bajos

grep984=grep("^1.44",datostfg2[,132]) 
datostfg2[grep984,132]
grep984 ###Vamos a estudiar el caso 2077
datostfg2[grep984,132]=as.numeric(datostfg2[grep984,129])/as.numeric(datostfg2[grep984,128])*100
grep985=grep("^8.057",datostfg2[,132]) ###Errores
datostfg2[grep985,132]
grep985 ####Caso 79
datostfg2[grep985,132]=as.numeric(datostfg2[grep985,129])/as.numeric(datostfg2[grep985,128])*100
datostfg2[grep985,132]="80.57" ####Redondeando lo anterior

grep986=grep("^10.09",datostfg2[,132]) ###Errores
datostfg2[grep986,132]
as.numeric(datostfg2[grep986,129])/as.numeric(datostfg2[grep986,128])*100 
datostfg2[grep986,128]="3.99"
datostfg2[grep986,132]=as.numeric(datostfg2[grep986,129])/as.numeric(datostfg2[grep986,128])*100 
grep2744=grep("^10",datostfg2[,132]) ###Errores
datostfg2[grep2744,132]
datostfg2[grep2744[c(2,3,5,7,8,9,11,13,15,18)],129]=datostfg[grep2744[c(2,3,5,7,8,9,11,13,15,18)],128]
datostfg2[grep2744[c(2,3,5,7,8,9,11,13,15,18)],128]=datostfg[grep2744[c(2,3,5,7,8,9,11,13,15,18)],129]
datostfg2[grep2744[c(2,3,5,7,8,9,11,13,15,18)],132]=as.numeric(datostfg2[grep2744[c(2,3,5,7,8,9,11,13,15,18)],129])/as.numeric(datostfg2[grep2744[c(2,3,5,7,8,9,11,13,15,18)],128])*100

grep2745=grep("^11",datostfg2[,132]) ###Errores
datostfg2[grep2745,132]
datostfg2[grep2745,128]=datostfg[grep2745,129]
datostfg2[grep2745,129]=datostfg[grep2745,128]
datostfg2[grep2745,132]=as.numeric(datostfg2[grep2745,129])/as.numeric(datostfg2[grep2745,128])*100
grep2746=grep("^12",datostfg2[,132]) ###Errores
datostfg2[grep2746,132]
datostfg2[grep2746,128]=datostfg[grep2746,129]
datostfg2[grep2746,129]=datostfg[grep2746,128]
datostfg2[grep2746,132]=as.numeric(datostfg2[grep2746,129])/as.numeric(datostfg2[grep2746,128])*100
grep2747=grep("^13",datostfg2[,132]) ###Errores
datostfg2[grep2747,132]
datostfg2[grep2747,128]=datostfg[grep2747,129]
datostfg2[grep2747,129]=datostfg[grep2747,128]
datostfg2[grep2747,132]=as.numeric(datostfg2[grep2747,129])/as.numeric(datostfg2[grep2747,128])*100
grep2748=grep("^17",datostfg2[,132]) ###Errores
datostfg2[grep2748,132]
datostfg2[grep2748,128]=datostfg[grep2748,129]
datostfg2[grep2748,129]=datostfg[grep2748,128]
datostfg2[grep2748,132]=as.numeric(datostfg2[grep2748,129])/as.numeric(datostfg2[grep2748,128])*100
grep2749=grep("^19",datostfg2[,132]) ###Errores
datostfg2[grep2749,132]
datostfg2[grep2749,128]=datostfg[grep2749,129]
datostfg2[grep2749,129]=datostfg[grep2749,128]
datostfg2[grep2749,132]=as.numeric(datostfg2[grep2749,129])/as.numeric(datostfg2[grep2749,128])*100
grep2750=grep("^250",datostfg2[,132]) ###Errores
datostfg2[grep2750,132]
datostfg2[grep2750,128]=datostfg[grep2750,129]
datostfg2[grep2750,129]=datostfg[grep2750,128]
datostfg2[grep2750,132]=as.numeric(datostfg2[grep2750,129])/as.numeric(datostfg2[grep2750,128])*100
grep2751=grep("^646",datostfg2[,132]) ###Errores
datostfg2[grep2751,132]
datostfg2[grep2751,128]
datostfg2[grep2751,129]
datostfg2[grep2751,132]=as.numeric(datostfg2[grep2751,129])/as.numeric(datostfg2[grep2751,128])*100
table(datostfg2[,132])
datostfg2[,132]=as.numeric(datostfg2[,132])
datostfg2[,132]=round(datostfg2[,132],2)
datostfg2[603,132]=NA
datostfg2[3877,132]=NA
datostfg2[4207,132]=NA
datostfg2[609,132]=NA
```


```{r,include=TRUE}
####Variable 133(num_FVC_obtenido) FVC Obtenido

table(datostfg2[,133])

datostfg2[7141,133]=datostfg[7141,132]
datostfg2[706,133]=datostfg[706,132]
datostfg2[6272,133] ####Desplazar 13 posiciones
datostfg2[6272,146]=datostfg[6272,133]
datostfg2[129,133] ####Desplazar 10 posiciones
datostfg2[129,143]=datostfg[129,133]
datostfg2[603,133]=NA

table(datostfg2[,133]) ####Vamos a estudiar los valores excesivamente bajos

grep987=grep("^10.5",datostfg2[,133]) 
datostfg2[grep987,13]
grep987 ###Vamos a estudiar el caso 10782
as.numeric(datostfg2[grep987,134])/as.numeric(datostfg2[grep987,137])*100
####Usando Tiffeau obtenido y fev1 obtenido,comprobamos que el dato es correcto
grep988=grep("^36.12",datostfg2[,133]) ###Errores
datostfg2[grep988,133]
grep988 ####Caso 2809
datostfg2[grep988,133]=6.12
grep989=grep("^47.89",datostfg2[,133]) ###Errores
datostfg2[grep989,133]
grep989 ###Caso 10181
datostfg2[grep989,133]="4.79"
grep2750=grep("^0.99",datostfg2[,133]) ###Errores
datostfg2[grep2750,133]=as.numeric(datostfg2[grep2750,128])*as.numeric(datostfg2[grep2750,138])
table(datostfg2[,133])
datostfg2[,133]=as.numeric(datostfg2[,133])
datostfg2[,133]=round(datostfg2[,133],2)
datostfg2[603,133]=NA
datostfg2[3877,133]=NA
datostfg2[4207,133]=NA
datostfg2[609,133]=NA
```

```{r,include=TRUE}
####Variable 134(num_FEV1_obtenido) FEV1 Obtenido

table(datostfg2[,134])

datostfg2[7141,134]=datostfg[7141,133]
datostfg2[706,134]=datostfg[706,133]
datostfg2[6272,134] ####Desplazar 13 posiciones
datostfg2[6272,147]=datostfg[6272,134]
datostfg2[129,134] ####Desplazar 10 posiciones
datostfg2[129,144]=datostfg[129,134]
datostfg2[603,134]=NA

table(datostfg2[,134]) ####Vamos a estudiar los valores excesivamente bajos

grep991=grep("^1",datostfg2[,134]) 
datostfg2[grep991,134]
datostfg2[grep991[c(82)],134]
grep991[c(82)] ###Vamos a estudiar el caso 4207,que tiene fallos
datostfg2[,134]=as.numeric(datostfg2[,134])
datostfg2[,134]=round(datostfg2[,134],2)
table(datostfg2[,134])
datostfg2[603,134]=NA
datostfg2[3877,134]=NA
datostfg2[4207,134]=NA
datostfg2[609,134]=NA
```


```{r,include=TRUE}
####Variable 135(num_FEV25_obtenido) FEV25 Obtenido

table(datostfg2[,135])

datostfg2[7141,135]=datostfg[7141,134]
datostfg2[706,135]=datostfg[706,134]
datostfg2[6272,135] ####Desplazar 13 posiciones
datostfg2[6272,148]=datostfg[6272,135]

datostfg2[129,135] ####Desplazar 10 posiciones
datostfg2[129,145]=datostfg[129,135]

datostfg2[603,135]=NA

table(datostfg2[,135]) ####Vamos a estudiar los valores excesivamente bajos

grep992=grep("^0",datostfg2[,135]) 
datostfg2[grep992,135]
datostfg2[grep992[c(8)],135]
grep992[c(8)] ###Vamos a estudiar el caso 8933,tengo que ver si es lógico
##Parece que es correcto

grep2709=grep("^23.39",datostfg2[,135]) 
datostfg2[grep2709,135]
datostfg2[grep2709,135]="2.39"
grep2710=grep("^44",datostfg2[,135]) 
datostfg2[grep2710,135] ###Caso 4207 que presenta múltiples fallos
grep2711=grep("^61.4",datostfg2[,135]) 
datostfg2[grep2711,135]
datostfg2[grep2711,135]="6.14" 
grep2712=grep("^74.6",datostfg2[,135]) 
datostfg2[grep2712,135]
datostfg2[grep2712,135]="7.46" 
grep2713=grep("^77.1",datostfg2[,135]) 
datostfg2[grep2713,135]
datostfg2[grep2713,135]="7.71" 
grep2714=grep("^77.9",datostfg2[,135]) 
datostfg2[grep2714,135]
datostfg2[grep2714,135]="7.79" 
grep2715=grep("^79.7",datostfg2[,135]) 
datostfg2[grep2715,135]
datostfg2[grep2715,135]="7.97" 
grep2716=grep("^79.9",datostfg2[,135]) 
datostfg2[grep2716,135]
datostfg2[grep2716,135]="7.99" 
grep2717=grep("^81.7",datostfg2[,135]) 
datostfg2[grep2717,135]
datostfg2[grep2717,135]="8.17" 
grep2718=grep("^82.9",datostfg2[,135]) 
datostfg2[grep2718,135]
datostfg2[grep2718,135]="8.29"
grep2719=grep("^83.6",datostfg2[,135]) 
datostfg2[grep2719,135]
datostfg2[grep2719,135]="8.36" 
grep2720=grep("^86.9",datostfg2[,135]) 
datostfg2[grep2720,135]
datostfg2[grep2720,135]="8.69" 
table(datostfg2[,135])
datostfg2[,135]=as.numeric(datostfg2[,135])
datostfg2[,135]=round(datostfg2[,135],2)
datostfg2[603,135]=NA
datostfg2[3877,135]=NA
datostfg2[4207,135]=NA
datostfg2[609,135]=NA
```

```{r,include=TRUE}
####Variable 136(num_PEF_obtenido) PEF Obtenido

table(datostfg2[,136])

datostfg2[7141,136]=datostfg[7141,135]
datostfg2[706,136]=datostfg[706,135]
datostfg2[6272,136] ####Desplazar 13 posiciones
datostfg2[6272,149]=datostfg[6272,136]
datostfg2[129,136] ####Desplazar 10 posiciones
datostfg2[129,146]=datostfg[129,136]
datostfg2[603,136]=NA
options(max.print=1300)
table(datostfg2[,136]) 

grep2721=grep("44.51",datostfg2[,136])
datostfg2[grep2721,136]
datostfg2[grep2721,136]="4.51"
grep2722=grep("45.93",datostfg2[,136])
datostfg2[grep2722,136]
datostfg2[grep2722,125]
datostfg2[grep2722,131]
as.numeric(datostfg2[grep2722,131])*(as.numeric(datostfg2[grep2722,141])/100) ###No sirve
grep2733=grep("7.41",datostfg2[,131])
table(datostfg2[grep2733,136])
datostfg2[grep2722,136]="5.93" ###Aunque también podría ser 4.93
grep2724=grep("52",datostfg2[,136])
datostfg2[grep2724,136]
datostfg2[grep2724,136]="5.2"
grep2725=grep("56",datostfg2[,136])
datostfg2[grep2725,136]
datostfg2[grep2725,136]="5.6"
grep2726=grep("56.8",datostfg2[,136])
datostfg2[grep2726,136]
datostfg2[grep2726,136]="5.68"
grep2727=grep("69.7",datostfg2[,136])
datostfg2[grep2727,136]
datostfg2[grep2727,136]="6.97"
grep2728=grep("76.82",datostfg2[,136])
datostfg2[grep2728,136]
datostfg2[grep2728,131]
grep2729=grep("7.91",datostfg2[,131])
table(datostfg2[grep2729,136])
datostfg2[grep2728,136]="7.82"
grep2730=grep("78.93",datostfg2[,136])
datostfg2[grep2730,136]
datostfg2[grep2730,131]
grep2731=grep("7.55",datostfg2[,131])
table(datostfg2[grep2731,136])
datostfg2[grep2730,136]="7.93"
grep2732=grep("79.5",datostfg2[,136])
datostfg2[grep2732,136]
datostfg2[grep2732,136]="7.95"
grep2733=grep("80.9",datostfg2[,136])
datostfg2[grep2733,136]
datostfg2[grep2733,136]="8.09"
grep2734=grep("81.8",datostfg2[,136])
datostfg2[grep2734,136]
datostfg2[grep2734,136]="8.18"
grep2735=grep("82.1",datostfg2[,136])
datostfg2[grep2735,136]
datostfg2[grep2735,136]="8.21"
grep2736=grep("82.8",datostfg2[,136])
datostfg2[grep2736,136]
datostfg2[grep2736,136]="8.28"
grep2737=grep("83.9",datostfg2[,136])
datostfg2[grep2737,136]
datostfg2[grep2737,136]="8.39"
grep2738=grep("86.6",datostfg2[,136])
datostfg2[grep2738,136]
datostfg2[grep2738,136]="8.66"
grep2739=grep("86.7",datostfg2[,136])
datostfg2[grep2739,136]
datostfg2[grep2739,136]="8.67"
grep2740=grep("88.4",datostfg2[,136])
datostfg2[grep2740,136]
datostfg2[grep2740,136]="8.84"
grep2741=grep("88.5",datostfg2[,136])
datostfg2[grep2741,136]
datostfg2[grep2741,136]="8.85"
grep2742=grep("89.2",datostfg2[,136])
datostfg2[grep2742,136]
datostfg2[grep2742,136]="8.92"
grep2743=grep("93.99",datostfg2[,136])
datostfg2[grep2743,136]
datostfg2[grep2743,136]="9.39"
table(datostfg2[,136]) 
datostfg2[,136]=as.numeric(datostfg2[,136])
datostfg2[,136]=round(datostfg2[,136],2)
datostfg2[603,136]=NA
datostfg2[3877,136]=NA
datostfg2[4207,136]=NA
datostfg2[609,136]=NA
```

```{r,include=TRUE}
####Variable 137(num_TIFFENAU_obtenido) TIFFENAU Obtenido

table(datostfg2[,137])

datostfg2[7141,137]=datostfg[7141,136]
datostfg2[706,137]=datostfg[706,136]
datostfg2[6272,137] ####Desplazar 13 posiciones
datostfg2[6272,150]=datostfg[6272,137]
datostfg2[129,137] ####Desplazar 10 posiciones
datostfg2[129,147]=datostfg[129,137]
datostfg2[603,137]=NA

table(datostfg2[,137]) 

####Revisemos los valores más bajos

grep993=grep("9.08",datostfg2[,137])
datostfg2[grep993[c(11)],137]
grep993[c(11)] ###Caso 10181
as.numeric(datostfg2[grep993[c(11)],134])/as.numeric(datostfg2[grep993[c(11)],133])*100
####Error al poner el punto
datostfg2[grep993[c(11)],137]=as.numeric(datostfg2[grep993[c(11)],134])/as.numeric(datostfg2[grep993[c(11)],133])*100
grep994=grep("15.06",datostfg2[,137])
datostfg2[grep994,137]
grep994
as.numeric(datostfg2[grep994,134])/as.numeric(datostfg2[grep994,133])*100 ###Fallo
datostfg2[grep994,137]=as.numeric(datostfg2[grep994,134])/as.numeric(datostfg2[grep994,133])*100
grep995=grep("^25",datostfg2[,137])
datostfg2[grep995,137]
grep995
as.numeric(datostfg2[grep995,134])/as.numeric(datostfg2[grep995,133])*100 ###Datos con poco sentido
###Eroores en 4207
grep996=grep("^3",datostfg2[,137])
datostfg2[grep996,137]
grep996
as.numeric(datostfg2[grep996,134])/as.numeric(datostfg2[grep996,133])*100 ###Datos con poco sentido en el segundo caso
as.numeric(datostfg2[grep996,132])*as.numeric(datostfg2[grep996,142])*100
datostfg2[grep996[c(2)],133]
datostfg2[grep996[c(2)],128]
datostfg2[grep996[c(2)],134]
####FEV1 no puede ser mayor que FVC,todo lo que esté por encima de 100 es erróneo
datostfg2[grep996[c(2)],134]="36.364"

grep997=grep("^4",datostfg2[,137])
datostfg2[grep997,137]
grep997
as.numeric(datostfg2[grep997,134])/as.numeric(datostfg2[grep997,133])*100 ###Datos correctos

grep998=grep("^10",datostfg2[,137])
datostfg2[grep998,137]
datostfg2[grep998[c(3,4,5,8,11,30,32,44,46,50)],137]
datostfg2[grep998[c(3,4,5,8,11,30,32,44,46,50)],134]=datostfg[grep998[c(3,4,5,8,11,30,32,44,46,50)],133]
datostfg2[grep998[c(3,4,5,8,11,30,32,44,46,50)],133]=datostfg[grep998[c(3,4,5,8,11,30,32,44,46,50)],134]
datostfg2[grep998[c(3,4,5,8,11,30,32,44,46,50)],137]=as.numeric(datostfg2[grep998[c(3,4,5,8,11,30,32,44,46,50)],134])/as.numeric(datostfg2[grep998[c(3,4,5,8,11,30,32,44,46,50)],133])*100
table(datostfg2[,137])
datostfg2[,137]=as.numeric(datostfg2[,137])
datostfg2[,137]=round(datostfg2[,137],2)
datostfg2[603,137]=NA
datostfg2[3877,137]=NA
datostfg2[4207,137]=NA
datostfg2[609,137]=NA

```

```{r,include=TRUE}
####Variable 138(num_FVC_por) FVC Por (num_FVC_obtenido/num_FVC_esperado)

table(datostfg2[,138])

datostfg2[7141,138]=datostfg[7141,137]
datostfg2[706,138]=datostfg[706,137]
datostfg2[6272,138] ####Desplazar 13 posiciones
datostfg2[6272,151]=datostfg[6272,138]
datostfg2[129,138] ####Desplazar 10 posiciones
datostfg2[129,148]=datostfg[129,138]
datostfg2[603,138]=NA

table(datostfg2[,138])  ####Revisar posibles errores y comprobar dividiendo las correspondientes filas

datostfg2[,138]=as.numeric(datostfg2[,133])/as.numeric(datostfg2[,128])*100
datostfg2[,138]=as.numeric(datostfg2[,138])
datostfg2[,138]=round(datostfg2[,138],0)
datostfg2[603,138]=NA
datostfg2[3877,138]=NA
datostfg2[4207,138]=NA
datostfg2[609,138]=NA
```

```{r,include=TRUE}
####Variable 139(num_FEV1_por) FEV1 Por (num_FEV1_obtenido/num_FEV1_esperado)

table(datostfg2[,139])

datostfg2[7141,139]=datostfg[7141,138]
datostfg2[706,139]=datostfg[706,138]
datostfg2[6272,139] ####Desplazar 13 posiciones
datostfg2[6272,152]=datostfg[6272,139]
datostfg2[129,139] ####Desplazar 10 posiciones
datostfg2[129,149]=datostfg[129,139]
datostfg2[603,139]=NA

table(datostfg2[,139])  ####Revisar posibles errores y comprobar dividiendo las correspondientes filas
datostfg2[,139]=as.numeric(datostfg2[,134])/as.numeric(datostfg2[,129])*100
datostfg2[,139]=round(datostfg2[,139],0)
datostfg2[603,139]=NA
datostfg2[3877,139]=NA
datostfg2[4207,139]=NA
datostfg2[609,139]=NA
```

```{r,include=TRUE}
####Variable 140(num_FEV25_por) FEV25 Por (num_FEV25_obtenido/num_FEV25_esperado)

table(datostfg2[,140])

datostfg2[7141,140]=datostfg[7141,139]
datostfg2[706,140]=datostfg[706,139]
datostfg2[6272,140] ####Desplazar 13 posiciones
datostfg2[6272,153]=datostfg[6272,140]
datostfg2[129,140] ####Desplazar 10 posiciones
datostfg2[129,150]=datostfg[129,140]
datostfg2[603,140]=NA

table(datostfg2[,140])  ####Revisar posibles errores y comprobar dividiendo las correspondientes filas
datostfg2[,140]=as.numeric(datostfg2[,135])/as.numeric(datostfg2[,130])*100
datostfg2[,140]=round(datostfg2[,140],0)
datostfg2[603,140]=NA
datostfg2[3877,140]=NA
datostfg2[4207,140]=NA
datostfg2[609,140]=NA

```

```{r,include=TRUE}
####Variable 141(num_PEF_por) PEF Por (num_PEF_obtenido/num_PEF_esperado)

table(datostfg2[,141])

datostfg2[7141,141]=datostfg[7141,140]
datostfg2[706,141]=datostfg[706,140]
datostfg2[6272,141] ####Desplazar 13 posiciones
datostfg2[6272,154]=datostfg[6272,141]
datostfg2[129,141] ####Desplazar 10 posiciones
datostfg2[129,151]=datostfg[129,141]
datostfg2[603,141]=NA

table(datostfg2[,141])  ####Revisar posibles errores y comprobar dividiendo las correspondientes filas
      datostfg2[,141]=as.numeric(datostfg2[,136])/as.numeric(datostfg2[,131])*100
datostfg2[,141]=round(datostfg2[,141],0)
datostfg2[603,141]=NA
datostfg2[3877,141]=NA
datostfg2[4207,141]=NA
datostfg2[609,141]=NA
```

```{r,include=TRUE}
####Variable 142(num_TIFFENAU_por) TIFFENAU Por (num_TIFFENAU_obtenido/num_RIFFENAU_esperado)

table(datostfg2[,142])

datostfg2[7141,142]=datostfg[7141,141]
datostfg2[706,142]=datostfg[706,141]
datostfg2[6272,142] ####Desplazar 13 posiciones
datostfg2[6272,155]=datostfg[6272,142]
datostfg2[129,142] ####Desplazar 10 posiciones
datostfg2[129,152]=datostfg[129,142]
datostfg2[603,142]=NA

table(datostfg2[,142])  ####Revisar posibles errores y comprobar dividiendo las correspondientes filas
datostfg2[603,142]=NA
datostfg2[3877,142]=NA
datostfg2[4207,142]=NA
datostfg2[609,142]=NA
```

```{r,include=TRUE}
####Variable 143 Fecha de espirometría

table(datostfg2[,143])

datostfg2[7141,143]=datostfg[7141,142]
datostfg2[706,143]=datostfg[706,142]
datostfg2[6272,143] ####Desplazar 13 posiciones
datostfg2[6272,156]=datostfg[6272,143]

datostfg2[129,153]=datostfg[129,143] ###Dato Correcto
datostfg2[603,143]

table(datostfg2[,143])  ####Variable revisada,todo está ya bien

```
```{r,include=TRUE}
####Variable 144(comentariosespirometria_txt) 

table(datostfg2[,144])

datostfg2[7141,144]=datostfg[7141,143]
datostfg2[706,144]=datostfg[706,143]
datostfg2[6272,144] ####Desplazar 13 posiciones
datostfg2[6272,157]=datostfg[6272,144]

datostfg2[129,154]=datostfg[129,144] 

table(datostfg2[,144])  ####Variable revisada,todo está ya bien

```

```{r,include=TRUE}
####Variable 145 (FNac_num)

table(datostfg2[,145])
datostfg2[7141,145]=datostfg[7141,144]
datostfg2[706,145]=datostfg[706,144]
datostfg2[6272,145] ####Desplazar 13 posiciones
datostfg2[6272,158]=datostfg[6272,145]
datostfg2[129,155]=datostfg[129,145] 
table(datostfg2[,145])####A partir del número 31 ya son números de 5 cifras.
grep1135=grep("^0",datostfg2[,145]) ####Se trata de errores

```

```{r,include=TRUE}
####Variable 146(num_FC) Frecuencia Cardíaca


table(datostfg2[,146])
datostfg2[7141,146]=datostfg[7141,145]
datostfg2[706,146]=datostfg[706,145]
datostfg2[6272,159]=datostfg[6272,146]
datostfg2[129,156]=datostfg[129,146] 
datostfg2[603,146] 
table(datostfg2[,146])  
###Voy a comprobar que los datos más extremos son correctos

grep999=grep("142",datostfg2[,146]) ###Voy a revisar el caso 835.El dato es correcto.
grep1000=grep("30",datostfg2[,146]) ###Casos 5849 y 9950.Los datos son correctos.
```

```{r,include=TRUE}
####Variable 147(num_EJE_QRS) Eje QRS,también llamado eje eléctrico del complejo QRS:El eje es la dirección en el espacio del vector eléctrico del corazón.El eje se puede medir en el ECG(electrocardiograma) de 12 derivaciones(que son el resultado de la exploración indirecta del corazón desde distintos planos) que se usa en clínica,puesto que cuando el vector eléctrico se dirige hacia una de las derivaciones produce un QRS positivo y cuando se aleja un QRS negativo. El complejo QRS es la representación gráfica de la despolarización de los ventrículos del corazón formando una estructura en el electrocardiograma.

table(datostfg2[,147])
datostfg2[7141,147]=datostfg[7141,146]
datostfg2[706,147]=datostfg[706,146]
datostfg2[6272,160]=datostfg[6272,147]
datostfg2[129,157]=datostfg[129,147]
datostfg2[603,147] 
table(datostfg2[,147])  ########Variable revisada,todo está ya bien
grep1136=grep("194",datostfg2[,147])
datostfg2[grep1136,166]
datostfg2[grep1136,150]
datostfg2[grep1136,147]=NA
grep1137=grep("210",datostfg2[,147])
datostfg2[grep1137,166]
datostfg2[grep1137,147]=NA
grep1138=grep("235",datostfg2[,147])
datostfg2[grep1138,166]
datostfg2[grep1138,147]=NA
```

```{r,include=TRUE}
####Variable 148(num_INTERVALO_P) Intervalo P :Duración en ms del intervalo P de un electrocardiograma

table(datostfg2[,148])

datostfg2[7141,148]=datostfg[7141,147]
datostfg2[706,148]=datostfg[706,147]
datostfg2[6272,161]=datostfg[6272,148] 
datostfg2[129,158]=datostfg[129,148]
datostfg2[603,148] 
table(datostfg2[,148])
grep1197=grep("808",datostfg2[,148])
datostfg2[grep1197,149] 
datostfg2[grep1197,164]
datostfg2[grep1197,166]
grep2067=grep("230",datostfg2[,149])
datostfg2[grep2067,148]
table(datostfg2[grep2067[-c(5)],148])
datostfg2[grep2067,148]="80" ###Es el más probable
grep1198=grep("^0",datostfg2[,148])
datostfg2[grep1198,148]
datostfg2[grep1198[c(1,4,5,7,10)],148]
datostfg2[grep1198[c(1,4,5,7,10)],149]
datostfg2[grep1198,164]
grep1198[c(1,10)] ###En estos casos no hay fallos,lo único que pasa es que los latidos no son sinusales,por eso no tienen onda P.
grep1199=grep("^0.05",datostfg2[,148])
datostfg2[grep1199,148] ###Vamos a revisar este caso,parece que viene dado en segundos.
datostfg2[grep1199,148]="50"
grep2000=grep("^0.1",datostfg2[,148])##Vamos a revisar este caso,parece que viene dado en segundos.
datostfg2[grep2000,148]="100"
grep2001=grep("^2",datostfg2[,148])
datostfg2[grep2001,148] ###Caso 3877,caso con fallos
datostfg2[grep2001[c(2)],148]=NA
grep2002=grep("^7",datostfg2[,148])
datostfg2[grep2002,148] 
datostfg2[grep2002[c(212)],164]
datostfg2[grep2002[c(212)],166]
datostfg2[grep2002[c(212)],148]
grep2002[c(212)] ###Caso 2650
datostfg2[grep2002[c(212)],125]
datostfg2[grep2002[c(212)],149]
grep2064=grep("148",datostfg2[,149])
datostfg[grep2064,148]
table(datostfg[grep2064[-c(40)],148]) ###El más probable es 70
###Veamos si hay alguna coincidencia
for (i in 1:11984){comp=(datostfg2[i,146]==datostfg2[grep2002[c(212)],146]&&
  datostfg2[i,149]==datostfg2[grep2002[c(212)],149])
if(!is.na(comp)) if (comp) {
   datostfg2[i,148]="Coinciden1"
}else{
        datostfg2[i,148]=datostfg2[i,148]
}}
grep2038=grep("Coinciden1",datostfg2[,148])
datostfg[grep2038,148]
grep2037=grep("Coinci",datostfg2[,148])
datostfg2[grep2037,148]=datostfg[grep2037,148]
datostfg2[grep2002[c(212)],148]="70"
grep2065=grep("^10",datostfg2[,148])
datostfg2[grep2065,148] 
datostfg2[grep2065[1001:1462],148]
datostfg2[grep2065[c(1071)],148]
datostfg2[grep2065[c(1071)],164]
datostfg2[grep2065[c(1071)],166]
datostfg2[grep2065[c(1071)],148]="100"
grep2066=grep("1$",datostfg2[,148])
datostfg2[grep2066,148]
grep2066=grep2066[-c(1,3,4,5,6,7,8,9,21,22,23,26,27,29,30,32,50,60,61,62,63,65,66,71,72,73,82,190,224,233,234,256,259,269,273,279,285,288,290,291,292,301,308,313,314,316,319,323,327,328,333,334,337,338,339,340,341,342,343,344,345,346,358,359,400,401,402,406,420,421,436,439,440,442,451,452,453,456,460,468,470,471,473,475,476,478,484,486,493,494,503,504,507,508,515,522,523,536,539,542,548,558,565,574,588,593,710,718)]
datostfg2[grep2066,164]
datostfg2[grep2066,166]
####Creo que se trata de un error
datostfg2[grep2066,148]="100"

grep2065=grep("10$",datostfg2[,148])
datostfg2[grep2065,148] 
datostfg2[grep2065[c(119)],148]
datostfg2[grep2065[c(119)],149]
datostfg2[grep2065[c(119)],164]
datostfg2[grep2065[c(119)],166]
datostfg2[grep2065[c(119)],148]="100"
table(datostfg2[,148])
```

```{r,include=TRUE}
####Variable 149(num_INTERVALO_PR) Intervalo PR :Duración en ms del intervalo PR de un electrocardiogrma

table(datostfg2[,149])
datostfg2[7141,149]=datostfg[7141,148]
datostfg2[706,149]=datostfg[706,148]
datostfg2[6272,162]=datostfg[6272,149]
datostfg2[129,159]=datostfg[129,149] ###Dato correcto
datostfg2[603,149] 
table(datostfg2[,149])########Revisar valores excesivamente bajos y excesivamente altos
grep2069=grep("^0",datostfg2[,149])
datostfg2[grep2069,149]
datostfg2[grep2069,149]=datostfg2[grep2069,148]
datostfg2[grep2069,148]=NA
datostfg2[grep2069[c(1,5)],149]=NA
datostfg2[grep2069,125]
grep2070=grep("1$",datostfg2[,149])
datostfg2[grep2070,149]
datostfg2[grep2070[c(11)],149]
datostfg2[grep2070[c(11)],148]
datostfg2[grep2070[c(11)],125]
grep2071=grep("100",datostfg2[,148])
datostfg2[grep2071,149]
table(datostfg2[grep2071[-c(26)],149]) ###160  es el más probable

###Veamos si hay alguna coincidencia
for (i in 1:11984){comp=(datostfg2[i,148]==datostfg2[grep2070[c(11)],148]&&
  datostfg2[i,150]==datostfg2[grep2070[c(11)],150])
if(!is.na(comp)) if (comp) {
   datostfg2[i,149]="Coinciden1"
}else{
        datostfg2[i,149]=datostfg2[i,149]
}}
grep2038=grep("Coinciden1",datostfg2[,149])
datostfg[grep2038,149]
table(datostfg[grep2038,149])
grep2037=grep("Coinci",datostfg2[,149])
datostfg2[grep2037,149]=datostfg[grep2037,149]

###Vamos a buscar una coincidencia más concreta
for (i in 1:11984){comp=(datostfg2[i,148]==datostfg2[grep2070[c(11)],148]&&
  datostfg2[i,150]==datostfg2[grep2070[c(11)],150]&& datostfg2[i,151]==datostfg2[grep2070[c(11)],151])
if(!is.na(comp)) if (comp) {
   datostfg2[i,149]="Coinciden1"
}else{
        datostfg2[i,149]=datostfg2[i,149]
}}
grep2038=grep("Coinciden1",datostfg2[,149])
datostfg[grep2038,149]
grep2037=grep("Coinci",datostfg2[,149])
datostfg2[grep2037,149]=datostfg[grep2037,149]
datostfg2[grep2070[c(11)],149]="149"

grep2072=grep("^7",datostfg2[,149])
datostfg2[grep2072,149]
datostfg2[grep2072,148]
datostfg2[grep2072,125]###Caso sin interés
datostfg2[grep2072,149]=NA

grep2073=grep("^14",datostfg2[,149])
datostfg2[grep2073[c(113)],149]
datostfg2[grep2073[c(113)],148]
datostfg2[grep2073[c(113)],125]

grep2074=grep("80",datostfg2[,148])
datostfg2[grep2074,149]
table(datostfg2[grep2074,149]) ####140 es el más probable

###Vamos a buscar una coincidencia 
for (i in 1:11984){comp=(datostfg2[i,148]==datostfg2[grep2073[c(113)],148]&&
  datostfg2[i,150]==datostfg2[grep2073[c(113)],150])
if(!is.na(comp)) if (comp) {
   datostfg2[i,149]="Coinciden1"
}else{
        datostfg2[i,149]=datostfg2[i,149]
}}

grep2038=grep("Coinciden1",datostfg2[,149])
datostfg[grep2038,149]
table(datostfg[grep2038,149])
grep2037=grep("Coinci",datostfg2[,149])
datostfg2[grep2037,149]=datostfg[grep2037,149]
datostfg2[grep2073[c(113)],149]="140"

grep2075=grep("15$",datostfg2[,149])
datostfg2[grep2075,149]
datostfg2[grep2075[c(5)],149]
datostfg2[grep2075[c(5)],148]
datostfg2[grep2075[c(5)],125]
grep2076=grep("109",datostfg2[,148])
datostfg2[grep2076,149]

###Vamos a buscar una coincidencia 
for (i in 1:11984){comp=(datostfg2[i,148]==datostfg2[grep2075[c(5)],148]&&
  datostfg2[i,150]==datostfg2[grep2075[c(5)],150])
if(!is.na(comp)) if (comp) {
   datostfg2[i,149]="Coinciden1"
}else{
        datostfg2[i,149]=datostfg2[i,149]
}}
datostfg2[grep2075[c(5)],149]="165"

grep2076=grep("17$",datostfg2[,149])
datostfg2[grep2076,149]
datostfg2[grep2076[c(32)],149]
datostfg2[grep2076[c(32)],148]
datostfg2[grep2076[c(32)],125]
grep2077=grep("78",datostfg2[,148])
datostfg2[grep2077,149]
table(datostfg2[grep2077,149]) ###170 es el más probable

###Vamos a buscar una coincidencia 
for (i in 1:11984){comp=(datostfg2[i,148]==datostfg2[grep2076[c(32)],148]&&
  datostfg2[i,150]==datostfg2[grep2076[c(32)],150])
if(!is.na(comp)) if (comp) {
   datostfg2[i,149]="Coinciden1"
}else{
        datostfg2[i,149]=datostfg2[i,149]
}}
grep2038=grep("Coinciden1",datostfg2[,149])
datostfg[grep2038,149]
table(datostfg[grep2038,149])
grep2037=grep("Coinci",datostfg2[,149])
datostfg2[grep2037,149]=datostfg[grep2037,149]
datostfg2[grep2076[c(32)],149]="170"

grep2073=grep("14$",datostfg2[,149])
datostfg2[grep2073[c(1)],149]
datostfg2[grep2073[c(1)],148]
datostfg2[grep2073[c(1)],125]

grep2078=grep("90",datostfg2[,148])
datostfg2[grep2078,149]
table(datostfg2[grep2078,149]) ###144 es el más probable

###Vamos a buscar una coincidencia más concreta
for (i in 1:11984){comp=(datostfg2[i,148]==datostfg2[grep2073[c(1)],148]&&
  datostfg2[i,150]==datostfg2[grep2073[c(1)],150])
if(!is.na(comp)) if (comp) {
   datostfg2[i,149]="Coinciden1"
}else{
        datostfg2[i,149]=datostfg2[i,149]
}}
grep2038=grep("Coinciden1",datostfg2[,149])
datostfg[grep2038,149]
table(datostfg[grep2038,149])
grep2037=grep("Coinci",datostfg2[,149])
datostfg2[grep2037,149]=datostfg[grep2037,149]
datostfg2[grep2073[c(1)],149]="144"
table(datostfg2[,149])
grep23000=grep("989",datostfg2[,149])
datostfg2[grep23000,149]="98"
grep25000=grep("60$",datostfg2[,149])
datostfg2[grep25000,149]
datostfg2[grep25000[c(297)],149]
datostfg2[grep25000[c(297)],166]
datostfg2[grep25000[c(297)],149]="160"

grep25001=grep("^600",datostfg2[,149])
datostfg2[grep25001,149]
datostfg2[grep25001,166]
grep25001=grep("^260",datostfg2[,149])
datostfg2[grep25001,149]
datostfg2[grep25001,166]
```

```{r,include=TRUE}
####Variable 150(num_INTERVALO_QRS) Intervalo QRS :Duración en ms del intervalo QRS de un electrocardiogrma

table(datostfg2[,150])
datostfg2[7141,150]=datostfg[7141,149]
datostfg2[706,150]=datostfg[706,149]
datostfg2[6272,163]=datostfg[6272,150] ###Dato correcto
datostfg2[129,160]=datostfg[129,160]
datostfg2[603,150] 
table(datostfg2[,150]) ########Revisar valores excesivamente bajos y excesivamente altos
grep2079=grep("989",datostfg2[,150])
datostfg2[grep2079,150]
datostfg2[grep2079,164]
datostfg2[grep2079,166]
datostfg2[grep2079,149]
grep2080=grep("182",datostfg2[,149])
datostfg2[grep2080,150]
table(datostfg2[grep2080[-c(18)],150]) ####El más probable es 98

###Vamos a buscar una coincidencia
for (i in 1:11984){comp=(datostfg2[i,149]==datostfg2[grep2079,149]&&
  datostfg2[i,151]==datostfg2[grep2079,151])
if(!is.na(comp)) if (comp) {
   datostfg2[i,150]="Coinciden1"
}else{
        datostfg2[i,150]=datostfg2[i,150]
}}
grep2038=grep("Coinciden1",datostfg2[,150])
datostfg[grep2038,150]
table(datostfg[grep2038,150])
grep2037=grep("Coinci",datostfg2[,150])
datostfg2[grep2037,150]=datostfg[grep2037,150]
datostfg2[grep2079,150]="98"

grep2081=grep("^0",datostfg2[,150])
datostfg2[grep2081,150]
datostfg2[grep2081,164]
datostfg2[grep2081,166]
datostfg2[grep2081,125]
datostfg2[grep2081,150]=NA
datostfg2[grep2081[c(1,2,3)],148]=NA
grep2082=grep("^7",datostfg2[,150])
datostfg2[grep2082,150]
datostfg2[grep2082[c(302)],150]
datostfg2[grep2082[c(302)],125]###Caso sin interés
datostfg2[grep2082[c(302)],150]=NA
grep2083=grep("8$",datostfg2[,150])
datostfg2[grep2083,150]
datostfg2[grep2083[1001:1401],150]
datostfg2[grep2083[c(1066)],150]
datostfg2[grep2083[c(1066)],125]
datostfg2[grep2083[c(1066)],164]
datostfg2[grep2083[c(1066)],166]
datostfg2[grep2083[c(1066)],151]
grep60000=grep("387",datostfg2[,151])
table(datostfg2[grep60000,150])
datostfg2[grep2083[c(1066)],150]="87" ###Es el más probable
grep2084=grep("9$",datostfg2[,150])
datostfg2[grep2084,150]
datostfg2[grep2084[c(361)],150]
datostfg2[grep2084[c(361)],125]
datostfg2[grep2084[c(361)],164]
datostfg2[grep2084[c(361)],166]
datostfg2[grep2084[c(361)],151]
grep60001=grep("391",datostfg2[,151])
table(datostfg2[grep60001,150])
datostfg2[grep2084[c(361)],150]="90" ###Es el más probable
grep60002=grep("^16",datostfg2[,150])
datostfg2[grep60002,150]
datostfg2[grep60002,147] ####Se ha copiado el valor del eje QRS
datostfg2[grep60002[c(4)],151]
grep60010=grep("455",datostfg2[,151])
table(datostfg2[grep60010,150])
datostfg2[grep60002,150]="90" ####Es el más probable
grep60003=grep("^17",datostfg2[,150])
datostfg2[grep60003,150]
datostfg2[grep60003[c(2)],150]
datostfg2[grep60003[c(2)],147]####Se ha copiado el valor del eje QRS
datostfg2[grep60003[c(2)],151]
grep60011=grep("425",datostfg2[,151])
table(datostfg2[grep60011,150])
datostfg2[grep60003[c(2)],150]="90"  ###Es el más probable
grep60004=grep("^21",datostfg2[,150])
datostfg2[grep60004,150]
datostfg2[grep60004,151]
datostfg2[grep60004,166]
datostfg2[grep60004,147]####Se ha copiado el valor del eje QRS
grep60005=grep("390",datostfg2[,151])
table(datostfg2[grep60005,150])
datostfg2[grep60004,150]="90" ###Es el más probable
grep60006=grep("^24",datostfg2[,150])
datostfg2[grep60006,150]
datostfg2[grep60006,151]
datostfg2[grep60006,147]####Se ha copiado el valor del eje QRS
grep60007=grep("380",datostfg2[,151])
table(datostfg2[grep60007,150])
datostfg2[grep60006,150]="90" ###Es el más probable
datostfg2[grep60006,166]
grep60007=grep("^26",datostfg2[,150])
datostfg2[grep60007,150]
datostfg2[grep60007,151]
datostfg2[grep60007,147]####Se ha copiado el valor del eje QRS
grep60020=grep("350",datostfg2[,151])
table(datostfg2[grep60020,150])
datostfg2[grep60007,150]="94" ###De los más probables es que tiene una mayor frecuencia en la muestra total
grep60022=grep("^29",datostfg2[,150])
datostfg2[grep60022,150]
datostfg2[grep60022,151]
datostfg2[grep60022,147]####Se ha copiado el valor del eje QRS
grep60023=grep("394",datostfg2[,151])
table(datostfg2[grep60023,150])
datostfg2[grep60022,150]="88" ###Es el más probable
grep60024=grep("^36",datostfg2[,150])
datostfg2[grep60024,150]
datostfg2[grep60024,151]
datostfg2[grep60024,147]####Se ha copiado el valor del eje QRS
grep60025=grep("379",datostfg2[,151])
table(datostfg2[grep60025,150])
datostfg2[grep60024,150]="93" ###Es el más probable
grep60026=grep("^39",datostfg2[,150])
datostfg2[grep60026,150]
datostfg2[grep60026[c(4)],151]
datostfg2[grep60026[c(4)],152]
datostfg2[grep60026[c(4)],147]####Se ha copiado el valor del eje QRS
datostfg2[grep60026[c(4)],150]=NA

grep60027=grep("^40",datostfg2[,150])
datostfg2[grep60027,150]
datostfg2[grep60027[c(5)],147]####Se ha copiado el valor del eje QRS
datostfg2[grep60027[c(5)],151]
grep60028=grep("428",datostfg2[,151])
table(datostfg2[grep60028,150])
datostfg2[grep60027[c(5)],150]="96" ####Es el más probable
grep60029=grep("^42",datostfg2[,150])
datostfg2[grep60029,150]
datostfg2[grep60029,147]####Se ha copiado el valor del eje QRS
datostfg2[grep60029,151]
grep60030=grep("391",datostfg2[,151])
table(datostfg2[grep60030,150])
datostfg2[grep60029,150]="90" ###Es el más probable
grep60031=grep("^44",datostfg2[,150])
datostfg2[grep60031,150]
datostfg2[grep60031,147]####Se ha copiado el valor del eje QRS
datostfg2[grep60031,151]
grep60032=grep("307",datostfg2[,151])
table(datostfg2[grep60032,150])
datostfg2[grep60031,150]="90" ###Es el más probable
grep60033=grep("^47",datostfg2[,150])
datostfg2[grep60033,150]
datostfg2[grep60033,147]####Se ha copiado el valor del eje QRS
datostfg2[grep60033,151]
grep60034=grep("349",datostfg2[,151])
table(datostfg2[grep60034,150])
datostfg2[grep60033,150]="90" ###Es el más probable
grep60035=grep("^5",datostfg2[,150])
datostfg2[grep60035,150]
datostfg2[grep60035,147]####Se ha copiado el valor del eje QRS en algunos casos
datostfg2[grep60035[c(3)],151]
grep60036=grep("369",datostfg2[,151])
table(datostfg2[grep60036,150])
datostfg2[grep60035[c(3)],150]="88" ###Es el más probable
datostfg2[grep60035[c(4)],151]
grep60037=grep("473",datostfg2[,151])
table(datostfg2[grep60037,150])
datostfg2[grep60035[c(4)],150]="90" ###Es el más probable
grep60035=grep("^5",datostfg2[,150])
datostfg2[grep60035,150]
datostfg2[grep60035,147]
datostfg2[grep60035[c(5)],151]
grep60038=grep("405",datostfg2[,151])
table(datostfg2[grep60038,150])
datostfg2[grep60035[c(5)],150]="98" ###Es el más probable
datostfg2[grep60035[c(7)],151]
grep60039=grep("429",datostfg2[,151])
table(datostfg2[grep60039,150])
datostfg2[grep60035[c(7)],150]="97" ###Es el más probable
datostfg2[grep60035[c(8)],151]
grep60040=grep("375",datostfg2[,151])
table(datostfg2[grep60040,150])
datostfg2[grep60035[c(8)],150]="86" ###Es el más probable
grep60041=grep("^6",datostfg2[,150])
datostfg2[grep60041,150]
datostfg2[grep60041,147]
datostfg2[grep60041[c(10,27,34,50,59,74,79)],150]
datostfg2[grep60041[c(10,27,34,50,59,74,79)],147]####No podemos estar seguros de que se trate de errores
datostfg2[grep60041[c(10,27,34,50,59,74,79)],151]

grep60043=grep("464",datostfg2[,151])
table(datostfg2[grep60043,150])
grep60044=grep("392",datostfg2[,151])
table(datostfg2[grep60044,150])
grep60045=grep("377",datostfg2[,151])
table(datostfg2[grep60045,150])
grep60046=grep("352",datostfg2[,151])
table(datostfg2[grep60046,150])
grep60047=grep("415",datostfg2[,151])
table(datostfg2[grep60047,150])
grep60048=grep("377",datostfg2[,151])
table(datostfg2[grep60048,150])
grep60049=grep("458",datostfg2[,151])
table(datostfg2[grep60049,150])

grep60050=grep("^7",datostfg2[,150])
datostfg2[grep60050,150]
datostfg2[grep60050,147]

grep60050=grep("^3",datostfg2[,150]) 
datostfg2[grep60050,149]
datostfg2[grep60050,150]
datostfg2[grep60050,151]
datostfg2[grep60050,152]

datostfg2[grep60050[c(1,2,3)],151]=datostfg2[grep60050[c(1,2,3)],150]
datostfg2[grep60050[c(1,2,3)],152]=datostfg2[grep60050[c(1,2,3)],151]
datostfg2[grep60050[c(1,2,3)],150]=NA
grep60050=grep("^3",datostfg2[,150])
datostfg2[grep60050,150]
datostfg2[grep60050,151]
datostfg2[grep60050,152]
datostfg2[grep60050[c(1,4)],150]=NA
datostfg2[grep60050[c(2)],151]=datostfg2[grep60050[c(2)],150]
datostfg2[grep60050[c(2)],152]=datostfg2[grep60050[c(2)],151]
datostfg2[grep60050[c(2)],150]=NA

grep60051=grep("^4",datostfg2[,150])
datostfg2[grep60051,149]
datostfg2[grep60051,150]
datostfg2[grep60051,151]
datostfg2[grep60051,152]
datostfg2[grep60051[c(2,5,6,7,8)],151]=datostfg2[grep60051[c(2,5,6,7,8)],150]
datostfg2[grep60051[c(2,5,6,7,8)],152]=datostfg2[grep60051[c(2,5,6,7,8)],151]
datostfg2[grep60051[c(2,5,6,7,8)],150]=NA
grep60051=grep("^4",datostfg2[,150])
datostfg2[grep60051,150]
datostfg2[grep60051,151]
datostfg2[grep60051,152]
datostfg2[grep60051[c(1)],151]=datostfg2[grep60051[c(1)],150]
datostfg2[grep60051[c(1)],152]=datostfg2[grep60051[c(1)],151]
datostfg2[grep60051[c(1)],150]=NA
datostfg2[grep60051[c(2,3)],150]=NA
grep60052=grep("^2",datostfg2[,150])
datostfg2[grep60052,149]
datostfg2[grep60052,150]
datostfg2[grep60052,151]
datostfg2[grep60052,152]
```

```{r,include=TRUE}
####Variable 151(num_INTERVALO_QTMedio) Intervalo QTMedio :Duración en ms del intervalo QTMedio de un electrocardiogrma

table(datostfg2[,151])
datostfg2[7141,151]=datostfg[7141,150]
datostfg2[706,151]=datostfg[706,150]
datostfg2[6272,164]=datostfg[6272,151]
datostfg2[129,161]=datostfg[129,151]
datostfg2[603,151] 
table(datostfg2[,151])  ########Revisar valores excesivamente bajos y excesivamente altos
grep2020=grep("4.13",datostfg2[,151]) ###Caso 11360
datostfg2[grep2020,164]
datostfg2[grep2020,166]
datostfg2[grep2020,151]="413"
grep2021=grep("4.15",datostfg2[,151]) ###Caso 7691
datostfg2[grep2021,164]
datostfg2[grep2021,166]
datostfg2[grep2021,151]="415"
grep2022=grep("4.9",datostfg2[,151])
datostfg2[grep2022,151]
datostfg2[grep2022[c(458)],151] ###Caso 10212
datostfg2[grep2022[c(458)],164]
datostfg2[grep2022[c(458)],166]
grep2023=grep("Brad",datostfg2[,164])
table(datostfg2[grep2023,151])
datostfg2[10212,152] ###También hay un error
datostfg2[10212,150]
grep2039=grep("86",datostfg2[,150])
datostfg2[grep2039,151]
table(datostfg2[grep2039[-c(365)],151])

###Veamos si hay alguna coincidencia
for (i in 1:11984){comp=(datostfg2[i,152]==datostfg2[grep2022[c(458)],152]&&
  datostfg2[i,150]==datostfg2[grep2022[c(458)],150])
if(!is.na(comp)) if (comp) {
   datostfg2[i,151]="Coinci4"
}else{
        datostfg2[i,151]=datostfg2[i,151]
}}
grep2038=grep("Coinci4",datostfg2[,151])
datostfg[grep2038,151]
datostfg2[10212,151]="409" ###Es el más probable

grep2024=grep("27",datostfg2[,151])
datostfg2[grep2024,151]
datostfg2[grep2024[c(26)],151]
grep2024[c(26)] ###Caso 3877,caso con fallos
datostfg2[grep2024[c(26)],151]=NA
grep2025=grep("40",datostfg2[,151]) ##Caso 4071
datostfg2[grep2025,151]
datostfg2[grep2025[c(587)],151] 
datostfg2[grep2025[c(587)],125]
datostfg2[grep2025[c(587)],152]
grep2026=grep("412",datostfg2[,152])
datostfg2[grep2026,151]
datostfg2[grep2026[-c(74)],151]
table(datostfg2[grep2026[-c(74)],151])
datostfg2[grep2025[c(587)],150]
grep2029=grep("82",datostfg2[,150])
datostfg2[grep2029,151]
datostfg2[grep2029[-c(132)],151]
table(datostfg2[grep2029[-c(132)],151])


###Veamos además si tenemos un registro semejante
for (i in 1:11984){comp=(datostfg2[i,152]==datostfg2[grep2025[c(587)],152]&&
  datostfg2[i,150]==datostfg2[grep2025[c(587)],150])
if(!is.na(comp)) if (comp) {
   datostfg2[i,151]="Coinci1"
}else{
        datostfg2[i,151]=datostfg2[i,151]
}}

grep2035=grep("Coinci1",datostfg2[,151])
datostfg[grep2035,151]
datostfg2[4071,151]="409"

grep2027=grep("41",datostfg2[,151])
datostfg2[grep2027,151]
datostfg2[grep2027[c(396)],151] ###Caso 3298
datostfg2[grep2027[c(396)],125]
datostfg2[grep2027[c(396)],152]
grep2028=grep("415",datostfg2[,152])
datostfg2[grep2028,151]
datostfg2[grep2028[-c(38)],151]
table(datostfg2[grep2028[-c(38)],151])
datostfg2[grep2027[c(396)],150]
grep2030=grep("94",datostfg2[,150])
datostfg2[grep2030,151]
datostfg2[grep2030[-c(139)],151]
table(datostfg2[grep2030[-c(139)],151])

###Veamos además si tenemos un registro semejante
for (i in 1:11984){comp=(datostfg2[i,152]==datostfg2[grep2027[c(396)],152]&&
  datostfg2[i,150]==datostfg2[grep2027[c(396)],150])
if(!is.na(comp)) if (comp) {
   datostfg2[i,151]="Coinci2"
}else{
        datostfg2[i,151]=datostfg2[i,151]
}}

grep2036=grep("Coinci2",datostfg2[,151])
datostfg[grep2036,151]
table(datostfg2[grep2028[-c(38)],151])
table(datostfg2[grep2030[-c(139)],151])
####El que más probabilidades tiene de ser el correcto es 418,aunque tomaré como dato "correcto" 412 ,ya que hay una coincidencia y por proximidad de las teclas es el que tiene más sentido.
datostfg2[grep2027[c(396)],151]="412"
grep2037=grep("Coinci",datostfg2[,151])
datostfg2[grep2037,151]=datostfg[grep2037,151]
table(datostfg2[,151])
grep2025=grep("40",datostfg2[,151]) ##Caso 4071
datostfg2[grep2025,151]
datostfg2[grep2025[c(808)],151]
datostfg2[grep2025[c(808)],152]
datostfg2[grep2025[c(808)],150]

###Veamos si hay alguna coincidencia
for (i in 1:11984){comp=(datostfg2[i,152]==datostfg2[grep2025[c(808)],152]&&
  datostfg2[i,150]==datostfg2[grep2025[c(808)],150])
if(!is.na(comp)) if (comp) {
   datostfg2[i,151]="Coinci5"
}else{
        datostfg2[i,151]=datostfg2[i,151]
}}

grep2040=grep("Coinci5",datostfg2[,151])
datostfg[grep2040,151]
datostfg2[grep2025[c(808)],151]="400" ####Ya que hay una coincidencia con otro caso y puede que solo se haya pulsado el 0 una vez.
grep2037=grep("Coinci",datostfg2[,151])
datostfg2[grep2037,151]=datostfg[grep2037,151]
table(datostfg2[,151])
grep39000=grep("^1",datostfg2[,151])
datostfg2[grep39000,151]
datostfg2[grep39000,152]
datostfg2[grep39000,166]
datostfg2[grep39000,169]


```

```{r,include=TRUE}
####Variable 152(num_INTERVALO_QTC) Intervalo QTC: Duración en ms del intervalo QTC de un electrocardiograma

table(datostfg2[,152])
datostfg2[7141,152]=datostfg[7141,151]
datostfg2[706,152]=datostfg[706,151]
datostfg2[6272,165]=datostfg[6272,152]
datostfg2[129,162]=datostfg[129,152]
datostfg2[603,152] 
table(datostfg2[,152])  ########Revisar valores excesivamente bajos y excesivamente altos
grep2041=grep("4.13",datostfg2[,152]) 
datostfg2[grep2041,152]
datostfg2[grep2041,152]="413"
datostfg2[grep2041,125]
grep2042=grep("4.34",datostfg2[,152])
datostfg2[grep2042,152]
datostfg2[grep2042,152]="434"
datostfg2[grep2042,125]
grep2043=grep("3.84",datostfg2[,152])
datostfg2[grep2043,152]
datostfg2[grep2043,152]="384"
datostfg2[grep2043,125]
grep2044=grep("3.98",datostfg2[,152])
datostfg2[grep2044,152]
datostfg2[grep2044,152]="398"
datostfg2[grep2044,125]
grep2045=grep("^7",datostfg2[,152])
datostfg2[grep2045,152]
datostfg2[grep2045,125] ####Caso sin interés
datostfg2[grep2045,152]=NA


grep2046=grep("^4",datostfg2[,152])
datostfg2[grep2046,152]
grep2047=grep("1",datostfg2[,125])
datostfg2[grep2047,152] ####No están esos 4
datostfg2[grep2046[1001:2000],152]
datostfg2[grep2046[2001:3000],152]
datostfg2[grep2046[3001:4000],152]
datostfg2[grep2046[4001:5000],152]
datostfg2[grep2046[5001:6000],152]
datostfg2[grep2046[c(1960,3997,5369,5240)],152]
datostfg2[grep2045,152]=NA

###Veamos si hay alguna coincidencia
for (i in 1:11984){comp=(datostfg2[i,151]==datostfg2[grep2046[c(1960)],151]&&
  datostfg2[i,150]==datostfg2[grep2046[c(1960)],150])
if(!is.na(comp)) if (comp) {
   datostfg2[i,152]="Coinci7"
}else{
        datostfg2[i,152]=datostfg2[i,152]
}}

grep2048=grep("Coinci7",datostfg2[,152])
datostfg[grep2048,152]
datostfg2[grep2046[c(1960)],152]="410"

###Veamos si hay alguna coincidencia
for (i in 1:11984){comp=(datostfg2[i,151]==datostfg2[grep2046[c(3997)],151]&&
  datostfg2[i,150]==datostfg2[grep2046[c(3997)],150])
if(!is.na(comp)) if (comp) {
   datostfg2[i,152]="Coinci8"
}else{
        datostfg2[i,152]=datostfg2[i,152]
}}

grep2049=grep("Coinci8",datostfg2[,152])
datostfg[grep2049,152]
grep2037=grep("Coinci",datostfg2[,152])
datostfg2[grep2037,152]=datostfg[grep2037,152]
datostfg2[grep2046[c(3997)],151]
grep2050=grep("391",datostfg2[,151])
datostfg2[grep2050,152]
table(datostfg2[grep2050[-c(76)],152])
datostfg2[grep2046[c(3997)],152]="410" ####Es el más probable

###Veamos si hay alguna coincidencia
for (i in 1:11984){comp=(datostfg2[i,151]==datostfg2[grep2046[c(5369)],151]&&
  datostfg2[i,150]==datostfg2[grep2046[c(5369)],150])
if(!is.na(comp)) if (comp) {
   datostfg2[i,152]="Coinci9"
}else{
        datostfg2[i,152]=datostfg2[i,152]
}}

grep2048=grep("Coinci9",datostfg2[,152])
datostfg[grep2048,152]
datostfg2[grep2046[c(5369)],152]="413"

for (i in 1:11984){comp=(datostfg2[i,151]==datostfg2[grep2046[c(5240)],151]&&
  datostfg2[i,150]==datostfg2[grep2046[c(5240)],150])
if(!is.na(comp)) if (comp) {
   datostfg2[i,152]="Coinci10"
}else{
        datostfg2[i,152]=datostfg2[i,152]
}}

grep2048=grep("Coinci10",datostfg2[,152])
datostfg[grep2048,152]


datostfg2[grep2046[c(5240)],151]
grep2051=grep("351",datostfg2[,151])
datostfg2[grep2051,152]
table(datostfg2[grep2051[-c(12)],152])
datostfg2[grep2046[c(5240)],152]="400" ####Es el que más sentido tiene.
grep2037=grep("Coinci",datostfg2[,152])
datostfg2[grep2037,152]=datostfg[grep2037,152]
table(datostfg2[,152])

grep2052=grep("^66",datostfg2[,152])
datostfg2[grep2052,152]
datostfg2[grep2052,151]
grep2053=grep("389",datostfg2[,151])
datostfg2[grep2053,152]
table(datostfg2[grep2051[-c(3)],152])
datostfg2[grep2052,152]="366"
grep2054=grep("^90",datostfg2[,152])
datostfg2[grep2054,152]
datostfg2[grep2054,151]
grep2055=grep("378",datostfg2[,151])
datostfg2[grep2055,152]
table(datostfg2[grep2051[-c(106)],152])
datostfg2[grep2054,152]="390"
grep2056=grep("^49",datostfg2[,152])
datostfg2[grep2056,152]
datostfg2[grep2056[c(1)],151]
grep2057=grep("449",datostfg2[,151])
datostfg2[grep2057,152]
table(datostfg2[grep2057[-c(3)],152])
datostfg2[grep2056[c(1)],152]="449"
grep2058=grep("^1",datostfg2[,152])
datostfg2[grep2058,152]
datostfg2[grep2058[c(2)],152] ###Caso 2299
datostfg2[grep2058[c(2)],151]
grep2059=grep("394",datostfg2[,151])
datostfg2[grep2059,152]
table(datostfg2[grep2059[-c(37)],152]) ###De los casos que tienen un 1 el que tiene más probabilidad es 410

###Veamos si hay alguna coincidencia
for (i in 1:11984){comp=(datostfg2[i,151]==datostfg2[grep2058[c(2)],151]&&
  datostfg2[i,150]==datostfg2[grep2058[c(2)],150])
if(!is.na(comp)) if (comp) {
   datostfg2[i,152]="Coinci11"
}else{
        datostfg2[i,152]=datostfg2[i,152]
}}

grep2048=grep("Coinci11",datostfg2[,152])
datostfg[grep2048,152]
datostfg2[grep2058[c(2)],152]="410"
grep2037=grep("Coinci",datostfg2[,152])
datostfg2[grep2037,152]=datostfg[grep2037,152]

grep2060=grep("40$",datostfg2[,152])
datostfg2[grep2060,152]
datostfg2[grep2060[c(26)],152]
datostfg2[grep2060[c(26)],151]
grep2061=grep("382",datostfg2[,151])
datostfg2[grep2061,152]
table(datostfg2[grep2061[-c(39)],152]) ###El más probable es 410
datostfg2[grep2060[c(26)],152]="410"



grep2062=grep("37",datostfg2[,152])
datostfg2[grep2062,152]
datostfg2[grep2062[c(636)],152]
datostfg2[grep2062[c(636)],151]
grep2063=grep("375",datostfg2[,151])
datostfg2[grep2063,152]
table(datostfg2[grep2061[-c(50)],152])

###Veamos si hay alguna coincidencia

for (i in 1:11984){comp=(datostfg2[i,151]==datostfg2[grep2062[c(636)],151]&&
  datostfg2[i,150]==datostfg2[grep2062[c(636)],150])
if(!is.na(comp)) if (comp) {
   datostfg2[i,152]="Coinci13"
}else{
        datostfg2[i,152]=datostfg2[i,152]
}}

grep2048=grep("Coinci13",datostfg2[,152])
datostfg[grep2048,152]
datostfg2[grep2062[c(636)],152]="375" ###Aunque 378 y 372 tienen la misma probabilidad de ser correctos
grep2037=grep("Coinci",datostfg2[,152])
datostfg2[grep2037,152]=datostfg[grep2037,152]

grep31000=grep("4.3",datostfg2[,152])
datostfg2[grep31000,152]
datostfg2[grep31000[c(550)],152]
datostfg2[grep31000[c(550)],151]
grep32000=grep("409",datostfg2[,151])
table(datostfg2[grep32000,152]) ####El que tiene más probabilidad de ser el dato correcto es 403
datostfg2[grep31000[c(550)],152]="403"
grep2046=grep("4$",datostfg2[,152])
datostfg2[grep2046,152]
datostfg2[grep2046[c(753)],152]
datostfg2[grep2046[c(753)],151]

grep30000=grep("391",datostfg2[,151])
table(datostfg2[grep30000,152]) ####El más probable es 410
datostfg2[grep2046[c(753)],152]="410"
grep2046=grep("4$",datostfg2[,152])
datostfg2[grep2046,152]
datostfg2[grep2046[c(989)],152]
datostfg2[grep2046[c(989)],151]
grep33000=grep("351",datostfg2[,151])
table(datostfg2[grep33000,152])
datostfg2[grep2046[c(989)],152]="400"
grep2060=grep("40$",datostfg2[,152])
datostfg2[grep2060,152]
datostfg2[grep2060[c(38)],152]
datostfg2[grep2060[c(38)],151]
grep2061=grep("440",datostfg2[,151])
datostfg2[grep2061,152]
table(datostfg2[grep2061[-c(85)],152]) ###El más probable es 410
datostfg2[grep2060[c(38)],152]="410"
table(datostfg2[,152])
grep34000=grep("^1",datostfg2[,152])
datostfg2[grep34000,166]
datostfg2[grep34000,169]
grep40000=grep("^1",datostfg2[,152])
datostfg2[grep40000,152]
```

```{r,include=TRUE}
####Variable 153 (Aumento voltaje onda S)
####En caso de éxito presentará un 1
table(datostfg2[,153])
datostfg2[7141,153]=datostfg[7141,152]
datostfg2[706,153]=datostfg[706,152]
datostfg2[6272,166]=datostfg[6272,153]
datostfg2[129,163]=datostfg[129,153]
datostfg2[603,153] 
table(datostfg2[,153])

```

```{r,include=TRUE}
####Variable 154 (Aumento voltaje onda R)
####En caso de éxito presentará un 1
table(datostfg2[,154])
datostfg2[7141,154]=datostfg[7141,153]
datostfg2[706,154]=datostfg[706,153]
datostfg2[6272,167]=datostfg[6272,154]
datostfg2[129,154] ####Desplazar 10 posiciones
datostfg2[129,164]=datostfg[129,154]
datostfg2[603,154] 
table(datostfg2[,154])  

```

```{r,include=TRUE}
####Variable 155 (Onda T negativa en tres o más derivaciones)
####En caso de éxito presentará un 1
table(datostfg2[,155])
datostfg2[7141,155]=datostfg[7141,154]
datostfg2[706,155]=datostfg[706,154]
datostfg2[6272,168]=datostfg[6272,155] 
datostfg2[129,155] ####Desplazar 10 posiciones
datostfg2[129,165]=datostfg[129,155]
datostfg2[603,155] 
table(datostfg2[,155])

```

```{r,include=TRUE}
####Variable 156 (Crecimiento auricular)
####En caso de éxito presentará un 1
table(datostfg2[,156])
datostfg2[7141,156]=datostfg[7141,155]
datostfg2[706,156]=datostfg[706,155]
datostfg2[6272,169]=datostfg[6272,156] 
datostfg2[129,156] ####Desplazar 10 posiciones
datostfg2[129,166]=datostfg[129,156]
datostfg2[603,156] 
table(datostfg2[,156]) 

```

```{r,include=TRUE}
####Variable 157 (Ondas Q anormales)
####En caso de éxito presentará un 1
table(datostfg2[,157])
datostfg2[7141,157]=datostfg[7141,156]
datostfg2[706,157]=datostfg[706,156]
datostfg2[6272,170]=datostfg[6272,157]
datostfg2[129,157] ####Desplazar 10 posiciones
datostfg2[129,167]=datostfg[129,157]
datostfg2[603,157] 
table(datostfg2[,157])

```

```{r,include=TRUE}
####Variable 158 (Bloqueos de ramas con QRS>120ms)
####En caso de éxito presentará un 1
table(datostfg2[,158])
datostfg2[7141,158]=datostfg[7141,157]
datostfg2[706,158]=datostfg[706,157]
datostfg2[6272,171]=datostfg[6272,158]
datostfg2[129,158] ####Desplazar 10 posiciones
datostfg2[129,168]=datostfg[129,158]
datostfg2[603,158] 
grep15000=grep("1",datostfg2[,158])
datostfg2[grep15000,150]
table(datostfg2[,158])

```

```{r,include=TRUE}
####Variable 159 (Onda R o R´ en V1>0.5mV, relación R/S>1)
####En caso de éxito presentará un 1
table(datostfg2[,159])
datostfg2[7141,159]=datostfg[7141,158]
datostfg2[706,159]=datostfg[706,158]
datostfg2[6272,172]=datostfg[6272,159]
datostfg2[129,159] ####Desplazar 10 posiciones
datostfg2[129,169]=datostfg[129,159]
datostfg2[603,159] 
table(datostfg2[,159])  

```

```{r,include=TRUE}
####Variable 160 Alteraciones ST
####En caso de éxito presentará un 1
table(datostfg2[,160])
datostfg2[7141,160]=datostfg[7141,159]
datostfg2[706,160]=datostfg[706,159]
datostfg2[6272,173]=datostfg[6272,160]
datostfg2[129,160] 
datostfg2[129,170]=datostfg[129,160] 
datostfg2[603,160] 
table(datostfg2[,160])

```

```{r,include=TRUE}
####Variable 161 (Extrasístoles)
####En caso de éxito presentará un 1
table(datostfg2[,161])
datostfg2[7141,161]=datostfg[7141,160]
datostfg2[706,161]=datostfg[706,160]
datostfg2[6272,174]=datostfg[6272,161]
datostfg2[129,161]
datostfg2[129,171]=datostfg[129,161]
datostfg2[603,161] 
table(datostfg2[,161])  
grep1Extra=grep("1",datostfg2[,161])
datostfg2[grep1Extra,163]
####Hay fallos,vamos a solucionarlo con un bucle
for (i in 1:11984){comp=(datostfg2[i,161]=="1"&&
  is.na(datostfg2[i,163])==TRUE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,161]="0"
}else{
        datostfg2[i,161]=datostfg2[i,161]
}}

table(datostfg2[,161])
```

```{r,include=TRUE}
####Variable 162 (OndaTnegativa_Multi)

table(datostfg2[,162])
datostfg2[7141,162]=datostfg[7141,161]
datostfg2[706,162]=datostfg[706,161]
datostfg2[6272,162] 
datostfg2[129,172]= datostfg[129,162] 
datostfg2[603,162] 
table(datostfg2[,162])

```


```{r,include=TRUE}
####Variable 163 (Extrasístoles_multi)

table(datostfg2[,163])
datostfg2[7141,163]=datostfg[7141,162]
datostfg2[706,163]=datostfg[706,162]
datostfg2[6272,163] 
datostfg2[129,173]=datostfg[129,163]
datostfg2[603,163] 
grep1001=grep("Extra",datostfg2[,163])
datostfg2[grep1001,163]
datostfg2[grep1001,161]
table(datostfg2[,163])
####Bucle
for (i in 1:11984){comp=(
  is.na(datostfg2[i,163])==FALSE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,161]="1"
}else{
        datostfg2[i,161]="0"
}}
grep1001=grep("Extra",datostfg2[,163])
datostfg2[grep1001,163]
datostfg2[grep1001,161]
table(datostfg2[,161])

for (i in 1:11984){comp=(
  is.na(datostfg[i,161])==TRUE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,161]=NA
}else{
        datostfg2[i,161]=datostfg2[i,161]
}}
table(datostfg2[,161])
datostfg2[7141,161]=datostfg[7141,160]
datostfg2[706,161]=datostfg[706,160]
datostfg2[6272,161]=datostfg[6272,148] 
datostfg2[129,161]=datostfg[129,151]
table(datostfg2[,161])####Con esta última parte he recuperado algunos NA que habia eliminado.
grep1Extra=grep("1",datostfg2[,161])
datostfg2[grep1Extra,163]
```

```{r,include=TRUE}
####Variable 164 (list_RITMO)

table(datostfg2[,164])
datostfg2[7141,164]=datostfg[7141,163]
datostfg2[706,164]=datostfg[706,163]
datostfg2[6272,164] 
datostfg2[129,174]=datostfg[129,164]
datostfg2[603,164]
table(datostfg2[,164])
grep1002=grep("Bradi",datostfg2[,164])
datostfg2[,164]=replace(datostfg2[,164],grep1002,"Bradicárdico")
grep15002=grep("42",datostfg2[,164])
datostfg2[grep15002,164]
grep15003=grep("43",datostfg2[,164])
datostfg2[grep15003,164]
table(datostfg2[,164])

  

```

```{r,include=TRUE}
####Variable 165 (fecha_MEDINT_electro) Fecha de realización del electrocardiograma electrocardiograma

table(datostfg2[,165])
datostfg2[7141,165]=datostfg[7141,164]
datostfg2[706,165]=datostfg[706,164]
datostfg2[6272,165] 
datostfg2[129,165] 
datostfg2[603,165]
table(datostfg2[,165])  ####Variable revisada,todo está ya bien

```

```{r,include=TRUE}
####Variable 165 (comentariosElectro_txt) 

table(datostfg2[,166])
datostfg2[7141,166]=datostfg[7141,165]
datostfg2[706,166]=datostfg[706,165]
datostfg2[6272,166] 
datostfg2[129,166] 
datostfg2[603,166]
table(datostfg2[,166])  ####Variable revisada,todo está ya bien

```

```{r,include=TRUE}
####Variable 167 (Pendiente de realización) :Pacientes a los que aún no se les ha realizado el electrocardiograma.

table(datostfg2[,167])
datostfg2[7141,167]=datostfg[7141,166]
datostfg2[706,167]=datostfg[706,166]
datostfg2[6272,167] 
datostfg2[129,167] 
datostfg2[603,167]
table(datostfg2[,167]) ####Variable revisada,todo está ya bien


```

```{r,include=TRUE}
####Variable 168 (OtrosHall) :Otros Hallazgos.

table(datostfg2[,168])

datostfg2[7141,168]=datostfg[7141,167]
datostfg2[706,168]=datostfg[706,167]
datostfg2[6272,168] 
datostfg2[129,168] 
datostfg2[603,168]

table(datostfg2[,168])  ####Examinar

```
```{r,include=TRUE}
####Variable 169 (recomendaciones_txt)

table(datostfg2[,169])
datostfg2[7141,169]=datostfg[7141,168]
datostfg2[706,169]=datostfg[706,168]
datostfg2[6272,169] 
datostfg2[129,169] 
datostfg2[603,169]
table(datostfg2[,169])


```
```{r,include=TRUE}
####Variable 170 (RecomProx_txt):Recomendaciones a corto plazo

table(datostfg2[,170])
datostfg2[7141,170]=datostfg[7141,169]
datostfg2[706,170]=datostfg[706,169]
datostfg2[6272,170] 
datostfg2[129,170] 
datostfg2[603,170]
table(datostfg2[,170])


```



```{r,include=TRUE}
####Variable 171(deporte): Deporte que practica cada paciente.

table(datostfg2[,171])

datostfg2[7141,171]=datostfg[7141,170]
datostfg2[706,171]=datostfg[706,170]
datostfg2[6272,171] 
datostfg2[129,171] 
datostfg2[603,171]

table(datostfg2[,171])
grep1003=grep("13",datostfg2[,171]) ###Caso 11124
datostfg2[grep1003,170]
datostfg2[grep1003,171]=datostfg2[grep1003,170]
datostfg2[grep1003,170]=NA
grep1004=grep("25",datostfg2[,171]) ###Caso 1504
datostfg2[grep1004,170]
datostfg2[grep1004,171]=datostfg2[grep1004,170]
datostfg2[grep1004,170]=NA
table(datostfg2[,171])
```

```{r,include=TRUE}
####Variable 172 Edad Paciente

table(datostfg2[,172])
datostfg2[7141,172]=datostfg[7141,171]
datostfg2[706,172]=datostfg[706,171]
datostfg2[6272,172] 
datostfg2[129,172] 
datostfg2[603,172]
table(datostfg2[,172])
grep1005=grep("^0",datostfg2[,172]) ###Caso 11124
datostfg2[grep1005,172]
datostfg2[grep1005,127] ####Revisar si ambas variables son iguales,en ese caso sustituir
datostfg[grep1003,171]
grep1004=grep("25",datostfg2[,171]) ###Caso 1504

```

```{r,include=TRUE}
####Variable 173 (Entrenador si/no)

table(datostfg2[,173])
datostfg2[7141,173]=datostfg[7141,172]
datostfg2[706,173]=datostfg[706,172]
datostfg2[6272,173] 
datostfg2[129,173] 
datostfg2[603,173]
table(datostfg2[,173])



```

```{r,include=TRUE,echo=FALSE}
####Variable 174 Pulsómetro si/no

table(datostfg2[,174])
datostfg2[7141,174]=datostfg[7141,173]
datostfg2[706,174]=datostfg[706,173]
datostfg2[6272,174] 
datostfg2[129,174] 
datostfg2[603,174]
table(datostfg2[,174])


datostfg2[,179]=c(rep(NA,11984))
datostfg2[,180]=c(rep(NA,11984))
datostfg2[,169]=datostfg[,169]
datostfg2[6272,169]=datostfg[6272,156]
datostfg2[7141,169]=datostfg[7141,168]
datostfg2[706,169]=datostfg[706,168]
datostfg2[129,169]=datostfg[129,159]
for (i in 1:11984){comp=(
  is.na(datostfg2[i,169])==TRUE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,180]="0"
}else{
        datostfg2[i,180]="1"
}}
table(datostfg2[,180])###Hay 10129 registros
grep8000=grep("1",datostfg2[,180])
datostfg2[grep8000[1:1000],169]
datostfg2[grep8000[1001:2000],169]
datostfg2[grep8000[2001:3000],169]
datostfg2[grep8000[3001:4000],169]
datostfg2[grep8000[4001:5000],169] 
datostfg2[grep8000[5001:6000],169] 
datostfg2[grep8000[6001:7000],169] 
datostfg2[grep8000[7001:8000],169] 
datostfg2[grep8000[8001:9000],169]
datostfg2[grep8000[9001:10000],169]
datostfg2[grep8000[10001:10129],169]

####Vamos a repasar los casos grises
datostfg2[grep8000,179]="0"
table(datostfg2[,179])
datostfg2[grep8000[c(10, 27, 41, 47, 48, 50, 87, 91, 96, 105, 106, 124, 125, 146, 150, 151, 164, 171, 176, 182,192, 197, 235, 236, 240, 242, 264, 268, 270, 283, 302, 317, 330, 360, 366, 374, 394,387, 412, 426, 428, 438, 451, 467, 468, 477, 510, 511, 512, 513, 529, 533, 554, 574,592, 603, 621, 651, 653, 658, 662, 679, 687, 703, 706, 712, 713, 760, 774, 778,785,805, 811, 814, 816, 817, 819, 820, 824, 826, 836, 839, 846, 849, 850, 851, 852,854, 855, 859, 880, 881, 892, 896, 900, 906, 908, 912, 935, 938, 955, 965, 973, 986,989, 993)],169]
datostfg2[grep8000[c(10, 27, 41, 47, 48, 50, 87, 91, 96, 105, 106, 124, 125, 146, 150, 151, 164, 171, 176, 182,192, 197, 235, 236, 240, 242, 264, 268, 270, 283, 302, 317, 330, 360, 366, 374, 394,387, 412, 426, 428, 438, 451, 467, 468, 477, 510, 511, 512, 513, 529, 533, 554, 574,592, 603, 621, 651, 653, 658, 662, 679, 687, 703, 706, 712, 713, 760, 774, 778,785,805, 811, 814, 816, 817, 819, 820, 824, 826, 836, 839, 846, 849, 850, 851, 852,854, 855, 859, 880, 881, 892, 896, 900, 906, 908, 912, 935, 938, 955, 965, 973, 986,989, 993)],179]="1"

datostfg2[grep8000[c(1164, 1170, 1182, 1184, 1202, 1204, 1215, 1223, 1235, 1239, 1249, 1256, 1262, 1274, 1281, 1306, 1307, 1309, 1314, 1317, 1328, 1349, 1353, 1374, 1384, 1397, 1416, 1419, 1424, 1434, 1437, 1446, 1447, 1452, 1462, 1464, 1472, 1473, 1479, 1495, 1496, 1501, 1508, 1525, 1527, 1531, 1534, 1537, 1548, 1582, 1591, 1602, 1619, 1668, 1673, 1694, 1722, 1727, 1738, 1740, 1743, 1776, 1777, 1786, 1794, 1806, 1808, 1813, 1830, 1835, 1844, 1848, 1851, 1876, 1885, 1886, 1923, 1932,1939, 1950, 1951,1956, 1970, 1982, 1988,1963)],169]

datostfg2[grep8000[c(1164, 1170, 1182, 1184, 1202, 1204, 1215, 1223, 1235, 1239, 1249, 1256, 1262, 1274, 1281, 1306, 1307, 1309, 1314, 1317, 1328, 1349, 1353, 1374, 1384, 1397, 1416, 1419, 1424, 1434, 1437, 1446, 1447, 1452, 1462, 1464, 1472, 1473, 1479, 1495, 1496, 1501, 1508, 1525, 1527, 1531, 1534, 1537, 1548, 1582, 1591, 1602, 1619, 1668, 1673, 1694, 1722, 1727, 1738, 1740, 1743, 1776, 1777, 1786, 1794, 1806, 1808, 1813, 1830, 1835, 1844, 1848, 1851, 1876, 1885, 1886, 1923, 1932, 1939, 1950,1951,1956, 1970, 1982, 1988,1963)],179]="1"

datostfg2[grep8000[c(2015, 2031, 2046, 2047, 2054, 2064, 2068, 2072, 2102, 2112, 2144, 2182, 2201, 2203, 2212, 2235, 2266, 2267, 2319, 2356, 2364, 2365, 2372, 2379, 2382, 2405, 2409, 2436, 2448, 2459, 2469,2470, 2500, 2529, 2535, 2545, 2547, 2551, 2553, 2563, 2568, 2569, 2571, 2579, 2580, 2581, 2585, 2595, 2612, 2621,  2630, 2667, 2684, 2685, 2687, 2721, 2723, 2743, 2757, 2773, 2804, 2819, 2822, 2825, 2845, 2849, 2867, 2913, 2951, 2979, 2996,3000)],169]

datostfg2[grep8000[c(2015, 2031, 2046, 2047, 2054, 2064, 2068, 2072, 2102, 2112, 2144, 2182, 2201, 2203, 2212, 2235, 2266, 2267, 2319, 2356, 2364, 2365, 2372, 2379, 2382, 2405, 2409, 2436, 2448, 2459, 2469,2470, 2500, 2529, 2535, 2545, 2547, 2551, 2553, 2563, 2568, 2569, 2571, 2579, 2580, 2581, 2585, 2595, 2612, 2621,  2630, 2667, 2684, 2685, 2687, 2721, 2723, 2743, 2757, 2773, 2804, 2819, 2822, 2825, 2845, 2849, 2867, 2913, 2951, 2979, 2996,3000)],179]="1"


datostfg2[grep8000[c(3005, 3006, 3015, 3017, 3029, 3032, 3041, 3044, 3059, 3075, 3077, 3083, 3085, 3102, 3106, 3111, 3127, 3129, 3145, 3150, 3158, 3186, 3188, 3200, 3201, 3203, 3210, 3217, 3220, 3230, 3231, 3239, 3268, 3283, 3289, 3296, 3324, 3325, 3332, 3334, 3345, 3353, 3354, 3356, 3364, 3374, 3377, 3378, 3379, 3384, 3395, 3422, 3425, 3452, 3455, 3484, 3500, 3502, 3507, 3511, 3518, 3518, 3519, 3520, 3523, 3538, 3539, 3542, 3543, 3551, 3556, 3574, 3583, 3592, 3599, 3602, 3615, 3622, 3635, 3660, 3671, 3672, 3676, 3684, 3700, 3709, 3710, 3719, 3726, 3728, 3744, 3754, 3780, 3794, 3800, 3803, 3804, 3815, 3827, 3844, 3846, 3852, 3859, 3860, 3869, 3870, 3874, 3886, 3888, 3892, 3904, 3905, 3906, 3914, 3922, 3942, 3943, 3948, 3960, 3964, 3965, 3986, 3987, 3994, 3999)],169]

datostfg2[grep8000[c(3005, 3006, 3015, 3017, 3029, 3032, 3041, 3044, 3059, 3075, 3077, 3083, 3085, 3102, 3106, 3111, 3127, 3129, 3145, 3150, 3158, 3186, 3188, 3200, 3201, 3203, 3210, 3217, 3220, 3230, 3231, 3239, 3268, 3283, 3289, 3296, 3324, 3325, 3332, 3334, 3345, 3353, 3354, 3356, 3364, 3374, 3377, 3378, 3379, 3384, 3395, 3422, 3425, 3452, 3455, 3484, 3500, 3502, 3507, 3511, 3518, 3518, 3519, 3520, 3523, 3538, 3539, 3542, 3543, 3551, 3556, 3574, 3583, 3592, 3599, 3602, 3615, 3622, 3635, 3660, 3671, 3672, 3676, 3684, 3700, 3709, 3710, 3719, 3726, 3728, 3744, 3754, 3780, 3794, 3800, 3803, 3804, 3815, 3827, 3844, 3846, 3852, 3859, 3860, 3869, 3870, 3874, 3886, 3888, 3892, 3904, 3905, 3906, 3914, 3922, 3942, 3943, 3948, 3960, 3964, 3965, 3986, 3987, 3994, 3999)],179]="1"

datostfg2[grep8000[c(4005, 4013, 4036, 4039, 4041, 4047, 4053, 4062, 4076, 4081, 4086, 4095, 4108, 4111, 4119, 4122, 4149, 4152, 4166, 4170, 4172, 4197, 4198, 4206, 4207, 4213,4229, 4241, 4251, 4257, 4273, 4281, 4313, 4316, 4337, 4340, 4348, 4366, 4410, 4427, 4433, 4449, 4458, 4487, 4496, 4513, 4517, 4567, 4568, 4585, 4613, 4620, 4638, 4643, 4645, 4648, 4650, 4652, 4654, 4659, 4674, 4696, 4723, 4731, 4734, 4761, 4779, 4810, 4816, 4841, 4870, 4871, 4876, 4880, 4920, 4923, 4928, 4950, 4981, 4986, 4995, 4999)],169]

datostfg2[grep8000[c(4005, 4013, 4036, 4039, 4041, 4047, 4053, 4062, 4076, 4081, 4086, 4095, 4108, 4111, 4119, 4122, 4149, 4152, 4166, 4170, 4172, 4197, 4198, 4206, 4207, 4213,4229, 4241, 4251, 4257, 4273, 4281, 4313, 4316, 4337, 4340, 4348, 4366, 4410, 4427, 4433, 4449, 4458, 4487, 4496, 4513, 4517, 4567, 4568, 4585, 4613, 4620, 4638, 4643, 4645, 4648, 4650, 4652, 4654, 4659, 4674, 4696, 4723, 4731, 4734, 4761, 4779, 4810, 4816, 4841, 4870, 4871, 4876, 4880, 4920, 4923, 4928, 4950, 4981, 4986, 4995, 4999)],179]="1"

datostfg2[grep8000[c(5003, 5022, 5030, 5032, 5039, 5042, 5043, 5059, 5067, 5072, 5089, 5098, 5107, 5109, 5115, 5118, 5131, 5145, 5148, 5154, 5162, 5163, 5164, 5186, 5188, 5191, 5242, 5256, 5276, 5278, 5281, 5296, 5297, 5310, 5317, 5321, 5322, 5323, 5326, 5336, 5350, 5358, 5380, 5397, 5402, 5404, 5434, 5439, 5448, 5459, 5466, 5470, 5496, 5511, 5514, 5527, 5556, 5569, 5578, 5588, 5592, 5593, 5595, 5597, 5611, 5629, 5662, 5671, 5684, 5699, 5756, 5781, 5795, 5798, 5819, 5820, 5839, 5876, 5893, 5897, 5925, 5936, 5949, 5968, 5999)],169]

datostfg2[grep8000[c(5003, 5022, 5030, 5032, 5039, 5042, 5043, 5059, 5067, 5072, 5089, 5098, 5107, 5109, 5115, 5118, 5131, 5145, 5148, 5154, 5162, 5163, 5164, 5186, 5188, 5191, 5242, 5256, 5276, 5278, 5281, 5296, 5297, 5310, 5317, 5321, 5322, 5323, 5326, 5336, 5350, 5358, 5380, 5397, 5402, 5404, 5434, 5439, 5448, 5459, 5466, 5470, 5496, 5511, 5514, 5527, 5556, 5569, 5578, 5588, 5592, 5593, 5595, 5597, 5611, 5629, 5662, 5671, 5684, 5699, 5756, 5781, 5795, 5798, 5819, 5820, 5839, 5876, 5893, 5897, 5925, 5936, 5949, 5968, 5999)],179]="1"

datostfg2[grep8000[c(6008, 6009, 6023, 6034, 6056, 6076, 6079, 6083, 6094, 6099, 6114, 6119, 6121, 6126, 6148, 6149, 6153, 6160, 6212, 6213, 6250, 6284, 6285, 6299, 6317, 6358, 6360, 6383, 6393, 6405, 6416, 6420, 6430, 6442, 6466, 6494, 6529, 6570, 6627, 6638, 6668, 6669, 6689, 6710, 6714, 6724, 6734, 6790, 6802, 6828, 6853, 6862, 6864, 6924, 6947, 6952, 6970, 6980, 6984, 6997)],169]

datostfg2[grep8000[c(6008, 6009, 6023, 6034, 6056, 6076, 6079, 6083, 6094, 6099, 6114, 6119, 6121, 6126, 6148, 6149, 6153, 6160, 6212, 6213, 6250, 6284, 6285, 6299, 6317, 6358, 6360, 6383, 6393, 6405, 6416, 6420, 6430, 6442, 6466, 6494, 6529, 6570, 6627, 6638, 6668, 6669, 6689, 6710, 6714, 6724, 6734, 6790, 6802, 6828, 6853, 6862, 6864, 6924, 6947, 6952, 6970, 6980, 6984, 6997)],179]="1"

datostfg2[grep8000[c(9002, 9011, 9018, 9045, 9052, 9087, 9090, 9099,9106, 9111, 9116, 9133, 9146, 9149, 9156, 9186, 9226, 9272, 9281, 9282, 9293, 9296, 9326, 9328, 9329, 9345,9349, 9351, 9415, 9428, 9533, 9591, 9592, 9599, 9611, 9615, 9637, 9647, 9671, 9672, 9680, 9683, 9687, 9691, 9702, 9709, 9721, 9732, 9743, 9747, 9749, 9756, 9765, 9789, 9790, 9792, 9794, 9852, 9855, 9862, 9866, 9884, 9910, 9915, 9925, 9934, 9949, 9956, 9961, 9966, 9976, 9982, 9993)],169]

datostfg2[grep8000[c(9002, 9011, 9018, 9045, 9052, 9087, 9090, 9099,9106, 9111, 9116, 9133, 9146, 9149, 9156, 9186, 9226, 9272, 9281, 9282, 9293, 9296, 9326, 9328, 9329, 9345,9349, 9351, 9415, 9428, 9533, 9591, 9592, 9599, 9611, 9615, 9637, 9647, 9671, 9672, 9680, 9683, 9687, 9691, 9702, 9709, 9721, 9732, 9743, 9747, 9749, 9756, 9765, 9789, 9790, 9792, 9794, 9852, 9855, 9862, 9866, 9884, 9910, 9915, 9925, 9934, 9949, 9956, 9961, 9966, 9976, 9982, 9993)],179]="1"

datostfg2[grep8000[c(7008,7016,7025,7042,7043,7063,7078,7079,7111,7116,7128,7141,7145,7175,7177,7183,7198,7199,7202,7215,7235,7250,7270,7282,7283,7300,7312,7318,7320,7344,7347,7349,7353,7357,7392,7397,7439,7453,7454,7495,7498,7503,7513,7532,7536,7542,7555,7562,7563,7574,7586,7600,7604,7608,7617,7618,7633,7635,7643,7657,7676,7686,7689,7692,7698,7700,7703,7708,7723,7739,7745,7748,7754,7756,7760,7767,7779,7787,7788,7793,7802,7807,7826,7827,7828,7831,7849,7852,7856,7867,7868,7870,7871,7873,7874,7883,7888,7894,7899,7914,7923,7937,7933,7947,7975,7978,7980,7992)],169]

datostfg2[grep8000[c(7008,7016,7025,7042,7043,7063,7078,7079,7111,7116,7128,7141,7145,7175,7177,7183,7198,7199,7202,7215,7235,7250,7270,7282,7283,7300,7312,7318,7320,7344,7347,7349,7353,7357,7392,7397,7439,7453,7454,7495,7498,7503,7513,7532,7536,7542,7555,7562,7563,7574,7586,7600,7604,7608,7617,7618,7633,7635,7643,7657,7676,7686,7689,7692,7698,7700,7703,7708,7723,7739,7745,7748,7754,7756,7760,7767,7779,7787,7788,7793,7802,7807,7826,7827,7828,7831,7849,7852,7856,7867,7868,7870,7871,7873,7874,7883,7888,7894,7899,7914,7923,7937,7933,7947,7975,7978,7980,7992)],179]="1"

datostfg2[grep8000[c(8027,8029,8036,8038,8046,8055,8082,8098,8102,8108,8130,8145,8176,8195,8199,8204,8210,8211,8223,8224,8225,8227,8228,8254,8285,8293,8301,8302,8304,8305,8310,8331,8346,8376,8408,8417,8418,8421,8431,8444,8450,8373,8380,8471,8483,8487,8500,8749,8751,8760,8783,8798,8809,8856,8872,8881,8904,8916,8922,8925,8926,8937,8942,8943,8946,8948,8951,8952,8953,8954,8961,8972,8974,8978,8983,8500,8533,8535,8542,8555,8556,8568,8572,8578,8596,8605,8610,8611,8618,8631,8634,8639,8647,8660,8671,8678,8679,8694,8725,8732,8733,8988,10124,10110,10084,10079,10069,10068,10064,10059,10054,10047,10041,10016,10008,10005)],169]


datostfg2[grep8000[c(8027,8029,8036,8038,8046,8055,8082,8098,8102,8108,8130,8145,8176,8195,8199,8204,8210,8211,8223,8224,8225,8227,8228,8254,8285,8293,8301,8302,8304,8305,8310,8331,8346,8376,8408,8417,8418,8421,8431,8444,8450,8373,8380,8471,8483,8487,8500,8749,8751,8760,8783,8798,8809,8856,8872,8881,8904,8916,8922,8925,8926,8937,8942,8943,8946,8948,8951,8952,8953,8954,8961,8972,8974,8978,8983,8500,8533,8535,8542,8555,8556,8568,8572,8578,8596,8605,8610,8611,8618,8631,8634,8639,8647,8660,8671,8678,8679,8694,8725,8732,8733,8988,10124,10110,10084,10079,10069,10068,10064,10059,10054,10047,10041,10016,10008,10005)],179]="1"

table(datostfg2[,179])

####Vamos a repasar ahora los casos con recomendaciones sobre la presion arterial
datostfg2[grep8000[c(49, 129, 161, 189, 190, 216, 223, 278, 307, 311, 351, 381, 411, 453, 458, 459, 490, 504, 508, 520, 532, 545, 547, 561, 564, 572, 577, 586, 595, 616, 623, 669, 688, 700, 726, 732, 741, 751, 754, 771, 780, 810, 847, 867, 877, 887, 913, 932, 937, 966, 974,1137, 1140, 1150, 1173, 1175, 1195, 1143, 1177, 1178, 1181, 1225, 1245, 1247, 1257, 1268, 1291, 1303, 1344, 1348, 1356, 1358, 1398, 1408, 1422, 1476, 1477, 1478, 1488, 1535, 1544, 1568, 1578, 1586, 1629, 1643, 1650, 1762, 1771, 1795, 1869, 1877, 1910, 1915, 1919, 1929, 1939, 1966,2021, 2024, 2196, 2292, 2305, 2348, 2504, 2512, 2606, 2636, 2675, 2700, 2736, 2833, 2877,2887, 2940, 2999,3046, 3069, 3088, 3276, 3302, 3322, 3392, 3409, 3449, 3453, 3454, 3496, 3527, 3558, 3613, 3618, 3633, 3650, 3652, 3687, 3694, 3696, 3699, 3708, 3721, 3753, 3769, 3854, 3877, 3901, 3912, 3950, 3962, 3978, 3980,4020, 4021, 4030, 4031, 4051, 4089, 4286, 4298, 4403, 4519, 4537, 4658, 4665, 4782, 4879, 4931, 4951, 4960,5014, 5016, 5122, 5142, 5153, 5160, 5161, 5190, 5245, 5312, 5360, 5493, 5649,6003, 6055, 6082, 6207, 6217, 6308, 6356, 6489, 6633, 6667, 6733, 6792, 6797, 6820, 6821, 6874, 6902, 6949, 6976,9006, 9051, 9058, 9059, 9061, 9207, 9279, 9290, 9311, 9361, 9387, 9423, 9481, 9484, 9486, 9681,9725, 9731, 9820, 9851, 9913, 9938, 9954, 7031,7056,7107,7142,7205,7279,7285,7319,7366,7389,7428,7442,7474,7504,7558,7565,7571,7587,7627,7629,7661,7677,7687,7707,7768,7838,7880,7938,7967,7972,7982,8003,8048,8093,8095,8134,8197,8212,8214,8260,8274,8289,8321,8384,8410,8345,8451,8467,8493,8496,8516,8517,8530,8581,8598,8626,8734,8854,8886,8909,8911,10058)],169]


datostfg2[grep8000[c(49, 129, 161, 189, 190, 216, 223, 278, 307, 311, 351, 381, 411, 453, 458, 459, 490, 504, 508, 520, 532, 542, 547, 561, 564, 572, 577, 586, 595, 616, 623, 669, 688, 700, 726, 732, 741, 751, 754, 771, 780, 810, 847, 867, 877, 887, 913, 932, 937, 966, 974,1137, 1140, 1150, 1173, 1175, 1195, 1143, 1177, 1178, 1181, 1225, 1245, 1247, 1257, 1268, 1291, 1303, 1344, 1348, 1356, 1358, 1398, 1408, 1422, 1476, 1477, 1478, 1488, 1535, 1544, 1568, 1578, 1586, 1629, 1643, 1650, 1762, 1771, 1795, 1869, 1877, 1910, 1915, 1919, 1929, 1939, 1966,2021, 2024, 2196, 2292, 2305, 2348, 2504, 2512, 2606, 2636, 2675, 2700, 2736, 2833, 2877,2887, 2940, 2999,3046, 3069, 3088, 3276, 3302, 3322, 3392, 3409, 3449, 3453, 3454, 3496, 3527, 3558, 3613, 3618, 3633, 3650, 3652, 3687, 3694, 3696, 3699, 3708, 3721, 3753, 3769, 3854, 3877, 3901, 3912, 3950, 3962, 3978, 3980,4020, 4021, 4030, 4031, 4051, 4089, 4286, 4298, 4403, 4519, 4537, 4658, 4665, 4782, 4879, 4931, 4951, 4960,5014, 5016, 5122, 5142, 5153, 5160, 5161, 5190, 5245, 5312, 5360, 5493, 5649,6003, 6055, 6082, 6207, 6217, 6308, 6356, 6489, 6633, 6667, 6733, 6792, 6797, 6820, 6821, 6874, 6902, 6949, 6976,9006, 9051, 9058, 9059, 9061, 9207, 9279, 9290, 9311, 9361, 9387, 9423, 9481, 9484, 9486, 9681,9725, 9731, 9820, 9851, 9913, 9938, 9954, 7031,7056,7107,7142,7205,7279,7285,7319,7366,7389,7428,7442,7474,7504,7558,7565,7571,7587,7627,7629,7661,7677,7687,7707,7768,7838,7880,7938,7967,7972,7982,8003,8048,8093,8095,8134,8197,8212,8214,8260,8274,8289,8321,8384,8410,8345,8451,8467,8493,8496,8516,8517,8530,8581,8598,8626,8734,8854,8886,8909,8911,10058)],179]="2"

####Vamos a repasar los que contienen algún consejo respiratorio
datostfg2[grep8000[c(24, 26, 85, 122, 166, 180, 204, 251, 435, 448, 478, 486, 518, 776, 902, 923, 948, 995,1062, 1068, 1101, 1121, 1188, 1205, 1207, 1369, 1393, 1394, 1404, 1409, 1417, 1468, 1489, 1506, 1519, 1530, 1543, 1626, 1647, 1655, 1701, 1735, 1769, 1774, 1815, 1827, 1867, 1875, 1883, 1898, 1913, 1953, 1984, 1995,2003, 2397, 2462, 2481, 2536, 2573, 2651, 2694,3011, 3128, 3161, 3162, 3225, 3229, 3238, 3255, 3304, 3376, 3563,4060, 4126, 4387, 4641, 4655, 4822, 4837, 4878,5086, 5110, 5211, 5395, 5438, 5453, 5469, 5543, 5580, 5869, 5948, 5999,6049, 6064, 6115, 6127, 6168, 6252, 6268, 6269, 6309, 6388, 6389, 6395, 6407, 6493, 6603, 6604, 6713, 6774, 6827, 6865,9060, 9137, 9173, 9278, 9364, 9365, 9377, 9406, 9417, 9420, 9429, 9449, 9639, 9698, 9717, 9746, 9754, 9787, 9819, 9877, 9893, 9894, 9926, 9977, 9998,7112,7126,7131,7147,7178,7306,7325,7328,7375,7425,7516,7567,7565,7607,7612,7631,7642,7658,7730,7751,7765,7808,7819,7825,7837,7858,7885,7893,7971,8002,8240,8256,8268,8335,8362,8369,8395,8174,8366,8480,8481,8473,8495,8512,8569,8579,8627,8629,8640,8649,8705,8712,8724,8752,8794,8820,8866,8883,8939,8940,8962,8967,8984,10105,10007)],169]


datostfg2[grep8000[c(24, 26, 85, 122, 166, 180, 204, 251, 435, 448, 478, 486, 518, 776, 902, 923, 948, 995,1062, 1068, 1101, 1121, 1188, 1205, 1207, 1369, 1393, 1394, 1404, 1409, 1417, 1468, 1489, 1506, 1519, 1530, 1543, 1626, 1647, 1655, 1701, 1735, 1769, 1774, 1815, 1827, 1867, 1875, 1883, 1898, 1913, 1953, 1984, 1995,2003, 2397, 2462, 2481, 2536, 2573, 2651, 2694,3011, 3128, 3161, 3162, 3225, 3229, 3238, 3255, 3304, 3376, 3563,4060, 4126, 4387, 4641, 4655, 4822, 4837, 4878,5086, 5110, 5211, 5395, 5438, 5453, 5469, 5543, 5580, 5869, 5948, 5999,6049, 6064, 6115, 6127, 6168, 6252, 6268, 6269, 6309, 6388, 6389, 6395, 6407, 6493, 6603, 6604, 6713, 6774, 6827, 6865,9060, 9137, 9173, 9278, 9364, 9365, 9377, 9406, 9417, 9420, 9429, 9449, 9639, 9698, 9717, 9746, 9754, 9787, 9819, 9877, 9893, 9894, 9926, 9977, 9998,7112,7126,7131,7147,7178,7306,7325,7328,7375,7425,7516,7567,7565,7607,7612,7631,7642,7658,7730,7751,7765,7808,7819,7825,7837,7858,7885,7893,7971,8002,8240,8256,8268,8335,8362,8369,8395,8174,8366,8480,8481,8473,8495,8512,8569,8579,8627,8629,8640,8649,8705,8712,8724,8752,8794,8820,8866,8883,8939,8940,8962,8967,8984,10105,10007)],179]="3"
table(datostfg2[,179])

####Vamos a revisar los que tienen alguna contraindicación, al menos relativa.

datostfg2[grep8000[c(107, 413, 460, 638, 642, 654, 656, 674, 681, 696, 723, 758, 767, 828, 830, 853, 903, 917, 919, 920, 922, 957,1325, 1435, 1500, 1615, 1760,2114, 2332, 2564,3199, 3218, 3223, 3316, 3411, 3415, 3418, 3442, 3447, 3492, 3516, 3529, 3530, 3554, 3683, 3757, 3801, 3921,3945,4010, 4072, 4136, 4406, 4417, 4483, 4499, 4557, 4642, 4663, 4688, 4708, 4716, 4799, 4867, 4935, 4952,5009, 5021, 5049, 5168, 5175, 5220, 5455, 5829,6021, 6165, 6307, 6384, 6427, 6463, 6501, 6592, 6665, 6782, 6839,9181, 9570, 9742, 9803,7020,7221,7243,7244,7281,7394,7409,7443,7445,7463,7696,7705,7721,7772,7822,7863,7864,7886,7959,7965,8007,8033,8044,8050,8062,8154,8171,8391,8499,8526,8630,8689,8705,8711,8956,10111)],169]

datostfg2[grep8000[c(107, 413, 460, 638, 642, 654, 656, 674, 681, 696, 723, 758, 767, 828, 830, 853, 903, 917, 919, 920, 922, 957,1325, 1435, 1500, 1615, 1760,2114, 2332, 2564,3199, 3218, 3223, 3316, 3411, 3415, 3418, 3442, 3447, 3492, 3516, 3529, 3530, 3554, 3683, 3757, 3801, 3921,3945,4010, 4072, 4136, 4406, 4417, 4483, 4499, 4557, 4642, 4663, 4688, 4708, 4716, 4799, 4867, 4935, 4952,5009, 5021, 5049, 5168, 5175, 5220, 5455, 5829,6021, 6165, 6307, 6384, 6427, 6463, 6501, 6592, 6665, 6782, 6839,9181, 9570, 9742, 9803,7020,7221,7243,7244,7281,7394,7409,7443,7445,7463,7696,7705,7721,7772,7822,7863,7864,7886,7959,7965,8007,8033,8044,8050,8062,8154,8171,8391,8499,8526,8630,8689,8705,8711,8956,10111)],179]="4"


####Voy a corregir errores que he cometido al asignar cada caso a su grupo correspondiente.

datostfg2[grep8000[c(240,850,2046,2553,2469,4241)],169]
datostfg2[grep8000[c(240,850,2046,2382,2553,2469,4241)],179] ####Corresponden a recomendaciones arteriales
datostfg2[grep8000[c(240,850,2046,2382,2553,2469,4241)],179]="2"

datostfg2[grep8000[c(50,87,283,1419,1479,3815,3353,4674,4340,9765,9756,9749,7827)],169]
datostfg2[grep8000[c(50,87,283,1419,1479,3815,3353,4674,4340,9765,9756,9749,7827)],179] ####Corresponden a contraindicaciones relativas
datostfg2[grep8000[c(50,87,283,1419,1479,3815,3353,4674,4340,9765,9756,9749,7827)],179]="4"

datostfg2[grep8000[c(5999)],169]
datostfg2[grep8000[c(5999)],179]="3" ###Respiratorio

datostfg2[grep8000[c(9099,2015,1495,4816,4871,4870,8983,8953)],169]
datostfg2[grep8000[c(9099,2015,1495,4816,4871,4870,8983,8953)],166]
datostfg2[grep8000[c(2015,4816,4871,4870,8983,8953)],179]="0"
datostfg2[grep8000[c(9099,1495)],179]="1"

datostfg2[grep8000[c(3502,3203)],169]
datostfg2[grep8000[c(3502,3203)],166]
datostfg2[grep8000[c(3502)],179]="0"
datostfg2[grep8000[c(3203)],179]="5"

datostfg2[grep8000[c(6802,6724,6494,9862)],169]
datostfg2[grep8000[c(6802,6724,6494,9862)],166]

datostfg2[grep8000[c(6724,6494)],179]="1"
datostfg2[grep8000[c(9862)],179]="2"

datostfg2[grep8000[c(387)],169]
datostfg2[grep8000[c(387)],179]="0"

datostfg2[grep8000[c(1239,3615,3592,5819)],169]
datostfg2[grep8000[c(1239,3615,3592,5819)],179]="4" ###Contraindicación relativa

datostfg2[grep8000[c(8036)],169]
datostfg2[grep8000[c(8036)],179]="4"

grep9000=grep8000[c(49, 129, 161, 189, 190, 216, 223, 278, 307, 311, 351, 381, 411, 453, 458, 459, 490, 504, 508, 520, 532, 542, 547, 561, 564, 572, 577, 586, 595, 616, 623, 669, 688, 700, 726, 732, 741, 751, 754, 771, 780, 810, 847, 867, 877, 887, 913, 932, 937, 966, 974,1137, 1140, 1150, 1173, 1175, 1195, 1143, 1177, 1178, 1181, 1225, 1245, 1247, 1257, 1268, 1291, 1303, 1344, 1348, 1356, 1358, 1398, 1408, 1422, 1476, 1477, 1478, 1488, 1535, 1544, 1568, 1578, 1586, 1629, 1643, 1650, 1762, 1771, 1795, 1869, 1877, 1910, 1915, 1919, 1929, 1939, 1966,2021, 2024, 2196, 2292, 2305, 2348, 2504, 2512, 2606, 2636, 2675, 2700, 2736, 2833, 2877,2887, 2940, 2999,3046, 3069, 3088, 3276, 3302, 3322, 3392, 3409, 3449, 3453, 3454, 3496, 3527, 3558, 3613, 3618, 3633, 3650, 3652, 3687, 3694, 3696, 3699, 3708, 3721, 3753, 3769, 3854, 3877, 3901, 3912, 3950, 3962, 3978, 3980,4020, 4021, 4030, 4031, 4051, 4089, 4286, 4298, 4403, 4519, 4537, 4658, 4665, 4782, 4879, 4931, 4951, 4960,5014, 5016, 5122, 5142, 5153, 5160, 5161, 5190, 5245, 5312, 5360, 5493, 5649,6003, 6055, 6082, 6207, 6217, 6308, 6356, 6489, 6633, 6667, 6733, 6792, 6797, 6820, 6821, 6874, 6902, 6949, 6976,9006, 9051, 9058, 9059, 9061, 9207, 9279, 9290, 9311, 9361, 9387, 9423, 9481, 9484, 9486, 9681,9725, 9731, 9820, 9851, 9913, 9938, 9954, 7031,7056,7107,7142,7205,7279,7285,7319,7366,7389,7428,7442,7474,7504,7558,7565,7571,7587,7627,7629,7661,7677,7687,7707,7768,7838,7880,7938,7967,7972,7982,8003,8048,8093,8095,8134,8197,8212,8214,8260,8274,8289,8321,8384,8410,8345,8451,8467,8493,8496,8516,8517,8530,8581,8598,8626,8734,8854,8886,8909,8911,10058)]



datostfg2[grep9000[c(274,266,263,257,236,188,37,26,93,91,77)],169]
datostfg2[grep9000[c(274,266,263,257,236,188,37,26,93,91,77)],179]="4" ###Contraindicacion relativa
datostfg2[grep8000[c(1040, 1050, 1073)],179]="4"
datostfg2[grep8000[c(1037,1075)],179]="2"
datostfg2[grep8000[c(1137,1140,1150,1173,1175)],179]
datostfg2[grep8000[c(1137,1140,1150,1173,1175)],179]="0"
datostfg2[grep8000[c(1137,1140,1150,1173,1175)],169]  





datostfg2[grep9000[c(1,3,4,6,10,19,29,39,44,45,216,209,185,173,162,160,158,157,155,152,149,113,110,106,101,100,99,94)],169]
grep17011=grep("rodar a baja Fc",datostfg2[,169])
datostfg2[grep17011,169]
datostfg2[grep17011,179]="4"
grep17012=grep("los peligros de la practica",datostfg2[,169])
datostfg2[grep17012,169]
datostfg2[grep17012,179]="4"

grep17015=grep("2",datostfg2[,179])
datostfg2[grep17015,169]
datostfg2[grep17015[c(255,141,139,105,32,1)],179]="4"

grep17016=grep("/contra",datostfg2[,169])
datostfg2[grep17016,179]
datostfg2[grep17016[c(19,31,36,44,64)],169]
datostfg2[grep17016[c(72)],169] 
datostfg2[grep17016[c(19,31,36,44,64,72)],179]="1"


datostfg2[grep9000[c(56)],169]
datostfg2[grep8000[c(1150, 1173, 1175, 1195, 1143)],169]
datostfg2[grep9000[c(5,161,107,97,78,67,65,63)],169]
datostfg2[grep9000[c(5,161,107,97,78,67,65,63)],179]="1"

datostfg2[grep8000[c(3075)],179]="0"

grep10000=grep8000[c(107, 413, 460, 638, 642, 654, 659, 674, 681, 696, 723, 758, 767, 828, 830, 853, 903, 917, 919, 920, 922, 957,1325, 1435, 1500, 1615, 1760,2114, 2332, 2564,3199, 3218, 3223, 3316, 3411, 3415, 3418, 3442, 3447, 3492, 3516, 3529, 3530, 3554, 3683, 3757, 3801, 3921,3945,4010, 4072, 4136, 4406, 4417, 4483, 4499, 4557, 4642, 4663, 4688, 4708, 4716, 4799, 4867, 4935, 4952,5009, 5021, 5049, 5168, 5175, 5220, 5455, 5829,6021, 6165, 6307, 6384, 6427, 6463, 6501, 6592, 6665, 6782, 6839,9181, 9570, 9742, 9803,7020,7221,7243,7244,7281,7394,7409,7443,7445,7463,7696,7705,7721,7772,7822,7863,7864,7886,7959,7965,8007,8033,8044,8050,8062,8154,8171,8391,8499,8526,8630,8689,8705,8711,8956,10111)]

datostfg2[grep10000[c(53,54,55,56,57,58,59,60,61,62,63,64,65)],169]
datostfg2[grep10000[c(53,54,55,56,57,58,59,60,61,62,63,64,65)],179]="1"


datostfg2[grep10000[c(123,122,120,93,92,84,81,70,68,23,13,2)],169]

grep11000=grep8000[c(24, 26, 85, 122, 166, 180, 204, 251, 435, 448, 478, 486, 518, 776, 902, 923, 948, 995,1062, 1068, 1101, 1121, 1188, 1205, 1207, 1369, 1393, 1394, 1404, 1409, 1417, 1468, 1489, 1506, 1519, 1530, 1543, 1626, 1647, 1655, 1701, 1735, 1769, 1774, 1815, 1827, 1867, 1875, 1883, 1898, 1913, 1953, 1984, 1995,2003, 2397, 2462, 2481, 2536, 2573, 2651, 2694,3011, 3128, 3161, 3162, 3225, 3229, 3238, 3255, 3304, 3376, 3563,4060, 4126, 4387, 4641, 4655, 4822, 4837, 4878,5086, 5110, 5211, 5395, 5438, 5453, 5469, 5543, 5580, 5869, 5948, 5999,6049, 6064, 6115, 6127, 6168, 6252, 6268, 6269, 6309, 6388, 6389, 6395, 6407, 6493, 6603, 6604, 6713, 6774, 6827, 6865,9060, 9137, 9173, 9278, 9364, 9365, 9377, 9406, 9417, 9420, 9429, 9449, 9639, 9698, 9717, 9746, 9754, 9787, 9819, 9877, 9893, 9894, 9926, 9977, 9998,7112,7126,7131,7147,7178,7306,7325,7328,7375,7425,7516,7567,7565,7607,7612,7631,7642,7658,7730,7751,7765,7808,7819,7825,7837,7858,7885,7893,7971,8002,8240,8256,8268,8335,8362,8369,8395,8174,8366,8480,8481,8473,8495,8512,8569,8579,8627,8629,8640,8649,8705,8712,8724,8752,8794,8820,8866,8883,8939,8940,8962,8967,8984,10105,10007)]

datostfg2[grep11000[c(189,33,36,44,60)],169]
datostfg2[grep11000[c(33,36,44)],179]="1"
datostfg2[grep11000[c(60)],179]="2"

grepumbral=grep("umbral anaer",datostfg2[,169])
datostfg2[grepumbral,169]
datostfg2[grepumbral[-c(1)],179]="4"
datostfg2[grep8000[c(8631,8618,8578,8983,8978,8953,8904,8500,8450)],169]
datostfg2[grep8000[c(8618)],179]="2"

datostfg2[,180]=NA
for (i in 1:11984){comp=(
  is.na(datostfg2[i,170])==FALSE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,180]="1"
}else{
        datostfg2[i,180]="0"
}}
table(datostfg2[,180])


datostfg2[,181]=c(rep(NA,11984))
for (i in 1:11984){comp=(
  is.na(datostfg2[i,170])==FALSE && is.na(datostfg2[i,169])==TRUE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,181]="1"
}else{
        datostfg2[i,181]="0"
}}
table(datostfg2[,181])
grep13000=grep("1",datostfg2[,181])
datostfg2[grep13000,179]="0"
grep11001=grep("12",datostfg2[,170])
datostfg2[grep11001,170]
datostfg2[grep11001[1001:2000],170]
datostfg2[grep11001[2001:3000],170]
datostfg2[grep11001[3001:3120],170]
grep11002=grep("doce",datostfg2[,170])
datostfg2[grep11002,170]
datostfg2[grep11001[1001:1004],170]
datostfg2[grep11001,180]="0"
datostfg2[grep11002,180]="0"
grep11003=grep("1",datostfg2[,180])
datostfg2[grep11003,170]
datostfg2[grep11003[1001:1023],170]

grep12000=grep("consultar al ",datostfg2[,170])
datostfg2[grep12000,170]
datostfg2[grep12000,169]
datostfg2[grep12000,179]="1"
grep12001=grep("con anterioridad",datostfg2[,170])
datostfg2[grep12001,170]
datostfg2[grep12001,169]
datostfg2[grep12001,179]="1"
grep12002=grep("pediatra",datostfg2[,170])
datostfg2[grep12002,170]
datostfg2[grep12002,169]
datostfg2[grep12002[c(4,5,6)],179]="1"
grep12003=grep("hoy aparecen",datostfg2[,170])
datostfg2[grep12003,170]
datostfg2[grep12003,169]
datostfg2[grep12003[c(1,3,6,7,12)],179]="4"
datostfg2[grep12003[c(8,9,10,11,13)],179]="0"
datostfg2[grep12003[c(2,4,5)],179]="1"
grep12004=grep("en sentido contrario",datostfg2[,170])
datostfg2[grep12004,170]
datostfg2[grep12004,169]
datostfg2[grep12004,179]="4"
grep12005=grep("con un cardi",datostfg2[,170])
datostfg2[grep12005,170]
datostfg2[grep12005,169]
datostfg2[grep12005,179]="1"
grep12006=grep("desfalleci",datostfg2[,170])
datostfg2[grep12006,170]
datostfg2[grep12006,169]
datostfg2[grep12006,179]="1"
grep12007=grep("con una ergo",datostfg2[,170])
datostfg2[grep12007,170]
datostfg2[grep12007,169]
datostfg2[grep12007,179]="1"
grep12008=grep("rterial",datostfg2[,170])
datostfg2[grep12008,170]
datostfg2[grep12008,169]
datostfg2[grep12008[c(2,4,6)],179]="4"
datostfg2[grep12008[-c(2,4,6)],179]="2"
grep12009=grep("queda pendiente ",datostfg2[,170])
datostfg2[grep12009,170]
datostfg2[grep12009,169]
datostfg2[grep12009,179]="1"
grep12010=grep("HASTA QUE NO",datostfg2[,170])
datostfg2[grep12010,170]
datostfg2[grep12010,169]
datostfg2[grep12010,179]="4"
grep12011=grep("n por cardi",datostfg2[,170])
datostfg2[grep12011,170]
datostfg2[grep12011,169]
datostfg2[grep12011,179]="1"
grep12012=grep("pendiente de",datostfg2[,170])
datostfg2[grep12012,170]
datostfg2[grep12012,169]
datostfg2[grep12012,179]="1"
grep12013=grep("^En las exploraciones",datostfg2[,170])
datostfg2[grep12013,170]
datostfg2[grep12013,169]
datostfg2[grep12013,179]="1"
grep12014=grep("/ no contra",datostfg2[,170])
datostfg2[grep12014,170]
datostfg2[grep12014,169]
datostfg2[grep12014[c(16)],179]="0"
datostfg2[grep12014[-c(16)],179]="1"
grep12015=grep("n/no contra",datostfg2[,170])
datostfg2[grep12015,170]
datostfg2[grep12015,169]
datostfg2[grep12015[c(16,14,12)],179]="0"
datostfg2[grep12015[-c(16,14,12)],179]="1"
grep12016=grep("/contra",datostfg2[,170])
datostfg2[grep12016,170]
datostfg2[grep12016,169]
datostfg2[grep12016,179]="1"
grep12017=grep("/ contra",datostfg2[,170])
datostfg2[grep12017,170]
datostfg2[grep12017,169]
datostfg2[grep12017[-c(8)],179]="1"
datostfg2[grep12017[c(8)],179]="0"
grep12018=grep("hasta valorar",datostfg2[,170])
datostfg2[grep12018,170]
datostfg2[grep12018,169]
datostfg2[grep12018,179]="4"
grep12019=grep("desaconsejan",datostfg2[,170])
datostfg2[grep12019,170]
datostfg2[grep12019,169]
datostfg2[grep12019,179]="4"
grep12020=grep("RELATIVA",datostfg2[,170])
datostfg2[grep12020,170]
datostfg2[grep12020,169]
datostfg2[grep12020[-c(4,5)],179]="4"
datostfg2[grep12020[c(4,5)],179]="0"
grep12021=grep("relativa",datostfg2[,170])
datostfg2[grep12021,170]
datostfg2[grep12021,169]
datostfg2[grep12021,179]="4"
grep12022=grep("hasta ser valorado",datostfg2[,170])
datostfg2[grep12022,170]
datostfg2[grep12022,169]
datostfg2[grep12022,179]="4"
grep12023=grep("Consultar",datostfg2[,170])
datostfg2[grep12023,170]
datostfg2[grep12023,169]
datostfg2[grep12023[c(1,2)],179]="1"
grep12024=grep("completar el estudio",datostfg2[,170])
datostfg2[grep12024,170]
datostfg2[grep12024,169]
datostfg2[grep12024[-c(1)],179]="1"
datostfg2[grep12024[c(1)],179]="3"
grep12025=grep("completar estudio",datostfg2[,170])
datostfg2[grep12025,170]
datostfg2[grep12025,169]
datostfg2[grep12025,179]="1"
grep12026=grep("nternacionales",datostfg2[,170])
datostfg2[grep12026,170]
datostfg2[grep12026,169]
datostfg2[grep12026[-c(80)],179]="1"
datostfg2[grep12026[c(80)],179]="0"
grep12027=grep("bloqueo",datostfg2[,170])
datostfg2[grep12027,170]
datostfg2[grep12027,169]
datostfg2[grep12027,179]="1"
grep12028=grep("para valorar ecocardiograma",datostfg2[,170])
datostfg2[grep12028,170]
datostfg2[grep12028,169]
datostfg2[grep12028,179]="1"
grep12029=grep("Debe ser",datostfg2[,170])
datostfg2[grep12029,170]
datostfg2[grep12029,169]
datostfg2[grep12029,179]="1"
grep12030=grep("Holter",datostfg2[,170])
datostfg2[grep12030,170]
datostfg2[grep12030,169]
datostfg2[grep12030[c(1,2)],179]="1"
datostfg2[grep12030[c(3,4)],179]="1"
grep12031=grep("Aunque no supone",datostfg2[,170])
datostfg2[grep12031,170]
datostfg2[grep12031,169]
datostfg2[grep12031,179]="4"
grep12032=grep("salvo que",datostfg2[,170])
datostfg2[grep12032,170]
datostfg2[grep12032,169]
datostfg2[grep12032,179]="1"
grep12033=grep("soplo",datostfg2[,170])
datostfg2[grep12033,170]
datostfg2[grep12033,169]
datostfg2[grep12033[c(1,2,3)],179]="1"
grep12034=grep("completar su reco",datostfg2[,170])
datostfg2[grep12034,170]
datostfg2[grep12034,169]
datostfg2[grep12034,179]="1"
grep12035=grep("quico",datostfg2[,170])
datostfg2[grep12035,170]
datostfg2[grep12035,169]
datostfg2[grep12035,179]="3"
grep12036=grep("cabecera",datostfg2[,170])
datostfg2[grep12036,170]
datostfg2[grep12036,169]
datostfg2[grep12036[c(1)],179]="2"
datostfg2[grep12036[c(2)],179]="3"
datostfg2[grep12036[-c(1,2)],179]="1"
grep12037=grep("ecocardio",datostfg2[,170])
datostfg2[grep12037,170]
datostfg2[grep12037,169]
datostfg2[grep12037[-c(6)],179]="1"
grep12038=grep("respuesta cardiovas",datostfg2[,170])
datostfg2[grep12038,170]
datostfg2[grep12038,169]
datostfg2[grep12038,179]
grep12039=grep("con test de esfuerzo",datostfg2[,170])
datostfg2[grep12039,170]
datostfg2[grep12039,169]
datostfg2[grep12039,179]="1"
grep12040=grep("a la espera de realizar",datostfg2[,170])
datostfg2[grep12040,170]
datostfg2[grep12040,169]
datostfg2[grep12040,179]
grep12041=grep("^Re",datostfg2[,170])
datostfg2[grep12041,170]
datostfg2[grep12041,169]
datostfg2[grep12041[c(67,2)],179]="1"
datostfg2[grep12041[c(259,5,11)],179]="4"
grep12042=grep("supeditar",datostfg2[,170])
datostfg2[grep12042,170]
datostfg2[grep12042,169]
datostfg2[grep12042[c(35,31,29,22)],179]="0"
datostfg2[grep12042[-c(35,31,29,22)],179]="1"
grep12044=grep("TA",datostfg2[,170])
datostfg2[grep12044,170]
datostfg2[grep12044,169]
datostfg2[grep12044[c(2)],179]="4"
datostfg2[grep12044[c(14,10,9)],179]="2"
grep12045=grep("PA",datostfg2[,170])
datostfg2[grep12045,170]
datostfg2[grep12045,169]
datostfg2[grep12045[c(4)],179]="2"
datostfg2[grep12045[c(8)],179]="5"
datostfg2[grep12045[c(8)],170]
grep12046=grep("^Se",datostfg2[,170])
datostfg2[grep12046,170]
datostfg2[grep12046,179]


####Casos sin registros cardiacos
datostfg2[,181]=NA
for (i in 1:11984){comp=(
  is.na(datostfg2[i,146])==TRUE && is.na(datostfg2[i,147])==TRUE &&is.na(datostfg2[i,148])==TRUE )
if(!is.na(comp)) if (comp) {
   datostfg2[i,181]="1"
}else{
        datostfg2[i,181]="0"
}}
table(datostfg2[,181])
grep18000=grep("1",datostfg2[,181])



table(datostfg2[,179])



#####Citas para prueba de esfuerzo
grep7036=grep("Cita U.F",datostfg2[,169])
datostfg2[grep7036,169]
datostfg2[grep7036,179]
grep7037=grep("Fisiolo",datostfg2[,169])
datostfg2[grep7037,169]
datostfg2[grep7037,179]
grep7038=grep("Cita Fisio",datostfg2[,169])
datostfg2[grep7038,169]
datostfg2[grep7038,179]

grep7039=grep("descartar",datostfg2[,169])
datostfg2[grep7039,169]
datostfg2[grep7039,179]


####La restricción/contraindicación de su práctica deportiva habitual dependerá de los resultados de las pruebas realizadas.
grep7040=grep("n/contra",datostfg2[,169])
datostfg2[grep7040,169]
datostfg2[grep7040,179]
datostfg2[grep7040[c(74,69,47,1,3,6,8,11,13,17,18,20)],179]="1"
datostfg2[grep7040[c(46,42,25)],179]="2"
grep7041=grep("con su cardi",datostfg2[,169])
datostfg2[grep7041,169]
datostfg2[grep7041[c(7,9)],179]="1"
grep7051=grep("su cardi",datostfg2[,169])
datostfg2[grep7051,169]
datostfg2[grep7051[-c(74,70,68,67,58,57,54,45,43,41,40,36,35,20,18,17,11,4,3)],179]
datostfg2[grep7051[-c(74,70,68,67,58,57,54,45,43,41,40,36,35,20,18,17,11,4,3)],169]
grep14000=grep7051[-c(74,70,68,67,58,57,54,45,43,41,40,36,35,20,18,17,11,4,3)]
datostfg2[grep14000[c(29,32)],179]="1"
####Consulta con cardiologo para valoración
grep7042=grep("con cardi",datostfg2[,169])
datostfg2[grep7042,169]
datostfg2[grep7042[c(81,66,62,22,21,13,14)],179]="1"
####Se recomienda la realización de un ecocardiograma
grep7045=grep("n de ecocardio",datostfg2[,169])
datostfg2[grep7045,169]
datostfg2[grep7045[c(24,5,7)],179]="1"
###Acudir a especialista en Cardiologia
grep7046=grep("especialista en cardi",datostfg2[,169])
datostfg2[grep7046,169]
datostfg2[grep7046,179]
grep7047=grep("especialista en Cardi",datostfg2[,169])
datostfg2[grep7047,169]
datostfg2[grep7047[-c(6,8)],179]
grep7048=grep("Cita Cardi",datostfg2[,169])
datostfg2[grep7048,169]
datostfg2[grep7048[c(6,22,23,16)],179]="1"
grep7050=grep("al cardio",datostfg2[,169])
datostfg2[grep7050,169]
datostfg2[grep7050,179]
datostfg2[grep7050[c(5)],179]="1"
grep7054=grep("del cardio",datostfg2[,169])
datostfg2[grep7054,169]
datostfg2[grep7054,179]
grep7055=grep("pendiente",datostfg2[,169])
datostfg2[grep7055,169]
datostfg2[grep7055[c(119,110,108,101,100,95,72,48,51,52,62,29,24,21,7,10,11,15)],169]
datostfg2[grep7055[c(119,110,108,101,100,95,72,48,51,52,62,29,24,21,7,10,11,15)],179]
grep7056=grep("en Sevilla",datostfg2[,169])
datostfg2[grep7056,169]
datostfg2[grep7056,179]
datostfg2[grep7056[c(20,19,16,3,5,6,9,10)],179]

####Consultar
grep7052=grep("cardiologo",datostfg2[,169])
datostfg2[grep7052,169]
datostfg2[grep7052[-c(32,2)],179]="4"


table(datostfg2[,179])

grep7070=grep("por cardi",datostfg2[,169])
datostfg2[grep7070,169]
datostfg2[grep7070[-c(62,61,59,55,50,42,24,23,18,12,3)],179]
datostfg2[grep7070[-c(62,61,59,55,50,42,24,23,18,12,3)],169]
grep14001=grep7070[-c(62,61,59,55,50,42,24,23,18,12,3)]
datostfg2[grep14001[c(38,21,8,11,10)],179]="1"


grep7083=grep("cita para prueba de esfuerzo",datostfg2[,169])
datostfg2[grep7083,169]
datostfg2[grep7083[c(192,176,18,19,20,43,42,39,48,84,81,137,136,135,132,128,138,140,139,142,143,147,148,152,153,158,160,14,28)],169]
datostfg2[grep7083[c(192,176,18,19,20,43,42,39,48,84,81,137,136,135,132,128,138,140,139,142,143,147,148,152,153,158,160,14,28)],179]
grep14002=grep7083[c(192,176,18,19,20,43,42,39,48,84,81,137,136,135,132,128,138,140,139,142,143,147,148,152,153,158,160,14,28)]
datostfg2[grep14002[c(10)],179]="2"
grep7084=grep("Se cita ",datostfg2[,169])
datostfg2[grep7084,169]
datostfg2[grep7084,179]
datostfg2[grep7084[c(35,34,33,32,23,22,21,17,15,12,5,3,1,7)],169]
datostfg2[grep7084[c(35,34,33,32,23,22,21,17,15,12,5,3,1,7)],179]
grep14003=grep7084[c(35,34,33,32,23,22,21,17,15,12,5,3,1,7)]
datostfg2[grep14003[c(13,11)],179]="1"

grep7030=grep("^Se aconseja",datostfg2[,169])
datostfg2[grep7030,169]
datostfg2[grep7030,179]
datostfg2[grep7030[c(10)],179]


grep7085=grep("soplo",datostfg2[,169])
datostfg2[grep7085,169]


datostfg2[,180]=NA
for (i in 1:11984){comp=(is.na(datostfg2[i,169])==TRUE &&
  is.na(datostfg2[i,170])==TRUE && is.na(datostfg2[i,146])==FALSE && is.na(datostfg2[i,147])==FALSE && is.na(datostfg2[i,148])==FALSE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,180]="1"
}else{
        datostfg2[i,180]="0"
}}


####Veamos aquellos pacientes en el que no hay comentarios finales,pero si previos.
table(datostfg2[,180])
grep17000=grep("1",datostfg2[,180])
datostfg2[grep17000,166]
datostfg2[grep17000[-c(1,7,19,34,79,109,118,149,171,192,196,217,218,219,231,232,233,235,236,237,238,239 ,240,241,242,248,249,250,254,262,263,264,265,266,278,279,291,303,304)],179]="0"
datostfg2[grep17000[c(1,7,19,34,79,109,118,149,171,192,196,217,218,219,231,232,233,235,236,237,238,239 ,240,241,242,248,249,250,254,262,263,264,265,266,278,279,291,303,304)],166]
datostfg2[grep17000[c(1,7,34,79,109,118,149,171,192,196,217,218,219,231,232,233,235,236,237,238,239 ,240,241,242,248,249,250,254,262,263,264,265,266,278,279,291,303,304)],179]="1"
datostfg2[grep17000[c(19)],179]="4"





datostfg2[,180]=NA
for (i in 1:11984){comp=(is.na(datostfg2[i,179])==TRUE&&
  is.na(datostfg2[i,169])==FALSE)
if(!is.na(comp)) if (comp) {
   datostfg2[i,180]="0"
}else{
        datostfg2[i,180]=datostfg2[i,180]
}}
table(datostfg2[,180])
####Ya hemos revisado todos los comentarios.


#####Vamos a realizar unas comprobaciones

grep17001=grep("No deber",datostfg2[,169])
datostfg2[grep17001,169]
datostfg2[grep17001,179]
grep17002=grep("aconsejo no seguir",datostfg2[,169])
datostfg2[grep17002,169]
datostfg2[grep17002,179]
grep17003=grep("sin realizar ejercicio",datostfg2[,169])
datostfg2[grep17003,169]
datostfg2[grep17003,179]
grep17004=grep("consultando de nuevo",datostfg2[,170])
datostfg2[grep17004,170]
datostfg2[grep17004,179]
grep17005=grep("abstenga",datostfg2[,170])
datostfg2[grep17005,170]
datostfg2[grep17005,179]
grep17006=grep("a su estado de salud",datostfg2[,170])
datostfg2[grep17006,170]
datostfg2[grep17006,179]="4"
grep17007=grep("por mayor",datostfg2[,170])
datostfg2[grep17007,170]
datostfg2[grep17007,179]="1"
grep17008=grep("Mareo en Oct",datostfg2[,170])
datostfg2[grep17008,170]
datostfg2[grep17008,179]="1"
grep17009=grep("dose la TA",datostfg2[,170])
datostfg2[grep17009,170]
datostfg2[grep17009,179]
grep17009=grep("control de TA",datostfg2[,170])
datostfg2[grep17009,170]
datostfg2[grep17009,179]
grep17010=grep("CONTRAINDICAN",datostfg2[,170])
datostfg2[grep17010,170]
datostfg2[grep17010,179]
datostfg2[grep17010[c(3)],179]="4"
grep17020=grep("urgencia",datostfg2[,169])
datostfg2[grep17020,169]
datostfg2[grep17020[c(7)],179]="5"
datostfg2[grep8000[c(642,6839)],169]
datostfg2[grep8000[c(642,6839)],179]="5"



datostfg2[,179]
table(datostfg2[,179])
datostfg2[,179]
grep20000=grep("3",datostfg2[,179])
datostfg2[grep20000,169]
datostfg2[grep20000,179]="6"

grep20001=grep("2",datostfg2[,179])
datostfg2[grep20001,169]
datostfg2[grep20001,179]="6"

table(datostfg2[,179])

grep22000=grep("4",datostfg2[,179])
datostfg2[grep22000,169]
datostfg2[grep22000[c(247,244,232,229,228,220,218,217,211,201,196,192,186,171,158,156,150,148,142,139,136,133,129,127,126,125,113,108,106)],169]
datostfg2[grep22000[c(247,244,232,229,228,220,218,217,211,201,196,192,186,171,158,156,150,148,142,139,136,133,129,127,126,125,113,108,106)],170]

datostfg2[grep22000[c(247,244,232,229,228,220,218,217,211,201,196,192,186,171,158,156,148,139,136,133,129,127,126,125,113,108,106)],179]="1"
datostfg2[grep22000[c(246)],179]="6"

datostfg2[grep22000[c(150,142)],169]
datostfg2[grep22000[c(150,142)],170]
datostfg2[grep22000[c(150,142)],179]="0"
datostfg2[grep22000[c(170,166,224)],169]="0"  ####Se debe a enfermedades neuro-genéticas o episodios que no tienen nada que ver con patologías cardíacas.


table(datostfg2[,179])

grep50000=grep("5",datostfg2[,179])
datostfg2[grep50000,179]=NA ####No las consideraré por el momento
datostfg2[,179]=as.factor(datostfg2[,179])


datostfg3=datostfg2[-c(grep18000),]

datostfg4=datostfg3[-c(grep50000),]
levels(datostfg4$V179)=c("Apto","Tejido Gris","ContraRela","AptoconRec")
colnames(datostfg4)[179]="Aptitud"
save(datostfg4,file="datostfg4.RData")
save(datostfg2,file="datostfg2.RData")



```



